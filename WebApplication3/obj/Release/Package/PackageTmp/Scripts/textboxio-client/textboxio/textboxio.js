/*
 Textbox.io JavaScript Library
 Copyright (c) 2013-2017 Ephox Corp. All rights reserved.
 This software is provided "AS IS," without a warranty of any kind.

 Version: 2.1.0.211
 Client Build: 2.1.0.271
*/
(function(){var ma,oa={},k=function(c,d,b){if("string"!==typeof c)throw"module id must be a string";if(void 0===d)throw"no dependencies for "+c;if(void 0===b)throw"no definition function for "+c;oa[c]={deps:d,defn:b,instance:void 0}},ka=function(c){var d=oa[c];if(void 0===d)throw"module ["+c+"] was undefined";if(void 0===d.instance){for(var b=oa[c],a=b.deps,e=b.defn,g=a.length,f=Array(g),h=0;h<g;++h)f[h]=ka(a[h]);a=e.apply(null,f);if(void 0===a)throw"module ["+c+"] returned undefined";b.instance=
a}return d.instance};ma={define:k,require:function(c,d){for(var b=c.length,a=Array(b),e=0;e<b;++e)a.push(ka(c[e]));d.apply(null,d)},demand:ka};var xa=ka,da=function(c,d){k(c,[],function(){return d})};k("1",[],function(){return Function("return this;")()});k("8",[],function(){return function(){return{major:"2",minor:"1",full:"2.1.0.211"}}});da("9",Array);k("7",["9"],function(c){return{noop:function(){},compose:function(c,b){return function(){return c(b.apply(null,arguments))}},constant:function(c){return function(){return c}},
identity:function(c){return c},tripleEquals:function(c,b){return c===b},curry:function(d){for(var b=new c(arguments.length-1),a=1;a<arguments.length;a++)b[a-1]=arguments[a];return function(){for(var a=new c(arguments.length),g=0;g<a.length;g++)a[g]=arguments[g];a=b.concat(a);return d.apply(null,a)}},not:function(c){return function(){return!c.apply(null,arguments)}},die:function(c){return function(){throw c;}},apply:function(c){return c()},call:function(c){c()}}});k("2",["8","7"],function(c,d){return function(b){b=
d.die(b);return{replace:b,replaceAll:b,inline:b,inlineAll:b,get:b,getActiveEditor:b,definePlugin:b,version:c,isSupported:d.constant(!1)}}});da("w",String);k("a",["9","w"],function(c,d){var b=function(a){return function(b){if(null===b)b="null";else{var g=typeof b;b="object"===g&&c.prototype.isPrototypeOf(b)?"array":"object"===g&&d.prototype.isPrototypeOf(b)?"string":g}return b===a}};return{isString:b("string"),isObject:b("object"),isArray:b("array"),isNull:b("null"),isBoolean:b("boolean"),isUndefined:b("undefined"),
isFunction:b("function"),isNumber:b("number")}});k("b",["9","w"],function(c,d){var b=function(a){return function(b){return a===b}},a=function(){var a=c.prototype.indexOf,e=function(b,e){return a.call(b,e)},d=function(a,e){return n(a,b(e))};return void 0===a?d:e}(),e=function(b,e){return-1<a(b,e)},g=function(a,b){for(var e=a.length,d=new c(e),f=0;f<e;f++)d[f]=b(a[f],f,a);return d},f=function(a,b){for(var e=0,c=a.length;e<c;e++)b(a[e],e,a)},h=function(a,b){for(var e=[],c=0,d=a.length;c<d;c++){var f=
a[c];b(f,c,a)&&e.push(f)}return e},l=function(a,b,e){f(a,function(a){e=b(e,a)});return e},m=function(a,b){for(var e=0,c=a.length;e<c;e++){var d=a[e];if(b(d,e,a))return d}},n=function(a,b){for(var e=b||q,c=0,d=a.length;c<d;++c)if(!0===e(a[c]))return c;return-1},p=c.prototype.push,r=function(a){for(var b=[],e=0,c=a.length;e<c;++e)p.apply(b,a[e]);return b},q=b(!0),s=function(a,b){for(var e=b||q,c=0,d=a.length;c<d;++c)if(!0!==e(a[c],c))return!1;return!0},t=c.prototype.slice,u=function(a){a=t.call(a,0);
a.reverse();return a};return{map:g,each:f,partition:function(a,b){for(var e=[],c=[],d=0,f=a.length;d<f;d++){var g=a[d];(b(g,d,a)?e:c).push(g)}return{pass:e,fail:c}},filter:h,groupBy:function(a,b){if(0===a.length)return[];for(var e=b(a[0]),c=[],d=[],f=0,g=a.length;f<g;f++){var h=a[f],l=b(h);l!==e&&(c.push(d),d=[]);e=l;d.push(h)}0!==d.length&&c.push(d);return c},indexOf:a,foldr:function(a,b,e){return l(u(a),b,e)},foldl:l,find:m,findIndex:n,findOr:function(a,b,e){a=m(a,b);return void 0!==a?a:e},findOrDie:function(a,
b,e){b=m(a,b);if(void 0===b)throw e||"Could not find element in array: "+d(a);return b},flatten:r,bind:function(a,b){var e=g(a,b);return r(e)},forall:s,exists:function(a,b){return-1<n(a,b)},contains:e,equal:function(a,b){return a.length===b.length&&s(a,function(a,e){return a===b[e]})},reverse:u,chunk:function(a,b){for(var e=[],c=0;c<a.length;c+=b){var d=a.slice(c,c+b);e.push(d)}return e},difference:function(a,b){return h(a,function(a){return!e(b,a)})},mapToObject:function(a,b){for(var e={},c=0,f=
a.length;c<f;c++){var g=a[c];e[d(g)]=b(g,c)}return e},pure:function(a){return[a]}}});k("x",["7"],function(c){return function(d,b,a){var e=d.isiOS()&&!0===/ipad/i.test(a),g=d.isiOS()&&!e,f=d.isAndroid()&&3===d.version.major,h=d.isAndroid()&&4===d.version.major,f=e||f||h&&!0===/mobile/i.test(a),l=(h=d.isiOS()||d.isAndroid())&&!f;b=b.isSafari()&&d.isiOS()&&!1===/safari/i.test(a);return{isiPad:c.constant(e),isiPhone:c.constant(g),isTablet:c.constant(f),isPhone:c.constant(l),isTouch:c.constant(h),isAndroid:d.isAndroid,
isiOS:d.isiOS,isWebView:c.constant(b)}}});k("y",[],function(){return{create:function(c,d,b){return{browser:{current:c,version:d},os:{current:b}}}}});k("1r",[],function(){var c=function(c){return function(){return c}};return{getter:c,attachGetters:function(d,b,a){for(var e=0;e<a.length;e++)d["is"+a[e].name]=c(a[e].name===b)}}});k("z",["1r"],function(c){return{create:function(d,b,a){var e=c.attachGetters,g={};g.current=b;g.version=a;e(g,g.current,d);return g}}});da("1s",Math);da("1t",isFinite);da("1u",
isNaN);da("1v",parseFloat);k("1k",["1s","1t","1u","1v"],function(c,d,b,a){var e=function(a){return function(b,e){var c=typeof e;if(c!==a)throw b+" was not a "+a+". Was: "+e+" ("+c+")";}},g=e("string"),f=e("number"),h=function(a,b){f(a,b);if(b!==c.abs(b))throw a+" was not an integer. Was: "+b;};return{vString:g,vChar:function(a,b){g(a,b);if(1!==b.length)throw a+" was not a single char. Was: "+b;},vInt:h,vNat:function(a,b){h(a,b);if(0>b)throw a+" was not a natural number. Was: "+b;},pNum:function(e){return!b(a(e))&&
d(e)}}});k("v",["1k"],function(c){var d=function(a,b,e){return""===b?!0:a.length<b.length?!1:a.substr(e,e+b.length)===b},b=function(a){var b=function(a,b){for(var e=[],c=0;c<a.length;c++)e.push(b(a[c]));return e};return function(){var e=b(arguments,function(a){return"string"===typeof a?a.toLowerCase():a});return a.apply(this,e)}},a=function(a,b){return d(a,b,0)},e=b(a),g=function(a,b){return d(a,b,a.length-b.length)},f=b(g),h=function(a,b){return a.substr(0,b)},l=function(a,b){return a.substr(a.length-
b,a.length)},m=function(a,b){return function(e,c){return a(e,c)?b(e,e.length-c.length):e}},n=m(a,l),m=m(g,h),p=function(a,b){return function(e,c){return a(e,c)?e:b(e,c)}},r=p(a,function(a,b){return b+a}),p=p(g,function(a,b){return a+b}),q=function(a,b){return-1!=a.indexOf(b)},s=b(q),t=function(a,b){return a===b},b=b(t),u=function(a){if(""===a)throw"head on empty string";return a.substr(0,1)},v=function(a){if(""===a)throw"tail on empty string";return a.substr(1,a.length-1)},w=function(a,b){c.vString("str",
a);c.vNat("num",b);for(var e="",d=0;d<b;d++)e+=a;return e},x=function(a){return function(b,e,d){c.vString("str",b);c.vChar("c",e);c.vNat("width",d);var f=b.length;return f>=d?b:a(b,w(e,d-f))}},y=x(function(a,b){return b+a}),x=x(function(a,b){return a+b});return{supplant:function(a,b){return a.replace(/\${([^{}]*)}/g,function(a,e){var c=b[e],d=typeof c;return"string"===d||"number"===d?c:a})},startsWith:a,startsWithIgnoringCase:e,endsWith:g,endsWithIgnoringCase:f,first:h,last:l,removeLeading:n,removeTrailing:m,
ensureLeading:r,ensureTrailing:p,trim:function(a){return a.replace(/^\s+|\s+$/g,"")},lTrim:function(a){return a.replace(/^\s+/g,"")},rTrim:function(a){return a.replace(/\s+$/g,"")},contains:q,containsIgnoringCase:s,htmlEncodeDoubleQuotes:function(a){return a.replace(/\"/gm,"&quot;")},equals:t,equalsIgnoringCase:b,head:u,repead:w,padLeft:y,padRight:x,toe:function(a){if(""===a)throw"toe on empty string";return a.substr(a.length-1,a.length)},tail:v,torso:function(a){if(""===a)throw"torso on empty string";
return a.substr(0,a.length-1)},capitalize:function(a){return""===a?a:u(a).toUpperCase()+v(a)}}});k("10",["v"],function(c){var d=c.contains,b=function(a){return function(b){return d(b,a)}},a=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/;return{create:function(e){var c=[{name:"Spartan",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(a){return d(a,"edge/")&&d(a,"chrome")&&d(a,"safari")&&d(a,"applewebkit")}},{name:"ChromeFrame",versionRegexes:[/.*?chromeframe\/([0-9]+)\.([0-9]+).*/,a],search:function(a){return d(a,
"chromeframe")?e():!1}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,a],search:function(a){return d(a,"chrome")&&!d(a,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(a){var b=d(a,"msie")||d(a,"trident");return d(a,"chromeframe")?b&&!e():b}},{name:"Opera",versionRegexes:[a,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:b("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:b("firefox")},
{name:"Safari",versionRegexes:[a,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(a){return(d(a,"safari")||d(a,"mobile/"))&&d(a,"applewebkit")}},{name:"Envjs",versionRegexes:[/.*?envjs\/\ ?([0-9]+)\.([0-9]+).*/],search:b("envjs")}],f=[{name:"Windows",search:b("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(a){return d(a,"iphone")||d(a,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},
{name:"Android",search:b("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:b("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:b("linux")},{name:"Solaris",search:b("sunos")},{name:"FreeBSD",search:b("freebsd")}];return{browsers:c,oses:f}},chromeFrameChecker:function(){try{return!!new ActiveXObject("ChromeTab.ChromeFrame")}catch(a){return!1}}}});k("11",[],function(){return{meetsSpec:function(c,d){var b=typeof c;if("boolean"===b)return!!c;
if("object"===b)return b=c.minimum,d.major>b.major||d.major===b.major&&d.minor>=b.minor;throw"invalid spec";}}});k("1w",[],function(){return{findOneInArrayOr:function(c,d,b){for(var a=0;a<c.length;a++){var e=c[a];if(b(e,a,c))return e}return d}}});k("12",["1w"],function(c){return{detect:function(d,b){var a=c.findOneInArrayOr,e=String(b).toLowerCase();return a(d,{name:void 0},function(a){return a.search(e)})}}});k("13",[],function(){return{detectVersion:function(c,d){var b=String(d).toLowerCase(),a=
c.versionRegexes;if(a){a:{for(var e=0;e<a.length;e++){var g=a[e];if(g.test(b)){a=g;break a}}a=void 0}b=a?{major:Number(b.replace(a,"$1")),minor:Number(b.replace(a,"$2"))}:{major:0,minor:0}}else b={major:0,minor:0};return b}}});k("c","x y z 10 11 12 13".split(" "),function(c,d,b,a,e,g,f){var h=f.detectVersion,l=b.create,m=e.meetsSpec,n=g.detect,p=function(a,b,e,c){return a[b]?a[b][e]?m(a[b][e],c):!!a[b].All:!1},r=function(b,e){var d=a.create(e),f=d.browsers,d=d.oses,g=n(d,b),m=g.name,g=h(g,b),r=n(f,
b),y=r.name,B=h(r,b),d=l(d,m,g),f=l(f,y,B),g=c(d,f,b);return{browser:f,os:d,deviceType:g,isSupported:function(a){return p(a,m,y,B)}}};return{Platform:d,detect:function(){return r(navigator.userAgent,a.chromeFrameChecker)},doDetect:r,isSupported:p,isSupportedPlatform:function(a,b){var e=b.browser;return p(a,b.os.current,e.current,e.version)}}});k("4g",["b"],function(c){var d=function(b){return b.replace(/\./g,"-")};return{create:function(b){var a=d(b);return{resolve:function(b){b=b.split(" ");return c.map(b,
function(b){return a+"-"+b}).join(" ")}}},cssNamespace:d,cssClass:function(b,a){return b+"-"+a}}});k("33",["4g"],function(c){return{resolve:c.create("ephox-polish").resolve}});k("1x",["33"],function(c){return c});da("19",Object);k("s",["7","19"],function(c,d){var b=c.constant(!1),a=c.constant(!0),e=function(){return g},g=function(){var f=function(a){return a.isNone()},g=function(a){return a()},m=function(a){return a},f={fold:function(a,b){return a()},is:b,isSome:b,isNone:a,getOr:m,getOrThunk:g,getOrDie:function(a){throw a||
"error: getOrDie called on none.";},or:m,orThunk:g,map:e,ap:e,each:e,bind:e,flatten:e,exists:b,forall:a,filter:e,equals:f,equals_:f,toArray:function(){return[]},toString:c.constant("none()")};d.freeze&&d.freeze(f);return f}(),f=function(c){var d=function(){return c},m=function(){return r},n=function(a){return f(a(c))},p=function(a){return a(c)},r={fold:function(a,b){return b(c)},is:function(a){return c===a},isSome:a,isNone:b,getOr:d,getOrThunk:d,getOrDie:d,or:m,orThunk:m,map:n,ap:function(a){return a.fold(e,
function(a){return f(a(c))})},each:n,bind:p,flatten:d,exists:p,forall:p,filter:function(a){return a(c)?r:g},equals:function(a){return a.is(c)},equals_:function(a,e){return a.fold(b,function(a){return e(c,a)})},toArray:function(){return[c]},toString:function(){return"some("+c+")"}};return r};return{some:f,none:e,from:function(a){return null===a||void 0===a?g:f(a)},equals:function(a,b){return a.equals(b)},equals_:function(a,b,e){return a.equals_(b,e)}}});k("2x",[],function(){return function(c,d,b){var a=
b||!1,e=function(){d();a=!0},g=function(){c();a=!1};return{on:e,off:g,toggle:function(){(a?g:e)()},isOn:function(){return a}}}});k("1o",["19"],function(c){var d=function(){var a=c.keys,b=function(a){var b=[],e;for(e in a)a.hasOwnProperty(e)&&b.push(e);return b};return void 0===a?b:a}(),b=function(a,b){for(var e=d(a),c=0,g=e.length;c<g;c++){var p=e[c];b(a[p],p,a)}},a=function(a,e){var c={};b(a,function(b,d){var g=e(b,d,a);c[g.k]=g.v});return c},e=function(a,e){var c=[];b(a,function(a,b){c.push(e(a,
b))});return c},g=function(a){return e(a,function(a){return a})};return{bifilter:function(a,e){var c={},d={};b(a,function(a,b){(e(a,b)?c:d)[b]=a});return{t:c,f:d}},each:b,map:function(b,e){return a(b,function(a,b,c){return{k:b,v:e(a,b,c)}})},mapToArray:e,tupleMap:a,find:function(a,b){for(var e=d(a),c=0,g=e.length;c<g;c++){var p=e[c],r=a[p];if(b(r,p,a))return r}},keys:d,values:g,size:function(a){return g(a).length}}});k("1q",[],function(){return{ATTRIBUTE:2,CDATA_SECTION:4,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,
DOCUMENT_FRAGMENT:11,ELEMENT:1,TEXT:3,PROCESSING_INSTRUCTION:7,ENTITY_REFERENCE:5,ENTITY:6,NOTATION:12}});k("21",["1q"],function(c){var d=function(a){return a.dom().nodeName.toLowerCase()},b=function(a){return a.dom().nodeType},a=function(a){return function(e){return b(e)===a}},e=a(c.ELEMENT),g=a(c.TEXT),a=a(c.DOCUMENT);return{name:d,type:b,value:function(a){return a.dom().nodeValue},isElement:e,isText:g,isDocument:a,isComment:function(a){return b(a)===c.COMMENT||"#comment"===d(a)}}});da("n",Error);
k("o",[],function(){"undefined"===typeof console&&(console={log:function(){}});return console});k("1a","a b 1o 21 n o".split(" "),function(c,d,b,a,e,g){var f=function(a,b,d){if(c.isString(d)||c.isBoolean(d)||c.isNumber(d))a.setAttribute(b,d+"");else throw g.error("Invalid call to Attr.set. Key ",b,":: Value ",d,":: Element ",a),new e("Attribute value was not simple");},h=function(a,b,e){f(a.dom(),b,e)},l=function(a,b){var e=a.dom().getAttribute(b);return null===e?void 0:e},m=function(a,b){var e=a.dom();
return e&&e.hasAttribute?e.hasAttribute(b):!1};return{clone:function(a){return d.foldl(a.dom().attributes,function(a,b){a[b.name]=b.value;return a},{})},set:h,setAll:function(a,e){var c=a.dom();b.each(e,function(a,b){f(c,b,a)})},get:l,has:m,remove:function(a,b){a.dom().removeAttribute(b)},hasNone:function(a){a=a.dom().attributes;return void 0===a||null===a||0===a.length},transfer:function(b,e,c){a.isElement(b)&&a.isElement(e)&&d.each(c,function(a){m(b,a)&&!m(e,a)&&h(e,a,l(b,a))})}}});k("4h",["b",
"1a"],function(c,d){var b=function(a,b){var c=d.get(a,b);return void 0===c||""===c?[]:c.split(" ")};return{read:b,add:function(a,e,c){c=b(a,e).concat([c]);d.set(a,e,c.join(" "))},remove:function(a,e,g){var f=c.filter(b(a,e),function(a){return a!==g});0<f.length?d.set(a,e,f.join(" ")):d.remove(a,e)}}});k("34",["b","4h"],function(c,d){var b=function(a){return d.read(a,"class")},a=function(a,b){return d.add(a,"class",b)},e=function(a,b){return d.remove(a,"class",b)};return{get:b,add:a,remove:e,toggle:function(d,
f){c.contains(b(d),f)?e(d,f):a(d,f)},supports:function(a){return void 0!==a.dom().classList}}});k("1y",["2x","1a","34"],function(c,d,b){var a=function(a,c){return b.supports(a)&&a.dom().classList.contains(c)};return{add:function(a,c){b.supports(a)?a.dom().classList.add(c):b.add(a,c)},remove:function(a,c){b.supports(a)?a.dom().classList.remove(c):b.remove(a,c);0===(b.supports(a)?a.dom().classList:b.get(a)).length&&d.remove(a,"class")},toggle:function(a,c){return b.supports(a)?a.dom().classList.toggle(c):
b.toggle(a,c)},toggler:function(e,d){var f=b.supports(e),h=e.dom().classList;return c(function(){f?h.remove(d):b.remove(e,d)},function(){f?h.add(d):b.add(e,d)},a(e,d))},has:a}});da("q",document);k("l",["7","n","o","q"],function(c,d,b,a){var e=function(a){if(null===a||void 0===a)throw new d("Node cannot be null or undefined");return{dom:c.constant(a)}};return{fromHtml:function(c,d){var h=(d||a).createElement("div");h.innerHTML=c;if(!h.hasChildNodes()||1<h.childNodes.length)throw b.error("HTML does not have a single root node",
c),"HTML must have a single root node";return e(h.childNodes[0])},fromTag:function(b,c){var d=(c||a).createElement(b);return e(d)},fromText:function(b,c){var d=(c||a).createTextNode(b);return e(d)},fromDom:e}});k("14",["1x","7","s","1y","l"],function(c,d,b,a,e){return function(){var g=b.none(),f=c.resolve("layer-editor-active"),h=function(b){a.remove(e.fromDom(b.element()),f)},l=function(c){g.filter(function(a){return a!==c.api}).each(h);a.add(e.fromDom(c.api.element()),f);g=b.some(c.api)};return{add:function(a){var c=
d.curry(l,a);g=g.orThunk(function(){a.api.events.loaded.addListener(c);return b.some(a.api)});a.api.events.focus.addListener(c)},get:function(){return g},remove:function(a){g.is(a.api)&&(g=b.none())}}}});k("2h",["1"],function(c){var d=function(b,a){for(var e=a||c,d=0;d<b.length&&void 0!==e&&null!==e;++d)e=e[b[d]];return e};return{path:d,resolve:function(b,a){var c=b.split(".");return d(c,a)}}});k("2i",["2h"],function(c){return{getOrDie:function(d,b){var a=c.resolve(d,b);if(void 0===a)throw d+" not available on this browser";
return a}}});k("1p",["2h","2i"],function(c,d){return{isPrototypeOf:function(b){var a=c.resolve("ownerDocument.defaultView",b);return d.getOrDie("HTMLElement",a).prototype.isPrototypeOf(b)}}});k("i",["a","b","1p","7","n"],function(c,d,b,a,e){var g=function(b,c,d,f,g,h){return{name:a.constant(b),output:a.constant(h||b),required:a.constant(f),validate:function(a){if(!d(a))throw a=g(b,c),new e(a);}}},f=function(a,b){return'value of "'+a+'" is not a '+b},h=function(a,b){return'value of "'+a+'" is not an '+
b},l=function(a,b,c){return function(e,d){return g(e,a,b,!0,c,d)}},m=function(a){return b.isPrototypeOf(a)},n=function(a){return c.isString(a)||c.isArray(a)||c.isObject(a)},p=l("array",c.isArray,h),r=l("boolean",c.isBoolean,f),q=l("function",c.isFunction,f),s=l("number",c.isNumber,f),t=l("object",c.isObject,h),u=l("string",c.isString,f),f=l("DOM element",m,f),v=l("string or an array",function(a){return c.isString(a)||c.isArray(a)},h),l=l("string or a DOM element",function(a){return c.isString(a)||
m(a)},h);return{arrayOfStrings:function(a){return g(a,"array of strings",function(b){p(a).validate(b);return d.forall(b,c.isString)},!0,h)},arrayOfObjects:function(a){return g(a,"array of objects",function(b){p(a).validate(b);return d.forall(b,c.isObject)},!0,h)},arrayOfToolbarGroups:function(a){return g(a,"array of toolbar groups",function(b){p(a).validate(b);return d.forall(b,n)},!0,h)},bool:r,domElement:f,func:q,number:s,object:t,string:u,stringOrArray:v,stringOrDom:l,param:g}});k("2g",["i"],function(c){return{paramList:function(){return[c.object("aria"),
c.func("fetch"),c.func("menuComplete"),c.func("menuExtra"),c.func("menuHover"),c.string("hoverSelector"),c.func("hover")]},encodeWithEditorApi:function(){return["menuComplete"]}}});k("6",["a","9"],function(c,d){var b=function(a){return function(){for(var b=new d(arguments.length),c=0;c<b.length;c++)b[c]=arguments[c];if(0===b.length)throw"Can't merge zero objects";for(var c={},h=0;h<b.length;h++){var l=b[h],m;for(m in l)l.hasOwnProperty(m)&&(c[m]=a(c[m],l[m]))}return c}},a=b(function(b,d){return c.isObject(b)&&
c.isObject(d)?a(b,d):d}),b=b(function(a,b){return b});return{deepMerge:a,merge:b}});k("1z","a b 1o 2g 6 7".split(" "),function(c,d,b,a,e,g){var f=function(a,b,c){return d.map(a,function(a){return b(a,c)})},h=function(a,b){if(c.isString(a))return a;if(c.isArray(a))return f(a,h,b);if(c.isObject(a)&&void 0!==a.action){var d=g.compose(a.action,b);return e.merge(a,{action:d})}d=f(a.items,h,b);return e.deepMerge(a,{items:d})};return{mentions:function(c,e){var f=a.encodeWithEditorApi();return b.map(c,function(a,
b){return d.contains(f,b)?function(b){return a(e(),b)}:a})},toolbar:function(a,b){return void 0===a.items?a:{items:f(a.items,h,b)}}}});k("p",["7","s"],function(c,d){var b=function(a){return e(function(b,c){return c(a)})},a=function(a){return e(function(b,c){return b(a)})},e=function(e){var f=function(){return e(c.constant(!1),c.constant(!0))},h=c.not(f),l=function(a){return m(function(c){return b(a(c))})},m=function(b){return e(a,b)};return{is:function(a){return e(c.constant(!1),function(b){return b===
a})},isValue:f,isError:h,getOr:function(a){return e(c.constant(a),c.identity)},getOrThunk:function(a){return e(a,c.identity)},getOrDie:function(){return e(function(a){c.die(a)()},c.identity)},or:function(a){return e(c.constant(a),b)},orThunk:function(a){return e(a,b)},fold:e,map:l,each:l,bind:m,exists:function(a){return e(c.constant(!1),a)},forall:function(a){return e(c.constant(!0),a)},toOption:function(){return e(d.none,d.some)}}};return{value:b,error:a}});da("20",Date);k("15","1z 6 s p 20 w".split(" "),
function(c,d,b,a,e,g){var f=function(){var a=(new e).getTime();return g(a).slice(-6)};return function(e,g,m){var n=b.from(e.ui.editorName).map(a.error);m=m.map(a.value);n=n.or(m).getOrThunk(function(){return a.value(f())});m=c.toolbar(e.platform.toolbar,g);g=c.mentions(e.mentions,g);return d.deepMerge(e,{ui:{editorName:n},platform:{toolbar:m},mentions:g})}});k("m","1q b s l n q".split(" "),function(c,d,b,a,e,g){var f=function(){var a=g.createElement("span");return void 0!==a.matches?0:void 0!==a.msMatchesSelector?
1:void 0!==a.webkitMatchesSelector?2:void 0!==a.mozMatchesSelector?3:-1}(),h=c.ELEMENT,l=c.DOCUMENT;return{all:function(b,c){var e=void 0===c?g:c.dom();return e.nodeType!==h&&e.nodeType!==l||0===e.childElementCount?[]:d.map(e.querySelectorAll(b),a.fromDom)},is:function(a,b){var c=a.dom();if(c.nodeType!==h)return!1;if(0===f)return c.matches(b);if(1===f)return c.msMatchesSelector(b);if(2===f)return c.webkitMatchesSelector(b);if(3===f)return c.mozMatchesSelector(b);throw new e("Browser lacks native selectors");
},one:function(c,e){var d=void 0===e?g:e.dom();return d.nodeType!==h&&d.nodeType!==l||0===d.childElementCount?b.none():b.from(d.querySelector(c)).map(a.fromDom)}}});k("16",["b","s","m"],function(c,d,b){return function(){var a=[];return{get:function(b){return d.from(c.find(a,function(a){return a.is(b)}))},findAll:function(e){var d=b.all(e);return c.filter(a,function(a){return c.exists(d,a.is)})},add:function(b){a.push(b)},remove:function(b){b=c.indexOf(a,b);a.splice(b,1)}}}});k("17",["s","21"],function(c,
d){return{one:function(b,a,e){var g=d.name(b);return c.from(a[g]).map(function(a){return a.replace(b,e)})}}});k("r",[],function(){return{cached:function(c){var d=!1,b;return function(){d||(d=!0,b=c.apply(null,arguments));return b}}}});k("2m",["r","l","21","q"],function(c,d,b,a){var e=function(a){a=a.dom().body;if(null===a||void 0===a)throw"Body is not available yet";return d.fromDom(a)};return{body:c.cached(function(){return e(d.fromDom(a))}),getBody:e,inBody:function(a){a=b.isText(a)?a.dom().parentNode:
a.dom();return void 0!==a&&null!==a&&a.ownerDocument.body.contains(a)}}});k("35",[],function(){return{isSupported:function(c){return void 0!==c.style}}});da("36",window);k("2n","a b 1o s 1a 2m l 21 35 v n o 36".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r){var q=function(a,b,e){if(!c.isString(e))throw p.error("Invalid call to CSS.set. Property ",b,":: Value ",e,":: Element ",a),new n("CSS value must be a string: "+e);l.isSupported(a)&&a.style.setProperty(b,e)},s=function(a,b,c){a=a.dom();q(a,b,c)},
t=function(a,b){return l.isSupported(a)?a.style.getPropertyValue(b):""},u=function(b,c){var e=b.dom(),e=t(e,c);return a.from(e).filter(function(a){return 0<a.length})},v=function(a,b,c){u(a,c).each(function(a){u(b,c).isNone()&&s(b,c,a)})};return{copy:function(a,b){var c=a.dom(),e=b.dom();l.isSupported(c)&&l.isSupported(e)&&(e.style.cssText=c.style.cssText)},set:s,preserve:function(a,b){var c=e.get(a,"style"),d=b(a);(void 0===c?e.remove:e.set)(a,"style",c);return d},setAll:function(a,c){var e=a.dom();
b.each(c,function(a,b){q(e,b,a)})},setOptions:function(a,c){var e=a.dom();b.each(c,function(a,b){a.fold(function(){l.isSupported(e)&&e.style.removeProperty(b)},function(a){q(e,b,a)})})},remove:function(a,b){var c=a.dom();l.isSupported(c)&&c.style.removeProperty(b);e.has(a,"style")&&""===m.trim(e.get(a,"style"))&&e.remove(a,"style")},get:function(a,b){var c=a.dom(),e=r.getComputedStyle(c).getPropertyValue(b),c=""!==e||g.inBody(a)?e:t(c,b);return null===c?void 0:c},getRaw:u,isValidValue:function(a,
b,c){a=f.fromTag(a);s(a,b,c);return u(a,b).isSome()},reflow:function(a){return a.dom().offsetWidth},transfer:function(a,b,c){h.isElement(a)&&h.isElement(b)&&d.each(c,function(c){v(a,b,c)})}}});k("2b",["2i"],function(c){return{documentPositionPreceding:function(d,b){var a=c.getOrDie("Node").DOCUMENT_POSITION_PRECEDING;return 0!==(d.compareDocumentPosition(b)&a)},documentPositionContainedBy:function(d,b){var a=c.getOrDie("Node").DOCUMENT_POSITION_CONTAINED_BY;return 0!==(d.compareDocumentPosition(b)&
a)}}});k("1b",["b","c","2b","7","m"],function(c,d,b,a,e){var g=function(a,b){return a.dom()===b.dom()},f=function(a,b){var c=a.dom(),e=b.dom();return c===e?!1:c.contains(e)},h=function(a,c){return b.documentPositionContainedBy(a.dom(),c.dom())};d=d.detect().browser.isIE()?h:f;return{eq:g,isEqualNode:function(a,b){return a.dom().isEqualNode(b.dom())},member:function(b,e){return c.exists(e,a.curry(g,b))},contains:d,is:e.is}});k("4f",["a","s"],function(c,d){return function(b,a,e,g,f){return b(e,g)?d.some(e):
c.isFunction(f)&&f(e)?d.none():a(e,g,f)}});k("4i","a b 7 s 2m 1b l 4f".split(" "),function(c,d,b,a,e,g,f,h){var l=function(e,d,g){e=e.dom();for(g=c.isFunction(g)?g:b.constant(!1);e.parentNode;){e=e.parentNode;var h=f.fromDom(e);if(d(h))return a.some(h);if(g(h))break}return a.none()},m=function(c,e){var g=d.find(c.dom().childNodes,b.compose(e,f.fromDom));return a.from(g).map(f.fromDom)},n=function(b,c){var e=function(b){for(var d=0;d<b.childNodes.length;d++){if(c(f.fromDom(b.childNodes[d])))return a.some(f.fromDom(b.childNodes[d]));
var g=e(b.childNodes[d]);if(g.isSome())return g}return a.none()};return e(b.dom())};return{first:function(a){return n(e.body(),a)},ancestor:l,closest:function(a,b,c){return h(function(a){return b(a)},l,a,b,c)},sibling:function(b,c){var e=b.dom();return e.parentNode?m(f.fromDom(e.parentNode),function(a){return!g.eq(b,a)&&c(a)}):a.none()},child:m,descendant:n}});k("37",["4i"],function(c){return{any:function(d){return c.first(d).isSome()},ancestor:function(d,b,a){return c.ancestor(d,b,a).isSome()},closest:function(d,
b,a){return c.closest(d,b,a).isSome()},sibling:function(d,b){return c.sibling(d,b).isSome()},child:function(d,b){return c.child(d,b).isSome()},descendant:function(d,b){return c.descendant(d,b).isSome()}}});k("39",["b","1o","7","9"],function(c,d,b,a){return{product:function(e,g){return{nu:function(){for(var d=new a(arguments.length),g=0;g<d.length;g++)d[g]=arguments[g];if(e.length!==d.length)throw'Wrong number of arguments to struct. Expected "['+e.length+']", got '+d.length+" arguments";var l={};
c.each(e,function(a,c){l[a]=b.constant(d[c])});return l},eq:function(a,c){for(var d=0;d<e.length;d++){var m=e[d];if(!(g&&g[d]||b.tripleEquals)(a[m](),c[m]()))return!1}return!0},evaluate:function(a){return d.map(a,function(a){return a()})}}}}});k("38",["39"],function(c){return function(){return c.product(arguments).nu}});k("4j",["a","b"],function(c,d){var b=function(a){return a.slice(0).sort()};return{sort:b,reqMessage:function(a,c){throw"All required keys ("+b(a).join(", ")+") were not specified. Specified keys were: "+
b(c).join(", ")+".";},unsuppMessage:function(a){throw"Unsupported keys for object: "+b(a).join(", ");},validateStrArr:function(a,b){if(!c.isArray(b))throw"The "+a+" fields must be an array. Was: "+b+".";d.each(b,function(b){if(!c.isString(b))throw"The value "+b+" in the "+a+" fields was not a string.";})},invalidTypeMessage:function(a,c){throw"All values need to be of type: "+c+". Keys ("+b(a).join(", ")+") were not.";},checkDupes:function(a){var c=b(a);a=d.find(c,function(a,b){return b<c.length-
1&&a===c[b+1]});if(void 0!==a&&null!==a)throw"The field: "+a+" occurs more than once in the combined fields: ["+c.join(", ")+"].";}}});k("3a","b 1o 7 s 4j 19".split(" "),function(c,d,b,a,e,g){return function(f,h){var l=f.concat(h);if(0===l.length)throw"You must specify at least one required or optional field.";e.validateStrArr("required",f);e.validateStrArr("optional",h);e.checkDupes(l);return function(m){var n=d.keys(m);c.forall(f,function(a){return c.contains(n,a)})||e.reqMessage(f,n);var p=c.filter(n,
function(a){return!c.contains(l,a)});0<p.length&&e.unsuppMessage(p);var r={};c.each(f,function(a){r[a]=b.constant(m[a])});c.each(h,function(c){r[c]=b.constant(g.prototype.hasOwnProperty.call(m,c)?a.some(m[c]):a.none())});return r}}});k("2u",["38","39","3a"],function(c,d,b){return{immutable:c,immutable2:d,immutableBag:b}});k("3b",[],function(){return{toArray:function(c,d){var b=[],a=function(a){b.push(a);return d(a)},e=d(c);do e=e.bind(a);while(e.isSome());return b}}});k("2a","a b 7 s 2u 3b 1b l".split(" "),
function(c,d,b,a,e,g,f,h){var l=function(a){return h.fromDom(a.dom().ownerDocument)},m=function(b){b=b.dom();return a.from(b.parentNode).map(h.fromDom)},n=function(b){b=b.dom();return a.from(b.previousSibling).map(h.fromDom)},p=function(b){b=b.dom();return a.from(b.nextSibling).map(h.fromDom)},r=function(a){a=a.dom();return d.map(a.childNodes,h.fromDom)},q=function(b,c){var e=b.dom().childNodes;return a.from(e[c]).map(h.fromDom)},s=e.immutable("element","offset");return{owner:l,defaultView:function(a){a=
a.dom().ownerDocument.defaultView;return h.fromDom(a)},documentElement:function(a){a=l(a);return h.fromDom(a.dom().documentElement)},parent:m,findIndex:function(b){return m(b).bind(function(c){c=r(c);c=d.findIndex(c,function(a){return f.eq(b,a)});return-1<c?a.some(c):a.none()})},parents:function(a,e){for(var d=c.isFunction(e)?e:b.constant(!1),f=a.dom(),g=[];null!==f.parentNode&&void 0!==f.parentNode;){var f=f.parentNode,l=h.fromDom(f);g.push(l);if(!0===d(l))break}return g},siblings:function(a){return m(a).map(r).map(function(b){return d.filter(b,
function(b){return!f.eq(a,b)})}).getOr([])},prevSibling:n,offsetParent:function(b){b=b.dom();return a.from(b.offsetParent).map(h.fromDom)},prevSiblings:function(a){return d.reverse(g.toArray(a,n))},nextSibling:p,nextSiblings:function(a){return g.toArray(a,p)},children:r,child:q,firstChild:function(a){return q(a,0)},lastChild:function(a){return q(a,a.dom().childNodes.length-1)},leaf:function(a,b){var c=r(a);return 0<c.length&&b<c.length?s(c[b],0):s(a,b)}}});k("2y","7 s 1b l 37 2a q".split(" "),function(c,
d,b,a,e,g,f){var h=function(a){a.dom().focus()},l=function(b){b=void 0!==b?b.dom():f;return d.from(b.activeElement).map(a.fromDom)};return{hasFocus:function(a){var b=g.owner(a).dom();return a.dom()===b.activeElement},focus:h,blur:function(a){a.dom().blur()},active:l,search:function(a){return l(g.owner(a)).filter(function(b){return a.dom().contains(b.dom())})},focusInside:function(a){var d=g.owner(a);l(d).filter(function(d){return e.closest(d,c.curry(b.eq,a))}).fold(function(){h(a)},c.noop)}}});k("2o",
["2a"],function(c){var d=function(a,b){c.parent(a).each(function(c){c.dom().insertBefore(b.dom(),a.dom())})},b=function(a,b){a.dom().appendChild(b.dom())};return{before:d,after:function(a,e){c.nextSibling(a).fold(function(){c.parent(a).each(function(a){b(a,e)})},function(a){d(a,e)})},prepend:function(a,e){c.firstChild(a).fold(function(){b(a,e)},function(b){a.dom().insertBefore(e.dom(),b.dom())})},append:b,appendAt:function(a,e,g){c.child(a,g).fold(function(){b(a,e)},function(a){d(a,e)})},wrap:function(a,
c){d(a,c);b(c,a)}}});k("3c",["b","2o"],function(c,d){return{before:function(b,a){c.each(a,function(a){d.before(b,a)})},after:function(b,a){c.each(a,function(c,g){d.after(0===g?b:a[g-1],c)})},prepend:function(b,a){c.each(a.slice().reverse(),function(a){d.prepend(b,a)})},append:function(b,a){c.each(a,function(a){d.append(b,a)})}}});k("2q",["b","3c","2a"],function(c,d,b){var a=function(a){a=a.dom();null!==a.parentNode&&a.parentNode.removeChild(a)};return{empty:function(e){e.dom().textContent="";c.each(b.children(e),
function(b){a(b)})},remove:a,unwrap:function(c){var g=b.children(c);0<g.length&&d.before(c,g);a(c)}}});k("22","2n l 2y 2o 2q q 36".split(" "),function(c,d,b,a,e,g,f){return{blur:function(){var f=d.fromHtml('<input type="text" />');c.setAll(f,{"z-index":"-666",background:"transparent",border:"0px",height:"50px",position:"absolute",top:"25%",left:"50%"});a.append(d.fromDom(g.body),f);b.focus(f);e.remove(f)}}});k("j",["b","n"],function(c,d){return function(b,a){c.each(a,function(a,c){if(c>b.length-1){if(a.required())throw new d('missing parameter "'+
a.name()+'"');}else a.validate(b[c])})}});k("3d",["b","1o","i","j"],function(c,d,b,a){var e=function(a){return[d.map(a,function(a){return a()})]};return{create:function(){var d=[];return{eventRegistry:{addListener:function(c){a(arguments,[b.func("handler")]);d.push(c)},removeListener:function(a){a=c.indexOf(d,a);-1!==a&&d.splice(a,1)}},eventTrigger:function(a){c.each(d,function(b){var c=e(a);b.apply(null,c)})}}}}});k("4k",["b","7"],function(c,d){return function(){var b=[],a=[],e=function(a){return a.slice(0)},
g=function(a){return-1!==c.indexOf(b,a)};return{get:function(e){return a[c.indexOf(b,e)]},put:function(c,e){if(void 0===c||null===c)throw"Invalid key, no undefined or null.";if(g(c))throw"Invalid key, key already exists.";b.push(c);a.push(e)},contains:g,remove:function(e,d){var g=c.indexOf(b,e);if(-1===g)throw"Invalid key, does not exist.";b.splice(g,1);return a.splice(g,1)[0]},each:function(e){c.each(b,function(b,c){e(a[c],b,c)})},keys:d.curry(e,b),values:d.curry(e,a),reset:function(){b.splice(0,
b.length);a.splice(0,a.length)}}}});k("3e",["4k"],function(c){return{create:function(){var d=c();return{bind:function(b,a){d.put(b,a);b.bind(a)},unbind:function(b){var a=d.remove(b);b.unbind(a)},unbindAll:function(){d.each(function(b,a){a.unbind(b)});d.reset()}}}}});k("23",["1o","3d","3e"],function(c,d,b){return function(a){var e=b.create(),g=c.map(a,function(a){var b=d.create();e.bind(a,b.eventTrigger);return b});a=c.map(g,function(a){return a.eventRegistry});g=c.map(g,function(a){return a.eventTrigger});
return{registry:a,trigger:g,destroy:function(){e.unbindAll()}}}});k("f",["a","1o","19"],function(c,d,b){var a=function(e){b.freeze(e);d.each(e,function(b){c.isObject(b)&&a(b)});return e};return{makeReadOnly:a}});k("4v",["9"],function(c){return{bounce:function(d){return function(){var b=c.prototype.slice.call(arguments),a=this;setTimeout(function(){d.apply(a,b)},0)}}}});k("3q",[],function(){return function(c,d){return{get:d,map:function(b){return c(function(a){d(function(c){c=b(c);a(c)})})},bind:function(b){return c(function(a){d(function(c){b(c).get(a)})})},
anonBind:function(b){return c(function(a){d(function(c){b.get(a)})})}}}});k("3r",["b"],function(c){return function(d){var b=function(a){return d(function(b){var d=[],f=0,h=function(c){return function(h){d[c]=h;f++;f>=a.length&&b(d)}};0===a.length?b([]):c.each(a,function(a,b){a.get(h(b))})})};return{nu:d,pure:function(a){return d(function(b){b(a)})},par:b,mapM:function(a,e){return b(c.map(a,e))},lift2:function(a,b,c){return d(function(d){var h=!1,l=!1,m=void 0,n=void 0,p=function(){if(h&&l){var a=
c(m,n);d(a)}};a.get(function(a){m=a;h=!0;p()});b.get(function(a){n=a;l=!0;p()})})},compose:function(a,b){return function(c){return b(c).bind(a)}}}}});k("3s",["4v","3q","3r"],function(c,d,b){var a=function(b){return d(a,function(a){b(c.bounce(a))})};return b(a)});k("3n",["1o","3s"],function(c,d){return function(){var b={};return{getOrSetIndexed:function(a,c){if(void 0!==b[a])return b[a];var d=c();return b[a]=d},waitForLoad:function(){var a=c.values(b);return d.par(a)}}}});da("3t",setTimeout);k("2l",
"b 6 3q 3r 3s s 3t".split(" "),function(c,d,b,a,e,g,f){var h=function(a){var m=g.none(),n=[],p=function(){return m.isSome()},r=function(a){m.each(function(b){f(function(){a(b)},0)})};e.nu(a).get(function(a){m=g.some(a);c.each(n,r);n=[]});a=b(h,function(a){p()?r(a):n.push(a)});return d.merge(a,{isSet:p})};return a(h)});k("6i",["1"],function(c){return{namespace:function(d,b){for(var a=b||c,e=d.split("."),g=0;g<e.length;++g){var f=e[g];if(void 0===a[f]||null===a[f])a[f]={};a=a[f]}return a}}});k("4w",
["6i"],function(c){return{install:function(d){var b=c.namespace(d);b.callbacks={};var a=0,e=function(){var b="callback_"+a;a++;return b},g=function(a,c){var g=e();b.callbacks[g]=function(){c||f(g);a.apply(null,arguments)};return d+".callbacks."+g},f=function(a){a=a.substring(a.lastIndexOf(".")+1);void 0!==b.callbacks[a]&&delete b.callbacks[a]};b.ephemeral=function(a){return g(a,!1)};b.permanent=function(a){return g(a,!0)};b.unregister=f;return b}}});k("4x",["7","l"],function(c,d){var b=function(a,
b,e,d,g,p,r){return{target:c.constant(a),x:c.constant(b),y:c.constant(e),stop:d,prevent:g,kill:p,raw:c.constant(r)}},a=function(a,e){return function(g){if(a(g)){var m=d.fromDom(g.target),n=function(){g.stopPropagation()},p=function(){g.preventDefault()},r=c.compose(p,n),m=b(m,g.clientX,g.clientY,n,p,r,g);e(m)}}},e=function(b,e,d,m,n){d=a(d,m);b.dom().addEventListener(e,d,n);return{unbind:c.curry(g,b,e,d,n)}},g=function(a,b,c,e){a.dom().removeEventListener(b,c,e)};return{bind:function(a,b,c,d){return e(a,
b,c,d,!1)},capture:function(a,b,c,d){return e(a,b,c,d,!0)}}});k("3u",["7","4x"],function(c,d){var b=c.constant(!0);return{bind:function(a,c,g){return d.bind(a,c,b,g)},capture:function(a,c,g){return d.capture(a,c,b,g)}}});k("3o","2l 4w p 1a 3u l 2o q".split(" "),function(c,d,b,a,e,g,f,h){var l=d.install("ephox.henchman.features");return{download:function(d){return c.nu(function(c){var p=function(){q.unbind();s.unbind()},r=g.fromTag("script");a.set(r,"src",d);a.set(r,"type","text/javascript");a.set(r,
"async","async");a.set(r,"data-main",l.ephemeral(function(a){c(b.value(a))}));var q=e.bind(r,"error",function(){p();c(b.error("Error loading external script tag "+d))}),s=e.bind(r,"load",p);f.append(g.fromDom(h.head),r)})}}});k("4y",["1a","l","2o","q"],function(c,d,b,a){return{addStylesheet:function(e,g){var f=g||d.fromDom(a),h=d.fromTag("link",f.dom());c.setAll(h,{rel:"stylesheet",type:"text/css",href:e});f=d.fromDom(f.dom().head);b.append(f,h);return h}}});k("3p","a b 2l 7 p 3u 4y".split(" "),function(c,
d,b,a,e,g,f){return{download:function(h,l){return b.nu(function(b){var n=function(a){d.each(r,function(a){a.unbind()});b(a.orThunk(function(a){return e.error(a+'Unable to download editor stylesheets from "'+h+'"')}))},p=f.addStylesheet(h),r=[g.bind(p,"load",function(a){var b;a:{try{var d=a.target().dom().sheet.cssRules;b=c.isObject(d)&&0===d.length;break a}catch(f){}b=!1}b?n(e.error("")):l(n)}),g.bind(p,"error",a.curry(n,e.error("")))]})}}});k("2j",["3n","3o","3p","7"],function(c,d,b,a){return function(){var e=
c(),g=function(){return e.waitForLoad()};return{preload:function(){g().get(a.identity)},addStylesheet:function(a,c){return e.getOrSetIndexed(a,function(){return b.download(a,c)})},addScript:function(a,b){return e.getOrSetIndexed(a,function(){return d.download(a).map(b)})},waitForLoad:g}}});k("4l",["2j"],function(c){var d=c();return{addStylesheet:function(b,a){return d.addStylesheet(b,a)},addScript:function(b,a){return d.addScript(b,a)}}});k("1j",["b","7","s","2u"],function(c,d,b,a){var e=a.immutable("str",
"replace"),g=function(a,c){return"2.1.0"!==a?b.some(c+" version "+a+" appears to be cached, as it does not match editor version 2.1.0."):b.none()};return{aboutTags:function(a,b){var d=[e("@@FULL_VERSION@@","2.1.0.211"),e("@@CLIENT_VERSION@@","2.1.0.271")],g=a?[e("@@INTEGRATION_TYPE@@",b.type),e("@@INTEGRATION_VERSION@@",b.version)]:[];return c.flatten([d,g])},strictMatch:g,weakMatch:function(a,b){return g(a,b).map(function(a){return a+" This may produce unexpected results."})},resourceParam:d.constant("version=2.1.0"),
fullParam:d.constant("version=2.1.0.211")}});k("4m",[],function(){var c=function(d){var b=d;return{get:function(){return b},set:function(a){b=a},clone:function(){return c(b)}}};return c});k("3g",["4l","1j","4m","o","q"],function(c,d,b,a,e){var g=function(b){b.each(function(b){d.weakMatch(b.version,"Code view").each(function(b){a.warn(b)});f.set(b.codemirror());h.set(b.jsbeautify())});return b},f=b(null),h=b(null);return{use:{codemirror:f.get,jsbeautify:h.get},load:{codeview:function(a){a=a+"/codeview.js?"+
d.resourceParam();return c.addScript(a,g)}}}});k("3f",["3g"],function(c){return{beautify:function(d){return c.use.jsbeautify().html(d,{indent_size:"2",indent_char:" ",max_preserve_newlines:"5",preserve_newlines:!0,keep_array_indentation:!1,break_chained_methods:!1,indent_scripts:"normal",brace_style:"collapse",space_before_conditional:!0,unescape_strings:!1,jslint_happy:!1,end_with_newline:!1,wrap_line_length:0,indent_inner_html:!1,comma_first:!1,e4x:!1})}}});k("24",["i","j","3f","3g","n"],function(c,
d,b,a,e){var g=function(a){return a.map(function(a){return a.dom()}).getOr(null)};return{documentElement:function(a){if(a.content().isInline())throw new e("documentElement called on inline mode");return g(a.content().doc())},insertHtmlAtCursor:function(a,b){d(arguments,[c.object("polish"),c.string("html")]);a.content().focus();a.insertHtmlAtCursor(b)},getSelectedText:function(a){return a.content().getSelectedText().getOr("")},uploadImages:function(a,b){d(arguments,[c.object("polish"),c.func("callback")]);
return a.uploadImages(b)},get:function(c){var e=null!==a.use.jsbeautify()&&c.isPrettyPrinting();c=c.getContent();return e?b.beautify(c):c},set:function(a,b){d(arguments,[c.object("polish"),c.string("html")]);a.setContent(b)},isDirty:function(a){d(arguments,[c.object("polish")]);return a.isDirty()},setDirty:function(a,b){d(arguments,[c.object("polish"),c.bool("state")]);a.setDirty(b)}}});k("4n",["a","b","1o","9"],function(c,d,b,a){return{generate:function(e){if(!c.isArray(e))throw"cases must be an array";
if(0===e.length)throw"there must be at least one case";var g={};d.each(e,function(d,h){var l=b.keys(d);if(1!==l.length)throw"one and only one name per case";var m=l[0],n=d[m];if(void 0!==g[m])throw"duplicate key detected:"+m;if("cata"===m)throw"cannot have a case named cata (sorry)";if(!c.isArray(n))throw"case arguments must be an array";g[m]=function(){var b=arguments.length;if(b!==n.length)throw"Wrong number of arguments to case "+m+". Expected "+n.length+" ("+n+"), got "+b;for(var c=new a(b),b=
0;b<c.length;b++)c[b]=arguments[b];return{fold:function(){if(arguments.length!==e.length)throw"Wrong number of arguments to fold. Expected "+e.length+", got "+arguments.length;return arguments[h].apply(null,c)}}}});return g}}});k("3h",["6","4n"],function(c,d){var b=d.generate([{inputSelector:["selector","callback"]},{outputSelector:["selector","callback"]},{inputPredicate:["predicate","callback"]},{outputPredicate:["predicate","callback"]}]);return c.merge(b,{cata:function(a,b,c,d,h){return a.fold(b,
c,d,h)}})});k("25",["b","i","j","7","3h"],function(c,d,b,a,e){var g=function(a){return function(b){b=c.map(b,function(a){return a.dom()});a(b)}},f=function(a){return function(b){return a(b.dom())}};return function(c){var l=function(a,e,f){b(arguments,[d.func("filter"),d.string("selector"),d.func("callback")]);var l=a(e,g(f));c.filter().customFilters().addFilter(l)},m=function(a,e,l){b(arguments,[d.func("filter"),d.func("predicate"),d.func("callback")]);var m=a(f(e),g(l));c.filter().customFilters().addFilter(m)};
return{selector:{addInput:a.curry(l,e.inputSelector),addOutput:a.curry(l,e.outputSelector)},predicate:{addInput:a.curry(m,e.inputPredicate),addOutput:a.curry(m,e.outputPredicate)}}}});k("5b",[],function(){return{zeroWidth:function(){return"\ufeff"}}});k("bm",["5b","7"],function(c,d){var b="\\w'\\-\\u0100-\\u017F\\u00C0-\\u00FF"+c.zeroWidth()+"\\u2018\\u2019",a="[^"+b+"]",e="["+b+"]";return{chars:d.constant(b),wordbreak:d.constant(a),wordchar:d.constant(e)}});da("68",RegExp);k("bn",["68"],function(c){return function(d,
b,a,e){return{term:function(){return new c(d,e.getOr("g"))},prefix:b,suffix:a}}});k("bp",["7","s","bm","bn"],function(c,d,b,a){return{token:function(b){return a(b,c.constant(0),c.constant(0),d.none())},word:function(c){c="((?:^'?)|(?:"+b.wordbreak()+"+'?))"+c+"((?:'?$)|(?:'?"+b.wordbreak()+"+))";return a(c,function(a){return 1<a.length?a[1].length:0},function(a){return 2<a.length?a[2].length:0},d.none())}}});k("bo",["bp"],function(c){var d=function(b){return b.replace(/[-\[\]{}()*+?.,\\\^$|#\s]/g,
"\\$&")};return{sanitise:d,word:function(b){b=d(b);return c.word(b)},token:function(b){b=d(b);return c.token(b)}}});k("6j",["bm","bn","bo","bp"],function(c,d,b,a){return{safeword:function(a){return b.word(a)},safetoken:function(a){return b.token(a)},custom:function(a,b,c,h){return d(a,b,c,h)},unsafeword:function(b){return a.word(b)},unsafetoken:function(b){return a.token(b)},sanitise:function(a){return b.sanitise(a)},chars:function(){return c.chars()},wordbreak:function(){return c.wordbreak()},wordchar:function(){return c.wordchar()}}});
k("4o",["7","6j","68"],function(c,d,b){return function(a,e,g){var f=d.sanitise(a),h=d.sanitise(e);return{patterns:function(){return[new b(f+"(.*?)"+h,"gi")]},useCursor:c.constant(!0),generate:function(a,b){return g.generate(a,b.key(),b.value())},derive:function(a){var b=a[1];return g.get(b).map(function(e){return{startIndex:c.constant(a.index),finishIndex:c.constant(a.index+a[0].length),key:c.constant(b),value:c.constant(e)}})}}}});k("52",["a","b","1o","7","4j"],function(c,d,b,a,e){var g=function(a,
b){return f(a,b,{validate:c.isFunction,label:"function"})},f=function(a,c,g){if(0===c.length)throw"You must specify at least one required field.";e.validateStrArr("required",c);e.checkDupes(c);return function(f){var h=b.keys(f);d.forall(c,function(a){return d.contains(h,a)})||e.reqMessage(c,h);a(c,h);var q=d.filter(c,function(a){return!g.validate(f[a],a)});0<q.length&&e.invalidTypeMessage(q,g.label);return f}},h=a.noop;return{exactly:a.curry(g,function(a,b){var c=d.filter(b,function(b){return!d.contains(a,
b)});0<c.length&&e.unsuppMessage(c)}),ensure:a.curry(g,h),ensureWith:a.curry(f,h)}});k("4p",["52"],function(c){var d=c.ensure(["elements","cursor","dictation","notify"]);c=c.ensure(["elements","cursor","dictation","range","notify"]);return{species:d,applicator:c}});k("48",["b","l","2a","q"],function(c,d,b,a){return{fromHtml:function(c,g){var f=(g||a).createElement("div");f.innerHTML=c;return b.children(d.fromDom(f))},fromTags:function(a,b){return c.map(a,function(a){return d.fromTag(a,b)})},fromText:function(a,
b){return c.map(a,function(a){return d.fromText(a,b)})},fromDom:function(a){return c.map(a,d.fromDom)}}});k("3i",["4o","4p","7","s","48"],function(c,d,b,a,e){return function(g,f,h){return c(g,f,{get:function(b){b=h(b);return a.some(b)},generate:function(c,g,f){c=e.fromHtml(f,c.dom());return d.species({elements:b.constant(c),cursor:a.none,dictation:a.none,notify:a.none})}})}});k("26",["i","j","3i"],function(c,d,b){return{addSimpleMacro:function(a,e,g,f){d(arguments,[c.object("polish"),c.string("startString"),
c.string("endString"),c.func("callback")]);var h=b(e,g,f);return a.macros().customMacros().add(h)},removeMacro:function(a,b){a.macros().customMacros().remove(b)}}});k("27",["b","i","j"],function(c,d,b){var a=["error","info","warning"];return{message:function(e,g,f,h){if(!c.contains(a,g))throw'Message level: "'+g+'" is not supported. Supported levels are: ['+a.join(", ")+"].";b(arguments,[d.object("polish"),d.string("level"),d.number("timeout"),d.string("msg")]);var l=e.ui().showMessage(g,f,h);return{hide:function(){l()}}}}});
k("3j",["7"],function(c){var d=c.constant("pencil");c=c.constant("code");return{pencil:d,code:c}});k("28",["i","j","3j","n"],function(c,d,b,a){return{get:function(a){return a.getMode()===b.pencil()?"design":"code"},set:function(e,g){d(arguments,[c.object("polish"),c.string("mode")]);var f=g.toLowerCase();if("code"!==f&&"design"!==f)throw new a('Editor mode "'+g+'" not supported. Must be either design or code.');e.setMode("design"===f?b.pencil():b.code())}}});k("g",["s","o"],function(c,d){var b=function(a){try{var b=
xa(a);return c.some(b)}catch(d){return c.none()}};return{get:b,register:function(a,b){return k(a,[],function(){return b})},hookup:function(a,c){b(c).fold(function(){d&&d.error&&d.error('textbox.io Could not find plugin "'+c+'". Have you declared it?')},function(b){a.events.loaded.addListener(function(){b.initialize(a)})})}}});k("3k",["7"],function(c){var d=function(b,a){return{left:c.constant(b),top:c.constant(a),translate:function(c,g){return d(b+c,a+g)}}};return d});k("4q","7 1b l 21 4i q".split(" "),
function(c,d,b,a,e,g){return{attached:function(a,h){var l=h||b.fromDom(g.documentElement);return e.ancestor(a,c.curry(d.eq,l)).isSome()},windowOf:function(b){var c=b.dom();return c===c.window?b:a.isDocument(b)?c.defaultView||c.parentWindow:null}}});k("3l",["3k","4q","l"],function(c,d,b){var a=function(a,b){return void 0!==a?a:void 0!==b?b:0},e=function(a){var e=a.dom(),h=e.ownerDocument,l=h.body,h=b.fromDom(h.documentElement);if(l===e)return c(l.offsetLeft,l.offsetTop);if(!d.attached(a,h))return c(0,
0);a=e.getBoundingClientRect();return c(a.left,a.top)};return{absolute:function(c){var f=c.dom().ownerDocument,h=f.body,l=d.windowOf(b.fromDom(f)),m=f.documentElement,f=a(l.pageYOffset,m.scrollTop),l=a(l.pageXOffset,m.scrollLeft),n=a(m.clientTop,h.clientTop),h=a(m.clientLeft,h.clientLeft);return e(c).translate(l-h,f-n)},relative:function(a){a=a.dom();return c(a.offsetLeft,a.offsetTop)},viewport:e}});k("29",["3k","3l","q"],function(c,d,b){return{get:function(a){a=void 0!==a?a.dom():b;return c(a.body.scrollLeft||
a.documentElement.scrollLeft,a.body.scrollTop||a.documentElement.scrollTop)},setToElement:function(a,b){var c=d.absolute(b);a.scrollTo(c.left(),c.top())}}});k("18","b 22 23 f 24 25 26 27 28 g 7 r 29 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q){return function(s,t,u){var v=b({loaded:s.events.loaded,focus:s.events.focus,dirty:s.events.dirty,internal:s.events.internal}),w=function(a,b){var c=q.owner(a),e=q.defaultView(a),c=r.get(c),d=b();e.dom().scrollTo(c.left(),c.top());return d},x=a.makeReadOnly({content:{documentElement:n.curry(e.documentElement,
s),insertHtmlAtCursor:n.curry(e.insertHtmlAtCursor,s),getSelectedText:n.curry(e.getSelectedText,s),uploadImages:n.curry(e.uploadImages,s),get:n.curry(e.get,s),set:n.curry(e.set,s),isDirty:n.curry(e.isDirty,s),setDirty:n.curry(e.setDirty,s)},mode:{set:n.curry(l.set,s),get:n.curry(l.get,s)},filters:g(s),macros:{addSimpleMacro:n.curry(f.addSimpleMacro,s),removeMacro:n.curry(f.removeMacro,s)},message:n.curry(h.message,s),events:v.registry,element:function(){return s.element().dom()},focus:s.focus,restore:p.cached(function(){return w(s.element(),
function(){d.blur();var a=e.get(s);v.destroy();s.destroy();return u.restore(a)})})});c.each(t,function(a){m.hookup(x,a)});return x}});k("d","b 14 15 16 17 18 s 1a 1b".split(" "),function(c,d,b,a,e,g,f,h,l){return function(){var m=d(),n=a(),p=function(a){return a.api},r=function(a,c){var d=b(c.options(),function(){return p.getOrDie("Internal Error")},f.from(h.get(a,"id"))),p=e.one(a,c.constructors(),d).map(function(b){var c=g(b.polish,d&&d.plugins?d.plugins:[],{restore:function(a){n.remove(e);m.remove(e);
return b.restore(a).dom()}}),e={is:function(b){return l.eq(a,b)},api:c};n.add(e);m.add(e);return c});return p};return{getOrCreate:function(a,b){return n.get(a).map(p).orThunk(function(){return r(a,b)})},get:function(a){a=n.findAll(a);return c.map(a,p)},getActiveEditor:m.get}}});k("2c",["6","1a"],function(c,d){return{withOptions:function(b,a){return d.has(b,"tabindex")?c.deepMerge(a,{content:{tabindex:d.get(b,"tabindex")}}):a}}});k("2d",["1o","c","s","2n"],function(c,d,b,a){d=d.detect();var e=d.browser.isIE()&&
10===d.browser.version.major,g=function(b,c){var d=a.getRaw(b,c).getOrThunk(function(){return a.get(b,c)});return e&&"0px"===d?"auto":d},f=function(a,c,e){a=g(a,c);return void 0===a?e:b.some(a)},h=function(a){return{width:f(a,"width",b.none()),"max-width":f(a,"max-width",b.some("none")),"min-width":f(a,"min-width",b.some("none")),"max-height":f(a,"max-height",b.some("none")),"min-height":f(a,"min-height",b.some("none"))}},l=function(b,e){var d=a.getRaw(b,"display"),f=g(b,"height");a.set(b,"display",
"none");var l=g(b,"height"),f="auto"===l?f:l,l=h(b);d.fold(function(){a.remove(b,"display")},function(c){a.set(b,"display",c)});void 0!==f&&a.set(e,"height",f);c.each(l,function(b,c){b.each(function(b){a.set(e,c,b)})})};return{copyFrom:l,explicit:function(a){l(a,a)}}});k("4u",["4g","7"],function(c,d){var b=c.create("ephox-elder");return{resolve:b.resolve,scrollable:d.curry(b.resolve,"scrollable")}});k("4b",["b","1y","34","9"],function(c,d,b,a){return{add:function(a,b){c.each(b,function(b){d.add(a,
b)})},remove:function(a,b){c.each(b,function(b){d.remove(a,b)})},toggle:function(a,b){c.each(b,function(b){d.toggle(a,b)})},hasAll:function(a,b){return c.forall(b,function(b){return d.has(a,b)})},hasAny:function(a,b){return c.exists(b,function(b){return d.has(a,b)})},get:function(c){if(b.supports(c)){c=c.dom().classList;for(var d=new a(c.length),f=0;f<c.length;f++)d[f]=c.item(f);c=d}else c=b.get(c);return c}}});k("6k",["1y","4b"],function(c,d){return{addClass:function(b){return function(a){c.add(a,
b)}},removeClass:function(b){return function(a){c.remove(a,b)}},removeClasses:function(b){return function(a){d.remove(a,b)}},hasClass:function(b){return function(a){return c.has(a,b)}}}});k("4r","b 4u 7 s 3u l 6k 29 3t 36".split(" "),function(c,d,b,a,e,g,f,h,l,m){var n=a.none();d=d.resolve("modal-scroll-lock");var p=function(a,b){c.each(b,function(b){a(b)})};return{block:function(){if(n.isNone()){var b=h.get(),c=e.bind(g.fromDom(m),"scroll",function(a){a=h.get();a.left()===b.left()&&a.top()===b.top()||
m.scrollTo(b.left(),b.top())});n=a.some(c)}},unblock:function(){n.each(function(b){n=a.none();l(function(){b.unbind()},250)})},lock:b.curry(p,f.addClass(d)),unlock:b.curry(p,f.removeClass(d))}});da("6e",clearTimeout);k("6l",["6e","3t"],function(c,d){return function(b,a){var e=null;return{cancel:function(){null!==e&&(c(e),e=null)},schedule:function(){var c=arguments;e=d(function(){b.apply(null,c);e=null},a)}}}});k("54",["b","2u"],function(c,d){return function(b){var a=d.immutable.apply(null,b),e=[];
return{bind:function(a){if(void 0===a)throw"Event bind error: undefined handler";e.push(a)},unbind:function(a){e=c.filter(e,function(b){return b!==a})},trigger:function(){var b=a.apply(null,arguments);c.each(e,function(a){a(b)})}}}});k("46",["1o"],function(c){return{create:function(d){var b=c.map(d,function(a){return{bind:a.bind,unbind:a.unbind}});d=c.map(d,function(a){return a.trigger});return{registry:b,trigger:d}}}});k("4s",["6l","54","46","3u"],function(c,d,b,a){return function(e){var g=!1,f=
b.create({started:d([]),stopped:d([])}),h=c(function(){!0===g&&(g=!1,f.trigger.stopped())},250),l=a.bind(e,"scroll",function(){h.cancel();!1===g&&f.trigger.started();g=!0;h.schedule()});return{events:f.registry,destroy:function(){l.unbind()},isScrolling:function(){return g}}}});k("4t",["s","29"],function(c,d){return{capture:function(b,a){var e=c.none();return{save:function(){e=c.some(d.get(b))},restore:function(){e.each(function(b){a.scrollTo(b.left(),b.top())})}}},preserve:function(b,a){var c=d.get(b);
a();var g=d.get(b);c.top()===g.top()&&c.left()===g.left()||b.dom().defaultView.scrollTo(c.left(),c.top())}}});k("3m",["4r","4s","4t","4u","1y"],function(c,d,b,a,e){return{register:function(b){e.add(b,a.scrollable())},deregister:function(b){e.remove(b,a.scrollable())},scrollable:a.scrollable,preserve:b.preserve,capture:b.capture,block:c.block,unblock:c.unblock,lock:c.lock,unlock:c.unlock,event:d}});k("1e",["2j"],function(c){var d=c();return{preload:function(){d.preload()},addStylesheet:function(b,
a){return d.addStylesheet(b,a)},addScript:function(b,a){return d.addScript(b,a)},waitForLoad:function(){return d.waitForLoad()}}});k("2k",["b","v"],function(c,d){var b=function(){return{zh_hk:"zh_tw",iw:"he",no:"nb",nn:"nb",en:"en",ar:"ar",ca:"ca",cs:"cs",da:"da",de:"de",el:"el",es:"es",fa:"fa",fi:"fi",fr:"fr",he:"he",hr:"hr",hu:"hu",it:"it",ja:"ja",kk:"kk",ko:"ko",nl:"nl",nb:"nb",pl:"pl",pt:"pt",pt_pt:"pt_pt",ro:"ro",ru:"ru",sl:"sl",sk:"sk",sv:"sv",th:"th",tr:"tr",uk:"uk",zh:"zh",zh_tw:"zh_tw"}},
a=function(a){a=a.toLowerCase().replace("-","_");var b=a.indexOf(";");a=-1<b?a.substring(0,b):a;a=d.trim(a);b=a.indexOf("_");b=-1<b?a.substring(0,b):a;return{full:a,languageCode:b}},e=function(b,e){var d=b.split(","),d=c.map(d,function(b){b=a(b);return e[b.full]||e[b.languageCode]||""});return c.find(d,function(a){return""!==a})};return{extract:a,determine:function(a){var c=b();return e(a,c)},determineFrom:e,localeList:b}});k("k",["s"],function(c){return{cat:function(c){for(var b=[],a=function(a){b.push(a)},
e=0;e<c.length;e++)c[e].each(a);return b},findMap:function(d,b){for(var a=0;a<d.length;a++){var e=b(d[a],a);if(e.isSome())return e}return c.none()},liftN:function(d,b){for(var a=[],e=0;e<d.length;e++){var g=d[e];if(g.isSome())a.push(g.getOrDie());else return c.none()}return c.some(b.apply(null,a))}}});k("1f","2h 2k 7 s k o".split(" "),function(c,d,b,a,e,g){var f=function(){var a=c.resolve("navigator")||{};return a.userLanguage||a.language||"en"}(),h=a.none();return{determine:function(c){var h=void 0!==
c?[c,f]:[f];return e.findMap(h,function(b){return a.from(d.determine(b))}).fold(function(){g.warn("WARNING: locales not supported: "+h.join(", "));return"en"},b.identity)},get:function(){return h.getOrDie("locale used before it has been set")},set:function(b){h=a.from(b)}}});k("1g","a 1o 2h 7 1f n o".split(" "),function(c,d,b,a,e,g,f){var h={font:{arial:"Arial",courier:"Courier New",comicsans:"Comic Sans MS",consolas:"Consolas",georgia:"Georgia",impact:"Impact",tahoma:"Tahoma",timesnr:"Times New Roman",
trebuchet:"Trebuchet MS",verdana:"Verdana"},error:{duplicate:{code:"That snippet code is already taken.",uuid:"That snippet uuid is already taken."},unknown:{uuid:"The snippet uuid cannot be found"},code:{duplicate:"That snippet code is already taken."}},cog:{login:"Log in",logout:"Log out","not-logged-in":"Not logged in",user:"User: {0}"},banner:{"logged-in":"Logged in as: {0}"}},l={},m="",n={},p=function(a){return b.resolve(a,n)||b.resolve(a,l)||b.resolve(a,h)};return{loadEnglish:function(a){l=
a},load:function(a,b){m=a;n=b;e.set(a)},isLoaded:function(a){return m===a&&0<d.keys(n).length},get:function(a){var b=p(a);if(c.isString(b))return b;throw new g("key "+a+" does not exist");},has:function(b){if(!c.isString(b))throw b.fold?f.error("object details were",b.fold(a.identity,a.identity,a.identity)):f.error("object key was",b),"key was an object";return c.isString(p(b))}}});k("1h",["s","o"],function(c,d){var b=c.none();return{set:function(a){b.fold(function(){b=c.some(a)},function(b){b!==
a&&d.error('Only one base URL supported per page. Requested value "'+a+'", already using "'+b+'"')})},get:function(){return b.getOrDie("Must begin loading with a base URL")}}});k("2p",["3u","l","q"],function(c,d,b){return{execute:function(a){if("complete"===b.readyState||"interactive"===b.readyState)a();else var e=c.bind(d.fromDom(b),"DOMContentLoaded",function(){a();e.unbind()})}}});k("3v",["a","b","2n","35"],function(c,d,b,a){return function(e,g){var f=function(a){var c=g(a);return 0>=c||null===
c?(a=b.get(a,e),parseFloat(a)||0):c},h=function(a,c){return d.foldl(c,function(c,e){var d=b.get(a,e),d=void 0===d?0:parseInt(d,10);return isNaN(d)?c:c+d},0)};return{set:function(b,d){if(!c.isNumber(d)&&!d.match(/^[0-9]+$/))throw e+".set accepts only positive integer values. Value was "+d;var f=b.dom();a.isSupported(f)&&(f.style[e]=d+"px")},get:f,getOuter:f,aggregate:h,max:function(a,b,c){a=h(a,c);return b>a?b-a:0}}}});k("2r",["2n","3v"],function(c,d){var b=d("width",function(a){return a.dom().offsetWidth});
return{set:function(a,c){b.set(a,c)},get:function(a){return b.get(a)},getOuter:function(a){return b.getOuter(a)},setMax:function(a,e){var d=b.max(a,e,"margin-left border-left-width padding-left padding-right border-right-width margin-right".split(" "));c.set(a,"max-width",d+"px")}}});da("2s",clearInterval);da("2t",setInterval);k("1i","2l r 2m 1y 2n l 2o 2p 2q 2r v 2s 2t".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r){var q=function(){var c=g.fromTag("div");a.add(c,"ephox-textbox-font");var d=g.fromTag("span");
a.add(d,"ephox-chameleon-icon");f.append(c,d);f.append(b.body(),c);var h=m.get(d),d=e.get(d,"font-family");l.remove(c);return 0<h&&void 0!==d&&n.contains(d,"Textbox Icons")},s=function(a){var b=0,c=r(function(){b+=250;q()?(p(c),a(!0)):2E3<b&&(p(c),a(!1))},250)};return{wait:d.cached(function(){return c.nu(function(a){h.execute(function(){q()?a(!0):s(a)})})})}});k("t","b 1e 7 p 1f 1g 1h 1i 1j o".split(" "),function(c,d,b,a,e,g,f,h,l,m){var n=function(b){h.wait().get(function(c){b(c?a.value(!0):a.error("Stylesheet loaded, but did not contain Textbox.io styles"))})},
p=function(b,c){var e=b+"/i18n/tbio_"+c+".js?"+l.resourceParam();return d.addScript(e,function(b){return b.bind(function(b){return l.strictMatch(b.version,"Language strings").fold(function(){return a.value(b.strings())},a.error)})})},r=function(a){var b="/textboxio.css?"+l.fullParam();d.addStylesheet(a+b,n)};return{load:function(a){f.set(a);a=f.get();r(a+"/css");p(a,"en").get(function(a){a.each(g.loadEnglish)});return a},devLoad:r,setLanguage:function(a){var b=e.determine(a);g.isLoaded(b)||(a=f.get(),
p(a,b).get(function(a){a.each(function(a){g.load(b,a)})}))},waitForLoad:function(){return d.waitForLoad()},getFailures:function(a){return c.bind(a,function(a){return a.fold(function(a){return[a]},b.constant([]))})}}});k("4z",["1a","l"],function(c,d){return{span:function(b){b=d.fromTag("span",b);c.set(b,"role","presentation");return b},div:function(b){b=d.fromTag("div",b);c.set(b,"role","presentation");return b},tag:function(b,a){var e=d.fromTag(b,a);c.set(e,"role","presentation");return e}}});k("6h",
["b","2m","2a"],function(c,d,b){var a=function(d,g){var f=[];c.each(b.children(d),function(b){g(b)&&(f=f.concat([b]));f=f.concat(a(b,g))});return f};return{all:function(b){return a(d.body(),b)},ancestors:function(a,d,f){return c.filter(b.parents(a,f),d)},siblings:function(a,d){return c.filter(b.siblings(a),d)},children:function(a,d){return c.filter(b.children(a),d)},descendants:a}});k("4e",["6h","m"],function(c,d){return{all:function(b){return d.all(b)},ancestors:function(b,a,e){return c.ancestors(b,
function(b){return d.is(b,a)},e)},siblings:function(b,a){return c.siblings(b,function(b){return d.is(b,a)})},children:function(b,a){return c.children(b,function(b){return d.is(b,a)})},descendants:function(b,a){return d.all(a,b)}}});k("31",["s","4e","m","4f"],function(c,d,b,a){var e=function(a,b,e){return c.from(d.ancestors(a,b,e)[0])};return{first:function(a){return c.from(d.all(a)[0])},ancestor:e,sibling:function(a,b){return c.from(d.siblings(a,b)[0])},child:function(a,b){return c.from(d.children(a,
b)[0])},descendant:function(a,b){return c.from(d.descendants(a,b)[0])},closest:function(c,d,h){return a(b.is,e,c,d,h)}}});k("6m",["31"],function(c){return{any:function(d){return c.first(d).isSome()},ancestor:function(d,b,a){return c.ancestor(d,b,a).isSome()},sibling:function(d,b){return c.sibling(d,b).isSome()},child:function(d,b){return c.child(d,b).isSome()},descendant:function(d,b){return c.descendant(d,b).isSome()},closest:function(d,b,a){return c.closest(d,b,a).isSome()}}});k("50","c 7 33 1a 1y 2n l 2o 2q 6m q".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n){var p=b.resolve("highcontrast-mode"),r=function(a){var c=f.fromTag("div");e.add(c,b.resolve("highcontrast-detect"));h.append(a,c);g.reflow(c);(!0===("none"===g.get(c,"background-image")?!0:!1)?e.add:e.remove)(a,p);l.remove(c)},q=function(b){var c=f.fromDom(n.documentElement);(!0===(a.has(c,"hc")&&a.has(c,"hcx"))?e.add:e.remove)(b,p)},s=d.noop;return{detect:function(a){var b=c.detect();b.os.isWindows()&&(b.browser.isIE()||b.browser.isSpartan()||b.browser.isFirefox()?
r:b.browser.isChrome()?q:s)(a)},isHighContrast:function(a){return m.ancestor(a.uiContainer(),"."+p)}}});k("51",["4n"],function(c){c=c.generate([{unchanged:["html"]},{changed:["html"]}]);return{unchanged:c.unchanged,changed:c.changed,cata:function(c,b,a){return c.fold(b,a)}}});k("42",["a","52"],function(c,d){var b=function(){return{validate:function(a,b){return c.isFunction(a)||"events"===b&&c.isObject(a)},label:"Function (or events)"}}(),a="activateInline communication connect content deactivateInline element events filter focus getContent getMode insertHtmlAtCursor isDirty isPrettyPrinting keyboard macros operations setContent setDirty smartview state ui undo".split(" "),
e=d.ensureWith(a.concat([]),b),b=d.ensureWith(a.concat("blur cleanup destroy fromTransfer fullscreen uploader toTransfer viewport".split(" ")),b);return{external:e,internal:b}});k("6n",["b","7"],function(c,d){return function(b){return c.mapToObject(b,function(){return{bind:d.noop,unbind:d.noop}})}});k("6o",["54","46","4m"],function(c,d,b){return function(a){a=b(a.dirty);var e=a.get,g=a.set,f=d.create({dirty:c([])});return{events:f.registry,isDirty:e,setDirty:function(a){var b=e();a!==b&&(g(a),!0===
a&&f.trigger.dirty())},state:function(){return{dirty:e()}}}}});k("6p",["b","7","3h"],function(c,d,b){return function(a,e,g){var f=[],h=d.curry(e,"input"),l=d.curry(e,"output"),m=d.curry(g,"input"),n=d.curry(g,"output");e=function(a){b.cata(a,h,l,m,n);f.push(a)};c.each(a.customs,e);return{state:function(){return{customs:f.slice(0)}},addFilter:e}}});k("2z",[],function(){var c=0;return{generate:function(d){var b=(new Date).getTime(),a=Math.floor(1E9*Math.random());c++;return d+"_"+a+c+String(b)}}});
k("6q",["1o","2z","6"],function(c,d,b){return function(a){var e={};c.each(a,function(a,b){e[b]=a});return{get:function(){return c.values(e)},add:function(a){var b=d.generate("macro");e[b]=a;return b},remove:function(a){delete e[a]},state:function(){return b.merge({},e)}}}});k("gr",["a","b","1o"],function(c,d,b){return{isFunctionOrEvents:function(a){var b=function(b){return!0===d.forall(a,function(a){return void 0!==b[a]&&void 0!==b[a].bind&&c.isFunction(b[a].bind)})?!0:!1};return{validate:function(a,
d){return c.isFunction(a)||"events"===d&&c.isObject(a)&&b(a)},label:"Function (or events)"}}}});k("bq",["gr","52"],function(c,d){return d.ensureWith("events init ui check scanView situation hasDropdown hasAutocorrect handle assign lock destroy state lookup name".split(" "),c.isFunctionOrEvents(["analytics"]))});k("6s",["b","7","s","6n"],function(c,d,b,a){return{noSituation:function(){return{primary:d.constant([]),secondary:d.constant([]),submenus:d.constant({})}},basic:function(){return{destroy:d.noop,
ui:b.none,state:d.constant({}),events:a(["analytics"])}}}});k("6r","7 s 6n bq 6s 1a".split(" "),function(c,d,b,a,e,g){return function(){var f=c.noop;return a({setAutocorrect:c.noop,setSpelling:c.noop,events:b(["analytics"]),init:function(a){a.body().each(function(a){g.set(a,"spellcheck","false");f=function(){g.remove(a,"spellcheck")}})},ui:d.none,check:c.noop,scanView:c.noop,situation:e.noSituation,hasDropdown:c.constant(!1),hasAutocorrect:c.constant(!1),handle:c.noop,assign:c.noop,lock:c.apply,destroy:function(){f()},
state:c.constant({}),lookup:c.constant(d.none()),name:c.constant("spelling-disabled")})}});k("6t",["b","1o","6i","7","s"],function(c,d,b,a,e){var g=function(e,g){var l={};d.each(e,function(a,c){var d=c.split(".");if(1>=d.length)l[c]={finalvalue:a};else{var e=l;b.namespace(c,l);for(var f=0;f<d.length-1;f++)e=e[d[f]];e[d[d.length-1]]={finalvalue:a}}});var m=function(b){var e={},f=d.keys(b);c.each(f,function(c){e[c]=void 0!==b[c].finalvalue?g(b[c].finalvalue):a.constant(m(b[c]))});return e};return m(l)};
return{ui:function(b,c){var d=g(b,void 0!==c?c:a.constant);return a.constant(e.some(d))},actions:function(b){b=g(b,a.identity);return a.constant(b)}}});k("53","b 6 3s 7 s p 6n 6o 6p 6q 6r 6s 33 6t 54 46".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t){return{basic:p.basic,draganddrop:function(){return{events:f(["insertAssets","insertHtml"]),destroy:a.noop}},communication:function(){return{headers:a.constant({}),destroy:a.noop}},fullscreen:function(){return{ui:e.none,actions:q.actions({maximize:a.noop,
restore:a.noop}),select:a.noop,deselect:a.noop,destroy:a.noop,events:f(["analytics","maximize","restore"])}},dialog:function(){return{destroy:a.noop,ui:e.none,events:f(["analytics"]),actions:q.actions({show:a.noop})}},spelling:function(){return n()},editorcontext:function(){return{events:f(["blockChanged","enterDown","enterUp"]),destroy:a.noop}},highlighter:function(){return{destroy:a.noop,run:a.noop}},linkvalidator:function(){return{destroy:a.noop,refresh:a.noop,ignore:a.noop,state:a.constant({ignore:[],
cache:{}})}},macros:function(){return{events:f(["analytics"]),state:a.constant({}),customMacros:a.constant(m({})),destroy:a.noop}},table:function(){return{ui:e.none,state:a.constant({}),events:f(["analytics"]),situation:p.noSituation,handle:a.noop,assign:a.noop,destroy:a.noop,name:a.constant("table-disabled")}},image:function(){return{events:f(["changed","contextmenu"]),situation:p.noSituation,handle:a.noop,assign:a.noop,destroy:a.noop,fireChanged:a.noop,name:a.constant("image-disabled")}},imageEdit:function(){var d=
function(d,e){return b.pure(c.map(e,a.compose(g.value,d)))},f=a.curry(d,a.identity),d=a.curry(d,function(a){return a.asset()});return{situation:p.noSituation,handle:a.noop,assign:a.noop,ui:e.none,destroy:a.noop,insertResample:a.constant({assets:f,correlated:d,destroy:a.noop}),name:a.constant("imageEdit-disabled")}},mobile:function(){return{ui:e.none,events:f(["fullscreen"]),destroy:a.noop}},noAnalytics:function(){return{log:a.noop,register:a.noop}},state:function(b){var c=h(b.laundry),e=l(b.filters,
a.noop,a.noop),f=m(b.macros.customs);return{filter:a.constant({customFilters:a.constant(e)}),macros:a.constant({customMacros:a.constant(f)}),laundry:c,getState:function(a){return d.merge(b,void 0===a?{}:a,{laundry:c.state(),filters:e.state(),macros:{customs:f.state()}})}}},uploader:function(){var b=t.create({reconstitute:s([]),uploadAssets:s(["assets"])});return{destroy:a.noop,events:b.registry,reconstitute:a.noop,uploadAssets:a.noop}},undo:function(){return{reset:a.noop,disable:a.apply,save:a.noop}}}});
k("45",["7","53","54","46"],function(c,d,b,a){return{activateInline:c.noop,deactivateInline:c.noop,communication:d.communication,events:function(){return a.create({loaded:b([]),focus:b([]),dirty:b([]),internal:b(["command","data"])}).registry},keyboard:c.die("the keyboard feature is not implemented in this mode"),operations:c.die("the operations feature is not implemented in this mode"),smartview:c.die("the smartview feature is not implemented in this mode"),ui:c.die("the ui feature is not implemented in this mode")}});
k("47",["b","7","54"],function(c,d,b){return function(a,e){var g=b(a),f=0,h=function(b){var d=c.map(a,function(a){return b[a]()});g.trigger.apply(null,d)};return{bind:function(a){g.bind(a);f++;1===f&&e.bind(h)},unbind:function(a){g.unbind(a);f--;0===f&&e.unbind(h)},trigger:d.die("Cannot trigger a source event.")}}});k("3w","4z 7 s 50 3f 51 3j 42 53 3g 45 33 54 46 47 4b l 2o 2q 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,v,w,x){return function(y,B,k){var A=l.state(k),C=b.none(),D=b.none(),
F=q.create({loaded:r([]),focus:r([]),dirty:s([],A.laundry.events.dirty),internal:r(["command","data"])}),E=function(){var a=G().display.wrapper,a=u.fromDom(a);return x.parent(a).getOrDie()},G=function(){return D.getOrDie("CodeMirror not added to DOM")},H=function(a){return L()?e.beautify(a):a},I=function(a){var b=G().doc;a=H(a);b.setValue(a);b.clearHistory()};k=function(){G().focus()};var L=function(){return!0===y.content.prettyprint};return h.internal({activateInline:n.activateInline,blur:d.die("blur is not supported in the API."),
cleanup:d.noop,communication:l.communication,connect:function(d){var e=c.div();v.append(d,e);B.updateUi(e);a.detect(e);d=m.use.codemirror()(e.dom(),{mode:"text/html",extraKeys:{"Ctrl-Space":"autocomplete"},lineWrapping:!0});d.on("focus",function(){F.trigger.focus()});t.add(e,[p.resolve("source-container"),"ephox-textbox-font",p.resolve("layer-editor")]);D=b.some(d);F.trigger.loaded();return!0},content:d.constant({body:d.constant(b.none()),doc:d.die("content.doc is not supported in code view"),execCommand:d.die("content.execCommand is not supported in code view"),
getSelectedText:function(){var a=G().getSelection();return void 0!==a&&null!==a&&0<a.length?b.some(a):b.none()},focus:k}),deactivateInline:n.deactivateInline,destroy:function(){var a=E();t.remove(a,[p.resolve("source-container"),"ephox-textbox-font",p.resolve("layer-editor")]);w.remove(a);D=b.none()},element:E,events:F.registry,filter:A.filter,focus:k,fromTransfer:function(a){var c=function(a){I(a);C=b.some(a);D.bind(function(a){a.on("change",function(a,b){A.laundry.setDirty(!0)})})};g.cata(a,c,c)},
fullscreen:l.fullscreen,getContent:function(){return G().doc.getValue()},getMode:f.code,insertHtmlAtCursor:function(a){G().replaceSelection(a)},isDirty:A.laundry.isDirty,isPrettyPrinting:L,keyboard:n.keyboard,macros:A.macros,operations:n.operations,setContent:function(a){I(a);A.laundry.setDirty(!1)},setDirty:A.laundry.setDirty,smartview:n.smartview,state:function(){return A.getState({content:{}})},toTransfer:function(){var a=G().doc.getValue();return C.filter(function(b){return H(b)===a}).fold(function(){return g.changed(a)},
g.unchanged)},ui:n.ui,undo:d.constant(l.undo()),uploader:d.constant(l.uploader()),viewport:E})}});k("55",[],function(){return"undo insert style emphasis align listindent format tools".split(" ")});k("6x",["2u"],function(c){return c.immutable("x","y","width","height")});k("6u",["6x","1s"],function(c,d){return{intersect:function(b,a){var e=d.max(b.x(),a.x()),g=d.max(b.y(),a.y()),f=d.min(b.x()+b.width(),a.x()+a.width()),f=d.max(0,f-e),h=d.min(b.y()+b.height(),a.y()+a.height()),h=d.max(0,h-g);return c(e,
g,f,h)}}});k("ru",["b","4n"],function(c,d){var b=d.generate([{unbundled:[]},{unsupported:["message"]},{item:["info","blueprint"]},{customMenu:["info","groups","blueprint"]},{textboxMenu:["info","blueprint"]},{palette:["info","children","blueprint"]}]);return{create:function(a){var d=function(a,c){return a.feature.fold(function(){return void 0!==a.unsupported?[b.unsupported(a.unsupported)]:[b.unbundled()]},function(b){if(void 0===b[a.command])return console.warn("unknown command: "+a.command),[];b=
b[a.command]();return[c(b)]})},g=function(a,f){return d(f,function(d){return c.contains(["widget","inline-widget","split-widget"],f.type)?b.item({instance:d.widget},a[f.type]):b.item(d[f.type](),a[f.type])})},f={dropdown:g,general:g,widget:g,"split-widget":g,"inline-widget":g,palette:function(a,f){return d(f,function(d){d=d.palette();var e=c.map(d.items,function(d){return c.contains(["widget","inline-widget","split-widget"],d.type)?b.item({instance:d.build},a[d.type]):b.item(d.spec,a[d.type])});return b.palette(d,
e,a.palette)})},submenu:function(d,e){var f=c.map(e.commands,a);return[b.customMenu(e,f,d.menu)]},menu:function(a,c){return d(c,function(d){return b.textboxMenu(d[c.type](),a[c.type])})}};return{classify:function(a,b){var c=f[b.type];return void 0!==c?c(a,b):[]}}},cata:function(a,b,c,d,h,l,m){return a.fold(b,c,d,h,l,m)}}});k("jl",["ru","b","7"],function(c,d,b){return{fromConfig:function(a,e,g){var f=function(a,c){var e=b.curry(h.classify,a),e=d.bind(c.items,e);return{category:c.category,books:e}};
a=b.curry(f,a);e=b.curry(f,e);var h=c.create(e);return d.map(g,a)}}});k("75",["4g"],function(c){return{resolve:c.create("ephox-chameleon").resolve}});k("xx",["2n"],function(c){return{show:function(d){c.remove(d,"display")},hide:function(d){c.set(d,"display","none")},isShowing:function(d){return c.getRaw(d,"display").isNone()},isHiding:function(d){return c.getRaw(d,"display").is("none")}}});k("rw",["52"],function(c){return{group:c.ensure(["component","isVisible","refreshUi","destroy"])}});k("rv","75 xx rw b 4z 1y 3c".split(" "),
function(c,d,b,a,e,g,f){return function(h){var l=e.span();g.add(l,c.resolve("toolbar-group"));var m=a.map(h,function(a){return a.component()});f.append(l,m);return b.group({component:function(){return l},isVisible:function(){return a.exists(m,d.isShowing)},refreshUi:function(){a.each(h,function(a){a.refreshUi()})},destroy:function(){a.each(h,function(a){a.destroy()})}})}});k("jm","rv rw b 6 7 54 46".split(" "),function(c,d,b,a,e,g,f){return{menu:function(c,d){var m=f.create({done:g([]),abort:g(["item"])}),
n=function(b){b.done.bind(function(){m.trigger.done()});b.abort.bind(function(a){m.trigger.abort(a.item())});return a.merge(b,{done:m.registry.done,abort:m.registry.abort})},p=b.foldr(d,function(b,c){var d=a.merge(c.structure(),b.structures),e=c.submenus().concat(b.submenus),f=a.merge(c.handlers(),b.actions),g=[c.refreshMenu].concat(b.refreshMenu),h=[c.destroyer].concat(b.destroyers),l=n(c.events);return{structures:d,submenus:e,refreshMenu:g,actions:f,destroyers:h,events:l}},{structures:{},submenus:[],
actions:{},refreshMenu:[],destroyers:[]});return{structure:e.constant(p.structures),init:function(a){b.each(p.refreshMenu,e.apply)},name:e.constant(c),handlers:e.constant(p.actions),submenus:e.constant(p.submenus),events:p.events,destroy:function(){b.each(p.destroyers,e.apply)}}},toolbar:function(a){a=c(a);var b=f.create({escaped:g([]),executed:g([])});return d.group({component:a.component,isVisible:a.isVisible,refreshUi:a.refreshUi,destroy:a.destroy,events:b.registry})}}});k("jv",["75","1y","2n",
"31"],function(c,d,b,a){var e=function(a,e){d.add(a,c.resolve("user-icon"));b.setAll(a,{"background-image":"url("+e+")"})};return{setUrl:e,findAndSetUrl:function(b,c){a.descendant(b,".ephox-pastry-icon-content").each(function(a){e(a,c)})}}});k("er",["b","1a","w"],function(c,d,b){var a=function(a){d.set(a,"aria-pressed","true")},e=function(a){d.set(a,"aria-pressed","false")};return{expanded:function(a){d.set(a,"aria-expanded","true")},collapsed:function(a){d.set(a,"aria-expanded","false")},checked:function(a,
c){d.set(a,"aria-checked",b(c))},press:a,release:e,pressed:function(b){(b.selected()?a:e)(b.element())},enable:function(a){d.set(a,"aria-disabled","false")},disable:function(a){d.set(a,"aria-disabled","true")},tabSelected:function(a,b){d.setAll(a,{"aria-selected":"true","aria-pressed":"true"});c.each(b,function(a){d.setAll(a,{"aria-selected":"false","aria-pressed":"false"})})},showPanel:function(a){d.set(a,"aria-selected","true");d.set(a,"aria-hidden","false")},hidePanel:function(a){d.set(a,"aria-selected",
"false");d.set(a,"aria-hidden","true")}}});k("rx",["er","7"],function(c,d){var b=function(a){a.enable();c.enable(a.element())},a=function(a){a.disable();c.disable(a.element())};return{control:function(c){return{enable:d.curry(b,c),disable:d.curry(a,c)}},ariaPressed:function(a){return{press:d.curry(c.press,a.element()),release:d.curry(c.release,a.element())}}}});k("ci",["4g"],function(c){return{resolve:c.create("ephox-echo").resolve}});k("7v","a b ci 2z 6 7 s 1a 1y l 2o 3c".split(" "),function(c,d,
b,a,e,g,f,h,l,m,n,p){var r=b.resolve("aria-help"),q=b.resolve("aria-help-visible"),s=function(a){h.set(a,"role","presentation")},t=function(a,b){h.setAll(a,{role:"application","aria-label":b})},u=function(a,b){h.set(a,"aria-owns",b)},v=function(a,b){h.set(a,"aria-controls",b)},w=function(b,c){var d=a.generate("ephox-aria");h.set(c,"id",d);v(b,d)},x=function(a,b){h.set(a,"aria-describedby",b)},y=function(a,b){h.set(a,"aria-label",b)};return{document:function(a){h.set(a,"role","document")},presentation:s,
region:function(a){h.set(a,"role","region")},controls:v,owns:u,disown:function(a){h.remove(a,"aria-owns")},editor:function(b,c,d,e,f){t(b,d);e.each(function(d){var e=m.fromTag("span");s(e);n.append(e,m.fromText(d));d=a.generate("ephox-aria");h.set(e,"id",d);x(c,d);l.add(e,r);!0===f&&l.add(e,q);n.append(b,e)});return{destroy:function(){h.remove(c,"aria-describedby")}}},inline:function(b,c,e,f,l){t(b,e);var n=[];h.has(c,"id")?u(b,h.get(c,"id")):(e=a.generate("ephox-aria-content"),h.set(c,"id",e),u(b,
e),n.push(function(){h.remove(c,"id")}));f.each(function(a){if(h.has(c,"aria-label")){var b=h.get(c,"aria-label");y(c,a);n.push(function(){y(c,b)})}else y(c,a),n.push(function(){h.remove(c,"aria-label")})});return{destroy:function(){d.each(n,g.apply)}}},group:function(a){h.set(a,"role","group")},toolbar:function(a,b){h.setAll(a,{role:"group","aria-label":b})},toolbarGroup:function(a,b){h.set(a,"role","toolbar");null===b||void 0===b||""===b||c.isArray(b)&&0===b.length||h.set(a,"aria-label",b)},toolbarButton:function(a,
b,c,d){h.setAll(a,{role:"button","aria-label":b,"aria-haspopup":""+c});d&&h.set(a,"aria-pressed","false");c&&h.set(a,"aria-expanded","false")},textButton:function(a,b){h.set(a,"role","button");s(b)},menu:function(a,b){h.setAll(a,{"aria-label":b,role:"menu"})},menuItem:function(a,b,c){b=b.map(function(a){return{"aria-label":a}}).getOr({});h.setAll(a,e.merge(b,{role:"menuitem","aria-haspopup":c.getOr(!1)}))},menuItemCheckbox:function(a){h.setAll(a,{role:"menuitemcheckbox","aria-checked":!1})},checkbox:function(a,
b){h.setAll(a,{role:"checkbox","aria-label":b,"aria-checked":!1})},dialog:function(a,b){h.setAll(a,{role:"dialog","aria-label":b})},button:function(a,b){h.setAll(a,{"aria-label":b,role:"button"})},labelledField:function(b,c,d){var e=m.fromTag("div");s(e);c+=a.generate("");d=m.fromHtml("<label>"+d+"</label>");h.set(d,"for",c);h.set(b,"id",c);p.append(e,[d,b]);return{element:g.constant(e),field:g.constant(b)}},textarea:function(a){h.setAll(a,{"aria-multiline":"true",role:"textbox"})},label:y,widget:function(a){h.set(a,
"role","widget")},option:function(a){h.set(a,"role","option")},listBox:function(a){h.set(a,"role","listbox")},live:function(a,b,c){h.setAll(a,{"aria-live":c?c:"polite",id:b})},tabList:function(a){h.set(a,"role","tablist")},tabButton:function(a,b){h.setAll(a,{"aria-label":b,role:"tab"})},tabPanel:function(a){h.setAll(a,{role:"tabpanel"})},linkElements:w,linkTabToPanel:function(a,b){w(a,b)},describedBy:x,labelledBy:function(a,b){h.set(a,"aria-labelledby",b)},required:function(a){h.set(a,"aria-required",
"true")},hidden:function(a,b){b?h.set(a,"aria-hidden",b):h.remove(a,"aria-hidden")},invalid:function(a,b){!0===b?h.set(a,"aria-invalid","true"):h.remove(a,"aria-invalid")}}});k("ry",["1a","2n","3u"],function(c,d,b){return{disable:function(a){c.set(a,"unselectable","on");d.setAll(a,{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none"});a.dom().style.setProperty("-moz-user-select","-moz-none");return b.bind(a,"onselectstart",function(){return!1})}}});k("l0",["4g"],function(c){return{resolve:c.create("ephox-pastry").resolve}});
k("kz","ry l0 54 46 1y 3u 2o 2q".split(" "),function(c,d,b,a,e,g,f,h){return function(l,m,n){e.add(l,d.resolve("button"));var p=c.disable(l);m=m.getOr(l);var r=null,q=e.toggler(l,d.resolve("button-disabled")),s=function(){q.isOn()||u.trigger.click()},t=g.bind(m,"click",s),u=a.create({click:b([])});return{element:function(){return l},name:function(){return n},destroy:function(){t.unbind();p.unbind();h.remove(l)},content:function(a){null!==r&&h.remove(r.element());f.append(l,a.element());r=a},enable:q.off,
disable:q.on,disabled:q.isOn,click:s,events:u.registry}}});k("gp",["kz","l0","s","1y","l"],function(c,d,b,a,e){return function(g){var f=e.fromTag("span");a.add(f,d.resolve("independent-button"));return c(f,b.none(),g)}});k("gq",["4z","l0","1a","4b","2q"],function(c,d,b,a,e){return function(g){var f=c.span();b.set(f,"aria-hidden",!0);a.add(f,[d.resolve("icon-content")].concat(g));return{element:function(){return f},destroy:function(){e.remove(f)}}}});k("ob","4z kz l0 s 1y l 2o 2q".split(" "),function(c,
d,b,a,e,g,f,h){return function(g){var m=c.span();e.add(m,b.resolve("statebutton"));var n=d(c.span(),a.some(m),g);e.add(n.element(),b.resolve("dependent-button"));f.append(m,n.element());g=e.toggler(m,b.resolve("statebutton-selected"));var p=e.toggler(m,b.resolve("statebutton-disabled"));return{element:function(){return m},destroy:function(){n.destroy();h.remove(m)},name:n.name,content:n.content,enable:function(){p.off();n.enable()},disable:function(){p.on();n.disable()},disabled:function(){return p.isOn()&&
n.disabled()},click:n.click,events:n.events,select:g.on,deselect:g.off,selected:g.isOn}}});k("l1",["ob","54","46"],function(c,d,b){return function(a){var e=c(a),g=b.create({click:d([])}),f=function(){e.selected()?e.deselect():e.select();g.trigger.click()};e.events.click.bind(f);return{element:e.element,name:e.name,content:e.content,destroy:function(){e.events.click.unbind(f);e.destroy()},enable:e.enable,disable:e.disable,disabled:e.disabled,click:e.click,events:g.registry,select:e.select,deselect:e.deselect,
selected:e.selected}}});k("rz","4z gp gq l1 l0 54 46 1y 2o 3c 2q".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){return function(p){var r=c.span();h.add(r,e.resolve("dropbutton"));var q=c.span();h.add(q,e.resolve("dropbutton-button"));var s=c.span();h.add(s,e.resolve("dropbutton-arrow"));m.append(r,[q,s]);var t=d(),u=a();u.content(b(["ephox-pastry-arrow-icon"]));l.append(q,t.element());l.append(s,u.element());var v=f.create({click:g([]),open:g([]),close:g([])}),w=function(){v.trigger.click()},x=function(){(u.selected()?
v.trigger.open:v.trigger.close)()};t.events.click.bind(w);u.events.click.bind(x);return{element:function(){return r},name:function(){return p},content:t.content,events:v.registry,open:function(){u.select();v.trigger.open()},close:function(){u.deselect();v.trigger.close()},destroy:function(){t.events.click.unbind(w);u.events.click.unbind(x);t.destroy();u.destroy();n.remove(r)},isOpen:function(){return u.selected()}}}});k("s0","4z gq l1 l0 7 54 46 1y 2o 3c 2q".split(" "),function(c,d,b,a,e,g,f,h,l,
m,n){return function(p){var r=c.span();h.add(r,a.resolve("dropbutton"));var q=c.span();h.add(q,a.resolve("dropbutton-button"));var s=c.span();h.add(s,a.resolve("dropbutton-arrow"));m.append(r,[q,s]);var t=b(),u=b();u.content(d(["ephox-pastry-arrow-icon"]));l.append(q,t.element());l.append(s,u.element());var v=f.create({click:g([]),open:g([]),close:g([])}),w=function(){v.trigger.click()},x=function(){(u.selected()?v.trigger.open:v.trigger.close)()};t.events.click.bind(w);u.events.click.bind(x);return{element:e.constant(r),
name:e.constant(p),content:t.content,events:v.registry,open:function(){u.select();v.trigger.open()},close:function(){u.deselect();v.trigger.close()},destroy:function(){t.events.click.unbind(w);u.events.click.unbind(x);t.destroy();u.destroy();n.remove(r)},isOpen:function(){return u.selected()},click:t.click,enable:t.enable,disable:t.disable,disabled:t.disabled,select:t.select,deselect:t.deselect,selected:t.selected}}});k("dv","4z l0 1y l 2o 2q".split(" "),function(c,d,b,a,e,g){return function(f){var h=
c.span();b.add(h,d.resolve("text-content"));e.append(h,a.fromText(f));return{element:function(){return h},destroy:function(){g.remove(h)}}}});k("jw","rx 75 7v gp rz s0 gq dv l1 s 1a 1y 3c 31".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q){var s=function(a,d,e,f){b.toolbarButton(a.element(),d,e,f);d=c.control(a);e=c.ariaPressed(a);return{enable:d.enable,disable:d.disable,press:e.press,release:e.release,destroy:function(){a.destroy()}}},t=function(a,b,c,e,g,l,p,q){p=m.from(p).fold(function(){return q(g)},
function(a){return a(g,b)});l=m.from(l).getOr(!1);a=a(b);c=f([d.resolve("icon"),d.resolve(c)]);l=!0===l?[h(q(g)).element()]:[];r.append(c.element(),l);a.content(c);a.events.click.bind(function(){e()});n.set(a.element(),"title",p);a.initAria=s;return a},u=function(a,c){q.descendant(a,c).bind(function(a){b.hidden(a,"true")})},v=function(a,b,c,e,f,g,h,l){a=t(a,b,c,e,f,g,h,l);p.add(a.element(),d.resolve("split-"+b));u(a.element(),".ephox-pastry-dropbutton-arrow");u(a.element(),".ephox-pastry-dropbutton-button");
q.descendant(a.element(),".ephox-pastry-dropbutton-arrow .ephox-pastry-icon-content").bind(function(a){p.add(a,d.resolve("icon"));p.add(a,d.resolve("arrow-"+b))});return a};return{aria:s,typical:function(b,c,d,e,f,g,h){return t(a,b,c,d,e,f,g,h)},toggle:function(a,b,c,d,e,f,g){return t(l,a,b,c,d,e,f,g)},splitToggle:function(a,b,c,d,e,f,h){return v(g,a,b,c,d,e,f,h)},split:function(a,b,c,d,f,g,h){return v(e,a,b,c,d,f,g,h)}}});k("jx",["4g"],function(c){return{resolve:c.create("ephox-gopher").resolve}});
k("s1",["jx","s","1y","4e","31"],function(c,d,b,a,e){return function(g){var f=c.resolve(g);return{set:function(a){b.add(a,f)},up:function(a){return b.has(a,f)?d.some(a):e.ancestor(a,"."+f)},all:function(b){return a.descendants(b,"."+f)},first:function(a){return e.descendant(a,"."+f)},is:function(a){return b.has(a,f)}}}});k("jy",["jx","s1","1a","1y"],function(c,d,b,a){var e=d("item"),g=c.resolve("disabled-item"),f="data-"+c.resolve("item-value");return{set:function(a,c){e.set(a);b.set(a,f,c)},get:function(a){return b.get(a,
f)},up:e.up,all:e.all,disable:function(b){a.add(b,g)},enable:function(b){a.remove(b,g)},isEnabled:function(b){return!a.has(b,g)}}});k("jz","b jx s1 jy s 1a 1y 31".split(" "),function(c,d,b,a,e,g,f,h){var l=b("menu"),m="data-"+d.resolve("menu-value"),n=d.resolve("active-menu");return{set:function(a,b){l.set(a);g.set(a,m,b)},active:function(a){return h.descendant(a,"."+n)},inactive:function(a){a=l.all(a);return c.filter(a,function(a){return!f.has(a,n)})},activate:function(a,b){var d=l.all(a);c.each(d,
function(a){f.remove(a,n)});f.add(b,n)},up:l.up,all:l.all,submenu:function(b,c,d){d=a.get(d);return(c.hasOwnProperty(d)?e.from(c[d]):e.none()).bind(function(a){return h.descendant(b,"["+m+'="'+a+'"]')})}}});k("k0",["s1","7"],function(c,d){var b=c("submenu"),a=c("main-menu");return{main:d.constant(a),submenu:d.constant(b)}});k("g0","b jx jy jz k0 4z 7 1a 1y l 2o 3c".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p){var r=function(a,c,d){b.set(d,c);h.set(d,"tabindex",-1);return d},q=function(a,b,c){return s(a,
b,c,!1)},s=function(a,b,c,e){var f=m.fromTag("li",a.dom()),h=g.span();l.add(h,d.resolve("item-text"));!0===e&&l.add(h,d.resolve("item-ellipsis"));n.append(h,m.fromText(c));n.append(f,h);r(a,b,f);return f},t=function(a){a=m.fromTag("li",a.dom());l.add(a,d.resolve("separator"));return a},u=function(a,b){return"-"!==b.value()?q(a,b.value(),b.text()):t(a)},v=function(b,d,e){var g=m.fromTag("ol",b.dom());a.set(g,d);b=c.map(e,f.curry(u,b));p.append(g,b);return g},w=function(b,c){var d=m.fromTag("div",b.dom());
a.set(d,c);return d};return{item:q,ellipsisItem:function(a,b,c){return s(a,b,c,!0)},mainmenu:function(a,b,c){a=v(a,b,c);e.main().set(a);return a},submenu:function(a,b,c){a=v(a,b,c);e.submenu().set(a);return a},widget:w,widgetSubmenu:function(a,b){var c=w(a,b);e.submenu().set(c);return c},separator:t,custom:r,enableItem:b.enable,disableItem:b.disable}});k("k1",[],function(){var c=function(c,b){if(void 0===c)throw"Cannot intersperse undefined";if(1>=c.length)return c;var a=[];a.push(c[0]);for(var e=
1;e<c.length;e++)a.push(b()),a.push(c[e]);return a};return{intersperse:function(d,b){return c(d,function(){return b})},intersperseThunk:c,untabulate:function(c){var b=[],a;for(a in c)if(Object.prototype.hasOwnProperty.call(c,a))for(var e=c[a],g=0;g<e.length;g++){var f=e[g];b[g]=b[g]||{};b[g][a]=f}return b},tabulate:function(c){for(var b={},a=0;a<c.length;a++){var e=c[a],g;for(g in e)if(Object.prototype.hasOwnProperty.call(e,g)){var f=e[g];Object.prototype.hasOwnProperty.call(b,g)||(b[g]=[]);b[g][a]=
f}}return b}}});k("s2",[],function(){return{css:function(c){var d=/^[a-zA-Z]/.test(c)?"":"e";c=c.replace(/[^\w]/gi,"-");return d+c}}});k("s3",["b"],function(c){return{splits:function(d,b){if(0===b.length)return[d];var a=c.foldl(b,function(a,b){if(0===b)return a;var c=d.substring(a.prev,b);return{prev:b,values:a.values.concat([c])}},{prev:0,values:[]}),e=b[b.length-1];return e<d.length?a.values.concat(d.substring(e)):a.values}}});k("k2",["s2","s3"],function(c,d){return{cssSanitise:function(b){return c.css(b)},
splits:function(b,a){return d.splits(b,a)}}});k("by","jm jv jw a b 7v g0 k1 7 s k2 l 3c q".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q){var s=function(a,b){var d=e.flatten(b);return c.menu(a,d)},t=function(a){return e.map(a,function(a){a=e.map(a,function(a){return a.items()});return e.flatten(a)})};return{create:function(c,v,w){var x=c.name,y=c.textkey,B=c.menuTextkey,k=c.tooltip,A=c.label,C=m.from(c.icon),D=l.constant(void 0!==c.contentFocus?c.contentFocus:!1),F=p.fromDom(q),E=a.isString(y)?
n.cssSanitise(x):x,G=w(y),B=w(B),H=f.mainmenu(F,E+"-menu",[]),I=b.toggle(x,E,l.identity,y,A,k,w);C.filter(a.isString).each(function(a){d.findAndSetUrl(I.element(),a)});var L=I.initAria(I,G,!0,c.toggle);c=t(v);var J=s(E,v);v=h.intersperseThunk(c,function(){return[f.separator(F)]});g.menu(H,B);r.append(H,e.flatten(v));return{button:l.constant(I),contentFocus:D,destroy:function(){I.destroy();J.destroy();L.destroy()},element:l.constant(H),events:J.events,handlers:J.handlers,icon:l.constant(C),init:J.init,
label:l.constant(G),name:J.name,structure:J.structure,submenus:J.submenus,textkey:l.constant(y),menuTextkey:l.constant(B),updateMenu:l.noop,enable:L.enable,disable:L.disable}}}});k("jn",["ru","by","b","7","s"],function(c,d,b,a,e){var g=function(a,b){return e.some(b(a))},f=function(a,b){return e.some(b(a,[]))},h=function(l,m){var n=a.curry(h,l);return c.cata(m,e.none,e.none,g,function(a,c,f){c=b.map(c,function(a){return b.bind(a.books,n)});a=d.create(a,c,l);return e.some(f(a,[]))},f,function(a,c,d){c=
b.bind(c,n);return e.some(d(a,c))}).toArray()};return{build:function(a,c){return{items:b.bind(a.books,function(a){return h(c,a)}),category:a.category}}}});k("br",["jl","jm","jn","b","7v"],function(c,d,b,a,e){return{build:function(g,f,h){var l=h.translations();g=c.fromConfig(f.toolbar(),f.menu(),g);g=a.map(g,function(a){return b.build(a,l)});return a.map(g,function(a){var b=d.toolbar(a.items);a=a.category;e.toolbarGroup(b.component(),l(a));return b})}}});k("bs",["2u"],function(c){var d=c.immutable("toolbar",
"menu");c=c.immutable("smartview","translations");var b=function(a){return function(){return a.apply(null,arguments)}};return{blueprints:b(d),env:b(c)}});k("bw",[],function(){return{link:function(){return/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\.\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w\.]+@)[A-Za-z0-9\.\-]+)(:[0-9]+)?((?:\/[\+~%\/\.\w\-_]*)?\??(?:[\-_.~*+=!&;:'%@?^${}()\w,]*)#?(?:[\-_.~*+=!&;:'%@?^${}()\w,\/]*))?)/g},tokens:function(c,d){return c.replace(/\{(\d+)\}/g,function(b,a,e,g){a=
parseInt(a,10);if(void 0===d[a])throw"No value for token: "+b+" in translation: "+c;return d[a]})}}});k("73","a 7 bw 1g 4n 9".split(" "),function(c,d,b,a,e,g){var f=e.generate([{raw:["text"]},{key:["key"]},{pkey:["key","params"]}]),h=function(c){var d=a.get(c);if(1<arguments.length||/\{(\d+)\}/.test(d)){for(var e=new g(arguments.length-1),f=1;f<arguments.length;f++)e[f-1]=arguments[f];return b.tokens(d,e)}return d};return{get:function(a){if(c.isString(a))throw"string passed to I18n.get:"+a;return a.fold(d.identity,
h,h)},has:a.has,translate:h,raw:f.raw,key:function(b){a.get(b);return f.key(b)},pkey:function(b,c){a.get(b);return f.pkey(b,c)},cata:function(a,b,c,d){return a.fold(b,c,d)}}});k("jo","7v 4z 73 33 54 46 1y 4b 3u l 2o 3c 2q".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r){return function(q,s){var t=void 0!==s?s:"info",u=d.div();h.add(u,[a.resolve("banner"),a.resolve("banner-"+t)]);t=d.div();f.add(t,a.resolve("banner-message"));n.append(t,m.fromText(q));var v=d.div();f.add(v,a.resolve("banner-buttons"));
var w=m.fromTag("span");f.add(w,a.resolve("banner-close"));n.append(v,w);c.button(w,b.translate("banner.close"));p.append(u,[t,v]);var x=l.bind(w,"click",function(){y.trigger.close()}),y=g.create({close:e([])});return{element:function(){return u},action:function(a){n.prepend(v,a.element())},destroy:function(){x.unbind();r.remove(u)},events:y.registry}}});k("bt","7 s jo 1a 3u l 2o 36".split(" "),function(c,d,b,a,e,g,f,h){return function(l){var m=l.description();l=l.link();var n=b(m,"error"),p=d.none(),
r=function(a,b){return e.bind(a,"click",function(){h.open(b.url())})},m=function(b){var e=g.fromTag("a");a.set(e,"href",b.url());a.set(e,"target","_blank");var h=g.fromText(b.text());p=d.some(r(e,b));f.append(e,h);n.action({element:c.constant(e)})};null!==l&&l.url()&&l.text()&&m(l);return{element:n.element,action:n.action,destroy:function(){n.destroy();p.each(function(a){a.unbind()})},events:n.events}}});k("s8",["52"],function(c){return{dropdown:c.exactly("enable disable select clear selectElement populate tick untick activate deactivate".split(" ")),
menu:c.exactly(["enable","disable"]),general:c.exactly("enable disable select deselect selected element".split(" ")),widget:c.exactly("enable disable select deselect press release".split(" ")),palette:c.exactly(["show","hide"])}});k("xy",["g0","l","2o"],function(c,d,b){return{generateItem:function(a,e,g,f){return g.fold(function(){return c.item(a,e.value(),f(e.textkey()))},function(f){f=f(e);var g=d.fromTag("li",a.dom());b.append(g,f);return c.custom(a,e.value(),g)})},generateSeparator:function(a,
e,g){var f=c.separator(a);b.append(f,d.fromText(g(e),a.dom()));return f}}});k("xz","a b er l0 7 s 1a 1y 4e".split(" "),function(c,d,b,a,e,g,f,h,l){var m=function(a,b){var c=d.find(a,function(a){return a.value()===b});return g.from(c)},n=function(a){a=l.children(a,".ephox-pastry-toggle-list-item-selected");d.each(a,function(a){h.remove(a,"ephox-pastry-toggle-list-item-selected");b.checked(a,!1)})};return{updateDropdown:function(b,d,f,l,n){d.fold(b.clear,e.noop,function(d){n.fold(function(){(c.isString(d)?
m(l,d):g.some(d)).each(b.select)},function(c){c=c(d);var e=a.resolve("arrow-righticon");h.add(c,e);b.selectElement(c)})});f.fold(b.disable,e.noop,b.enable)},tick:function(a,c){n(a);var e=l.descendants(a,".ephox-gopher-item"),e=d.find(e,function(a){return f.get(a,"data-ephox-gopher-item-value")===c});void 0!==e&&null!==e&&(h.add(e,"ephox-pastry-toggle-list-item-selected"),b.checked(e,!0))},untick:n,activate:function(a){h.add(a,"ephox-pastry-statebutton-selected")},deactivate:function(a){h.remove(a,
"ephox-pastry-statebutton-selected")}}});k("s7",["er","g0","l0","7","1y"],function(c,d,b,a,e){var g=b.resolve("toggle-list-item-selected"),f=function(a){d.enableItem(a);c.enable(a)},h=function(a){d.disableItem(a);c.disable(a)},l=function(a){e.remove(a,g);c.checked(a,!1)},m=function(a){e.add(a,g);c.checked(a,!0)};return{control:function(b){return{enable:a.curry(f,b),disable:a.curry(h,b)}},selected:function(b){return{deselect:a.curry(l,b),select:a.curry(m,b),selected:a.curry(e.has,b,g)}}}});k("s9",
["jv","a","7v","4z","4b"],function(c,d,b,a,e){var g=function(c){var d=a.span();b.hidden(d,!0);e.add(d,["ephox-pastry-icon-content","ephox-chameleon-icon"].concat([c]));return[d]},f=function(d){var f=a.span();b.hidden(f,!0);e.add(f,["ephox-pastry-icon-content","ephox-chameleon-"+d.value]);c.setUrl(f,d.icon);return[f]},h=function(a){return g(!0===a.icon?"ephox-chameleon-"+a.value:a.icon)};return{generate:g,generateFrom:function(a){return void 0===a.icon?[]:(d.isString(a.icon)?f:h)(a)}}});k("a7","7v 2z c 7 1a 2n l 2o 2q 2a 3t".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n){var p=b.detect().browser.isFirefox(),r={position:"absolute",left:"-9999px"},q=function(a,b){var d=f.fromTag("span",a.dom());c.presentation(d);var e=f.fromText(b,a.dom());h.append(d,e);return d},s=function(a,b){var c=d.generate("ephox-echo-voice");e.set(b,"id",c);e.set(a,"aria-describedby",c)},t=function(a,b,c){var d=m.owner(b),f=q(d,c);p&&s(b,f);e.setAll(f,a(c));g.setAll(f,r);h.append(b,f);n(function(){e.remove(f,"aria-live");l.remove(f)},1E3)};b=a.curry(t,function(a){return{"aria-live":"polite",
"aria-atomic":"true","aria-label":a}});a=a.curry(t,a.constant({"aria-live":"assertive","aria-atomic":"true",role:"alert"}));return{describe:function(a,b){var d=m.owner(a),d=q(d,b);g.set(d,"display","none");c.hidden(d,!0);s(a,d);return d},speak:b,shout:a,tokenSelector:function(){return'span[id^="ephox-echo-voice"]'}}});k("y0","s7 s9 75 7v a7 g0 7 s 54 46 1y l 2o 3c 2q 31 q".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u){var v=p.fromDom(u),w=b.resolve("label-default");return function(u,y){var B=
m.create({populate:l(["items"])}),k=function(c){var e=u(c.textkey),e=g.item(v,c.name+"-menu-trigger",e);n.add(e,b.resolve("menu-more"));c=d.generate("ephox-chameleon-"+c.name);q.prepend(e,c);a.menuItem(e,h.none(),h.some(!0));return e}(y),A=function(a){a=p.fromText(a);C(a)},C=function(a){t.child(k,".ephox-gopher-item-text").each(function(b){s.empty(b);r.append(b,a);n.remove(b,w)})},D=c.control(k);return{element:f.constant(k),populate:function(a){B.trigger.populate(a)},select:function(a){t.child(k,
e.tokenSelector()).each(s.remove);var b=e.describe(k,y.describe(a));r.append(k,b);a=u(a.textkey());A(a)},selectElement:C,disable:D.disable,enable:D.enable,clear:function(){A(u(y.textkey));t.child(k,".ephox-gopher-item-text").each(function(a){n.add(a,w)})},destroy:function(){s.remove(k)},events:B.registry}}});k("s4","s8 xy xz y0 b 7v g0 jx 7 54 46 1a 1y l 3c 2q q".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u){var v=q.fromDom(u),w="data-"+h.resolve("item-value"),x=function(a){a=f.submenu(v,
a+"-menu",[]);r.remove(a,"ephox-gopher-main-menu");r.add(a,"ephox-gopher-submenu");return a},y=function(a,b){var c=p.get(b,"data-ephox-gopher-menu-value"),d={};d[a.name+"-menu-trigger"]=c;return d};return{init:function(f,h){var r=x(h.name);g.menu(r,f(h.textkey,!1));var q=y(h,r),u=a(f,h),k=function(a){a=e.bind(a,function(a){var b=e.map(a.items(),function(a){a=d.generateItem(v,a,h.render,f);g.menuItemCheckbox(a);return a});return a.label().fold(l.constant(b),function(a){return[d.generateSeparator(v,
a,f)].concat(b)})});t.empty(r);s.append(r,a)},E=n.create({done:m([]),abort:m(["item"])}),G={};e.each(h.values,function(a){G[a.value()]=function(a){a=p.get(a,w);h.action(a);E.trigger.done()}});u.events.populate.bind(function(a){k(a.items())});return{items:l.constant([u.element()]),structure:l.constant(q),submenus:l.constant([r]),refreshMenu:function(){h.updateDropdown(c.dropdown({enable:u.enable,disable:u.disable,select:u.select,clear:u.clear,selectElement:u.selectElement,populate:u.populate,tick:l.curry(b.tick,
r),untick:l.curry(b.untick,r),activate:l.noop,deactivate:l.noop}))},destroyer:function(){u.destroy()},handlers:l.constant(G),events:E.registry}}}});k("s5","s7 s8 s9 7v g0 7 s 54 46 l 3c q".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p){var r=m.fromDom(p);return{init:function(m,p){var t=m(p.textkey),u=(!0===p.hasDialog?e.ellipsisItem:e.item)(r,p.value,t),v=c.control(u),w=!0===p.toggle?c.selected(u):{select:g.noop,deselect:g.noop,selected:g.constant(!1)};!0===p.toggle?a.menuItemCheckbox(u):a.menuItem(u,
f.some(t),f.some(!1));var x=function(){p.updateGeneral(d.general({disable:v.disable,enable:v.enable,select:w.select,deselect:w.deselect,selected:w.selected,element:g.constant(u)}))},y=l.create({done:h([]),abort:h(["item"])}),t={};t[p.value]=function(){y.trigger.done();p.action();x()};var k=b.generateFrom(p);n.prepend(u,k);return{items:g.constant([u]),structure:g.constant({}),submenus:g.constant([]),refreshMenu:x,handlers:g.constant(t),destroyer:g.identity,events:y.registry}}}});k("s6","s7 jv s9 75 7v g0 6 7 s 1a 1y l 3c q".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,p,r,q){var s=p.fromDom(q),t=function(b){return{submenu:function(a){var c=a.textkey();a=a.element();e.menu(a,b(c));n.remove(a,"ephox-gopher-main-menu");n.add(a,"ephox-gopher-submenu");return a},item:function(c){var d=c.textkey(),d=b(d);c=g.item(s,c.name()+"-menu-trigger",d);n.add(c,a.resolve("menu-more"));e.menuItem(c,l.some(d),l.some(!0));return c}}};return{nested:function(a,e,g){g=t(a);a=g.submenu(e);var l=m.get(a,"data-ephox-gopher-menu-value");g=g.item(e);var n={};
n[e.name()+"-menu-trigger"]=l;var l=f.merge(n,e.structure()),p=b.generate("ephox-chameleon-"+e.name());r.prepend(g,p);e.icon().each(function(a){0<p.length&&d.setUrl(p[0],a)});var q=c.control(g),n=void 0!==e.destroyer?e.destroyer:void 0!==e.destroy?e.destroy:h.noop;return{items:h.constant([g]),structure:h.constant(l),submenus:h.constant([a].concat(e.submenus())),refreshMenu:function(){e.updateMenu({enable:q.enable,disable:q.disable})},destroyer:n,handlers:e.handlers,events:e.events}}}});k("k4","s7 s8 s9 75 7v g0 7 s 54 46 47 1y 4b 1b l 2y 2o 3c 37 q".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,v,w,x){var y=s.fromDom(x),k=a.resolve("menu-widget"),z=function(a,b){var c=g.widgetSubmenu(y,b);u.append(c,a.element());r.add(a.element(),[k,"ephox-gopher-item"]);return c},A=function(c,d,e){c=c(d.textkey());c=g.item(y,e,c);p.add(c,a.resolve("menu-more"));e=b.generate(a.resolve(e));v.prepend(c,e);return c};x=function(a,b){var g=b.instance(),p=g.name(),r=p+"-submenu",q=z(g,r),s=A(a,g,p);e.menu(q,a(g.menuTextkey()));e.menuItem(s,h.some(a(g.textkey())),h.some(!0));
var t=c.control(s),u={};u[p]=r;var v=m.create({done:n([],g.events.done),abort:l(["item"])});g.events.abort.bind(function(){v.trigger.abort(s)});return{items:f.constant([s]),structure:f.constant(u),submenus:f.constant([q]),refreshMenu:function(){g.updateWidget(d.widget({enable:t.enable,disable:t.disable,select:f.noop,deselect:f.noop,press:f.noop,release:f.noop}))},destroyer:g.destroy,handlers:f.constant({}),events:v.registry}};return{widget:x,inline:function(b,r){var v=r.instance(),x=v.name();p.add(v.element(),
a.resolve("menu-inline-widget"));var k=s.fromTag("li");u.append(k,v.element());var B=g.custom(y,x,k),z=c.control(B);e.menuItem(B,h.some(b(v.textkey())),h.some(!1));k={};k[x]=function(a){var b=t.active().filter(function(b){return w.ancestor(b,f.curry(q.eq,a))});v.element().dom().click();b.each(t.focus)};var A=m.create({done:n([],v.events.done),abort:l(["item"])});v.events.abort.bind(function(){A.trigger.abort(B)});return{items:f.constant([B]),structure:f.constant({}),submenus:f.constant([]),refreshMenu:function(){v.updateInlineWidget(d.widget({enable:z.enable,
disable:z.disable,select:f.noop,deselect:f.noop,press:f.noop,release:f.noop}))},destroyer:v.destroy,handlers:f.constant(k),events:A.registry}},split:x,styles:f.constant(k)}});k("k8","75 4z s 1y 2n 3u 2o 31 m".split(" "),function(c,d,b,a,e,g,f,h,l){var m=c.resolve("keyfocus"),n=function(b,c){var h=d.span();e.set(h,"display","none");a.add(h,m);f.append(b,h);return g.bind(h,"click",function(a){c();a.kill()})};return{onButton:function(a){return n(a.element(),a.click)},custom:n,trigger:function(a){var c=
"."+m;a=l.is(a,c)?b.some(a):h.descendant(a,c);a.each(function(a){a.dom().click()});return a}}});k("a6",["2u"],function(c){return{menu:c.immutableBag(["focusActive"],[])}});k("sh","b jx jy s 1y 31".split(" "),function(c,d,b,a,e,g){var f=d.resolve("item-selected"),h=function(a,b){e.add(b,f)},l=function(a,b){e.remove(b,f)};return{is:function(a){return e.has(a,f)},none:function(a){var d=b.all(a);c.each(d,function(b){l(a,b)})},selectAll:function(a,d){var g=b.all(a);c.each(g,function(a){e.remove(a,f)});
c.each(d,function(a){e.add(a,f)})},select:h,deselect:l,selected:function(a){return g.descendant(a,"."+f)},first:function(c){var d=b.all(c);return a.from(d[0]).map(function(a){h(c,a);return a})},last:function(c){var d=b.all(c);return a.from(d[d.length-1]).map(function(a){h(c,a);return a})}}});k("sg","b sh jy 7 s 1b".split(" "),function(c,d,b,a,e,g){var f=function(d,f){var h=b.all(d),l=c.findIndex(h,function(a){return g.eq(f,a)});return 0<=l?e.some({index:a.constant(l),all:a.constant(h)}):e.none()},
h=function(a,b){return 0===b?a.length-1:b-1},l=function(a,b){return b===a.length-1?0:b+1},m=function(a,b,c){return f(a,b).map(function(e){var f=c(e.all(),e.index());e=e.all()[f];d.deselect(a,b);d.select(a,e);return e})};return{first:function(a){var c=b.all(a);return e.from(c[0]).map(function(b){d.select(a,b);return b})},prev:function(a,b){return m(a,b,h)},next:function(a,b){return m(a,b,l)}}});k("a8",[],function(){var c=function(c){return function(){return c}};return{BACKSPACE:c([8]),TAB:c([9]),ENTER:c([13]),
SHIFT:c([16]),CTRL:c([17]),ALT:c([18]),CAPSLOCK:c([20]),ESCAPE:c([27]),SPACE:c([32]),PAGEUP:c([33]),PAGEDOWN:c([34]),END:c([35]),HOME:c([36]),LEFT:c([37]),UP:c([38]),RIGHT:c([39]),DOWN:c([40]),INSERT:c([45]),DEL:c([46]),META:c([91,93,224]),F10:c([121])}});k("vg",["b","a8","w"],function(c,d,b){return{isCommand:function(a,e){var g=[];c.each(e,function(a){a="string"===typeof a?[a.toUpperCase().charCodeAt(0)]:a;g=g.concat(a)});var f=function(a){return 0<c.filter(g,function(b){return c.contains(d[a](),
b)}).length};if(!!a.altKey!==f("ALT")||!!a.shiftKey!==f("SHIFT")||!!a.ctrlKey!==f("CTRL")||!!a.metaKey!==f("META"))return!1;var f=null!==a.charCode&&void 0!==a.charCode&&0!==a.charCode?b.fromCharCode(a.charCode).toUpperCase().charCodeAt(0):a.which,h=d.CTRL().concat(d.ALT()).concat(d.SHIFT()).concat(d.META()),l=c.filter(g,function(a){return!c.contains(h,a)});return 1<l.length?!1:0===l.length&&void 0===a.which||l[0]===f}}});k("vi",[],function(){return{stop:function(c){c.preventDefault();c.stopPropagation&&
c.stopPropagation()}}});k("y2",["b","1o","a8"],function(c,d,b){return function(a,e){var g=e?a.slice(0):[],f=e,h=e?c.map(d.values(b),function(a){return a()}):[];return{swallowShortcuts:function(a){g=a.slice(0)},yieldShortcuts:function(a){g=c.difference(g,a)},swallowChars:function(){f=!0},yieldChars:function(){f=!1},swallowKeys:function(a){h=a.slice(0)},yieldKeys:function(a){h=c.difference(h,a)},process:function(a,b){a.fold(function(a){c.contains(g,a)&&b()},function(a){c.contains(h,a)&&b()},function(){f&&
b()})}}}});k("vk",["b","1o","a8"],function(c,d,b){var a={BACKSPACE:b.BACKSPACE,TAB:b.TAB,ENTER:b.ENTER,CAPSLOCK:b.CAPSLOCK,ESCAPE:b.ESCAPE,SPACE:b.SPACE,PAGEUP:b.PAGEUP,PAGEDOWN:b.PAGEDOWN,END:b.END,HOME:b.HOME,LEFT:b.LEFT,UP:b.UP,DOWN:b.DOWN,RIGHT:b.RIGHT,INSERT:b.INSERT,DEL:b.DEL};return{getSpecial:function(b){var g=null;d.each(a,function(a,d){c.contains(a(),b)&&(g=d)});return g},noModifiers:function(a){return!(a.metaKey||a.altKey||a.ctrlKey)},isCharCode:function(a){return a.charCode===a.keyCode}}});
k("y3","b vg vk a8 s w".split(" "),function(c,d,b,a,e,g){var f=function(a,b){return e.from(c.find(b,function(b){return d.isCommand(a,b)}))},h=function(a){return b.isCharCode(a)?e.none():e.from(b.getSpecial(a.keyCode))};return{identify:function(b,c){return{fold:function(d,e,r){f(b,c).fold(function(){h(b).fold(function(){r(b.which&&g.fromCharCode(b.which))},function(b){e(a[b]())})},d)}}},shortcut:f,special:h}});k("vh",["vi","y2","y3","7"],function(c,d,b,a){return function(e,g){var f=!1,h=d(e,g);return{on:function(){f=
!0},off:function(){f=!1},isOn:function(){return f},handle:function(a){return function(b){f&&a(b.raw())}},stop:function(d){var f=b.identify(d,e);h.process(f,a.curry(c.stop,d))},swallowShortcuts:h.swallowShortcuts,yieldShortcuts:h.yieldShortcuts,swallowChars:h.swallowChars,yieldChars:h.yieldChars,swallowKeys:h.swallowKeys,yieldKeys:h.yieldKeys}}});k("vj",["54","46"],function(c,d){return function(){return d.create({character:c(["character"]),space:c(["shift","stopper"]),left:c(["shift","stopper"]),right:c(["shift",
"stopper"]),backspace:c(["shift","stopper"]),tab:c(["shift","stopper"]),enter:c(["shift","stopper"]),capslock:c(["shift","stopper"]),escape:c(["shift","stopper"]),pageup:c(["shift","stopper"]),pagedown:c(["shift","stopper"]),end:c(["shift","stopper"]),home:c(["shift","stopper"]),down:c(["shift","stopper"]),up:c(["shift","stopper"]),insert:c(["shift","stopper"]),del:c(["shift","stopper"]),command:c(["command"])})}});k("nh","b 6 vg vh vi vj vk w".split(" "),function(c,d,b,a,e,g,f,h){return function(l){var m=
d.merge({shortcuts:[],swallow:!1},l),n=g(),p=a(m.shortcuts,m.swallow),r=function(a){return c.find(m.shortcuts,function(c){return b.isCommand(a,c)})||null},q=function(a,b,c){t(a);n.trigger[b].apply(void 0,c)},s=function(a){return function(){p.isOn()&&e.stop(a)}};l=p.handle(function(a){var b=r(a);null!==b?q(a,"command",[b]):(b=f.getSpecial(a.keyCode),f.noModifiers(a)&&null!==b&&(b=b.toLowerCase(),q(a,b,[a.shiftKey,s(a)])))});var t=function(a){p.isOn()&&p.stop(a)},u=p.handle(function(a){if(f.noModifiers(a))f.isCharCode(a)||
null===f.getSpecial(a.keyCode)?null!==r(a)?t(a):a.which&&q(a,"character",[h.fromCharCode(a.which)]):t(a);else return!1});return{off:p.off,on:p.on,events:n.registry,swallowShortcuts:p.swallowShortcuts,yieldShortcuts:p.yieldShortcuts,swallowChars:p.swallowChars,yieldChars:p.yieldChars,swallowKeys:p.swallowKeys,yieldKeys:p.yieldKeys,keypress:u,keydown:l}}});k("si","b jy a8 nh 7 54 46 3u".split(" "),function(c,d,b,a,e,g,f,h){return function(l){var m=f.create({mouseover:g(["item"]),click:g(["item"])}),
n=[],p=a({shortcuts:l.shortcuts,swallow:l.swallow});l=l.tabs?[b.TAB()]:[];p.swallowKeys([b.UP(),b.DOWN(),b.ENTER(),b.SPACE(),b.ESCAPE()].concat(l));var r=function(){c.each(n,function(a){a.mouseover().unbind();a.click().unbind();a.keydown().unbind()});n=[];p.off()};return{destroy:function(){r()},attach:function(a){r();n=c.map(a,function(a){var b=h.bind(a,"mouseover",function(a){d.up(a.target()).each(m.trigger.mouseover)}),c=h.bind(a,"click",function(a){d.up(a.target()).each(m.trigger.click)});a=h.bind(a,
"keydown",function(a){p.keydown(a)});return{mouseover:e.constant(b),click:e.constant(c),keydown:e.constant(a)}});p.on()},detach:r,simulateKey:function(a){p.keydown(a)},events:m.registry,keys:p.events}}});k("bl",["2n"],function(c){var d=function(b){return"rtl"===c.get(b,"direction")?"rtl":"ltr"};return{onDirection:function(b,a){return function(c){return"rtl"===d(c)?a:b}},getDirection:d}});k("al",["7","2x","2n"],function(c,d,b){var a=function(a,g,f,h){var l=b.get(a,g);void 0===l&&(l="");f=l===f?h:f;
l=c.curry(b.set,a,g,l);a=c.curry(b.set,a,g,f);return d(l,a,!1)};return{toggler:function(b){return a(b,"visibility","hidden","visible")},displayToggler:function(b,c){return a(b,"display","none",c)},isVisible:function(a){a=a.dom();return!(0>=a.offsetWidth&&0>=a.offsetHeight)}}});k("ju","b sg sh si jy jz k0 6 7 54 46 1b bl l 2y 21 al q".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,v){return function(w,x){var y=n.create({select:m(["item"]),active:m(["item"]),show:m(["menu"]),hide:m(["menu"]),
collapse:m(["menu"]),expand:m(["menu","trigger"]),escaped:m([])}),k=a({shortcuts:[],swallow:[],tabs:x.tabs}),z={},A=function(a){g.activate(w,a)},C=function(){var a=g.inactive(w);c.each(a,function(a){f.submenu().is(a)&&y.trigger.hide(a)})},D=function(a){e.isEnabled(a)&&g.submenu(w,z,a).each(function(b){y.trigger.expand(b,a)})},F=function(a){g.up(a).each(function(c){A(c);b.selectAll(c,[a]);y.trigger.active(a)})},E=function(a){g.active(w).bind(function(c){b.selected(c).orThunk(function(){return d.first(c)}).each(function(b){a(c,
b)})})},G=function(a){E(function(b,c){e.isEnabled(c)&&a(b,c)})},H=function(a){E(function(b,c){a(b,c).each(function(a){p.eq(c,a)||(g.submenu(w,z,c).each(y.trigger.collapse),y.trigger.active(a))})})},I=l.curry(H,d.prev),L=l.curry(H,d.next),J=function(){f.main().first(w).each(function(a){A(a);b.selected(a).each(y.trigger.active)})},K=function(a){s.active().fold(a.stopper(),function(b){!1===c.contains(["input"],t.name(b))&&a.stopper()()});G(function(a,c){g.submenu(w,z,c).fold(function(){f.submenu().is(a)&&
(y.trigger.collapse(a),J())},function(a){y.trigger.expand(a,c);b.none(a);b.first(a).each(y.trigger.active);A(a)})})},H=function(a){s.active().fold(a.stopper(),function(b){!1===c.contains(["input"],t.name(b))&&a.stopper()()});G(function(a,b){f.submenu().is(a)&&(y.trigger.collapse(a),J())})},M=function(a){G(function(b,c){var d=e.get(c);z.hasOwnProperty(d)&&void 0!==z[d]?K(a):y.trigger.select(c)})},N=function(a){a.shift()?I(a):L(a)};k.keys.up.bind(I);k.keys.down.bind(L);x.tabs&&k.keys.tab.bind(N);k.keys.enter.bind(M);
k.keys.space.bind(M);k.keys.escape.bind(function(a){a.stopper()();E(function(a,b){f.submenu().is(a)?(y.trigger.collapse(a),J()):y.trigger.escaped()})});"ltr"===r.getDirection(w)?(k.keys.left.bind(H),k.keys.right.bind(K)):(k.keys.right.bind(H),k.keys.left.bind(K));k.events.mouseover.bind(function(a){a=a.item();b.is(a)&&g.submenu(w,z,a).forall(u.isVisible)||(F(a),C(),D(a))});k.events.click.bind(function(a){a=a.item();var b=e.get(a);z.hasOwnProperty(b)&&void 0!==z[b]||!e.isEnabled(a)||y.trigger.select(a)});
return{destroy:function(){k.destroy()},populate:function(a){z=h.merge({},a)},on:function(a){a=void 0!==a?a:[q.fromDom(v)];k.attach(a)},off:function(){k.detach()},selectFirst:function(){g.active(w).each(function(a){b.none(a);b.first(a).each(y.trigger.active)})},select:function(a){F(a);C()},setActiveMenu:A,simulateKey:k.simulateKey,state:function(){return g.active(w).bind(function(a){return b.selected(a).map(function(b){return{menu:l.constant(a),item:l.constant(b)}})})},events:y.registry}}});k("bx",
"75 b 1o ju 4z 7 s 54 46 47 4m 2u 1a 1y 2y 2o 31".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u){return function(v,w,x){var y=e.div();q.add(y,c.resolve("menu-"+w()+"-sandbox"));r.set(y,"tabindex",-1);t.append(v(),y);var k=f.none(),z=a(y,{tabs:!0}),A=n({}),C=function(){z.off();E();F.trigger.close()},D=function(a){var c=b.mapToArray(A.get(),p.immutable("submenu","item")),e=r.get(a,"data-ephox-gopher-menu-value"),c=d.find(c,function(a){return a.submenu()===e});return f.from(c).bind(function(b){return u.descendant(y,
"[data-ephox-gopher-item-value="+b.item()+"]").map(function(b){return{menu:g.constant(a),item:g.constant(b)}})})};v=function(a){var b=D(a.menu()).map(function(a){return a.item()});F.trigger.collapse(a.menu(),b)};var F=l.create({open:h([]),close:h([]),itemAction:h(["value","item"]),itemHover:m(["item"],z.events.active),reveal:m(["menu","trigger"],z.events.expand),collapse:h(["menu","item"]),escaped:m([],z.events.escaped)});z.events.hide.bind(v);z.events.collapse.bind(v);z.events.escaped.bind(function(){z.state().fold(C,
function(a){D(a.menu()).fold(function(){C()},function(a){F.trigger.collapse(a.menu(),f.some(a.item()));z.select(a.item())})})});z.events.select.bind(function(a){a=a.item();var b=r.get(a,"data-ephox-gopher-item-value");F.trigger.itemAction(b,a)});z.events.active.bind(function(a){x.focusActive()&&s.focusInside(a.item())});var E=function(){b.each(A.get(),function(a,b){u.descendant(y,'[data-ephox-gopher-menu-value="'+a+'"]').each(function(a){var c=u.descendant(y,'[data-ephox-gopher-item-value="'+b+'"]');
F.trigger.collapse(a,c)})})};return{update:function(a){A.set(a);z.populate(a)},setActiveMenu:function(a){k=f.from(a);z.setActiveMenu(a);z.selectFirst()},getActiveMenu:function(){return k},structure:A,destroy:function(){C();z.destroy()},open:function(a,b){s.focus(b);z.on(a);z.selectFirst();F.trigger.open()},close:C,events:F.registry,sandbox:g.constant(y),select:z.select,simulateKey:z.simulateKey}}});k("sj",["4n"],function(c){c=c.generate([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]}]);
return{southeast:c.southeast,southwest:c.southwest,northeast:c.northeast,northwest:c.northwest,cata:function(c,b,a,e,g){return c.fold(b,a,e,g)}}});k("kt",["7","s"],function(c,d){var b=function(a,d){return a.view(d).fold(c.constant([]),function(c){var d=a.owner(c),d=b(a,d);return[c].concat(d)})};return{pathTo:function(a,c){var g=c.owner(a),g=b(c,g);return d.some(g)}}});k("ku",["s","l","2a","q"],function(c,d,b,a){return{view:function(b){return(b.dom()===a?c.none():c.from(b.dom().defaultView.frameElement)).map(d.fromDom)},
owner:function(a){return b.owner(a)}}});k("c7","b 7 kt ku 3k l 3l 29 q".split(" "),function(c,d,b,a,e,g,f,h,l){return{find:function(m){var n=g.fromDom(l),p=h.get(n);return b.pathTo(m,a).fold(d.curry(f.absolute,m),function(a){var b=f.viewport(m);a=c.foldr(a,function(a,b){var c=f.viewport(b);return{left:a.left+c.left(),top:a.top+c.top()}},{left:0,top:0});return e(a.left+b.left()+p.left(),a.top+b.top()+p.top())})}}});k("6d",["2n","3v"],function(c,d){var b=d("height",function(a){return a.dom().offsetHeight});
return{set:function(a,c){b.set(a,c)},get:function(a){return b.get(a)},getOuter:function(a){return b.getOuter(a)},setMax:function(a,d){var g=b.max(a,d,"margin-top border-top-width padding-top padding-bottom border-bottom-width margin-bottom".split(" "));c.set(a,"max-height",g+"px")}}});k("6y","c7 6x l 6d 29 2r q 36".split(" "),function(c,d,b,a,e,g,f,h){return{absolute:function(b){var e=c.find(b),f=g.getOuter(b);b=a.getOuter(b);return d(e.left(),e.top(),f,b)},view:function(){var a=h.innerWidth,c=h.innerHeight,
g=b.fromDom(f),g=e.get(g);return d(g.left(),g.top(),a,c)}}});k("sk","7 c7 6x 6y 3k 6d 29 2r".split(" "),function(c,d,b,a,e,g,f,h){return{toBox:function(a,e){var n=c.curry(d.find,e),n=a.fold(n,n,function(){var a=f.get();return d.find(e).translate(-a.left(),-a.top())}),p=h.getOuter(e),r=g.getOuter(e);return b(n.left(),n.top(),p,r)},viewport:function(c,d){return d.fold(function(){return c.fold(a.view,a.view,b)},function(a){return c.fold(a,a,b)})},translate:function(a,b,d,g){var h=e(d,g);return a.fold(c.constant(h),
c.constant(h),function(){var a=f.get();return h.translate(-a.left(),-a.top())})}}});k("sl",["2u"],function(c){var d=c.immutableBag("x y width height maxHeight direction classes label candidateYforTest".split(" "),[]);c=c.immutable("position","left","top","right","bottom");return{decision:d,css:c}});k("na",["s","sj","sk","sl","4n"],function(c,d,b,a,e){e=e.generate([{none:[]},{relative:["x","y"]},{fixed:["x","y","width","height"]}]);return{none:e.none,relative:e.relative,fixed:e.fixed,reposition:function(b,
e){return b.fold(function(){return a.css("absolute",c.some(e.x()),c.some(e.y()),c.none(),c.none())},function(b,d){return a.css("absolute",c.some(e.x()-b),c.some(e.y()-d),c.none(),c.none())},function(b,g,m,n){b=e.x()-b;g=e.y()-g;var p=e.width(),r=e.height();m-=b+p;n-=g+r;var q=c.some(b),s=c.some(g),t=c.some(m),u=c.some(n),v=c.none();return d.cata(e.direction(),function(){return a.css("fixed",q,s,v,v)},function(){return a.css("fixed",v,s,t,v)},function(){return a.css("fixed",q,v,v,u)},function(){return a.css("fixed",
v,v,t,u)})})},viewport:function(a,c){return b.viewport(a,c)},toBox:function(a,c){return b.toBox(a,c)},translate:function(a,c,d,e){return b.translate(a,c,d,e)},cata:function(a,b,c,d){return a.fold(b,c,d)}}});k("n8",["na","2u","36"],function(c,d,b){var a=d.immutable("anchorBox","origin"),e=function(){return c.fixed(0,0,b.innerWidth,b.innerHeight)};return{box:function(b){var c=e();return a(b,c)},element:function(b){var d=e();b=c.toBox(d,b);return a(b,d)},fixedOrigin:e}});k("ew",["7","3k"],function(c,
d){return function(b,a){return{southeast:c.constant(d(-b,a)),southwest:c.constant(d(b,a)),northeast:c.constant(d(-b,-a)),northwest:c.constant(d(b,-a))}}});k("y4",["4g"],function(c){return{resolve:c.create("ephox-repartee").resolve}});k("sm",["7","y4"],function(c,d){var b=d.resolve("caret-top-align"),a=d.resolve("caret-bottom-align"),e=d.resolve("caret-right-align"),g=d.resolve("caret-left-align"),f=d.resolve("caret-middle-align");return{east:c.constant(g),south:c.constant(b),west:c.constant(e),north:c.constant(a),
middle:c.constant(f),all:c.constant([b,a,g,e,f])}});k("sn",["2u"],function(c){return c.immutable("x","y","bubble","direction","anchors","label")});k("n9",["sj","sm","sn"],function(c,d,b){var a=function(a,b){return a.x()+a.width()-b.width()/2},e=function(a,b){return a.x()+a.width()-b.width()},g=function(a,b){return a.y()-b.height()},f=function(a){return a.y()+a.height()},h=function(a,e,g){return b(a.x(),f(a),g.southeast(),c.southeast(),[d.south(),d.east()],"layout-se")},l=function(a,g,h){return b(e(a,
g),f(a),h.southwest(),c.southwest(),[d.south(),d.west()],"layout-sw")},m=function(a,e,f){return b(a.x(),g(a,e),f.northeast(),c.northeast(),[d.north(),d.east()],"layout-ne")},n=function(a,f,h){return b(e(a,f),g(a,f),h.northwest(),c.northwest(),[d.north(),d.west()],"layout-nw")},p=function(e,f,h){return b(a(e,f),g(e,f),h.northeast(),c.northeast(),[d.north(),d.middle()],"layout-nm")},r=function(e,g,h){return b(a(e,g),f(e),h.southeast(),c.southeast(),[d.south(),d.middle()],"layout-sm")};return{southeast:h,
northeast:m,southwest:l,northwest:n,southmiddle:r,northmiddle:p,all:function(){return[h,l,m,n,r,p]},allRtl:function(){return[l,h,n,m,r,p]}}});k("so",["sj","sm","sn"],function(c,d,b){var a=function(a){return a.x()+a.width()},e=function(a,b){return a.y()-b.height()+a.height()},g=function(e,f,g){return b(a(e),e.y(),g.southeast(),c.southeast(),[d.south(),d.east()],"link-layout-se")},f=function(a,e,f){e=a.x()-e.width();return b(e,a.y(),f.southwest(),c.southwest(),[d.south(),d.west()],"link-layout-sw")},
h=function(f,g,h){return b(a(f),e(f,g),h.northeast(),c.northeast(),[d.north(),d.east()],"link-layout-ne")},l=function(a,f,g){var h;h=a.x()-f.width();return b(h,e(a,f),g.northwest(),c.northwest(),[d.north(),d.west()],"link-layout-nw")};return{southeast:g,northeast:h,southwest:f,northwest:l,all:function(){return[g,f,h,l]},allRtl:function(){return[f,g,l,h]}}});k("hj",["7","2n","6d","1s"],function(c,d,b,a){return{anchored:c.constant(function(c,g){b.setMax(c,a.floor(g));d.setAll(c,{"overflow-x":"hidden",
"overflow-y":"auto"})}),expandable:c.constant(function(c,d){b.setMax(c,a.floor(d))})}});k("y5","b 7 sj sl 4n 1s".split(" "),function(c,d,b,a,e,g){var f=e.generate([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),h=function(c,e,h,p){var r=c.x(),q=c.y(),s=c.bubble().left(),t=c.bubble().top(),u=p.x(),v=p.y(),w=p.width(),x=p.height(),s=r+s,r=q+t,y=s>=u,k=r>=v,q=y&&k,t=s+e<=u+w&&r+h<=v+x,u=y?g.min(e,u+w-s):g.abs(u-(s+e)),w=k?g.min(h,v+x-r):g.abs(v-(r+h));e=p.width()-e;p=g.max(0,s);e=g.min(p,
e);h=k?r:r+(h-w);p=d.constant(h+w-v);v=d.constant(v+x-h);v=b.cata(c.direction(),v,v,p,p);c=a.decision({x:e,y:h,width:u,height:w,maxHeight:v,direction:c.direction(),classes:c.anchors(),label:c.label(),candidateYforTest:r});return q&&t?f.fit(c):f.nofit(c,u,w)};return{attempts:function(e,g,n,p,r){var q=n.width(),s=n.height(),t=function(a,b,c,d){a=a(g,n,p);return h(a,q,s,r).fold(f.fit,function(a,e,g){return e>c||g>d?f.nofit(a,e,g):f.nofit(b,c,d)})};return c.foldl(e,function(a,b){var c=d.curry(t,b);return a.fold(f.fit,
c)},f.nofit(a.decision({x:g.x(),y:g.y(),width:n.width(),height:n.height(),maxHeight:n.height(),direction:b.southeast(),classes:[],label:"none",candidateYforTest:g.y()}),-1,-1)).fold(d.identity,d.identity)}}});k("y6","7 2n l 6d 2o 3l 2q 2r".split(" "),function(c,d,b,a,e,g,f,h){return{measure:function(l){var m=b.fromTag("div");d.setAll(m,{position:"fixed",opacity:"0",top:"0",left:"0",bottom:"0",right:"0"});e.prepend(l,m);l=g.viewport(m);var n=h.get(m),p=a.get(m);f.remove(m);return{top:l.top,left:l.left,
width:c.constant(n),height:c.constant(p)}}}});k("sp","7 s na sm y5 y6 4b 2n 6d 2r".split(" "),function(c,d,b,a,e,g,f,h,l,m){return{layout:function(a,b,d,f){h.remove(b,"max-height");b={width:c.constant(m.getOuter(b)),height:c.constant(l.getOuter(b))};return e.attempts(f.preference(),a,b,d,f.bounds())},setClasses:function(b,c){f.remove(b,a.all());f.add(b,c.classes())},setHeight:function(a,b,c){c.maxHeightFunction()(a,b.maxHeight())},position:function(a,e,f){var l=function(a){return a+"px"};f=f.origin();
var m=c.constant(f);f=f.fold(m,m,function(){var c=g.measure(a);return b.fixed(c.left(),c.top(),c.width(),c.height())});e=b.reposition(f,e,a);h.setOptions(a,{position:d.some(e.position()),left:e.left().map(l),top:e.top().map(l),right:e.right().map(l),bottom:e.bottom().map(l)})}}});k("nb","s 6y n9 hj na sp 2u".split(" "),function(c,d,b,a,e,g,f){var h=f.immutableBag(["bounds","origin","preference","maxHeightFunction"],[]),l=function(a,b,c){return void 0===a[b]?c:a[b]},m=function(a,b,c,d){a=g.layout(a,
b,c,d);g.position(b,a,d);g.setClasses(b,a);g.setHeight(b,a,d)};return{fixed:function(b,d,f,g,s){var t=l(s,"maxHeightFunction",a.anchored());s=b.anchorBox();b=b.origin();g=h({bounds:e.viewport(b,c.none()),origin:b,preference:g,maxHeightFunction:t});m(s,d,f,g)},relative:function(c,f,g,q){q=void 0!==q?q:{};q=h({bounds:l(q,"bounds",d.view()),origin:l(q,"origin",e.none()),preference:l(q,"preference",b.all()),maxHeightFunction:l(q,"maxHeightFunction",a.anchored())});m(c,f,g,q)}}});k("k5","c 7 s n8 ew n9 so na nb 3k 3l 2a".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,p){var r=function(d,e,f,g,r,q,s){var k=!c.detect().deviceType.isiOS();return function(c){var C,D;!0===k?D=a.fixedOrigin():(D=d(),D=p.offsetParent(D).map(n.absolute).getOr(m(0,0)),D=h.relative(D.left(),D.top()));var F=D;C=h.viewport(F,b.some(e));D=h.toBox(F,f());C={bounds:C,origin:F,preference:r.isRtl()?q.allRtl():q.all(),maxHeightFunction:s};c=c.panel();l.relative(D,c,g,C)}},q=function(b,c,d,e,f,g,h){return function(b){var c=f.isRtl()?g.allRtl():g.all(),m={maxHeightFunction:h},
n=a.element(d());b=b.panel();l.fixed(n,b,e,c,m)}},s=c.detect().deviceType.isiOS()?r:q;return{main:function(a,b,c,e,f,h){a=s(a,b,c,e,f,g,h);return{recalculate:a,isAnchored:d.constant(!0),place:a}},submenu:function(a,b,c,g,h){a=s(a,b,c,e(3,-2),g,f,h);return{recalculate:a,isAnchored:d.constant(!0),place:a}}}});k("y7",["3k"],function(c){return function(){return{northwest:function(){return c(-2,1)},northeast:function(){return c(0,1)},southwest:function(){return c(-2,-2)},southeast:function(){return c(0,
-2)}}}});k("k3",["b","s","2u"],function(c,d,b){var a=function(a){return function(b){return b.key()===a}},e=b.immutable("key","value");return{put:function(b,d,h,l,m){var n=void 0!==l?l:e,p=void 0!==m?m:a(d);b=c.foldl(b,function(a,b){var c=p(b)?n(d,h):b;return{updated:p(b)||a.updated,acc:a.acc.concat([c])}},{updated:!1,acc:[]});return b.updated?b.acc:b.acc.concat([n(d,h)])},get:function(b,e,h){e=void 0!==h?h:a(e);b=c.find(b,e);return d.from(b)}}});k("k6",["b","2m"],function(c,d){return{triage:function(b){b=
c.foldr(b,function(a,b){var c=d.inBody(b.menu());return{keep:c?[b].concat(a.keep):a.keep,throwaway:!1===c?[b].concat(a.throwaway):a.throwaway}},{throwaway:[],keep:[]});c.each(b.throwaway,function(a){a.popup().destroy()});return b.keep}}});k("cj",["b","7","1b","37"],function(c,d,b,a){var e=function(c,e){return a.ancestor(c,d.curry(b.eq,e))};return{ancestor:e,anyAncestor:function(a,b){return c.exists(b,function(b){return e(a,b)})},sibling:function(c,e){return a.sibling(c,d.curry(b.eq,e))},child:function(c,
e){return a.child(c,d.curry(b.eq,e))},descendant:function(c,e){return a.descendant(c,d.curry(b.eq,e))}}});k("ap","b 7 1b 3u l cj q".split(" "),function(c,d,b,a,e,g,f){return function(h,l,m){m=m||[e.fromDom(f)];var n=[],p=function(a){var c=l();a=a.target();b.member(a,c)||g.anyAncestor(a,c)||h(a)};return{on:function(){c.each(m,function(b){n.push(a.bind(b,"mousedown",p).unbind)})},off:function(){c.each(n,d.apply)},mousedown:p}}});k("sq","6 4z l0 1y 2n 2o 2q 31 al".split(" "),function(c,d,b,a,e,g,f,h,
l){return function(m){var n=c.merge({layerClass:null,zindex:null},m),p=d.div();a.add(p,b.resolve("panel"));e.setAll(p,{position:"absolute",display:"none",top:"0px"});n.zindex&&e.set(p,"z-index",n.zindex);n.layerClass&&a.add(p,n.layerClass);m=void 0!==m.container?m.container:h.first("body").getOrDie();g.append(m,p);m=l.displayToggler(p,"block");return{element:function(){return p},destroy:function(){f.remove(p)},content:function(a){f.empty(p);g.append(p,a)},show:m.on,hide:m.off,toggle:m.toggle}}});
k("mt",[],function(){return{create:function(){var c=!1;return{isBlocked:function(){return c},block:function(){c=!0},unblock:function(){c=!1}}}}});k("mu",[],function(){return{create:function(c,d){return{control:c,instance:d}}}});k("eh",["mt","mu"],function(c,d){return{tap:function(b){var a=c.create();return d.create(a,function(){a.isBlocked()||b.apply(null,arguments)})}}});k("k7","75 ap 4z sq 7 eh 54 46 1y 2n 2y 2o 31".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r){return{create:function(q,s){var t=
h.create({open:f([]),close:f([]),uistale:f([])});if(void 0===q)throw"uicontainer not specified";var u=a({layerClass:c.resolve("layer-menus"),container:q()}),v=b.div();l.add(v,c.resolve("popup-container"));u.content(v);var w=!1,x=function(){w&&(k.off(),u.hide(),w=!1,z.control.block(),t.trigger.close())},y=[v],k=d(function(a){!1===!w&&(x(),r.ancestor(a,"."+s).fold(function(){n.focus(a)},e.noop))},function(){return y}),z=g.tap(function(){t.trigger.uistale()});z.control.block();return{element:function(){return v},
panel:u.element,destroy:function(){u.hide();u.destroy();k.off()},open:function(){w||(z.control.unblock(),m.set(u.element(),"opacity","0"),u.show(),m.reflow(u.element()),k.on(),w=!0,t.trigger.open(),m.set(u.element(),"opacity","1"))},close:x,closed:function(){return!w},mousedown:function(a){k.mousedown(a.original())},uiStale:function(){z.instance()},setContent:function(a){p.append(v,a)},setComponents:function(a){y=a.concat([v])},events:t.registry}}}});k("bz","k3 k4 k5 k6 k7 b 7 hj 2u 1b 2n 6m".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,p){var r=l.immutable("menu","popup"),q=function(a){return function(b){return m.eq(b.menu(),a)}};return function(l,m,u,v,w){var x=[],y=function(){var a=g.map(x,function(a){return a.popup().panel()}).concat(v);g.each(x,function(b){b.popup().setComponents(a)})},k=function(a){var b=c.get(x,a,q(a)).fold(function(){return A(a)},function(a){return a.popup()});y();x=c.put(x,a,b,r,q(a));return b},z=function(a){c.get(x,a,q(a)).each(function(a){a.popup().close()});n.set(a,"display",
"none")},A=function(a){var b=e.create(l,w);b.setContent(a);x=c.put(x,a,b,r,q(a));y();return b};return{initMenu:A,registerMenus:function(b){x=a.triage(x);return g.map(b,k)},hideAll:function(){g.each(x,function(a){z(a.menu())})},hideMenu:z,expandMenu:function(a,c){var e=k(a),g=p.descendant(a,"."+d.styles())?h.expandable():h.anchored(),g=b.submenu(l,m,f.constant(c),u.uiDirection(),g);n.set(a,"display","block");e.open();g.recalculate(e);return{popup:e,anchorage:g}}}}});k("11h","4z l0 4b l 2o 2q".split(" "),
function(c,d,b,a,e,g){return function(a,h){var l=c.span();b.add(l,[d.resolve("righticon-content"),h]);e.append(l,a);return{element:function(){return l},destroy:function(){g.remove(l)}}}});k("11i",["11h","dv"],function(c,d){return function(b,a){var e=d(b),g=c(e.element(),a);return{element:g.element,destroy:function(){e.destroy();g.destroy()}}}});k("y1","a6 rx bx xy xz s9 k5 y7 bz 75 b 7v er 2z c g0 4z 11h 11i l1 7 54 46 47 hj 1a 1y 4b l 2o 3c 2q q".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,
t,u,v,w,x,y,k,z,A,C,D,F,E,G,H,I,L,J){var K=s.detect().deviceType.isiOS;return function(s,N,S,Q,P,R,O,T,W,X){var V=x(S);O=d.control(V);E.add(V.element(),[m.resolve("dropdown-button"),m.resolve(S+"-dropdown-button")]);D.set(V.element(),"title",T(Q));p.toolbarButton(V.element(),T(Q),!0,W);var aa=b(s.uiContainer,y.constant("dropdown-"+S),c.menu({focusActive:!0})),ca=G.fromDom(J),Z=t.mainmenu(ca,S+"-menu",[]),ba=l(aa.sandbox,s.bounds,N,[V.element()],X).initMenu(Z);S=h();var ia=f.main(s.uiContainer,s.bounds,
V.element,S,N.uiDirection(),C.anchored());p.menu(Z,T(P));var ga=q.generate("menu-control");D.set(Z,"id",ga);p.controls(V.element(),ga);var fa=u.span();F.add(fa,m.resolve("dropdown-viewport"));V.content({element:y.constant(fa)});var Y=function(a,b){var c=b.map(g.generate).getOr([]);I.prepend(a,c)};N=function(){na(T(Q))};var na=function(a){L.empty(fa);H.append(fa,w(a,"ephox-pastry-arrow-righticon").element())},ea=function(){V.deselect();W&&r.pressed(V);r.collapsed(V.element());p.disown(V.element());
ba.close();aa.close()},$=function(){V.select();W&&r.pressed(V);r.expanded(V.element());p.owns(V.element(),ga);ba.open();var a=[s.uiContainer()];aa.open(a,V.element())},U=z.create({select:A(["value","item"],aa.events.itemAction),itemHover:A(["item"],aa.events.itemHover),escaped:A([],aa.events.escaped),open:k(["menu","popup","anchor"]),close:A([],aa.events.close)});V.events.click.bind(function(){(V.selected()?$:ea)()});ba.events.close.bind(ea);aa.events.open.bind(function(){U.trigger.open(Z,ba,ia);
aa.update({});K()||aa.setActiveMenu(Z)});aa.events.escaped.bind(ea);N();return{element:y.constant(V.element()),menu:ba.element,list:y.constant(Z),click:V.click,populate:function(b){L.empty(Z);n.each(b,function(b){b.label().each(function(b){b=a.generateSeparator(ca,b,T);H.append(Z,b)});n.each(b.items(),function(b){var c=a.generateItem(ca,b,R,T);p.menuItemCheckbox(c);Y(c,b.icon());H.append(Z,c)})})},enable:O.enable,disable:O.disable,close:ea,uiStale:ba.uiStale,recalculate:function(){ia.recalculate(ba)},
clear:N,select:function(a){na(T(a.textkey()));Y(fa,a.icon())},selectElement:function(a){a=v(a,"ephox-pastry-arrow-righticon");V.content({element:a.element,destroy:y.noop})},tick:y.curry(e.tick,Z),untick:y.curry(e.untick,Z),activate:y.curry(e.activate,V.element()),deactivate:y.curry(e.deactivate,V.element()),destroy:function(){aa.destroy();V.destroy()},events:U.registry}}});k("sa","k8 s8 y1 46 47 1a".split(" "),function(c,d,b,a,e,g){return{init:function(f,h,l,m,n){var p=b(f,h,n.name,n.textkey,n.menuTextkey,
n.render,n.layout,l,n.toggle,m);f=function(){n.updateDropdown(d.dropdown({enable:p.enable,disable:p.disable,select:p.select,clear:p.clear,selectElement:p.selectElement,populate:p.populate,tick:p.tick,untick:p.untick,activate:p.activate,deactivate:p.deactivate}))};var r=c.onButton(p);p.events.select.bind(function(a){n.action(a.value());p.close()});var q=a.create({select:e(["value","item"],p.events.select),itemHover:e(["item"],p.events.itemHover),escaped:e([],p.events.escaped),open:e(["menu","popup",
"anchor"],p.events.open),close:e([],p.events.close)});f();g.set(p.element(),"tabindex","-1");return{dropdown:function(){return{events:q.registry,close:p.close,uiStale:p.uiStale,enable:p.enable,disable:p.disable,list:p.list,menu:p.menu,recalculate:p.recalculate}},component:p.element,refreshUi:f,destroy:function(){r.unbind();p.destroy()}}}}});k("sb","k8 s8 jv jw a er 7 46 47 1a".split(" "),function(c,d,b,a,e,g,f,h,l,m){var n=function(b,c){var d=a.typical(b.value,b.value,b.action,b.textkey,b.label,b.tooltip,
c);b.setup&&b.setup(d,b);return d},p=function(b,c){var d=a.toggle(b.value,b.value,b.action,b.textkey,b.label,b.tooltip,c);b.setup&&b.setup(d,b);b.selected&&d.select();return d};return{init:function(a,q){var s=!0===q.hasPopup,t=(!0===q.toggle?p:n)(q,a);e.isString(q.icon)&&b.findAndSetUrl(t.element(),q.icon);var u=t.initAria(t,a(q.textkey),s,q.toggle);m.set(t.element(),"tabindex","-1");var v=function(){!0===q.toggle&&g.pressed(t)},w=c.onButton(t);t.events.click.bind(function(){v()});var x=!0===q.toggle?
t.select:f.noop,y=!0===q.toggle?t.deselect:f.noop,k=!0===q.toggle?t.selected:f.constant(!1);v();var z=h.create({click:l([],t.events.click)});return{generals:function(){return{events:z.registry,enableButton:t.enable,disableButton:t.disable}},component:t.element,refreshUi:function(){q.updateGeneral(d.general({disable:u.disable,enable:u.enable,select:x,deselect:y,selected:k,element:t.element}));v()},destroy:function(){w.unbind();t.destroy();u.destroy()}}}}});k("sc","a6 k8 bx k5 y7 bz 75 b er c 4z 54 46 47 hj 1a 1y 2n 2y 2o 3c 2q 2a".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,v,w,x,y,k,z){var A=m.detect().deviceType.isiOS;return{init:function(m,D,F,E,G,H){var I=G.button(),L=d.onButton(I),J=b(m.uiContainer,G.name,c.menu({focusActive:!0}));t.set(I.element(),"tabindex","-1");var K=n.div();u.add(K,f.resolve("menu-system-main"));var M=g(J.sandbox,m.bounds,D,[I.element()],E),N=M.initMenu(K);F=e();var S=a.main(m.uiContainer,m.bounds,I.element,F,D.uiDirection(),s.anchored()),Q=function(){S.recalculate(N)},P=function(){var a=z.children(J.sandbox());
h.each(a,function(a){v.set(a,"display","none")})},R=function(a){J.update(a.structure());k.empty(K);x.append(K,a.element());a=M.registerMenus(a.submenus());a=h.map(a,function(a){return a.panel()});k.empty(J.sandbox());y.append(J.sandbox(),[N.panel()].concat(a));P()},O=function(a){G.init(a)},T=r.create({open:p(["menu","popup","anchor"]),close:q([],J.events.close),itemAction:q(["value","item"],J.events.itemAction),itemHover:q(["item"],J.events.itemHover),reveal:p(["menu","trigger","popup","anchor"]),
collapse:q(["menu","item"],J.events.collapse),escaped:q([],J.events.escaped)});I.events.click.bind(function(){return(I.selected()?N.open:N.close)()});G.events.done.bind(function(){J.close()});G.events.abort.bind(function(a){J.select(a.item());w.focus(a.item())});N.events.uistale.bind(function(){J.getActiveMenu().bind(function(a){O(a)})});N.events.close.bind(function(){J.close();l.collapsed(I.element())});N.events.open.bind(function(){var a=void 0!==H?H:[],a=[J.sandbox()].concat(a);R(G);O(G);v.set(N.panel(),
"display","block");v.set(K,"display","block");J.open(a,K);l.expanded(I.element())});J.events.open.bind(function(){T.trigger.open(G.element(),N,S);A()||J.setActiveMenu(G.element())});J.events.close.bind(function(){M.hideAll();I.deselect()});J.events.itemAction.bind(function(a){var b=G.handlers();if(void 0!==b[a.value()])(0,b[a.value()])(a.item())});J.events.reveal.bind(function(a){l.expanded(a.trigger());var b=M.expandMenu(a.menu(),a.trigger(),N);T.trigger.reveal(a.menu(),a.trigger(),b.popup,b.anchorage)});
J.events.collapse.bind(function(a){M.hideMenu(a.menu());a.item().each(l.collapsed)});return{menus:function(){return{events:T.registry,enable:G.enable,disable:G.disable,close:N.close,uiStale:N.uiStale,mousedown:N.mousedown,contentFocus:G.contentFocus,menu:N.element,refreshMenus:O,recalculate:Q}},component:I.element,refreshUi:function(){G.updateMenu({enable:G.enable,disable:G.disable})},destroy:function(){L.unbind();J.destroy();G.destroy();N.destroy()}}}}});k("sd","s8 75 xx b a7 4z 7 s 2m 1y 3c".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n){return{init:function(p,r){var q=g.span();m.add(q,d.resolve("palette-group"));var s=f.curry(e.speak,l.body()),t=function(a){var c=b.isShowing(q);b.hide(q);c&&a.each(s);return c},u=c.palette({show:function(a){var c=b.isHiding(q);b.show(q);c&&a.each(s);return c},hide:t});t(h.none());n.append(q,a.map(r,function(a){return a.component()}));return{component:f.constant(q),destroy:function(){a.each(r,function(a){a.destroy()})},refreshUi:function(){p.updatePalette(u);a.each(r,
function(a){a.refreshUi()})}}}}});k("se","k8 s8 k5 y7 bz jw 7v er 2z g0 7 54 46 47 hj 1a l 2o q".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,v,w){return{widget:function(x,y,k,z,A){var C=A.instance();A=u.fromDom(w);var D=(C.toggle?g.splitToggle:g.split)(C.name(),C.name(),n.identity,C.textkey(),C.label(),C.tooltip,k),F=c.custom(D.element(),function(){D.open();C.enter()});t.set(D.element(),"tabindex","-1");var E=D.initAria(D,k(C.textkey()),!0,C.toggle);z=e(x.uiContainer,x.bounds,y,[D.element()],
z);var G=a(),H=m.widget(A,C.name());A=l.generate("menu-control");t.set(H,"id",A);f.controls(D.element(),A);f.owns(D.element(),A);f.menu(H,k(C.menuTextkey()));v.append(H,C.element());var I=z.initMenu(H),L=b.main(x.uiContainer,x.bounds,D.element,G,y.uiDirection(),s.expandable()),J=function(){L.recalculate(I)};I.events.open.bind(function(){h.expanded(D.element());C.open();K.trigger.open(H,I,L)});I.events.close.bind(function(){h.collapsed(D.element());C.close();D.close()});C.events.done.bind(function(){I.close();
D.close()});C.events.abort.bind(function(){I.close();D.close();K.trigger.abort()});D.events.open.bind(function(){I.open();L.recalculate(I)});D.events.close.bind(function(){C.close();I.close()});D.events.click.bind(function(){C.action()});var K=r.create({abort:p([]),close:q([],C.events.close),open:p(["menu","popup","anchor"])});return{widgets:function(){return{events:K.registry,open:D.open,isOpen:D.isOpen,close:D.close,recalculate:J}},component:D.element,refreshUi:function(){C.updateWidget(d.widget({select:D.select,
deselect:D.deselect,enable:D.enable,disable:D.disable,press:E.press,release:E.release}))},destroy:function(){F.unbind();E.destroy();I.destroy();C.destroy();D.destroy()}}}}});k("sf","k8 s8 k5 y7 bz 75 jw 7v er 7 54 46 hj 1a 1y".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s){return{widget:function(h,u,v,w,x){var y=x.instance(),k=f.toggle(y.name(),y.name(),m.identity,y.textkey(),y.label(),y.tooltip,v),z=c.onButton(k),A=k.initAria(k,v(y.textkey()),!0,!0);v=e(h.uiContainer,h.bounds,u,[k.element()],
w);w=a();var C=v.initMenu(y.element()),D=b.main(h.uiContainer,h.bounds,k.element,w,u.uiDirection(),r.expandable());q.set(k.element(),"tabindex","-1");s.add(C.element(),g.resolve("toolbar-widget"));var F=function(){D.recalculate(C)};C.events.open.bind(function(){l.expanded(k.element());y.open();E.trigger.open(y.element(),C,D)});C.events.close.bind(function(){l.collapsed(k.element());y.close()});y.events.done.bind(function(){C.close();k.deselect()});y.events.abort.bind(function(){C.close();k.deselect();
E.trigger.abort()});k.events.click.bind(function(){k.selected()?(C.open(),D.recalculate(C)):C.close();l.pressed(k)});var E=p.create({abort:n([]),open:n(["menu","popup","anchor"])}),G=function(){k.deselect();C.close()};return{widgets:function(){return{events:E.registry,close:G,recalculate:F}},component:k.element,refreshUi:function(){y.updateWidget(d.widget({select:m.noop,deselect:m.noop,enable:A.enable,disable:A.disable,press:m.noop,release:m.noop}))},destroy:function(){z.unbind();A.destroy();C.destroy();
y.destroy();k.destroy()}}},inline:function(a,b){var e=b.instance(),f=c.custom(e.element(),function(){e.element().dom().click()});q.remove(e.element(),"tabindex");s.add(e.element(),g.resolve("toolbar-inline-widget"));h.toolbarButton(e.element(),a(e.textkey()),!1);var r=p.create({abort:n([]),open:n(["menu","popup","anchor"])});return{widgets:function(){return{events:r.registry,recalculate:m.noop,close:m.noop}},component:e.element,refreshUi:function(){e.updateInlineWidget(d.widget({select:m.noop,deselect:m.noop,
enable:m.curry(l.enable,e.element()),disable:m.curry(l.disable,e.element()),press:m.noop,release:m.noop}))},destroy:function(){f.unbind();e.destroy()}}}}});k("jp","s4 s5 s6 k4 sa sb sc sd se sf 7".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){return{menu:function(e){return{general:n.curry(d.init,e),menu:n.curry(b.nested,e),dropdown:n.curry(c.init,e),widget:n.curry(a.widget,e),"split-widget":n.curry(a.split,e),"inline-widget":n.curry(a.inline,e),palette:n.die("No palettes for menus yet")}},toolbar:function(a,
b,c,d){var t=function(e){return n.curry(e,a,b,c,d)};return{menu:t(f.init),dropdown:t(e.init),widget:t(m.widget),"split-widget":t(l.widget),"inline-widget":n.curry(m.inline,c),general:n.curry(g.init,c),palette:h.init}}}});k("gv",["4n"],function(c){c=c.generate([{toolbar:[]},{menu:[]}]);return{toolbar:c.toolbar,menu:c.menu,cata:function(c,b,a){return c.fold(b,a)}}});k("bu",["jp","gv"],function(c,d){return function(b){var a=c.menu(b);return{widget:a.widget,menu:a.menu,general:a.general,"inline-widget":function(b){return a["inline-widget"]({instance:function(){return b.instance(d.menu())}})},
"split-widget":a["split-widget"],dropdown:a.dropdown,palette:a.palette}}});k("jq",["b","c","3m","2y"],function(c,d,b,a){var e=function(b,c,d,e){b.events.escaped.bind(function(b){d.focused()&&a.focus(e.component())});b.events.close.bind(function(a){c.focus()})},g=function(a,c,d,e){a.events.open.bind(function(a){b.register(a.popup().panel())})};return{init:function(b,h,l,m,n,p,r,q,s){var t=b.dropdown(s),u=t.dropdown();b=l.toolbar;(d.detect().deviceType.isTouch()?g:e)(u,n,b,t);var v=!1;u.events.open.bind(function(a){n.toReading();
r.show(a.popup(),a.anchor());v=!0});u.events.close.bind(function(){v=!1});u.events.escaped.bind(function(){a.focus(t.component())});n.events.mousedown.bind(function(){v&&u.close()});n.events.uiStale.bind(u.uiStale);l.toolbar.events.transitionend.bind(function(a){c.contains(["top","height"],a.property())&&u.recalculate()});return{component:t.component,refreshUi:t.refreshUi,destroy:t.destroy}}}});k("jr",[],function(){return{init:function(c,d,b,a,e,g,f,h,l){c=c.general(l);d=c.generals();c.refreshUi();
return{generals:d,component:c.component,refreshUi:c.refreshUi,destroy:c.destroy}}}});k("es",["s","29"],function(c,d){var b=function(a,b){var g=c.none();return{begin:function(){g=c.some(d.get(a))},end:function(){g.each(function(a){b.scrollTo(a.left(),a.top())});g=c.none()}}};return{fromSafe:function(a){return b(a.doc(),a.win())},fromUnsafe:function(a){var c=a.doc().getOrDie();a=a.win().getOrDie();return b(c,a)}}});k("js","7 s es 3m l 2y 21 2a q".split(" "),function(c,d,b,a,e,g,f,h,l){return{init:function(m,
n,p,r,q,s,t,u,v){var w=m.menu(v,[]),x=w.menus(),y=b.fromUnsafe(q);x.events.open.bind(function(a){q.toReading();x.refreshMenus(a.menu());t.show(a.popup(),a.anchor())});x.events.close.bind(function(){q.focus();y.end()});x.events.escaped.bind(function(){g.focus(w.component())});x.events.reveal.bind(function(a){v.init(a.menu());t.show(a.popup(),a.anchor())});x.events.itemAction.bind(function(a){y.end()});x.events.itemHover.bind(function(b){y.begin();if(null!==l.activeElement&&void 0!==l.activeElement){var d=
e.fromDom(l.activeElement),m=h.owner(b.item());"input"!==f.name(d)&&a.preserve(m,c.curry(g.focusInside,b.item()))}else q.backupSelection(),g.focus(b.item())});q.events.mousedown.bind(x.mousedown);q.events.uiStale.bind(x.uiStale);q.events.focus.bind(x.enable);var k=!q.isInline()&&v.contentFocus();k&&x.disable();return{component:w.component,refreshUi:function(){w.refreshUi();var a=k?d.none():d.some(!0);q.getSelection().or(a).fold(x.disable,x.enable)},destroy:function(){q.events.mousedown.unbind(x.mousedown);
q.events.uiStale.unbind(x.update);w.destroy()}}}}});k("jt","c l0 7 gv 1y 3u 2y".split(" "),function(c,d,b,a,e,g,f){var h=function(a,b,d,e,g,h,u,v,w,x,y){var k=d[b]({instance:a(y.instance)});a=k.widgets();g=g.toolbar;a.events.open.bind(function(a){u.toReading();w.show(a.popup(),a.anchor())});a.events.abort.bind(function(){f.focus(k.component())});u.events.mousedown.bind(a.close);return(c.detect().deviceType.isTouch()&&"split-widget"===b?m:l)(a,u,g,k)},l=function(a,b,c,d){return d},m=function(a,b,c,
f){var h=g.capture(f.component(),"click",function(b){b.kill();e.add(f.component(),d.resolve("statebutton-selected"));a.isOpen()?a.close():a.open()});a.events.close.bind(function(){e.remove(f.component(),d.resolve("statebutton-selected"))});return{widgets:f.widgets,component:f.component,refreshUi:f.refreshUi,destroy:function(){h.unbind();f.destroy()}}};return{widget:b.curry(h,b.identity,"widget"),inlineWidget:b.curry(h,function(b){return function(){return b(a.toolbar())}},"inline-widget"),splitWidget:b.curry(h,
b.identity,"split-widget")}});k("aj",["7","33"],function(c,d){var b=d.resolve("editor-container");return{editorContainer:c.constant(b)}});k("bv","jp 7 jq jr js jt aj".split(" "),function(c,d,b,a,e,g,f){return function(h,l,m,n,p,r,q){var s=c.toolbar(r,m,q,f.editorContainer()),t=function(a){return d.curry(a,s,h,l,m,n,p,r,q)};return{widget:t(g.widget),"inline-widget":t(g.inlineWidget),"split-widget":t(g.splitWidget),cards:s.cards,general:t(a.init),dropdown:t(b.init),menu:t(e.init),palette:s.palette}}});
k("8p","c 7 s 73 2u o".split(" "),function(c,d,b,a,e,g){var f=e.immutable("key","link"),h=e.immutable("url","text"),l=function(c,d,e){return function(g){var l=h(d,a.translate(e));return f(a.pkey(c,g),b.some(l))}},m=function(c){return function(d){return f(a.pkey(c,d),b.none())}};e=function(c){return function(d){var e=c(d);d=h(d[0].websiteUrl,a.translate("cloud.dashboard"));return f(e.key(),b.some(d))}};var n={"no.api.key":e(m("cloud.error.apikey")),"domain.not.supported":e(function(c){return f(a.pkey("cloud.error.domain",
[c[0].details.domain]),b.none())}),"plan.exceeded":e(m("cloud.error.plan")),"error.code.invalid.toolbar":m("errors.toolbar.invalid"),"error.code.spelling.not.found":m("errors.spelling.missing.service"),"error.code.images.not.found":m("errors.images.missing.service"),"safari.imagepaste":l("errors.safari.image","https://support.ephox.com/entries/88543243-Safari-Direct-paste-of-images-does-not-work","errors.safari.url"),"webview.imagepaste":m("errors.webview.image"),"flash.clipboard.no.rtf":function(a){return(c.detect().browser.isSafari()?
l("errors.images.missing.flash","https://support.ephox.com/entries/59328357-Safari-6-1-and-7-Flash-Sandboxing","errors.safari.rtf"):m("errors.images.missing.flash"))(a)},"fileupload.invalidimages":m("errors.images.upload.invalid"),"error.imageupload":m("errors.images.upload.failed"),"error.imageupload.generic":m("errors.images.upload.unknown"),"error.imageupload.cors":m("errors.images.upload.cors"),"errors.paste.word.notready":m("errors.paste.notready"),"errors.paste.process.failure":m("errors.paste.generic"),
"flash.crashed":m("errors.flash.crashed"),"errors.imageimport.failed":m("errors.images.import.failed"),"errors.imageimport.unsupported":m("errors.images.import.unsupported"),"errors.imageimport.invalid":m("errors.images.import.invalid"),"imageedit.needsproxy":m("errors.images.edit.needsproxy"),"imageedit.proxyerror":m("errors.images.edit.proxyerror"),"imageedit.generic":m("errors.images.edit.generic")},p={"errors.local.images.disallowed":"Removing pasted images from content. Local image insert has been disabled.",
"errors.dragdrop.images.disallowed":"Blocking image drop operation. Local image insert has been disabled."},r=function(b,c){var e=(0,n[b])(c);return{description:d.constant(a.get(e.key())),link:d.constant(e.link().getOr(null))}};return{get:r,getOrLog:function(a,c){return b.from(p[a]).fold(function(){var d=r(a,c);return b.some(d)},function(a){g.warn(a);return b.none()})}}});k("6v","br bs a b 7 bt bu bv 73 8p 33 1y o".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r){var q=function(b,c){var d=function(c){var d=
m.get("error.code.invalid.toolbar",[c.small()]),d=g(d);b.displayBanner(d);a.each(c.big(),function(a){r.error(a)})};return c.fold(function(a){d(a);return[]},e.identity)};return{setup:function(e,g,m,r,w,x){x=q(e,x);var y=function(a){a=b.isString(a)?l.has(a)?l.key(a):l.raw(a):a;return l.get(a)};p.add(e.toolbar.element(),n.resolve("layer-above-editor"));g=d.blueprints(h(w.uiContainer,e,g,m,r,w,y),f(y));w=d.env(w.uiContainer,y);w=c.build(x,g,w);a.each(w,e.toolbar.add);e.position();a.each(w,function(a){m.events.uiStale.bind(function(){a.refreshUi()})})}}});
k("k9","k8 jm 75 jw ob dv 7 1a 1y 2y".split(" "),function(c,d,b,a,e,g,f,h,l,m){return function(n){var p=e("overflower");l.add(p.element(),b.resolve("more-button"));p.content(g(n("toolbar.more")));var r=c.onButton(p);h.set(p.element(),"tabindex","-1");n=n("aria.label.more");h.set(p.element(),"title",n);var q=a.aria(p,n,!0,!0),s=d.toolbar([{component:p.element,destroy:p.destroy,refreshUi:f.noop}]);return{group:s.component,select:function(){p.select();q.press()},deselect:function(){q.release();p.deselect()},
focus:function(){m.focus(p.element())},destroy:function(){r.unbind();q.destroy();s.destroy()},events:p.events}}});k("l5",["s","1b","2y","4i","2a"],function(c,d,b,a,e){return{preserve:function(g,f){var h=e.owner(f),l=b.active(h).bind(function(b){var e=function(a){return d.eq(b,a)};return e(f)?c.some(f):a.descendant(f,e)}),m=g(f);l.each(function(a){b.active(h).filter(function(b){return d.eq(b,a)}).orThunk(function(){b.focus(a)})});return m}}});k("y8",["2u"],function(c){return c.immutable("component",
"index")});k("sr",["b","y8"],function(c,d){return function(b){var a=[];return{add:function(c,g){var f=g?b.indexOf(a,g).getOrDie():a.length;a.splice(f,0,c);return d(c,f)},remove:function(e){e=b.resolve(a,e).getOrDie();var g=c.indexOf(a,e);a.splice(g,1);return d(e,g)},get:function(){return a.slice(0)},itemAt:function(c){return b.resolve(a,c)}}}});k("ss",["a","b","p"],function(c,d,b){return function(a){var e=function(a,d){return c.isNumber(d)?g(a,d):c.isString(d)?f(a,d):c.isObject(d)?h(a,d):b.error("Unsupported specifier type: "+
d)},g=function(a,c){return 0===a.length?b.error("Items is empty"):0>c||c>=a.length?b.error("Item index: "+c+" is out of range (0-"+(a.length-1)+")"):b.value(a[c])},f=function(c,e){var f=d.find(c,function(b){return a(b)===e});return void 0===f?b.error("No item with value: ["+e+"]"):b.value(f)},h=function(a,c){return-1===d.indexOf(a,c)?b.error("Specified object is not a registered item: "+c):b.value(c)};return{resolve:e,indexOf:function(a,c){return e(a,c).bind(function(e){e=d.indexOf(a,e);return-1<
e?b.value(e):b.error("Item not found: "+c)})},index:g,value:f,item:h}}});k("ka","75 b l5 7v sr ss 7 54 46 1y 4b 2n l 2o 3c 2q".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t){return function(u,v){var w=l.create({grow:h([]),shrink:h([]),exit:h([])}),x=e(g(f.identity)),y=r.fromTag("div");p.set(y,"overflow-x","auto");m.add(y,c.resolve("toolstrip"));a.toolbarGroup(y);var k=r.fromTag("div");n.add(k,[c.resolve("toolbar"),c.resolve("toolbar-primary")]);var z=r.fromTag("div");n.add(z,[c.resolve("toolbar"),
c.resolve("toolbar-more")]);q.append(y,k);q.append(y,z);var A=function(){var a=x.get();return d.bind(a,function(a){return a.isVisible()?[a.component()]:[]})};return{element:function(){return y},main:f.constant(k),mores:f.constant(z),destroy:function(){var a=x.get();d.each(a,function(a){a.destroy()})},focused:f.constant(!1),enter:f.noop,restore:f.noop,refocus:f.noop,refresh:f.curry(b.preserve,function(){var a=A(),a=u.build(a);t.empty(k);t.empty(z);s.append(k,a);p.reflow(k)},y),add:function(a){x.add(a)},
events:w.registry}}});k("kb",["7"],function(c){return{item:c.constant('.ephox-chameleon-toolbar-group [tabindex="-1"]'),group:c.constant(".ephox-chameleon-toolbar-group"),sector:c.constant(".ephox-chameleon-toolstrip > *")}});k("oj","75 1y 4b 2n 3u 6d".split(" "),function(c,d,b,a,e,g){var f=c.resolve("toolbar-more-closed"),h=c.resolve("toolbar-more-open"),l=c.resolve("toolbar-more-hide"),m=c.resolve("toolbar-more-show"),n=function(b,c){a.set(b,"height",c+"px");a.reflow(b)},p=function(a){d.remove(a,
h);d.add(a,f);n(a,0)},r=function(b){d.remove(b,f);d.add(b,h);a.remove(b,"height")};return function(c){p(c);var f=!1,h=e.bind(c,"transitionend",function(d){"height"===d.raw().propertyName&&(b.remove(c,[m,l]),f&&a.remove(c,"height"))});return{visible:function(){return f},hide:function(){f=!1;n(c,g.get(c));d.add(c,l);p(c)},show:function(){r(c);var a=g.get(c);p(c);d.add(c,m);r(c);n(c,a);f=!0},destroy:function(){h.unbind()}}}});k("y9",["2u"],function(c){return c.immutable("within","extra","withinWidth")});
k("ox",["b","7"],function(c,d){return{make:function(b,a,e){return c.foldl(b,function(b,c){return a(c,b.len).fold(d.constant(b),function(a){return{len:a.finish(),list:b.list.concat([a])}})},{len:void 0!==e?e:0,list:[]}).list}}});k("oy",["b","s"],function(c,d){var b=function(a,b){return b>=a.start()&&b<=a.finish()},a=function(a,b){return c.findIndex(a,function(a){return a.start()===b})};return{get:function(a,g){var f=c.find(a,function(a){return b(a,g)});return d.from(f)},find:function(a,b){return d.from(c.find(a,
b))},inUnit:b,sublist:function(b,c,d){c=a(b,c);var h=a(b,d);d=-1<h?h:b[b.length-1]&&b[b.length-1].finish()===d?b.length+1:-1;return-1<c&&-1<d?b.slice(c,d):[]}}});k("p0",["b","6","7"],function(c,d,b){return{translate:function(a,e){return c.map(a,function(a){return d.merge(a,{start:b.constant(a.start()+e),finish:b.constant(a.finish()+e)})})}}});k("oz",["b","oy","p0"],function(c,d,b){var a=function(a,c,d){c=d(a,c);return b.translate(c,a.start())};return{splits:function(b,g,f){return 0===g.length?b:c.bind(b,
function(b){var e=c.bind(g,function(a){return d.inUnit(b,a)?[a-b.start()]:[]});return 0<e.length?a(b,e,f):[b]})}}});k("h4",["ox","oy","oz","p0"],function(c,d,b,a){return{generate:function(a,b,d){return c.make(a,b,d)},get:function(a,b){return d.get(a,b)},find:function(a,b){return d.find(a,b)},splits:function(a,c,d){return b.splits(a,c,d)},translate:function(b,c){return a.translate(b,c)},sublist:function(a,b,c){return d.sublist(a,b,c)}}});k("st",["b","y9","7","s","h4"],function(c,d,b,a,e){var g=function(d,
f,g){var h=e.generate(d,function(c,d){var e=g(c);return a.some({element:b.constant(c),start:b.constant(d),finish:b.constant(d+e),width:b.constant(e)})});d=c.filter(h,function(a){return a.finish()<f});var l=c.foldr(d,function(a,b){return a+b.width()},0),h=h.slice(d.length);return{within:b.constant(d),extra:b.constant(h),withinWidth:b.constant(l)}},f=function(a){return c.map(a,function(a){return a.element()})},h=function(a,b,c){a=f(a.concat(b));return d(a,[],c)},l=function(a,b,c,e){a=f(a).concat([c]);
return d(a,f(b),e)},m=function(a,b,c){return d(f(a),[],c)},n=function(b,c,d){b=g(c,b,d);return 0===b.extra().length?a.some(b):a.none()};return{partition:function(a,b,c,d){var e=n(a,b,c).getOrThunk(function(){return g(b,a-c(d),c)}),f=e.within(),v=e.extra(),e=e.withinWidth();return 1===v.length&&v[0].width()<=c(d)?h(f,v,e):1<=v.length?l(f,v,d,e):m(f,v,e)}}});k("kc","75 oj b l5 7v sr ss st 7 54 46 1y 4b 2n l 2o 3c 2q 2r".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,v,w){return function(x,y){var k=
n.create({grow:m([]),shrink:m([]),exit:m([])}),z=g(f(l.identity)),A=s.fromTag("div");e.toolbarGroup(A);p.add(A,c.resolve("toolstrip"));var C=s.fromTag("div");r.add(C,[c.resolve("toolbar"),c.resolve("toolbar-primary")]);var D=s.fromTag("div");r.add(D,[c.resolve("toolbar"),c.resolve("toolbar-more")]);t.append(A,C);t.append(A,D);var F=d(D);y.events.click.bind(function(){F.visible()?(F.hide(),y.deselect(),k.trigger.shrink()):(F.show(),y.select(),k.trigger.grow())});var E=function(){var a=z.get();return b.bind(a,
function(a){return a.isVisible()?[a.component()]:[]})};return{element:function(){return A},main:l.constant(C),mores:l.constant(D),destroy:function(){var a=z.get();b.each(a,function(a){a.destroy()});y.destroy();F.destroy()},focused:l.constant(!1),enter:l.noop,restore:l.noop,refocus:l.noop,refresh:l.curry(a.preserve,function(){x.update();var a=E(),a=x.build(a);q.set(C,"visibility","hidden");x.clearWidth();v.empty(C);u.append(C,a);var b=x.width(C);t.append(C,y.group());var a=h.partition(b,a,w.getOuter,
y.group()),b=a.extra(),c=a.within();v.empty(C);v.empty(D);u.append(C,c);u.append(D,b);x.updateWidth(y,a);q.remove(C,"visibility")},A),add:function(a){z.add(a)},events:k.registry}}});k("g2",["2u"],function(c){return{grid:c.immutableBag(["trigger"],["isValid","first"]),flow:c.immutableBag(["trigger"],["first","executeOnArrow"]),sectors:c.immutableBag(["trigger","first"],[]),radio:c.immutableBag(["one"],[]),input:c.immutableBag([],["execute"]),button:c.immutableBag(["execute"],["process"]),dialog:c.immutableBag(["execute",
"ok","cancel"],["index"]),inlineDialog:c.immutableBag(["ok","cancel"],["index"]),page:c.immutableBag(["trigger"],["first"]),tabular:c.immutableBag(["trigger"],["first","isValid"]),dynamic:c.immutableBag([],["execute"])}});k("kd",["52"],function(c){return c.ensure(["enter","exit","destroy"])});k("ke",["b"],function(c){var d=function(b){return function(a){return a.raw().which===b}};return{inSet:function(b){return function(a){return c.contains(b,a.raw().which)}},and:function(b){return function(a){return c.forall(b,
function(b){return b(a)})}},is:d,isShift:function(b){return!0===b.raw().shiftKey},basic:function(b,a){return{matches:d(b),run:a}},rule:function(b,a){return{matches:b,run:a}}}});k("kf",["b","1a","2y","4e"],function(c,d,b,a){var e=function(a){d.has(a,"tabIndex")||d.set(a,"tabIndex","-1")};return{set:function(a){e(a);b.focus(a)},find:function(a){return b.search(a)},isFocused:b.hasFocus,mark:e,markSelectors:function(b,d){c.each(d,function(d){d=a.descendants(b,d);c.each(d,e)})}}});k("cw","b kd kf 7 54 46 3u".split(" "),
function(c,d,b,a,e,g,f){return function(h,l,m){var n=f.bind(h,"keydown",m.getOr(function(a){var b=c.find(l,function(b){return b.matches(a)});void 0!==b&&null!==b&&b.run(a).each(function(b){a.kill()})})),p=g.create({enter:e([]),exit:e([])});return d({isFocused:a.curry(b.isFocused,h),element:a.constant(h),clear:a.noop,enter:function(){b.set(h);p.trigger.enter()},refresh:a.noop,isEnabled:a.constant(!0),exit:function(){p.trigger.exit()},events:p.registry,destroy:function(){n.unbind()}})}});k("ck","kd ke cw a8 7 s".split(" "),
function(c,d,b,a,e,g){return function(f,h){var l=b(f,[d.rule(d.inSet(a.SPACE().concat(a.ENTER())),function(){h.execute()(f);return g.some(!0)})],h.process());return c({element:l.element,destroy:l.destroy,clear:l.clear,isFocused:l.isFocused,isEnabled:e.constant(!0),refresh:e.noop,enter:l.enter,exit:l.exit})}});k("kj",["b","s"],function(c,d){return{adjust:function(b,a,c,d){b+=a;return b>d?c:b<c?d:b},findPrev:function(b,a,e){var g=c.reverse(b.slice(0,a));b=c.reverse(b.slice(a+1));e=c.find(g.concat(b),
e);return void 0!==e&&null!==e?d.some(e):d.none()},findNext:function(b,a,e){var g=b.slice(0,a);b=b.slice(a+1);e=c.find(b.concat(g),e);return d.from(e)}}});k("kg","b kj 7 s 1b 2n 37 al".split(" "),function(c,d,b,a,e,g,f,h){var l=function(b){b=c.find(b,m);return a.from(b)},m=function(a){return h.isVisible(a.element())&&a.isEnabled()&&"hidden"!==g.get(a.element(),"visibility")};return{exit:function(a){c.each(a,function(a){a.clear();a.exit()})},clear:function(a){c.each(a,function(a){a.clear()})},refresh:function(a){c.each(a,
function(a){a.refresh()})},first:l,enterFirst:function(b,c){c.index().bind(function(c){return a.from(b[c]).filter(m)}).orThunk(function(){return l(b)}).each(function(a){a.enter()})},isEnabled:function(a){return c.exists(a,function(a){return a.isEnabled()})},locate:function(a,d){return c.find(a,function(a){var c=d.target();a=a.element();return f.closest(c,b.curry(e.eq,a))})},next:function(a,b){var e=c.indexOf(a,b);return d.findNext(a,e,m).getOr(b)},prev:function(a,b){var e=c.indexOf(a,b);return d.findPrev(a,
e,m).getOr(b)},prevNoCycle:function(b,d){var e=c.indexOf(b,d);return 0<e?a.some(b[e-1]):a.none()},nextNoCycle:function(b,d){var e=c.indexOf(b,d);return e+1<b.length?a.some(b[e+1]):a.none()},progress:function(a,b){a.exit();b.enter()},destroy:function(a){c.each(a,function(a){a.destroy()})}}});k("cl","b kd g2 ke ck kf kg a8 7 54 46 3u 21".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r){return function(q,s,t){var u=t.execute(),v=b.button({execute:u}),w=s.slice(0).concat([e(t.cancel(),v),e(t.ok(),v)]),
x=p.bind(q,"keydown",function(b){var d=f.locate(w,b);if(void 0!==d&&null!==d){var e=a.isShift(b);a.is(h.TAB()[0])(b)?(e=(e?f.prev:f.next)(w,d),f.progress(d,e),b.kill()):a.is(h.ESCAPE()[0])(b)?(y(),b.kill(),u(t.cancel())):(d=d.element(),"button"===r.name(d)||e||!a.is(h.ENTER()[0])(b)?(d=[h.UP()[0],h.DOWN()[0]],e=["textarea","select","input"],a.inSet(d)(b)&&!1===c.contains(e,r.name(b.target()))&&b.kill()):(u(t.ok()),b.kill()))}}),y=function(){f.exit(w);k.trigger.exit()},k=n.create({enter:m([]),exit:m([])});
return d({enter:function(){f.enterFirst(w,t)},exit:y,clear:l.curry(f.clear,w),refresh:l.curry(f.refresh,w),isEnabled:l.curry(f.isEnabled,w),isFocused:l.curry(g.isFocused,q),events:k.registry,destroy:function(){f.destroy(w);x.unbind()}})}});k("cm","kd ke kf kg a8 7 54 46 4m 3u".split(" "),function(c,d,b,a,e,g,f,h,l,m){return function(n){var p=l([]),r=function(b,c){d.is(e.TAB()[0])(c)&&(d.isShift(c)?a.prevNoCycle:a.nextNoCycle)(p.get(),b).each(function(d){a.progress(b,d);c.kill()})},q=m.bind(n,"keydown",
function(b){var c=a.locate(p.get(),b);void 0!==c&&null!==c&&r(c,b)}),s=h.create({enter:f([]),exit:f([])}),t=function(a){return function(){return a(p.get())}};return c({element:g.constant(n),enter:function(){a.first(p.get()).each(function(a){a.enter()})},exit:function(){a.exit(p.get());s.trigger.exit()},set:function(b){a.destroy(p.get());p.set(b)},clear:t(a.clear,p),refresh:t(a.refresh,p),isEnabled:t(a.isEnabled,p),isFocused:t(b.isFocused,n),destroy:function(){a.destroy(p.get());q.unbind()},events:s.registry})}});
k("kl","b kf 7 s 2u 1b 4e 31 2a al".split(" "),function(c,d,b,a,e,g,f,h,l,m){var n=e.immutableBag(["index","focused","group","items"],[]),p=e.immutableBag(["index","sectors","sector"],[]),r=e.immutableBag(["index","candidates"],[]);return{ofFocus:function(e,l,p){return d.find(e).bind(function(d){return h.closest(d,l).bind(function(e){var h=f.descendants(e,p),h=c.filter(h,m.isVisible),l=c.findIndex(h,b.curry(g.eq,d));return-1<l?a.some(n({index:l,focused:d,group:e,items:h})):a.none()})})},ofSector:function(d,
e,l){var m=f.descendants(d,e);return h.closest(l,e).bind(function(d){var e=c.findIndex(m,b.curry(g.eq,d));return-1<e?a.some(p({index:e,sectors:m,sector:d})):a.none()})},within:function(d,e,h){d=f.descendants(d,h);e=c.findIndex(d,b.curry(g.eq,e));return-1<e?a.some(r({index:e,candidates:d})):a.none()}}});k("kh",["kj","kl","s"],function(c,d,b){return{horizontal:function(a,e,g,f){return d.within(a,g,e).bind(function(a){var d=a.index();a=a.candidates();d=c.adjust(d,f,0,a.length-1);return b.from(a[d])})}}});
k("ki",["7","bl"],function(c,d){return function(b,a){var e=c.curry(a,-1,0),g=c.curry(a,1,0),f=d.onDirection(e,g),h=d.onDirection(g,e),e=c.curry(a,0,-1),g=c.curry(a,0,1),l=function(a){return a(b)()},f=c.curry(l,f),h=c.curry(l,h);return{west:f,east:h,north:e,south:g}}});k("cn","kd ke cw kh kf ki a8 7 s 31 m".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){return function(p,r,q){var s=l.none();e.markSelectors(p,[r.item()]);var t=function(b){return e.find(p).bind(function(c){return a.horizontal(p,r.item(),
c,b)})},u=g(p,function(a){return t(a).bind(function(a){x(a);return q.executeOnArrow().fold(function(){return l.some(!0)},v)})}),v=function(){return e.find(p).bind(q.trigger()).map(h.constant(!0))},w=b(p,[d.rule(d.inSet(f.LEFT().concat(f.UP())),u.west),d.rule(d.inSet(f.RIGHT().concat(f.DOWN())),u.east),d.rule(d.inSet(f.SPACE().concat(f.ENTER())),v)],l.none()),x=function(a){s=l.some(a);e.set(a)};return c({element:w.element,destroy:w.destroy,clickFocus:function(a){n.is(a,r.item())&&x(a)},clear:function(){s=
l.none()},isFocused:w.isFocused,isEnabled:h.constant(!0),refresh:h.noop,enter:function(){w.enter();s.orThunk(function(){return q.first().fold(function(){return m.descendant(p,r.item())},h.apply)}).bind(x)},exit:w.exit})}});k("kk","ke cw kf a8 7 s 31".split(" "),function(c,d,b,a,e,g,f){return{delegate:function(f,l,m){return d(f,[c.basic(a.LEFT()[0],l.west),c.basic(a.RIGHT()[0],l.east),c.basic(a.UP()[0],l.north),c.basic(a.DOWN()[0],l.south),c.rule(c.inSet(a.SPACE().concat(a.ENTER())),function(){return b.find(f).bind(m.trigger()).map(e.constant(!0))})],
g.none())},findRecent:function(a,b,c,d){return d.isValid().fold(e.constant(c),function(a){return c.filter(a)}).orThunk(function(){return d.first().bind(function(a){return a()}).orThunk(function(){return f.descendant(a,b)})})}}});k("co","kd kj kf kk ki 7 s 4m 2u 2y 4e 2a 1s".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r){var q=l.immutable("row","column");return function(l,t,u,v,w){var x=u,y=v;b.markSelectors(l,[t.cell()]);var k=h(f.none()),z=function(a){return p.findIndex(a).map(function(a){return q(r.floor(a/
y),a%y)})},A=function(a,c){return b.find(l).bind(function(b){return z(b).bind(function(b){var e=d.adjust(b.row(),c,0,x-1),g=d.adjust(b.column(),a,0,y-1);b=n.descendants(l,t.cell());var h=b.length-1,e=e*y,e=e+g>h?0<a?e:h:e+g;return 0<=e&&e<b.length?f.some(b[e]):f.none()})})};u=e(l,function(a,c){return A(a,c).bind(function(a){b.set(a);k.set(f.some(a));return f.some(!0)})});var C=a.delegate(l,u,w);return c({element:C.element,destroy:C.destroy,clear:function(){k.set(f.none())},isFocused:C.isFocused,isEnabled:g.constant(!0),
refresh:g.noop,enter:function(){C.enter();k.set(a.findRecent(l,t.cell(),k.get(),w));k.get().each(m.focus)},exit:C.exit,resize:function(a,b){x=a;y=b}})}});k("cp","b kd ke kf kg a8 7 54 46 3u 21".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){return function(p,r,q){var s=q.ok(),t=q.cancel(),u=m.bind(p,"keydown",function(a){var d=e.locate(r,a);if(void 0!==d&&null!==d){var f=b.isShift(a);b.is(g.TAB()[0])(a)?(f=(f?e.prev:e.next)(r,d),e.progress(d,f),a.kill()):b.is(g.ESCAPE()[0])(a)?(v(),a.kill(),t(a.target())):
!f&&b.is(g.ENTER()[0])(a)?(s(a.target()),a.kill()):(d=[g.UP()[0],g.DOWN()[0]],f=["textarea","select","input"],b.inSet(d)(a)&&!1===c.contains(f,n.name(a.target()))&&a.kill())}}),v=function(){e.exit(r);w.trigger.exit()},w=l.create({enter:h([]),exit:h([])});return d({enter:function(){e.enterFirst(r,q)},exit:v,clear:f.curry(e.clear,r),refresh:f.curry(e.refresh,r),isEnabled:f.curry(e.isEnabled,r),isFocused:f.curry(a.isFocused,p),events:w.registry,destroy:function(){e.destroy(r);u.unbind()}})}});k("32",
["n"],function(c){return{set:function(d,b){if(void 0===b)throw new c("Value.set was undefined");d.dom().value=b},get:function(c){return c.dom().value}}});k("cq","kd ke cw a8 7 s 1a 32".split(" "),function(c,d,b,a,e,g,f,h){return function(l,m){var n=b(l,[d.basic(a.ENTER()[0],function(a){return m.execute().map(function(b){var c={isShift:e.constant(d.isShift(a))},f=h.get(l);b(f,c);return!0})})],g.none());return c({element:n.element,destroy:n.destroy,clear:n.clear,isFocused:n.isFocused,isEnabled:function(){return!f.has(l,
"disabled")},refresh:e.noop,enter:function(){n.enter();l.dom().setSelectionRange(0,h.get(l).length)},exit:n.exit})}});k("cr","kd ke kf kg a8 7 54 46 3u".split(" "),function(c,d,b,a,e,g,f,h,l){return function(m,n){var p=l.bind(m,"keydown",function(b){var c=a.locate(n,b);if(d.is(e.ESCAPE()[0])(b))r(),b.kill();else if(void 0!==c&&null!==c&&d.is(e.TAB()[0])(b)){var f=(d.isShift(b)?a.prev:a.next)(n,c);a.progress(c,f);b.kill()}}),r=function(){a.exit(n);q.trigger.exit()},q=h.create({enter:f([]),exit:f([])});
return c({enter:function(){a.first(n).each(function(a){a.enter()})},exit:r,clear:g.curry(a.clear,n),refresh:g.curry(a.refresh,n),isEnabled:g.curry(a.isEnabled,n),isFocused:g.curry(b.isFocused,m),destroy:function(){a.destroy(n);p.unbind()},events:q.registry})}});k("cs","kd ke kf kg a8 7 54 46 3u".split(" "),function(c,d,b,a,e,g,f,h,l){return function(m,n){var p=l.bind(m,"keydown",function(b){var c=a.locate(n,b);if(d.is(e.ESCAPE()[0])(b))r(),b.kill();else if(void 0!==c&&null!==c)if(d.is(e.UP()[0])(b))a.progress(c,
a.prev(n,c)),b.kill();else if(d.is(e.DOWN()[0])(b))a.progress(c,a.next(n,c)),b.kill();else if(d.is(e.TAB()[0])(b)){var f=(d.isShift(b)?a.prev:a.next)(n,c);a.progress(c,f);b.kill()}}),r=function(){a.exit(n);q.trigger.exit()},q=h.create({enter:f([]),exit:f([])});return c({enter:function(){a.first(n).each(function(a){a.enter()})},exit:r,clear:g.curry(a.clear,n),refresh:g.curry(a.refresh,n),isEnabled:g.curry(a.isEnabled,n),isFocused:g.curry(b.isFocused,m),events:q.registry,destroy:function(){a.destroy(n);
p.unbind()}})}});k("ct","b kd ke cw kf a8 7 s 1b 2y 4e 31".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p){return function(r,q,s){var t=q.stops().join(","),u=function(){return s.first().bind(function(a){return p.descendant(r,a)}).getOr(r)},v=function(a){var b=u();return(m.hasFocus(b)?h.some:e.find)(b).bind(function(b){var d;d=u();if(l.eq(d,b)&&0>a)d=h.none();else{var e=n.descendants(d,t);b=c.findIndex(e,f.curry(l.eq,b))+a;d=b>=e.length?h.none():0>b?h.some(d):0<=b&&b<e.length?h.some(e[b]):h.none()}return d})};
q=function(a){return v(a).bind(function(a){e.set(a);return h.some(!0)})};var w=a(r,[b.rule(b.and([b.isShift,b.inSet(g.TAB())]),f.curry(q,-1)),b.rule(b.inSet(g.TAB()),f.curry(q,1)),b.rule(b.inSet(g.SPACE().concat(g.ENTER())),function(){return e.find(r).bind(s.trigger()).map(f.constant(!0))})],h.none());return d({element:w.element,destroy:w.destroy,clear:f.noop,isFocused:w.isFocused,isEnabled:f.constant(!0),refresh:f.noop,enter:function(){w.enter();e.set(u())},exit:w.exit})}});k("cu","kd ke cw kh kf ki a8 7 s 31 m".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n){return function(p,r,q){var s=function(b){return e.find(p).bind(function(c){return a.horizontal(p,r.item(),c,b)})},t=g(p,function(a){return s(a).bind(function(a){e.set(a);q.one()(p,a);return l.some(!0)})}),u=b(p,[d.rule(d.inSet(f.LEFT().concat(f.UP())),t.west),d.rule(d.inSet(f.RIGHT().concat(f.DOWN())),t.east),d.rule(d.inSet(f.SPACE()),h.curry(l.some,!0))],l.none());return c({element:u.element,destroy:u.destroy,clear:h.noop,refresh:function(){u.isFocused()&&m.descendant(p,
r.selected()).each(e.set)},isFocused:u.isFocused,isEnabled:h.constant(!0),enter:function(){u.enter();m.descendant(p,r.selected()).orThunk(function(){return m.descendant(p,r.item())}).each(function(a){n.is(a,r.selected())||q.one()(p,a);e.set(a)})},exit:u.exit})}});k("cv","b kd ke cw kj kf kl ki a8 7 s 54 46 6d 6h 4i 4e m 2a al".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,v,w,x){return function(y,k,z){g.markSelectors(y,[k.sector(),k.group(),k.item()]);var A=function(a){return t.descendant(a,
function(a){return v.is(a,k.item())&&G(a)})},C=function(a){return t.child(a,L)},D=function(a){a=s.children(a,L);return 0<a.length?n.some(a[a.length-1]):n.none()},F=h(y,function(a){return f.ofFocus(y,k.group(),k.item()).bind(function(b){var c=b.items();b=e.adjust(b.index(),a,0,c.length-1);return n.from(c[b])})}),E=function(a){return f.ofFocus(y,k.group(),k.item()).bind(function(b){return a(b.group()).bind(A)})},G=function(a){return 0<q.get(a)},H=function(a){return f.ofSector(y,k.sector(),a).map(function(a){return e.findPrev(a.sectors(),
a.index(),G).getOr(a.sector())})},I=function(a){return f.ofSector(y,k.sector(),a).map(function(a){return e.findNext(a.sectors(),a.index(),G).getOr(a.sector())})},L=function(a){var b;if(b=v.is(a,k.group()))a=u.descendants(a,k.item()),b=c.exists(a,x.isVisible);return b},J=function(a){return function(){return a().map(function(a){g.set(a);K.trigger.active(a);return a})}},K=r.create({enter:p([]),exit:p([]),active:p(["element"])}),M=a(y,[b.rule(b.inSet(l.ESCAPE()),function(){M.exit();K.trigger.exit();return n.some(!0)}),
b.rule(b.inSet(l.RIGHT().concat(l.DOWN())),J(F.east)),b.rule(b.inSet(l.LEFT().concat(l.UP())),J(F.west)),b.rule(b.and([b.isShift,b.inSet(l.TAB())]),J(m.curry(E,function(a){return w.prevSibling(a).filter(L).orThunk(function(){return H(a).bind(D)})}))),b.rule(b.inSet(l.TAB()),J(m.curry(E,function(a){return w.nextSibling(a).filter(L).orThunk(function(){return I(a).bind(C)})}))),b.rule(b.inSet(l.SPACE().concat(l.ENTER())),function(){return g.find(y).bind(z.trigger()).map(m.constant(!0))})],n.none());
return d({element:M.element,clear:m.noop,isFocused:M.isFocused,enter:function(){M.enter();K.trigger.enter();z.first()().orThunk(function(){return A(y)}).each(function(a){g.set(a);K.trigger.active(a)})},refresh:m.noop,isEnabled:m.constant(!0),exit:M.exit,destroy:M.destroy,events:K.registry})}});k("km",["kj","2u","1s"],function(c,d,b){return{move:function(a,e,g){var f=d.immutable("row","col"),h=a.length-1,l=a[e.row()]-1,h=c.adjust(e.row(),g.dr(),0,h);a=a[h]-1;l=b.max(l,a);e=b.min(a,c.adjust(e.col(),
g.dc(),0,l));return f(h,e)}}});k("cx","b kd kf kk kl km ki 7 s 4m 2u 4e 31".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r){return function(q,s,t){var u=s.row(),v=s.cell();b.markSelectors(q,[u,v]);var w=m(l.none()),x=f(q,function(a,c){return D(a,c).bind(function(a){b.set(a);w.set(l.some(a));return l.some(!0)})}),y=n.immutable("row","col"),k=n.immutable("dc","dr"),z=function(a){a=p.descendants(a,u);return c.map(a,function(a){return p.descendants(a,v).length})},A=function(a){return r.closest(a,u).bind(function(b){return e.within(q,
b,u).bind(function(c){return e.within(b,a,v).map(function(a){return y(c.index(),a.index())})})})},C=function(a){var b=p.descendants(q,u);return l.from(b[a.row()]).bind(function(b){b=p.descendants(b,v);return l.from(b[a.col()])})},D=function(a,c){return b.find(q).bind(function(b){return A(b).bind(function(b){var d=z(q);b=g.move(d,b,k(a,c));return C(b)})})},F=a.delegate(q,x,t);return d({element:F.element,destroy:F.destroy,clear:function(){w.set(l.none())},isFocused:F.isFocused,isEnabled:h.constant(!0),
refresh:h.noop,enter:function(){F.enter();w.set(a.findRecent(q,s.cell(),w.get(),t));w.get().each(b.set)},exit:F.exit})}});k("cy",["kf"],function(c){return function(d,b,a,e,g){c.markSelectors(d,[b.cell()])}});k("8h","1o c ck cl cm cn co cp cq cr cs ct cu cv cw cx cy 7 s 54 46".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,v,w,x,y){b={single:s,multiple:m,multipleAll:n,flow:g,grid:f,sectors:q,radio:r,input:l,dialog:a,button:b,inlineDialog:h,tabular:t,page:p,dynamic:e};var k={grid:u};u=function(a,
b){var c=w.from(k[b]).getOr(v.noop);return function(){c.apply(null,arguments);return{element:v.noop,clear:v.noop,isFocused:v.noop,isEnabled:v.noop,refresh:v.noop,enter:v.noop,exit:v.noop,events:y.create({enter:x([]),exit:x([]),active:x([])}).registry,destroy:v.noop,set:v.noop,clickFocus:v.noop,resize:v.noop}}};return d.detect().deviceType.isTouch()?c.map(b,u):b});k("c0","k8 k9 ka kb kc 7v c g2 8h s 54 46 47 3u 2y".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s){return function(t,u){var v=d(u),
w=f.detect().deviceType.isTouch()?b(t,v):e(t,v);g.toolbar(w.main(),u("aria.label.toolbar"));g.group(w.mores());var x=p.create({drawer:r(["delta","total"],w.events.drawer),grow:r([],w.events.grow),shrink:n([]),transitionend:n(["property"]),exit:n([])}),y=q.bind(w.element(),"transitionend",function(a){x.trigger.transitionend(a.raw().propertyName)}),k=m.none(),z=h.sectors({first:m.none,trigger:c.trigger}),A=l.sectors(w.element(),a,z);A.events.exit.bind(function(){k=m.none();x.trigger.exit()});A.events.active.bind(function(a){k=
m.some(a.element())});var C=function(){return A.isFocused()},D=function(){k.each(s.focus)};w.events.shrink.bind(function(){s.search(w.mores()).isSome()&&v.focus();x.trigger.shrink()});return{element:w.element,refresh:w.refresh,add:w.add,enter:function(){A.enter()},destroy:function(){A.exit();k=m.none();y.unbind();w.destroy();A.destroy()},focused:C,restore:D,refocus:function(){C()&&D()},events:x.registry}}});k("a5",["bx","by","bz","c0"],function(c,d,b,a){return{toolbar:function(b,c){return a(b,c)},
menu:function(a,b,c){return d.create(a,b,c)},popup:function(a,c,d,h,l){return b(a,c,d,h,l)},menuSystem:function(a,b,d){return c(a,b,d)}}});k("i4",["b","c","s","36"],function(c,d,b,a){var e=d.detect(),g=e.deviceType.isTouch,f=function(b,c){return a.screen.width>=b&&a.screen.height>=c},h=function(){return!f(620,700)&&g()};return{isTouch:g,choice:function(a,d){return c.foldl(a,function(a,c){return a.orThunk(function(){return c.predicate()?b.some(c.value()):b.none()})},b.none()).getOr(d)},isLarge:function(){return f(620,
700)},isLargeTouch:function(){return f(620,700)&&g()},isSmallTouch:h,isLargeDesktop:function(){return f(620,700)&&!g()},isSmallAndroid:function(){return h()&&e.deviceType.isAndroid()}}});k("c1",["1o","c","4b","i4"],function(c,d,b,a){d=d.detect();a={"ephox-platform-desktop":!d.deviceType.isTouch(),"ephox-platform-touch":d.deviceType.isTouch(),"ephox-platform-small-touch":a.isSmallTouch(),"ephox-platform-android":d.deviceType.isAndroid(),"ephox-platform-ios":d.deviceType.isiOS(),"ephox-platform-ie":d.browser.isIE()||
d.browser.isSpartan(),"ephox-platform-firefox":d.browser.isFirefox()};var e=[];c.each(a,function(a,b){!0===a&&e.push(b)});return{addClasses:function(a){b.add(a,e)}}});k("kn","b 4z 33 3e 54 46 1y 2o 2q".split(" "),function(c,d,b,a,e,g,f,h,l){return function(){var m=d.div();f.add(m,b.resolve("bannerarium"));f.add(m,b.resolve("layer-above-editor"));var n=[],p=a.create(),r=function(a){-1<n.indexOf(a)&&(n=c.filter(n,function(b){return b!==a}));a.destroy();p.unbind(a.events.close);l.remove(a.element())},
q=g.create({close:e(["banner"])});return{element:function(){return m},display:function(a){n.push(a);p.bind(a.events.close,function(){r(a);q.trigger.close(a)});h.append(m,a.element())},hide:r,destroy:function(){l.remove(m);c.each(n,r)},events:q.registry}}});k("c2",["kn","54","46"],function(c,d,b){return function(){var a=c();a.events.close.bind(function(){e.trigger.resize()});var e=b.create({resize:d([])});return{element:a.element,display:function(b){a.display(b);e.trigger.resize()},hide:function(b){a.hide(b);
e.trigger.resize()},destroy:a.destroy,events:e.registry}}});k("ko",["2i"],function(c){return{atob:function(d){return c.getOrDie("atob")(d)},requestAnimationFrame:function(d){c.getOrDie("requestAnimationFrame")(d)}}});k("9u",["3t"],function(c){return function(d,b){var a=null,e=null;return{throttle:function(){e=arguments;null===a&&(a=c(function(){d.apply(null,e);e=a=null},b))}}}});k("su","ko 7 9u 2a al 2s 2t 36".split(" "),function(c,d,b,a,e,g,f,h){var l=function(a,b){var c=f(b,500);return function(){g(c)}},
m=function(b,c){var d=new h.MutationObserver(c);d.observe(a.owner(b).dom(),{attributes:!0,subtree:!0,childList:!0,attributeFilter:["style","class"]});return function(){d.disconnect()}},n=void 0!==h.MutationObserver&&null!==h.MutationObserver?m:l;return{onShow:function(a,f){if(e.isVisible(a))return c.requestAnimationFrame(f),d.noop;var g=b(function(){e.isVisible(a)&&(h(),c.requestAnimationFrame(f))},100),h=n(a,g.throttle);return h}}});k("sv",["b","s","1b"],function(c,d,b){var a=[],e=function(d){return c.findIndex(a,
function(a){return b.eq(a.element,d)})};return{begin:function(b,c){if(-1===e(b)){var d=c();a.push({element:b,unbind:d})}},query:function(b){b=e(b);return-1===b?d.none():d.some(a[b])},end:function(b){b=e(b);if(-1!==b){var c=a[b];a.splice(b,1);c.unbind()}}}});k("kp","b ko 7 s 1b 3u l 6d su al 2r sv 3t 36".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q){var s=function(a){return{element:a,handlers:[],lastWidth:n.get(a),lastHeight:h.get(a)}},t=[],u=function(a){return c.findIndex(t,function(b){return e.eq(b.element,
a)})},v=function(a){var d=n.get(a.element),e=h.get(a.element);if(d!==a.lastWidth||e!==a.lastHeight)a.lastWidth=d,a.lastHeight=e,c.each(a.handlers,b.apply)},w=function(a){var b=a.element;m.isVisible(b)?v(a):p.begin(b,function(){return l.onShow(b,function(){p.end(b);v(a)})})},x=!1,y=function(){x=!1;c.each(t,w)},k=function(){x||(x=!0,d.requestAnimationFrame(y))},z=a.none(),A=function(){z.each(function(b){b.unbind();z=a.none()})};return{bind:function(b,d){var h=c.find(t,function(a){return e.eq(a.element,
b)});void 0===h&&(h=s(b),t.push(h));h.handlers.push(d);z.isNone()&&(z=a.some(g.bind(f.fromDom(q),"resize",k)));r(function(){-1!==u(h.element)&&w(h)},100)},unbind:function(a,b){p.end(a);var d=u(a);if(-1!==d){var e=c.indexOf(t[d].handlers,b);-1!==e&&(t[d].handlers.splice(e,1),0===t[d].handlers.length&&t.splice(d,1),0===t.length&&A())}}}});k("c3","ko 7 s 54 46 6d kp 2r".split(" "),function(c,d,b,a,e,g,f,h){return function(l){var m=e.create({change:a(["width","height","element"])}),n=void 0!==l.resize&&
void 0!==l.resize.container?b.some(l.resize.container):b.none(),p=b.none();return{hookup:function(a){var e=n.getOr(a),s=function(){l.resize&&l.resize.callback&&l.resize.callback();var a=h.get(e),b=g.get(e);m.trigger.change(a,b,e)};p=b.some({target:d.constant(e),f:s});c.requestAnimationFrame(function(){f.bind(e,s)})},destroy:function(){p.each(function(a){f.unbind(a.target(),a.f)})},events:m.registry}}});k("c4","1p 7 s 33 1y l 2o 3c 2a".split(" "),function(c,d,b,a,e,g,f,h,l){var m=function(b,c){var d=
g.fromTag("div");e.add(d,a.resolve(c));f.append(d,b);return d};return{build:function(d,p,r){b.from(p).filter(c.isPrototypeOf).map(g.fromDom).each(function(b){var c=g.fromTag("div");e.add(c,a.resolve("flex-row"));var p=g.fromTag("div");e.add(p,a.resolve("flex-column"));h.append(p,l.children(d));f.append(d,c);f.append(c,p);f.append(c,m(b,"side-bar"))});b.from(r).filter(c.isPrototypeOf).map(g.fromDom).each(function(a){f.append(d,m(a,"bottom-bar"))})}}});k("c5",["7","54","46"],function(c,d,b){return function(){var a=
b.create({change:d(["width","height","element"])});return{hookup:c.noop,destroy:c.noop,events:a.registry}}});k("kq",["7","s","6n","3c","2r"],function(c,d,b,a,e){return function(){return{updateWidth:c.noop,clearWidth:c.noop,build:c.identity,update:c.noop,width:e.getOuter,init:function(a,b,c,d,e){a.refresh()},state:c.constant({toolbar:{drag:d.none()}}),integrate:function(b,c,d,e){a.append(b,[c.element(),d.element(),e])},destroy:c.noop,events:b(["changed"])}}});k("wp",["52"],function(c){var d=c.exactly(["compare",
"extract","mutate","sink"]),b=c.exactly(["element","start","stop","destroy"]);c=c.exactly(["forceDrop","drop","move","delayDrop"]);return{mode:d,sink:b,api:c}});k("10g",["4g"],function(c){return{resolve:c.create("ephox-dragster").resolve}});k("wq","10g 6 1y 2n l 2q".split(" "),function(c,d,b,a,e,g){return function(f){f=d.merge({layerClass:c.resolve("blocker")},f);var h=e.fromTag("div");a.setAll(h,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"});b.add(h,c.resolve("blocker"));b.add(h,
f.layerClass);return{element:function(){return h},destroy:function(){g.remove(h)}}}});k("q9","wp wq s 3k 3u 2o 2q".split(" "),function(c,d,b,a,e,g,f){return c.mode({compare:function(b,c){return a(c.left()-b.left(),c.top()-b.top())},extract:function(c){return b.some(a(c.x(),c.y()))},sink:function(a,b){var m=d(b),n=e.bind(m.element(),"mousedown",a.forceDrop),p=e.bind(m.element(),"mouseup",a.drop),r=e.bind(m.element(),"mousemove",a.move),q=e.bind(m.element(),"mouseout",a.delayDrop);return c.sink({element:m.element,
start:function(a){g.append(a,m.element())},stop:function(){f.remove(m.element())},destroy:function(){m.destroy();p.unbind();r.unbind();q.unbind();n.unbind()}})},mutate:function(a,b){a.mutate(b.left(),b.top())}})});k("10h",["s","54","46"],function(c,d,b){return function(){var a=c.none(),e=function(b,d){var e=a.map(function(a){return b.compare(a,d)});a=c.some(d);return e},g=b.create({move:d(["info"])});return{onEvent:function(a,b){b.extract(a).each(function(a){e(b,a).each(function(a){g.trigger.move(a)})})},
reset:function(){a=c.none()},events:g.registry}}});k("10i",["7"],function(c){return function(d){return{onEvent:function(b,a){},reset:c.noop}}});k("wr",["10h","10i"],function(c,d){return function(){var b=d(),a=c(),e=b;return{on:function(){e.reset();e=a},off:function(){e.reset();e=b},isOn:function(){return e===a},onEvent:function(a,b){e.onEvent(a,b)},events:a.events}}});k("qa","wp wr 6l 54 46 9".split(" "),function(c,d,b,a,e,g){return{setup:function(f,h,l){var m=!1,n=e.create({start:a([]),stop:a([])}),
p=d(),r=function(){t.stop();p.isOn()&&(p.off(),n.trigger.stop())},q=b(r,200);p.events.move.bind(function(a){h.mutate(f,a.info())});var s=function(a){return function(){var b=g.prototype.slice.call(arguments,0);if(m)return a.apply(null,b)}},t=h.sink(c.api({forceDrop:r,drop:s(r),move:s(function(a,b){q.cancel();p.onEvent(a,h)}),delayDrop:s(q.schedule)}),l);return{element:t.element,go:function(a){t.start(a);p.on();n.trigger.start()},on:function(){m=!0},off:function(){m=!1},destroy:function(){t.destroy()},
events:n.registry}}}});k("ib",["q9","qa","9"],function(c,d,b){return{transform:function(a,b){var g=void 0!==b?b:{};return d.setup(a,void 0!==g.mode?g.mode:c,b)}}});k("11j",["54","46","3l"],function(c,d,b){return{both:function(a){var e=d.create({relocate:c(["x","y","deltaX","deltaY"])});return{mutate:function(c,d){var h=b.absolute(a),l=h.left()+c,h=h.top()+d;e.trigger.relocate(l,h,c,d)},events:e.registry}}}});k("ya","ib 11j 54 46 2n 3u l 6m q".split(" "),function(c,d,b,a,e,g,f,h,l){return function(m,
n){var p=a.create({relocate:b(["x","y","deltaX","deltaY"]),dragend:b([])}),r=d.both(m);e.set(m,"position","absolute");var q=c.transform(r),s=g.bind(m,"mousedown",function(a){0!==a.raw().button||h.closest(a.target(),n)||(q.on(),q.go(f.fromDom(l.body)))});q.events.stop.bind(function(){p.trigger.dragend();q.off()});r.events.relocate.bind(function(a){p.trigger.relocate(a.x(),a.y(),a.deltaX(),a.deltaY())});return{blocker:q.element,destroy:function(){s.unbind();q.destroy()},events:p.registry}}});k("11k",
["b","s","2u","1s"],function(c,d,b,a){var e=b.immutable("hx","hy","position","x","y"),g=function(a,b,c,d,g,p){p=b.x();b=b.y()-c;return(b>=a.y()&&b<=a.y()+a.h()?[e(p,b,"absolute",p,b)]:[]).concat([e(g,a.y(),"fixed",g-d.left(),a.fy())])};return{detect:function(b,e,l,m,n,p){b=g(b,e,n,p,l,m);b=c.find(b,function(b){return 10>a.abs(m-b.hy())&&38>a.abs(l-b.hx())});return d.from(b)}}});k("11l",["7"],function(c){return function(d,b,a,e){return{x:c.constant(d),y:c.constant(b),width:c.constant(a),height:c.constant(e),
right:c.constant(d+a),bottom:c.constant(b+e)}}});k("yd",["11l","6d","3l","2r"],function(c,d,b,a){return{box:function(e){var g=b.absolute(e),f=a.getOuter(e);e=d.getOuter(e);return c(g.left(),g.top(),f,e)}}});k("144",["4g"],function(c){return{resolve:c.create("ephox-ego").resolve}});da("dg",parseInt);k("11m","144 7 s 1a 1u dg".split(" "),function(c,d,b,a,e,g){return{make:function(f){var h="data-"+c.resolve(f+"-left"),l="data-"+c.resolve(f+"-top"),m="data-"+c.resolve(f+"-position");return{get:function(c){var f=
g(a.get(c,h),10),r=g(a.get(c,l),10);c=a.get(c,m);return e(f)||e(r)?b.none():b.some({left:d.constant(f),top:d.constant(r),position:d.constant(c)})},set:function(b,c,d,e){a.set(b,m,c);a.set(b,h,d+"px");a.set(b,l,e+"px")},clear:function(b){a.remove(b,m);a.remove(b,h);a.remove(b,l)}}}}});k("yb","11k yd 11m 2u 3k 29 2a".split(" "),function(c,d,b,a,e,g,f){var h=b.make("pre-snap");a.immutable("fixed","loc");var l=function(a,b,c,d,e,f){return h.get(b).fold(function(){return a.fromLocation(b,c,d)},function(c){return a.fromFixed(b,
c.left()+e,c.top()+f)})},m=function(a,b,e,h){var l=f.owner(b),l=g.get(l);b=d.box(b);e=e.loc();return c.detect(a,b,e.left(),e.top(),h,l)};return{move:function(a,b,c,d,f,g){var u=a.graph(),v=a.lazyTheatre(),w=a.lazyHeight();c=l(u,b,c,d,f,g);var x=c.loc(),y=c.fixed();return m(v,a.container(),c,w).fold(function(){var a=u.boundToFixed(v,b,x.left(),x.top(),y.left(),y.top(),w);h.set(b,"fixed",a.left(),a.top());return{position:"fixed",left:a.left()+"px",top:a.top()+"px"}},function(a){var c=u.boundToFixed(v,
b,x.left(),x.top(),y.left(),y.top(),w);h.set(b,"fixed",c.left()+"px",c.top()+"px");c="absolute"===a.position()?u.locationToAbsolute(b,a.x(),a.y()):e(a.x(),a.y());return{position:a.position(),left:c.left()+"px",top:c.top()+"px"}})},forget:function(a){h.clear(a)}}});k("ye",[],function(){return{isInside:function(c,d,b){return!(d>c.y()+c.h()||b<c.y())},isAllInside:function(c,d,b){return d>c.y()&&d<c.y()+c.h()&&b>c.y()&&b<c.y()+c.h()}}});k("yc","11m ye s 3k 2n 3l dg".split(" "),function(c,d,b,a,e,g,f){var h=
c.make("old"),l=function(b,c,d){return e.getRaw(c,"left").bind(function(b){return e.getRaw(c,"top").map(function(c){var d=f(b,10);c=f(c,10);return a(d,c)})}).getOrThunk(function(){return b.locationToAbsolute(c,d.left(),d.top())})},m=function(a,c,f,m,n,u){f=g.absolute(m);n="absolute"===e.get(m,"position");var v=d.isAllInside(c,f.top(),f.top()+u());return n&&!v?(n=l(a,m,f),h.set(m,"absolute",n.left(),n.top()),a=a.absoluteToFixed(m,f.left(),f.top()),c=f.top()<=c.y()?c.fy():c.fy()+c.h()-u(),b.some({position:"fixed",
left:a.left()+"px",top:c+"px"})):b.none()},n=function(a,c,f,g,l,m){return h.get(g).bind(function(f){var l="fixed"===e.get(g,"position"),n=a.absoluteToLocation(g,f.left(),f.top()),n=d.isAllInside(c,n.top(),n.top()+m());return l&&n?(h.clear(g),b.some({position:"absolute",left:f.left()+"px",top:f.top()+"px"})):b.none()})};return{forget:function(a){h.clear(a)},update:function(a,b,c,d,f,g){m(a,b,c,d,f,g).orThunk(function(){return n(a,b,c,d,f,g)}).each(function(a){e.setAll(d,a)})},state:function(a){return h.get(a)},
set:function(a,b){h.set(a,b.position(),b.left(),b.top())}}});k("sw","ya yb yc 7 s 54 46 47 2n 3l".split(" "),function(c,d,b,a,e,g,f,h,l,m){return{none:function(b,c){var d=f.create({dragend:g([]),moved:g([])});return{blocker:a.die("no blocker"),setState:a.noop,getState:a.constant({}),init:function(a,b){l.setAll(c,{left:a+"px",top:b+"px",position:"absolute"});d.trigger.moved()},update:a.noop,destroy:a.noop,events:d.registry}},except:function(e){return function(p,r){var q=c(r,e.join(",")),s=f.create({dragend:h([],
q.events.dragend),moved:g([])});q.events.relocate.bind(function(a){var c=a.x(),e=a.y(),f=a.deltaX();a=a.deltaY();c=d.move(p,r,c,e,f,a);l.setAll(r,c);"absolute"!==c.position&&b.forget(r)});q.events.dragend.bind(function(){s.trigger.moved()});return{blocker:q.blocker,setState:function(a){l.setAll(r,{position:a.position(),left:a.x()+"px",top:a.y()+"px"})},getState:function(){var b=m.viewport(r),c=l.get(r,"position");return{x:b.left,y:b.top,position:a.constant(c)}},init:function(a,b){l.setAll(r,{left:a+
"px",top:b+"px",position:"absolute"});s.trigger.moved()},update:function(){d.forget(r)},destroy:function(){q.destroy()},events:s.registry}}}}});k("sx","6 s 46 47 2n 3l 2r 1s dg".split(" "),function(c,d,b,a,e,g,f,h){return{register:function(f,m,n,p){f.container();var r=n(f,m),q=p(f,m);n=b.create({dragend:a([],r.events.dragend),appear:a(["element"],q.events.appear),disappear:a(["element"],q.events.disappear)});r.events.moved.bind(function(){t();s=!0});q.events.scrolled.bind(function(){t()});var s=!1,
t=function(){r.update();q.update();var a=f.lazyTheatre(),b=g.absolute(m),a=h.max(0,a.x()+a.w()-b.left());e.set(m,"max-width",a+"px")};return{blocker:r.blocker,setState:function(a){r.setState(a);q.setState(a);t();s=!0},state:function(){if(!s)return d.none();var a=c.deepMerge(r.getState(),q.getState());return d.some(a)},init:function(a,b){r.init(a,b);t()},update:t,destroy:function(){q.destroy();r.destroy()},events:n.registry}}}});k("sy","yc yd ye 7 54 46 3u 29 2a".split(" "),function(c,d,b,a,e,g,f,
h,l){return{transitions:function(m,n){var p=m.container(),r=l.defaultView(n),q=g.create({appear:e(["element"]),disappear:e(["element"]),scrolled:e([])}),s=f.bind(r,"scroll",function(){q.trigger.scrolled()});return{update:function(){var a=m.lazyTheatre(),e=d.box(p);if(b.isInside(a,e.y(),e.bottom())){q.trigger.appear(n);var f=m.graph(),g=l.owner(p),g=h.get(g);c.update(f,a,e,n,g,m.lazyHeight)}else q.trigger.disappear(n)},destroy:function(){s.unbind()},setState:function(b){b.transition().each(a.curry(c.set,
n))},getState:function(){return{transition:a.constant(c.state(n))}},events:q.registry}}}});k("11n",["2u","3k","29","2a"],function(c,d,b,a){var e=c.immutable("fixed","loc");return function(c){var f=function(c,e,f){c=a.owner(c);c=b.get(c);e-=c.left();f-=c.top();return d(e,f)},h=function(c,e,f){c=a.owner(c);c=b.get(c);e+=c.left();f+=c.top();return d(e,f)};return{locationToFixed:f,fixedToLocation:h,absoluteToFixed:function(e,f,h){var p=c();e=a.owner(e);e=b.get(e);f-=e.left();return d(f,p.top()-h)},locationToAbsolute:function(a,
b,e){a=c();return d(b,e).translate(-a.left(),-a.top())},absoluteToLocation:function(a,b,e){a=c();return d(b,e).translate(a.left(),a.top())},fromFixed:function(a,b,c){var f=d(b,c);a=h(a,b,c);return e(f,a)},fromLocation:function(a,b,c){a=f(a,b,c);b=d(b,c);return e(a,b)},boundToFixed:function(a,b,c,e,f,g,h){b=c<a.x()?a.fx():c>a.x()+a.w()?a.fx()+a.w():f;a=e<a.y()?a.fy():e+h>a.y()+a.h()?a.fy()+a.h()-h:g;return d(b,a)}}}});k("yf",["11n","7"],function(c,d){return function(b,a,e,g){a=c(a);return{lazyTheatre:b,
graph:d.constant(a),lazyHeight:e,container:d.constant(g)}}});k("sz","yf 7 3k 6d 3l 29 31 2a 36".split(" "),function(c,d,b,a,e,g,f,h,l){return function(m,n){var p=m.isInline()?m.element():h.parent(m.placeholder()).getOr(m.placeholder());return c(function(){var a=g.get();return{x:a.left,y:a.top,w:d.constant(l.innerWidth),h:d.constant(l.innerHeight),fx:d.constant(0),fy:d.constant(0)}},function(){return m.isInline()?b(0,0):e.absolute(p)},function(){var b=f.descendant(n,".ephox-chameleon-toolbar").getOr(n);
return a.getOuter(b)},p)}});k("6c","33 1y 2n 3l 2a 2r".split(" "),function(c,d,b,a,e,g){var f=c.resolve("drag-show"),h=c.resolve("fade-container");return{width:function(c,d){return b.getRaw(c,"max-width").fold(function(){return e.owner(d).dom().defaultView.innerWidth-a.absolute(d).left()},function(a){return parseInt(a,10)})},updateWidth:function(a,c,d){c=0===d.extra().length?d.withinWidth():d.withinWidth()+g.getOuter(c.group());0<c&&b.set(a,"width",c+"px")},clearWidth:function(a){b.remove(a,"width")},
offsetFrom:function(b,c,d,e){c=void 0!==e.toolbar.offset?e.toolbar.offset:{left:0,top:-1*d};d=a.absolute(b.element());b=b.isInline()?{left:d.left(),top:d.top()}:{left:0,top:0};return{left:b.left+c.left,top:b.top+c.top}},initFade:function(a,b){d.add(b,f)},fadeIn:function(a,b){d.remove(a,h);d.add(b,f)},fadeOut:function(a,b){d.remove(b,f);d.add(a,h)}}});k("kr","7v sw sx sy c 4z 7 33 sz 6c 46 47 1y 4b 2n 6d 2o 3c".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,v){return function(w,x){var y=g.div();
s.set(y,"position","relative");r.add(y,h.resolve("dragging-container"));var k=g.div();r.add(k,h.resolve("draggable-container"));var z=w.isInline()?x:k,A=l(w,z,k),C=a.transitions,D=d.except([".ephox-pastry-button","."+h.resolve("banner-buttons")+" *",".ephox-polish-ui-container",".ephox-polish-socket"]),F=b.register(A,z,D,C);m.initFade(z,k);F.events.appear.bind(f.curry(m.fadeIn,z,k));F.events.disappear.bind(f.curry(m.fadeOut,z,k));r.add(k,h.resolve("layer-above-editor"));q.add(F.blocker(),[h.resolve("above-outside"),
h.resolve("dragging")]);var E=g.span();c.hidden(E,!0);q.add(E,[h.resolve("toolbar-drag-handle"),h.resolve("general-drag-handle"),"ephox-textbox-font",h.resolve("icon")]);A=e.detect();A.browser.isIE()&&10===A.browser.version.major&&r.add(E,h.resolve("ie10"));return{updateWidth:f.curry(m.updateWidth,z),clearWidth:f.curry(m.clearWidth,z),build:function(a){return[E].concat(a)},width:f.curry(m.width,z),init:function(a,b,c,d,e){var f=s.preserve(z,function(){s.set(z,"visibility","hidden");s.remove(z,"display");
a.refresh();return t.get(a.element())});e.toolbar.drag.fold(function(){var a=m.offsetFrom(w,z,f,d);F.init(a.left,a.top)},F.setState);v.append(k,[a.element(),b.element()])},update:function(){F.update()},state:function(){return{toolbar:{drag:F.state()}}},integrate:function(a,b,c,d){u.append(k,b.element());w.isInline()?(v.append(y,[k,d]),u.append(x,y)):v.append(x,[k,d])},destroy:function(){F.destroy()},events:n.create({changed:p([],F.events.dragend)}).registry}}});k("ks","sw sx sy 7 s 33 sz 6c 46 47 1y 2n l 6d 2o 3c".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t){return function(u,v){var w=r.fromTag("div");p.set(w,"position","relative");n.add(w,g.resolve("floating-container"));var x=r.fromTag("div");n.add(x,g.resolve("draggable-container"));var y=u.isInline()?v:x,k=f(u,y),z=d.register(k,y,c.none,b.transitions);h.initFade(y,x);z.events.appear.bind(a.curry(h.fadeIn,y,x));z.events.disappear.bind(a.curry(h.fadeOut,y,x));n.add(x,g.resolve("layer-above-editor"));return{updateWidth:a.curry(h.updateWidth,y),clearWidth:a.curry(h.clearWidth,
y),build:a.identity,width:a.curry(h.width,y),init:function(a,b,c,d,e){c=p.preserve(y,function(){p.set(y,"visibility","hidden");p.remove(y,"display");a.refresh();return q.get(a.element())});d=h.offsetFrom(u,y,c,d);z.init(d.left,d.top);t.append(x,[a.element(),b.element()])},update:function(){z.update()},state:a.constant({toolbar:{drag:e.none()}}),integrate:function(a,b,c,d){s.append(x,b.element());u.isInline()?(t.append(w,[x,d]),s.append(v,w)):t.append(v,[x,d])},destroy:function(){z.destroy()},events:l.create({changed:m([],
z.events.dragend)}).registry}}});k("c6",["kq","kr","ks"],function(c,d,b){return{setup:function(a,e,g,f){return(!0===g.toolbar.draggable?d:void 0!==g.toolbar.offset||a.isInline()?b:c)(a,e)}}});k("6w","a5 4z 7 50 73 1f c1 33 c2 c3 c4 c5 aj c6 1a 1y 4b 2n l 2o 2q 2r".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,v,w,x,y,k){return function(z,A,C,D,F,E){var G=w.fromTag("div");D.updateUi(G);u.add(G,[r.editorContainer(),"ephox-textbox-font",h.resolve("layer-editor")]);s.set(G,"lang",g.get());f.addClasses(G);
var H=q.setup(z,G,F,E),I=c.toolbar(H,e.translate);!1===F.toolbar.visible&&t.add(G,"ephox-polish-no-toolbar");A.events.toolbar.bind(I.enter);I.events.exit.bind(z.focus);var L=l(),J=d.div();t.add(J,h.resolve("socket"));var K=F.autoresize?m(F):p();H.integrate(G,I,L,J);n.build(G,F.sideBar,F.bottomBar);var M=z.isInline()?function(){v.set(L.element(),"min-width",k.getOuter(z.element())+"px")}:b.noop;K.events.change.bind(function(a){I.refresh();C.refresh();M()});H.events.changed.bind(function(){I.refresh()});
return{element:function(){return G},socket:function(a){a.connect(J)},viewport:b.constant(J),connect:function(b){x.append(b,G);a.detect(G);K.hookup(z.element());return!0},destroy:function(){K.destroy();I.destroy();H.destroy();L.destroy();y.remove(G)},toolbar:I,position:function(){M();H.init(I,L,J,F,E)},refresh:function(){H.update();I.refresh()},banners:L.element,displayBanner:L.display,hideBanner:L.hide,state:H.state}}});k("56","a c 1p 7 s 6u 6v 6w 6x 6y l".split(" "),function(c,d,b,a,e,g,f,h,l,m,
n){var p=function(a){a=m.absolute(a);var b=m.view();a=g.intersect(a,b);return l(a.x(),a.y(),a.width(),a.height())};return{build:function(a,b,c,d,e,g,l,m){var n=h(a,b,c,g,l,m),p=d.tabbed(n);p.init();return{element:n.element,socket:n.socket,viewport:n.viewport,init:function(b,d,h){d=p.config(a.isInline(),d,e,h);f.setup(n,g,a,b,c,d);p.loaded()},connect:n.connect,destroy:function(){n.destroy();p.destroy()},displayBanner:n.displayBanner,hideBanner:n.hideBanner,position:n.position,refresh:n.refresh,tabstrip:n.toolbar,
state:n.state}},bounds:function(){var f=function(a){var d=function(){return e.from(a.bounds()).filter(b.isPrototypeOf).map(n.fromDom).map(p).getOrThunk(m.view)};return c.isFunction(a.bounds)?d:m.view};return d.detect().deviceType.isTouch()?a.constant(m.view):f}()}});k("3x",["s","p","55","56"],function(c,d,b,a){return{settings:function(e){return{onprem:!0,blocktag:{styles:[{rule:"p"},{rule:"h1"},{rule:"h2"},{rule:"h3"},{rule:"h4"},{rule:"div"},{rule:"pre"}],bundled:!0},image:{bundled:!0},imageEdit:{bundled:!0},
imageupload:{immediate:!1,bundled:!1},content:{css:e+"/css",tabindex:null,stylesheets:[],documentStyles:"",prettyprint:!0},ui:{layout:a,isFullScreen:!1,toolbar:{draggable:!1},autoresize:!0,locale:{},editorName:d.value("debug"),bounds:null,showHelpHint:!1},shortcuts:{features:!0},spelling:{bundled:!0,autocorrect:!0,scanView:!0,multilingual:!0,menu:!0},specialchar:{bundled:!0},fileupload:{bundled:!0,allowLocalImages:!0},horizontalrule:{bundled:!0},media:{bundled:!0},mentions:{bundled:!1},registration:{bundled:!1},
help:{baseUrl:e+"/html",integration:{},bundled:!0},draganddrop:{bundled:!0},wordcount:{bundled:!0},formatting:{bundled:!0},alignindent:{bundled:!0},directionality:{bundled:!0},parlance:{bundled:!0,languages:"en_us en_gb es fr de pt zh".split(" ")},font:{faces:[],bundled:!0},lists:{bundled:!0},link:{bundled:!0},linkvalidator:{bundled:!1},removeformat:{bundled:!0},fullscreen:{bundled:!0,autoresize:!1},editorcontext:{bundled:!0},macros:{whitelist:c.none(),bundled:!0},highlighter:{external:[],bundled:!0},
table:{bundled:!0},contextmenu:{bundled:!0},project:{apiKey:null},smartclipboard:{bundled:!0,copy:{},paste:{forceText:!1,baseUrl:e+"/js",swf:e+"/flash/textboxpaste.swf",officeStyles:"prompt",htmlStyles:"merge",allowLocalImages:!0,enableFlashImport:!0}},resize:{bundled:!0},platform:{toolbar:{items:b,contextual:["table-tools","image-tools"]},allowLocalImages:!0,fillscreen:!1},codeview:{bundled:!0,showButton:!0,mode:"pencil",css:e+"/css",js:e+"/js"},findreplace:{bundled:!0},accessibility:{bundled:!0},
plaincodeview:{bundled:!0}}},state:function(){return{spelling:{words:{},language:c.none()},undo:{initial:{clean:"",marked:""},undo:[],redo:[]},profile:{spelling:!1,nativeSpelling:!0,autocorrect:!0,capitalisation:!1,linkpreviews:!1},content:{clean:"",marked:""},ui:{toolbar:{drag:c.none()}},macros:{customs:{}},filters:{customs:[]},laundry:{dirty:!1},linkvalidator:{ignore:[],cache:{}}}}}});k("3y",["s","42","54","46"],function(c,d,b,a){return function(e){var g=c.none(),f=function(a){return function(){var b=
e.get()[a];if(null===b||void 0===b)throw"can't find instance method: "+a;return b.apply(null,arguments)}},h=function(){var a=g.getOrDie("Cannot reconnect the editor before it has been connected the first time.");f("connect")(a)&&l.trigger.connected()},l=a.create({connected:b([])});return d.external({activateInline:f("activateInline"),deactivateInline:f("deactivateInline"),content:f("content"),keyboard:f("keyboard"),smartview:f("smartview"),macros:f("macros"),ui:f("ui"),filter:f("filter"),undo:f("undo"),
operations:f("operations"),getMode:f("getMode"),element:f("element"),connect:function(a){g=c.some(a);h()},reconnect:h,focus:f("focus"),getContent:f("getContent"),setContent:f("setContent"),insertHtmlAtCursor:f("insertHtmlAtCursor"),state:f("state"),communication:f("communication"),uploader:f("uploader"),isDirty:f("isDirty"),setDirty:f("setDirty"),isPrettyPrinting:f("isPrettyPrinting"),events:l.registry})}});k("ll",[],function(){return"body p div article aside figcaption figure footer header nav section ol ul li table thead tbody tfoot caption tr td th h1 h2 h3 h4 h5 h6 blockquote pre address".split(" ")});
k("eq",["c","s","n"],function(c,d,b){return function(a,e){var g=function(a){try{return f(a)}catch(b){return d.none()}},f=function(b){return a(b)?d.from(b.dom().nodeValue):d.none()},h=c.detect().browser,l=h.isIE()&&10===h.version.major?g:f;return{get:function(c){if(!a(c))throw new b("Can only get "+e+" value of a "+e+" node");return l(c).getOr("")},getOption:l,set:function(c,d){if(!a(c))throw new b("Can only set raw "+e+" value of a "+e+" node");c.dom().nodeValue=d}}}});k("ak",["21","eq"],function(c,
d){var b=d(c.isText,"text");return{get:function(a){return b.get(a)},getOption:function(a){return b.getOption(a)},set:function(a,c){b.set(a,c)}}});k("dy","ll b 7 1a 1b 2n l 2o 3c 21 6h 4i 2q 4e 31 ak 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u){return function(){return{up:b.constant({selector:s.ancestor,closest:s.closest,predicate:p.ancestor,all:u.parents}),down:b.constant({selector:q.descendants,predicate:n.descendants}),styles:b.constant({get:g.get,getRaw:g.getRaw,set:g.set,remove:g.remove}),
attrs:b.constant({get:a.get,set:a.set,remove:a.remove,copyTo:function(b,c){var d=a.clone(b);a.setAll(c,d)}}),insert:b.constant({before:h.before,after:h.after,afterAll:l.after,append:h.append,appendAll:l.append,prepend:h.prepend,wrap:h.wrap}),remove:b.constant({unwrap:r.unwrap,remove:r.remove}),create:b.constant({nu:f.fromTag,clone:function(a){return f.fromDom(a.dom().cloneNode(!1))},text:f.fromText}),query:b.constant({comparePosition:function(a,b){return a.dom().compareDocumentPosition(b.dom())},
prevSibling:u.prevSibling,nextSibling:u.nextSibling}),property:b.constant({children:u.children,name:m.name,parent:u.parent,isText:m.isText,isElement:m.isElement,getText:t.get,setText:t.set,isBoundary:function(a){return m.isElement(a)?"body"===m.name(a)?!0:d.contains(c,m.name(a)):!1},isEmptyTag:function(a){return m.isElement(a)?d.contains(["br","img","hr"],m.name(a)):!1}}),eq:e.eq,is:e.is}}});k("np",["b","s","2u"],function(c,d,b){var a=b.immutable("item","mode");b=function(b,c,d,f){var g=void 0!==
f?f:e;return b.property().parent(c).map(function(b){return a(b,g)})};var e=function(b,c,d,e){var f=void 0!==e?e:g;return d.sibling(b,c).map(function(b){return a(b,f)})},g=function(b,c,d,e){var f=void 0!==e?e:g;b=b.property().children(c);return d.first(b).map(function(b){return a(b,f)})},f=[{current:b,next:e,fallback:d.none()},{current:e,next:g,fallback:d.some(b)},{current:g,next:g,fallback:d.some(e)}],h=function(a,b,e,g,r){var q=c.find(void 0!==r?r:f,function(a){return a.current===e});return void 0===
q||null===q?d.none():q.current(a,b,g,q.next).orThunk(function(){return q.fallback.bind(function(c){return h(a,b,c,g)})})};return{backtrack:b,sidestep:e,advance:g,go:h}});k("nq",["s"],function(c){return{left:function(){return{sibling:function(c,b){return c.query().prevSibling(b)},first:function(d){return 0<d.length?c.some(d[d.length-1]):c.none()}}},right:function(){return{sibling:function(c,b){return c.query().nextSibling(b)},first:function(d){return 0<d.length?c.some(d[0]):c.none()}}}}});k("no",["s",
"np","nq"],function(c,d,b){var a=function(b,g,f,h,l,m){return d.go(b,g,h,l).bind(function(d){return m(d.item())?c.none():f(d.item())?c.some(d.item()):a(b,d.item(),f,d.mode(),l,m)})};return{left:function(c,g,f,h){return a(c,g,f,d.sidestep,b.left(),h)},right:function(c,g,f,h){return a(c,g,f,d.sidestep,b.right(),h)}}});k("i7",["7","no","np","nq"],function(c,d,b,a){var e=function(a,b){return 0===a.property().children(b).length},g=function(a,b,c,e){return d.left(a,b,c,e)},f=function(a,b,c,e){return d.right(a,
b,c,e)};return{before:function(a,b,d){return g(a,b,c.curry(e,a),d)},after:function(a,b,d){return f(a,b,c.curry(e,a),d)},seekLeft:g,seekRight:f,walkers:function(){return{left:a.left,right:a.right}},walk:function(a,c,d,e,f){return b.go(a,c,d,e,f)},backtrack:b.backtrack,sidestep:b.sidestep,advance:b.advance}});k("iw",["dy","i7"],function(c,d){var b=c();return{gather:function(a,c,g){return d.gather(b,a,c,g)},before:function(a,c){return d.before(b,a,c)},after:function(a,c){return d.after(b,a,c)},seekLeft:function(a,
c,g){return d.seekLeft(b,a,c,g)},seekRight:function(a,c,g){return d.seekRight(b,a,c,g)},walkers:function(){return d.walkers()},walk:function(a,c,g,f){return d.walk(b,a,c,g,f)}}});k("f4","1a l 2o 3c 2q 2a".split(" "),function(c,d,b,a,e,g){var f=function(a){return d.fromDom(a.dom().cloneNode(!0))},h=function(a,b){var e=d.fromTag(b),f=c.clone(a);c.setAll(e,f);return e};return{shallow:function(a){return d.fromDom(a.dom().cloneNode(!1))},shallowAs:h,deep:f,copy:function(b,c){var d=h(b,c),e=g.children(f(b));
a.append(d,e);return d},mutate:function(c,d){var f=h(c,d);b.before(c,f);var p=g.children(c);a.append(f,p);e.remove(c);return f}}});k("kv","b p iw l 2o 3c 21 2q f4 4e 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){return{convertToHeading:function(b,f){var q=n.owner(b),q=a.fromTag(f,q.dom()),s=n.children(b),s=c.map(s,l.deep);g.append(q,s);s=m.descendants(q,"b,strong");c.each(s,h.unwrap);e.before(b,q);h.remove(b);return d.value(q)},joinLinks:function(a,c){return b.seekLeft(c,function(a){return"a"===
f.name(a)},a).fold(function(){return d.value(c)},function(a){var b=n.children(c);g.append(a,b);h.remove(c);return d.value(a)})}}});k("t0",["7","p"],function(c,d){return function(b){var a=c.compose(d.error,b);return{invalidError:a,different:function(b,c,f,h,l){return 0===c.length?a(h):c===f?a(l):d.value(b)}}}});k("kw",["t0","1a"],function(c,d){return function(b){var a=c(b);return{changeAlt:function(b,c,f,h){var l=d.get(b,"src");return a.different(b,c,l,f,h).map(function(a){d.set(a,"alt",c);return a})}}}});
k("j9",["7","1b"],function(c,d){return function(b,a,e,g){var f=d.eq(b,e)&&a===g;return{startContainer:c.constant(b),startOffset:c.constant(a),endContainer:c.constant(e),endOffset:c.constant(g),collapsed:c.constant(f)}}});k("qh","1o 1a 2n l 2o 21 f4 2a".split(" "),function(c,d,b,a,e,g,f,h){var l=function(a,c){return b.getRaw(a,c).getOrThunk(function(){return b.get(a,c)})},m=function(){var b=a.fromTag("td");e.append(b,a.fromTag("br"));return b},n=function(a,b,e){var g=f.copy(a,b);c.each(e,function(a,
b){null===a?d.remove(g,b):d.set(g,b,a)});return g},p=function(a){return a},r=function(b){return function(){return a.fromTag("tr",b.dom())}};return{cellOperations:function(c,d){return{row:r(d),cell:function(d){var f=h.owner(d.element()),f=a.fromTag(g.name(d.element()),f.dom());e.append(f,a.fromTag("br"));1===d.colspan()&&b.set(f,"width",l(d.element(),"width"));c(d.element(),f);return f},replace:n,gap:m}},paste:function(a){return{row:r(a),cell:m,replace:p,gap:m}}}});k("jc","b 7 2u 6d 3l 2r".split(" "),
function(c,d,b,a,e,g){var f=b.immutable("row","y"),h=b.immutable("col","x"),l=function(a){return e.absolute(a).left()+g.getOuter(a)},m=function(a){return e.absolute(a).left()},n=function(a,b){return h(a,m(b))},p=function(a,b){return h(a,l(b))},r=function(a){return e.absolute(a).top()},q=function(a,b,d){if(0===d.length)return[];var e=c.map(d.slice(1),function(b,c){return b.map(function(b){return a(c,b)})}),f=d[d.length-1].map(function(a){return b(d.length-1,a)});return e.concat([f])};b={delta:d.identity,
positions:d.curry(q,function(a,b){return f(a,r(b))},function(b,c){return f(b,r(c)+a.getOuter(c))}),edge:r};var s={delta:d.identity,edge:m,positions:d.curry(q,n,p)};d={delta:function(a,b){return-a},edge:l,positions:d.curry(q,p,n)};return{height:b,rtl:d,ltr:s}});k("j2",["jc"],function(c){return{ltr:c.ltr,rtl:c.rtl}});k("b4",["j2"],function(c){return function(d){var b=function(a){return d.directionAt(a).isRtl()?c.rtl:c.ltr};return{delta:function(a,c){return b(c).delta(a,c)},edge:function(a){return b(a).edge(a)},
positions:function(a,c){return b(c).positions(a,c)}}}});k("j3","j9 s qh b4 l 2o 2q".split(" "),function(c,d,b,a,e,g,f){return{erase:function(a,b,m,n){a=e.fromText("");g.after(b,a);f.remove(b);return d.some(c(a,0,a,0))},execute:function(d,e,f,g){return function(p,r,q){var s=g(),t=p.doc().getOrDie();p=a(d);t=b.cellOperations(f,t);return e(s,r,q,t,p).map(function(a){return c(a,0,a,0)})}}}});k("b7",["7","s","3k","l","3l"],function(c,d,b,a,e){return{only:function(e){var f=d.from(e.dom().documentElement).map(a.fromDom).getOr(e);
return{parent:c.constant(f),view:c.constant(e),origin:c.constant(b(0,0))}},detached:function(a,b){var d=c.curry(e.absolute,b);return{parent:c.constant(b),view:c.constant(a),origin:d}}}});k("az",["b7"],function(c){var d=function(b,a,d){return b.isInline()?c.detached(b.element(),a.uiContainer()):c.only(d)};return{get:d,fromEngine:function(b){var a=b.content(),c=b.smartview();return a.doc().map(function(b){return d(a,c,b)})}}});k("fq",["2u"],function(c){var d=c.immutable("width","height"),b=c.immutable("rows",
"columns"),a=c.immutable("row","column"),e=c.immutable("x","y"),g=c.immutable("element","rowspan","colspan"),f=c.immutable("element","rowspan","colspan","row","column"),h=c.immutable("before","on","after"),l=c.immutable("element","cells"),m=c.immutableBag(["startRow","startCol","finishRow","finishCol"],[]);c=c.immutableBag(["row","col"],[]);return{dimensions:d,grid:b,address:a,coords:e,extended:f,detail:g,context:h,rowdata:l,bounds:m,cell:c}});k("b8","b 7 s fq 1a 21 4e 31 2a dg".split(" "),function(c,
d,b,a,e,g,f,h,l,m){var n=function(a,d){return c.contains(a,g.name(d))?b.some(d):h.ancestor(d,a.join(","))},p=function(a,b){return l.parent(b).map(function(b){return f.children(b,a)})},r=d.curry(p,"th,td");d=d.curry(p,"tr");var q=function(a,b){return m(e.get(a,b),10)};return{cell:function(a){return n(["td","th"],a)},firstCell:function(a){return h.descendant(a,"th,td")},cells:function(a){return f.descendants(a,"th,td")},neighbourCells:r,table:function(a){return n(["table"],a)},row:function(a){return n(["tr"],
a)},rows:function(a){return f.descendants(a,"tr")},neighbourRows:d,attr:q,grid:function(b,c,d){c=q(b,c);b=q(b,d);return a.grid(c,b)}}});k("qb",["b","7","fq","b8","1a"],function(c,d,b,a,e){return{fromTable:function(g){g=a.rows(g);return c.map(g,function(f){var g=c.map(a.cells(f),function(a){var c=e.has(a,"rowspan")?parseInt(e.get(a,"rowspan"),10):1,d=e.has(a,"colspan")?parseInt(e.get(a,"colspan"),10):1;return b.detail(a,c,d)});return{element:d.constant(f),cells:d.constant(g)}})}}});k("qc",["b","7",
"s","fq","1s"],function(c,d,b,a,e){var g=function(a,b){var d=c.bind(a.all(),function(a){return a.cells()});return c.filter(d,b)};return{generate:function(b){var g={},l=[],m=0,n=0;c.each(b,function(b,d){var f=[];c.each(b.cells(),function(b,c){for(var l=0;void 0!==g[d+","+l];)l++;for(var p=a.extended(b.element(),b.rowspan(),b.colspan(),d,l),w=0;w<b.colspan();w++)for(var x=0;x<b.rowspan();x++){var y=d+x,k=l+w;g[y+","+k]=p;m=e.max(m,y+1);n=e.max(n,k+1)}f.push(p)});l.push(a.rowdata(b.element(),f))});b=
a.grid(m,n);return{grid:d.constant(b),access:d.constant(g),all:d.constant(l)}},getAt:function(a,c,d){a=a.access()[c+","+d];return void 0!==a?b.some(a):b.none()},findItem:function(a,c,d){a=g(a,function(a){return d(c,a.element())});return 0<a.length?b.some(a[0]):b.none()},filterItems:g,justCells:function(a){a=c.map(a.all(),function(a){return a.cells()});return c.flatten(a)}}});k("t2",["b","s","k","1s"],function(c,d,b,a){return{repeat:function(a,b){for(var c=[],d=0;d<a;d++)c.push(b(d));return c},range:function(a,
b){for(var c=[],d=a;d<b;d++)c.push(d);return c},unique:function(a,b){var d=[];c.each(a,function(c,l){l<a.length-1&&!b(c,a[l+1])?d.push(c):l===a.length-1&&d.push(c)});return d},deduce:function(e,g){if(0>g||g>=e.length-1)return d.none();var f=e[g].fold(function(){var a=c.reverse(e.slice(0,g));return b.findMap(a,function(a,b){return a.map(function(a){return{value:a,delta:b+1}})})},function(a){return d.some({value:a,delta:0})}),h=e[g+1].fold(function(){var a=e.slice(g+1);return b.findMap(a,function(a,
b){return a.map(function(a){return{value:a,delta:b+1}})})},function(a){return d.some({value:a,delta:1})});return f.bind(function(b){return h.map(function(c){var d=c.delta+b.delta;return a.abs(c.value-b.value)/d})})}}});k("t1",["b","7","s","qc","t2"],function(c,d,b,a,e){var g=function(a,d,e){var g=a();a=c.find(g,d);return b.from(a).orThunk(function(){return b.from(g[0]).orThunk(e)}).map(function(a){return a.element()})};return{columns:function(b){var h=b.grid(),l=e.range(0,h.columns()),m=e.range(0,
h.rows());return c.map(l,function(e){return g(function(){return c.bind(m,function(c){return a.getAt(b,c,e).filter(function(a){return a.column()===e}).fold(d.constant([]),function(a){return[a]})})},function(a){return 1===a.colspan()},function(){return a.getAt(b,0,e)})})},rows:function(b){var h=b.grid(),l=e.range(0,h.rows()),m=e.range(0,h.columns());return c.map(l,function(e){return g(function(){return c.bind(m,function(c){return a.getAt(b,e,c).filter(function(a){return a.row()===e}).fold(d.constant([]),
function(a){return[a]})})},function(a){return 1===a.rowspan()},function(){return a.getAt(b,e,0)})})}}});k("qu","b8 1a 2n 6d 21 2r v 1s dg".split(" "),function(c,d,b,a,e,g,f,h,l){var m=function(a,c){b.set(a,"width",c+"px")},n=function(a,c){b.set(a,"height",c+"px")},p=function(a,c){return b.getRaw(a,c).getOrThunk(function(){return b.get(a,c)})},r=function(a,b,d){var e=c.table(a).map(function(a){a=g.get(a);return h.floor(b/100*a)}).getOr(b);d(a,e);return e},q=function(a,b,c){var d=l(a,10);return f.endsWith(a,
"%")&&"table"!==e.name(b)?r(b,d,c):d},s=function(a){var b=p(a,"width");return b?q(b,a,m):g.get(a)},t=function(b){var c=p(b,"height");return c?q(c,b,n):a.get(b)},u=function(a,b,c){c=c(a);a=d.has(a,b)?l(d.get(a,b),10):1;return c/a};return{setWidth:m,setHeight:n,getWidth:function(a){return u(a,"colspan",s)},getHeight:function(a){return u(a,"rowspan",t)}}});k("qv",["7","1a","2n","dg"],function(c,d,b,a){var e=function(b,c){return d.has(b,c)&&1<a(d.get(b,c),10)};return{hasColspan:function(a){return e(a,
"cellspan")},hasRowspan:function(a){return e(a,"rowspan")},minWidth:c.constant(10),minHeight:c.constant(10),getInt:function(c,d){return a(b.get(c,d),10)}}});k("qs","b 7 t1 qu qv t2 2n".split(" "),function(c,d,b,a,e,g,f){var h=function(a,b,c){return f.getRaw(a,b).fold(function(){return c(a)+"px"},function(a){return a})},l=function(b){return h(b,"width",a.getWidth)},m=function(b){return h(b,"height",a.getHeight)},n=function(b){return a.getWidth(b)},p=function(a,f,h,l){a=b.columns(a);var m=c.map(a,function(a){return a.map(f.edge)});
return c.map(a,function(a,b){return a.filter(d.not(e.hasColspan)).fold(function(){var a=g.deduce(m,b);return l(a)},function(a){return h(a)})})},r=function(a){return a.map(function(a){return a+"px"}).getOr("")},q=function(b){return a.getHeight(b)},s=function(a,f,h,l){a=b.rows(a);var m=c.map(a,function(a){return a.map(f.edge)});return c.map(a,function(a,b){return a.filter(d.not(e.hasRowspan)).fold(function(){var a=g.deduce(m,b);return l(a)},function(a){return h(a)})})};return{getRawWidths:function(a,
b){return p(a,b,l,r)},getPixelWidths:function(a,b){return p(a,b,n,function(a){return a.getOrThunk(e.minWidth)})},getPixelHeights:function(a,b){return s(a,b,q,function(a){return a.getOrThunk(e.minHeight)})},getRawHeights:function(a,b){return s(a,b,m,r)}}});k("rh","b 7 4n t2 v 1s 1v dg".split(" "),function(c,d,b,a,e,g,f,h){var l=b.generate([{invalid:["raw"]},{pixels:["value"]},{percent:["value"]}]),m=function(a,b,c){a=c.substring(0,c.length-a.length);var d=f(a);return a===d.toString()?b(d):l.invalid(c)},
n=function(a){return e.endsWith(a,"%")?m("%",l.percent,a):e.endsWith(a,"px")?m("px",l.pixels,a):l.invalid(a)},p=function(a,b){return c.map(a,function(a){return n(a).fold(function(){return a},function(a){return a/b*100+"%"},function(a){return a+"%"})})},r=function(a,b,d){var e=d/b;return c.map(a,function(a){return n(a).fold(function(){return a},function(a){return a*e+"px"},function(a){return a/100*d+"px"})})},q=function(b,c){var e=b.fold(function(){return d.constant("")},function(a){return d.constant(a/
c+"px")},function(a){return d.constant(a/c+"px")});return a.repeat(c,e)},s=function(a,b,c){return a.fold(function(){return b},function(a){return r(b,c,a)},function(a){return p(b,c)})},t=function(a,b){var c=g.floor(a);return{value:c+b,remainder:a-c}},u=function(a,b){return n(a).fold(d.constant(a),function(a){return a+b+"px"},function(a){return a+b+"%"})},v=function(a){if(0===a.length)return a;a=c.foldr(a,function(a,b){var c=n(b).fold(function(){return{value:b,remainder:0}},function(a){return t(a,"px")},
function(a){return t(a,"%")});return{output:[c.value].concat(a.output),remainder:a.remainder+c.remainder}},{output:[],remainder:0});var b=a.output;return b.slice(0,b.length-1).concat([u(b[b.length-1],g.round(a.remainder))])};return{validate:n,redistribute:function(a,b,d){d=n(d);a=c.forall(a,function(a){return"0px"===a})?q(d,a.length):s(d,a,b);return v(a)},sum:function(a,b){return 0===a.length?b:c.foldr(a,function(a,b){return n(b).fold(d.constant(0),d.identity,d.identity)+a},0)},toIntegers:v}});k("j7",
"b 7 qb qc jc qs rh qu qv 2n 6d 2r".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p){var r=function(a,b,d){c.each(b,function(b){var c=a.slice(b.column(),b.colspan()+b.column()),c=f.sum(c,l.minWidth());m.set(b.element(),"width",c+d)})},q=function(a,b,d,e){c.each(d,function(b){var c=a.slice(b.row(),b.rowspan()+b.row()),c=f.sum(c,l.minHeight());m.set(b.element(),"height",c+e)});c.each(b,function(b,c){m.set(b.element(),"height",a[c])})},s=function(a){return f.validate(a).fold(d.constant("px"),d.constant("px"),
d.constant("%"))};return{setWidth:h.setWidth,getWidth:h.getWidth,setHeight:h.setHeight,getHeight:h.getHeight,redistribute:function(c,d,h,l){var x=b.fromTable(c),k=a.generate(x),B=k.all(),z=a.justCells(k);d.each(function(a){var b=s(a),d=p.get(c),e=g.getRawWidths(k,l),d=f.redistribute(e,d,a);r(d,z,b);m.set(c,"width",a)});h.each(function(a){var b=s(a),d=n.get(c),h=g.getRawHeights(k,e.height),d=f.redistribute(h,d,a);q(d,B,z,b);m.set(c,"height",a)})}}});k("qj","b 7 s 4m 52 1a 2n dg".split(" "),function(c,
d,b,a,e,g,f,h){var l=function(a){var b=g.has(a,"colspan")?h(g.get(a,"colspan"),10):1,c=g.has(a,"rowspan")?h(g.get(a,"rowspan"),10):1;return{element:d.constant(a),colspan:d.constant(b),rowspan:d.constant(c)}},m=e.exactly(["cell","row","replace","gap"]);return{modification:function(c,d){m(c);var e=a(b.none()),f=void 0!==d?d:l,g=function(a){var d;d=f(a);d=c.cell(d);e.get().isNone()&&e.set(b.some(d));h=b.some({item:a,replacement:d});return d},h=b.none();return{getOrInit:function(a,b){return h.fold(function(){return g(a)},
function(c){return b(a,c.item)?c.replacement:g(a)})},cursor:e.get}},transform:function(d,e){return function(f){var g=a(b.none());m(f);var h=[],l=function(a,d){var e=c.find(h,function(b){return d(b.item,a)});return b.from(e)},u=function(a){var c=f.replace(a,e,{scope:d});h.push({item:a,sub:c});g.get().isNone()&&g.set(b.some(c));return c};return{replaceOrInit:function(a,b){return l(a,b).fold(function(){return u(a)},function(c){return b(a,c.item)?c.sub:u(a)})},cursor:g.get}}},merging:function(c){m(c);
var e=a(b.none());return{combine:function(a){e.get().isNone()&&e.set(b.some(a));return function(){var b=c.cell({element:d.constant(a),colspan:d.constant(1),rowspan:d.constant(1)});f.remove(b,"width");f.remove(a,"width");return b}},cursor:e.get}}}});k("dj","b s 21 4i ak 2a".split(" "),function(c,d,b,a,e,g){var f=["img","br"],h=function(a){return b.isText(a)&&e.get(a).length||c.contains(f,b.name(a))},l=function(a,b){var c=function(a){a=g.children(a);for(var e=a.length-1;0<=e;e--){var f=a[e];if(b(f))return d.some(f);
f=c(f);if(f.isSome())return f}return d.none()};return c(a)};return{firstCursor:function(b){return a.descendant(b,h)},lastCursor:function(a){return l(a,h)}}});k("ln",["b"],function(c){var d="body p div article aside figcaption figure footer header nav section ol ul table thead tfoot tbody caption tr td th h1 h2 h3 h4 h5 h6 blockquote pre address".split(" "),b=function(a,b){var f=a.property().name(b);return c.contains(d,f)},a=function(a,b){return c.contains(["br","img","hr","input"],a.property().name(b))};
return{isBlock:b,isList:function(a,b){var d=a.property().name(b);return c.contains(["ol","ul"],d)},isFormatting:function(a,b){var d=a.property().name(b);return c.contains("address pre p h1 h2 h3 h4 h5 h6".split(" "),d)},isContainer:function(a,b){return c.contains("div li td th blockquote body caption".split(" "),a.property().name(b))},isEmptyTag:a,isFrame:function(a,b){return"iframe"===a.property().name(b)},isInline:function(c,d){return!(b(c,d)||a(c,d))&&"li"!==c.property().name(d)}}});k("ep",["dy",
"ln"],function(c,d){var b=c();return{isBlock:function(a){return d.isBlock(b,a)},isList:function(a){return d.isList(b,a)},isFormatting:function(a){return d.isFormatting(b,a)},isContainer:function(a){return d.isContainer(b,a)},isEmptyTag:function(a){return d.isEmptyTag(b,a)},isFrame:function(a){return d.isFrame(b,a)},isInline:function(a){return d.isInline(b,a)}}});k("qk","b dj ep 1b l 3c 21 4i 2q 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m){return{merge:function(n){var p=function(a){return m.nextSibling(a).each(function(a){if(b.isBlock(a))return!0;
if(b.isEmptyTag(a))return"img"===f.name(a)?!1:!0}).getOr(!1)},r=function(c){return d.lastCursor(c).bind(function(d){var g=p(d);return m.parent(d).map(function(l){var m;(m=!0===g)||(m="li"===f.name(l)||h.ancestor(l,b.isList).isSome()||"br"===f.name(d)||b.isBlock(l)&&!a.eq(c,l));return m?[]:[e.fromTag("br")]})}).getOr([])},q=function(){return c.bind(n,function(a){var b=m.children(a);return 1<b.length||1==b.length&&"br"!==f.name(b[0])?b.concat(r(a)):[]})}();l.empty(n[0]);g.append(n[0],q)}}});k("t3",
["b","7"],function(c,d){var b=function(a,b){return c.map(a,function(a){return a[b]})},a=function(a,b){if(0===a.length)return 0;var d=a[0],h=c.findIndex(a,function(a){return!b(d,a)});return-1===h?a.length:h};return{subgrid:function(c,g,f,h){var l=c[g].slice(f),l=a(l,h);c=b(c,f).slice(g);h=a(c,h);return{colspan:d.constant(l),rowspan:d.constant(h)}}}});k("qn",["b","fq","t3","qc"],function(c,d,b,a){return{toDetails:function(a,g){var f=c.map(a,function(a,b){return c.map(a,function(a,b){return!1})});return c.map(a,
function(h,l){return c.bind(h,function(c,h){if(!1===f[l][h]){for(var p=b.subgrid(a,l,h,g),r=p.rowspan(),q=p.colspan(),s=l;s<l+r;s++)for(var t=h;t<h+q;t++)f[s][t]=!0;return[d.detail(c,p.rowspan(),p.colspan())]}return[]})})},toGrid:function(b,c){for(var d=[],h=0;h<b.grid().rows();h++){for(var l=[],m=0;m<b.grid().columns();m++){var n=a.getAt(b,h,m).map(function(a){return a.element()}).getOrThunk(c.gap);l.push(n)}d.push(l)}return d}}});k("t4","b 1a l 2o 3c 2q 31 2a".split(" "),function(c,d,b,a,e,g,f,
h){return{render:function(l,m){var n=f.child(l,"tbody").getOrThunk(function(){var c=b.fromTag("tbody",h.owner(l).dom());a.append(l,c);return c});g.empty(n);var p=c.map(m,function(b){var e=b.element();g.empty(e);c.each(b.cells(),function(b){var c=b.element(),f=b.colspan();1===f?d.remove(c,"colspan"):d.set(c,"colspan",f);c=b.element();f=b.rowspan();1===f?d.remove(c,"rowspan"):d.set(c,"rowspan",f);a.append(e,b.element())});return e});e.append(n,p)}}});k("t5",["1a","2n","l"],function(c,d,b){return{col:function(a,
e,g,f,h){var l=b.fromTag("div");d.setAll(l,{position:"absolute",left:e-f/2+"px",top:g+"px",height:h+"px",width:f+"px"});c.set(l,"data-column",a);return l},row:function(a,e,g,f,h){var l=b.fromTag("div");d.setAll(l,{position:"absolute",left:e+"px",top:g-h/2+"px",height:h+"px",width:f+"px"});c.set(l,"data-row",a);return l}}});k("rk",["4g"],function(c){return{resolve:c.create("ephox-snooker").resolve}});k("rj","b t1 qb qc t5 rk 1y 2n 6d 2o 3l 2q 4e 2r".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q){var s=
g.resolve("resizer-bar"),t=g.resolve("resizer-rows"),u=g.resolve("resizer-cols"),v=function(a){a=r.descendants(a.parent(),"."+s);c.each(a,p.remove)},w=function(a,b,d){var e=a.origin();c.each(b,function(b,c){b.each(function(b){b=d(e,b);f.add(b,s);m.append(a.parent(),b)})})},x=function(a,b,c,d){w(a,b,function(a,b){var g=e.col(b.col(),b.x()-a.left(),c.top()-a.top(),7,d);f.add(g,u);return g})},k=function(a,b,c,d){w(a,b,function(a,b){var g=e.row(b.row(),c.left()-a.left(),b.y()-a.top(),d,7);f.add(g,t);
return g})},B=function(a,b){var d=r.descendants(a.parent(),"."+s);c.each(d,b)};return{refresh:function(c,e,f,g){v(c,e);var h=b.fromTable(e),h=a.generate(h),m=d.rows(h),p=d.columns(h),h=n.absolute(e);f=0<m.length?f.positions(m,e):[];k(c,f,h,q.getOuter(e));g=0<p.length?g.positions(p,e):[];x(c,g,h,l.getOuter(e))},hide:function(a){B(a,function(a){h.set(a,"display","none")})},show:function(a){B(a,function(a){h.set(a,"display","block")})},destroy:v,isRowBar:function(a){return f.has(a,t)},isColBar:function(a){return f.has(a,
u)}}});k("ql","b 6 7 s k b8 qb qn qc t4 jc rj 1b 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q){var s=function(a,d){var f=function(a){return e.findMap(a,function(a){return q.parent(a.element())}).getOrThunk(function(){return d.row()})};return c.map(a,function(a){var c=f(a);return{element:b.constant(c),cells:b.constant(a)}})},t=function(b,d){var e=c.flatten(c.map(b.all(),function(a){return a.cells()})),e=c.find(e,function(a){return r.eq(d,a.element())});return a.from(e)};return{run:function(c,
d,e,g,q){return function(t,k,A,C,D){var F=f.fromTable(k),E=l.generate(F);return d(E,A).map(function(a){var d=h.toGrid(E,C);a=c(d,a,r.eq,q(C));d=a.grid();d=h.toDetails(d,r.eq);d=s(d,C);return{grid:b.constant(d),cursor:a.cursor}}).fold(function(){return a.none()},function(a){m.render(k,a.grid());e(a.grid(),D);g(k);p.refresh(t,k,n.height,D);return a.cursor()})}},onCell:function(a,b){return g.cell(b.element()).bind(function(b){return t(a,b)})},onPaste:function(a,b){return g.cell(b.element()).bind(function(c){return t(a,
c).map(function(a){return d.merge(a,{generators:b.generators,clipboard:b.clipboard})})})},onMergable:function(a,b){return b.mergable()},onUnmergable:function(a,b){return b.unmergable()}}});k("t6","b 7 p t2 9 n 1s".split(" "),function(c,d,b,a,e,g,f){var h=function(a,b){return c.map(a,b.cell)},l=function(b,c,d){return b.concat(a.repeat(c,function(a){return h(b[0],d)}))},m=function(b,d,e){return c.map(b,function(b){return b.concat(h(a.range(0,d),e))})};return{measure:function(a,c,e){if(a.row()>=c.length||
a.column()>c[0].length)return b.error("invalid start address out of table bounds, row: "+a.row()+", column: "+a.column());c=c.slice(a.row());a=c[0].slice(a.column());var f=e[0].length;return b.value({rowDelta:d.constant(c.length-e.length),colDelta:d.constant(a.length-f)})},tailor:function(a,b,c,e){var g=0>c.colDelta()?m:d.identity;a=0>c.rowDelta()?l:d.identity;b=g(b,f.abs(c.colDelta()),e);return a(b,f.abs(c.rowDelta()),e)}}});k("qo",[],function(){return{merge:function(c,d,b,a){if(0===c.length)return c;
for(b=d.startRow();b<=d.finishRow();b++)for(var e=d.startCol();e<=d.finishCol();e++)c[b][e]=a();return c},unmerge:function(c,d,b,a){for(var e=!0,g=0;g<c.length;g++)for(var f=0;f<c[0].length;f++){var h=b(c[g][f],d);!0===h&&!1===e?c[g][f]=a():!0===h&&(e=!1)}return c}}});k("qm",["7","t6","qo"],function(c,d,b){return{merge:function(a,e,g,f,h){return d.measure(a,e,g).map(function(l){l=d.tailor(a,e,l,f);for(var m=a.row(),n=a.column(),p=m+g.length,r=n+g[0].length,q=m;q<p;q++)for(var s=n;s<r;s++){var t=l,
u=q,v=s,w=c.curry(h,t[u][v]),x=t[u];1<t.length&&1<x.length&&(0<v&&w(x[v-1])||v<x.length-1&&w(x[v+1])||0<u&&w(t[u-1][v])||u<t.length-1&&w(t[u+1][v]))&&b.unmerge(l,l[q][s],h,f.cell);l[q][s]=f.replace(g[q-m][s-n])}return l})}}});k("qp",["b"],function(c){return{insertRowAt:function(d,b,a,e,g){var f=d.slice(0,b),h=d.slice(b);a=c.map(d[a],function(a,c){return 0<b&&b<d.length&&e(d[b-1][c],d[b][c])?d[b][c]:g(a,e)});return f.concat([a]).concat(h)},insertColumnAt:function(d,b,a,e,g){return c.map(d,function(c){var d=
0<b&&b<c.length&&e(c[b-1],c[b])?c[b]:g(c[a],e);return c.slice(0,b).concat([d]).concat(c.slice(b))})},deleteRowAt:function(c,b){return c.slice(0,b).concat(c.slice(b+1))},deleteColumnAt:function(d,b){return c.map(d,function(a){return a.slice(0,b).concat(a.slice(b+1))})}}});k("qq",["b","7"],function(c,d){var b=function(a,b,g,f){return c.map(a,function(a){return c.map(a,function(a){return c.exists(b,d.curry(g,a))?f(a,g):a})})};return{replaceColumn:function(a,d,g,f){var h=c.bind(a,function(b,c){return void 0!==
a[c][d]&&0<c&&g(a[c-1][d],a[c][d])||0<d&&g(b[d-1],b[d])?[]:[b[d]]});return b(a,h,g,f)},replaceRow:function(a,d,g,f){var h=a[d],l=c.bind(h,function(b,c){return void 0!==a[d][c]&&0<d&&g(a[d-1][c],a[d][c])||0<c&&g(h[c-1],h[c])?[]:[b]});return b(a,l,g,f)}}});k("t7",[],function(){var c=function(c){return{fold:c}};return{none:function(){return c(function(c,b,a,e,g){return c()})},only:function(d){return c(function(b,a,c,g,f){return a(d)})},left:function(d,b){return c(function(a,c,g,f,h){return g(d,b)})},
middle:function(d,b,a){return c(function(c,g,f,h,l){return h(d,b,a)})},right:function(d,b){return c(function(a,c,g,f,h){return h(d,b)})}}});k("qr",["b","7","t7","1s"],function(c,d,b,a){var e=function(a,c){return 0===a.length?b.none():1===a.length?b.only(0):0===c?b.left(0,1):c===a.length-1?b.right(c-1,c):0<c&&c<a.length-1?b.middle(c-1,c,c+1):b.none()};return{determine:function(b,f,h,l){var m=b.slice(0);b=e(b,f);var n=function(a){return c.map(a,d.constant(0))};f=d.constant(n(m));var p=function(b,c){if(0<=
h){var d=a.max(l,m[c]-h);return n(m.slice(0,b)).concat([h,d-m[c]]).concat(n(m.slice(c+1)))}var d=a.max(l,m[b]+h),e=m[b]-d;return n(m.slice(0,b)).concat([d-m[b],e]).concat(n(m.slice(c+1)))};return b.fold(f,function(b){return[a.max(l,m[b]+h)-m[b]]},p,function(a,b,c){return p(b,c)},function(b,c){if(0<=h)return n(m.slice(0,c)).concat([h]);var d=a.max(l,m[c]+h);return n(m.slice(0,c)).concat([d-m[c]])})}}});k("qt",["b","7","qc","dg"],function(c,d,b,a){var e=function(b,c,d){for(var e=0;b<c;b++)e+=void 0!==
d[b]?a(d[b],10):0;return e};return{recalculateWidth:function(a,f){var h=b.justCells(a);return c.map(h,function(a){var b=e(a.column(),a.column()+a.colspan(),f);return{element:a.element,width:d.constant(b),colspan:a.colspan}})},recalculateHeight:function(a,f){var h=b.justCells(a);return c.map(h,function(a){var b=e(a.row(),a.row()+a.rowspan(),f);return{element:a.element,height:d.constant(b),rowspan:a.rowspan}})},matchRowHeight:function(a,b){return c.map(a.all(),function(a,c){return{element:a.element,
height:d.constant(b[c])}})}}});k("ja","b qr qb qc qs qt qu qv 31 1s".split(" "),function(c,d,b,a,e,g,f,h,l,m){var n=function(a){return c.foldr(a,function(a,b){return a+b},0)},p=function(c){c=b.fromTable(c);return a.generate(c)};return{adjustWidth:function(a,b,l,m){var u=p(a),v=e.getPixelWidths(u,m);b=d.determine(v,l,b,h.minWidth());b=c.map(b,function(a,b){return a+v[b]});u=g.recalculateWidth(u,b);c.each(u,function(a){f.setWidth(a.element(),a.width())});u=n(b);f.setWidth(a,u)},adjustHeight:function(a,
b,d,l){var u=p(a);l=e.getPixelHeights(u,l);l=c.map(l,function(a,c){return d===c?m.max(b+a,h.minHeight()):a});var v=g.recalculateHeight(u,l),u=g.matchRowHeight(u,l);c.each(u,function(a){f.setHeight(a.element(),a.height())});c.each(v,function(a){f.setHeight(a.element(),a.height())});u=n(l);f.setHeight(a,u)},adjustWidthTo:function(b,d){var h=a.generate(b),m=e.getPixelWidths(h,d),h=g.recalculateWidth(h,m);c.each(h,function(a){f.setWidth(a.element(),a.width())});var n=c.foldr(m,function(a,b){return b+
a},0);0<h.length&&l.ancestor(h[0].element(),"table").each(function(a){f.setWidth(a,n)})}}});k("j8","b 7 s 2u qj fq qk b8 qb ql qm qn qc qo qp qq ja 2q dg".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,v,w){w=function(a){0===h.cells(a).length&&v.remove(a)};var x=a.immutable("grid","cursor"),k=function(a,b,c){return B(a,b,c).orThunk(function(){return B(a,0,0)})},B=function(a,c,d){return b.from(a[c]).bind(function(a){return b.from(a[d])})},z=function(a,b,c){return x(a,B(a,b,c))};a=u.adjustWidthTo;
return{insertRowBefore:m.run(function(a,b,c,d){var e=b.row(),f=b.row();a=s.insertRowAt(a,f,e,c,d.getOrInit);return z(a,f,b.column())},m.onCell,d.noop,d.noop,e.modification),insertRowAfter:m.run(function(a,b,c,d){var e=b.row(),f=b.row()+b.rowspan();a=s.insertRowAt(a,f,e,c,d.getOrInit);return z(a,f,b.column())},m.onCell,d.noop,d.noop,e.modification),insertColumnBefore:m.run(function(a,b,c,d){var e=b.column(),f=b.column();a=s.insertColumnAt(a,f,e,c,d.getOrInit);return z(a,b.row(),f)},m.onCell,a,d.noop,
e.modification),insertColumnAfter:m.run(function(a,b,c,d){var e=b.column(),f=b.column()+b.colspan();a=s.insertColumnAt(a,f,e,c,d.getOrInit);return z(a,b.row(),f)},m.onCell,a,d.noop,e.modification),eraseColumn:m.run(function(a,b,c,d){a=s.deleteColumnAt(a,b.column());b=k(a,b.row(),b.column());return x(a,b)},m.onCell,a,w,e.modification),eraseRow:m.run(function(a,b,c,d){a=s.deleteRowAt(a,b.row());b=k(a,b.row(),b.column());return x(a,b)},m.onCell,d.noop,w,e.modification),makeColumnHeader:m.run(function(a,
b,c,d){a=t.replaceColumn(a,b.column(),c,d.replaceOrInit);return z(a,b.row(),b.column())},m.onCell,d.noop,d.noop,e.transform("row","th")),unmakeColumnHeader:m.run(function(a,b,c,d){a=t.replaceColumn(a,b.column(),c,d.replaceOrInit);return z(a,b.row(),b.column())},m.onCell,d.noop,d.noop,e.transform(null,"td")),makeRowHeader:m.run(function(a,b,c,d){a=t.replaceRow(a,b.row(),c,d.replaceOrInit);return z(a,b.row(),b.column())},m.onCell,d.noop,d.noop,e.transform("col","th")),unmakeRowHeader:m.run(function(a,
b,c,d){a=t.replaceRow(a,b.row(),c,d.replaceOrInit);return z(a,b.row(),b.column())},m.onCell,d.noop,d.noop,e.transform(null,"td")),mergeCells:m.run(function(a,c,e,g){g=c.cells();f.merge(g);a=q.merge(a,c.bounds(),e,d.constant(g[0]));return x(a,b.from(g[0]))},m.onMergable,d.noop,d.noop,e.merging),unmergeCells:m.run(function(a,d,e,f){a=c.foldr(d,function(a,b){return q.unmerge(a,b,e,f.combine(b))},a);return x(a,b.from(d[0]))},m.onUnmergable,a,d.noop,e.merging),pasteCells:m.run(function(a,c,d,e){e=function(a,
b){var c=l.fromTable(a),c=r.generate(c);return p.toGrid(c,b)}(c.clipboard(),c.generators());var f=g.address(c.row(),c.column());return n.merge(f,a,e,c.generators(),d).fold(function(){return x(a,b.some(c.element()))},function(a){var b=k(a,c.row(),c.column());return x(a,b)})},m.onPaste,a,d.noop,e.modification)}});k("2f","l 48 2o 3c 2q 2a".split(" "),function(c,d,b,a,e,g){var f=function(a){return a.dom().innerHTML};return{get:f,set:function(f,l){var m=g.owner(f).dom(),n=c.fromDom(m.createDocumentFragment()),
m=d.fromHtml(l,m);a.append(n,m);e.empty(f);b.append(f,n)},getOuter:function(a){var d=c.fromTag("div");a=c.fromDom(a.dom().cloneNode(!0));b.append(d,a);return f(d)}}});k("rg","b 7 p j3 az j2 j7 j8 1a l 2f 2o 2q 31".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q){var s=function(a){return function(d,e){return c.foldl(a,function(a,b){return a.bind(function(a){return w(e,function(a){return v(b,d,e,a)})})},b.value(e))}},t=s([h.makeRowHeader,h.makeColumnHeader]),u=s([h.makeRowHeader]);h=s([h.makeColumnHeader]);
var v=function(b,c,f,g){return e.fromEngine(c).bind(function(e){e=d.constant(e);var h=d.noop;return a.execute(c.region(),b,h,e)(c.content(),f,{element:d.constant(g)})})},w=function(a,c){return q.descendant(a,"td,th").bind(function(a){return c(a)}).fold(function(){return b.error("Could not run the operation on table")},function(c){return b.value(a)})};return{setCaption:function(a,b){var c=q.child(a,"caption").fold(function(){return m.fromTag("caption")},function(a){r.empty(a);return a});n.set(c,b);
p.prepend(a,c)},setSummary:function(a,b){l.set(a,"summary",b)},setDimensions:function(a,b){f.redistribute(a,b.width(),b.height(),"rtl"===l.get(a,"dir")?g.rtl:g.ltr)},addBothHeaders:t,addRowHeader:u,addColumnHeader:h}});k("kx","7 p t0 rg 1a 2f 31".split(" "),function(c,d,b,a,e,g,f){return function(h){var l=b(h);return{changeCaption:function(b,c,d,f){var g=e.get(b,"summary");return l.different(b,c,g,d,f).map(function(b){a.setCaption(b,c);return b})},changeSummary:function(b,c,d,e){var h=f.descendant(b,
"caption").map(g.get).getOr("");return l.different(b,c,h,d,e).map(function(b){a.setSummary(b,c);return b})},setHeaders:function(b,d,e,f){return(!0===e&&!0===f?a.addBothHeaders:!0===e?a.addRowHeader:!0===f?a.addColumnHeader:c.constant(l.invalidError("a11y.t4b.repair.errors.none")))(b,d)},setScope:function(a,b){e.set(a,"scope",b);return d.value(a)}}}});k("ky",["4n","2u"],function(c,d){var b=c.generate([{field:["name","textkey","f"]},{select:["name","textkey","values"]},{toggles:["name","textkey","options"]}]),
a=d.immutable("value","text"),e=d.immutable("value","icon","textkey");return{field:b.field,select:b.select,toggles:b.toggles,pair:a,toggle:e,cata:function(a,b,c,d){return a.fold(b,c,d)}}});k("c8","b 7 s p kv kw kx 2u 1a l ky".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){return function(p){var r=h.immutableBag("id description prompts element severity url repair".split(" "),[]),q=h.immutableBag(["ui","repair"],[]),s=g(p),t=f(p),u={I1:b.some(q({ui:[n.field("image-alt","a11y.i1.repair.info",d.constant(""))],
repair:function(a,b,c){return s.changeAlt(b.element(),c["image-alt"](),"a11y.i1.repair.errors.empty","a11y.i1.repair.errors.duplicate")}})),I2:b.some(q({ui:[n.field("image-alt","a11y.i2.repair.info",function(a){return l.get(a.element(),"alt")})],repair:function(a,b,c){return s.changeAlt(b.element(),c["image-alt"](),"a11y.i2.repair.errors.empty","a11y.i2.repair.errors.duplicate")}})),T1:b.some(q({ui:[n.field("table-caption","a11y.t1.repair.info",d.constant(""))],repair:function(a,b,c){return t.changeCaption(b.element(),
c["table-caption"](),"a11y.t1.repair.errors.empty","a11y.t1.repair.errors.duplicate")}})),T2:b.some(q({ui:[n.field("table-summary","a11y.t2.repair.info",d.constant(""))],repair:function(a,b,c){return t.changeSummary(b.element(),c["table-summary"](),"a11y.t2.repair.errors.empty","a11y.t2.repair.errors.duplicate")}})),T3:b.some(q({ui:[n.field("table-caption","a11y.t3.repair.info",function(a){return l.get(a.element(),"summary")})],repair:function(a,b,c){return t.changeCaption(b.element(),c["table-caption"](),
"a11y.t3.repair.errors.empty","a11y.t3.repair.errors.duplicate")}})),T4A:b.none(),T4B:b.some(q({ui:[n.toggles("table-headers","a11y.t4b.repair.info",[n.toggle("row-header","ephox-polish-row-header","a11y.t4b.repair.row"),n.toggle("col-header","ephox-polish-column-header","a11y.t4b.repair.column")])],repair:function(a,b,c){var d=c["row-header"]();c=c["col-header"]();return t.setHeaders(a,b.element(),d,c)}})),T4C:b.some(q({ui:[n.select("scope-type","a11y.t4c.repair.info",[n.pair("row","a11y.t4c.repair.scope.row"),
n.pair("col","a11y.t4c.repair.scope.col"),n.pair("rowgroup","a11y.t4c.repair.scope.rowgroup"),n.pair("colgroup","a11y.t4c.repair.scope.colgroup")])],repair:function(a,b,c){return t.setScope(b.element(),c["scope-type"]())}})),D1:b.some(q({ui:[n.select("heading-type","a11y.d1.repair.info",[n.pair("h1","a11y.d1.repair.block.h1"),n.pair("h2","a11y.d1.repair.block.h2"),n.pair("h3","a11y.d1.repair.block.h3"),n.pair("h4","a11y.d1.repair.block.h4"),n.pair("h5","a11y.d1.repair.block.h5"),n.pair("h6","a11y.d1.repair.block.h6")])],
repair:function(a,b,c){return e.convertToHeading(b.element(),c["heading-type"]())}})),D2:b.none(),D3:b.some(q({ui:[],repair:function(a,b,c){return e.joinLinks(a.content().isRoot,b.element())}})),D4:b.none(),D5:b.none(),O1:b.none(),O2:b.none()};return{convert:function(d,e){var f=function(a){var b=a.repair();return function(a,c){return d.undo().transaction(function(){return b(d,a,c)})}};return c.map(e,function(c){var d=c.rule(),e=d.id().toUpperCase(),g=void 0!==u[e]?u[e]:b.none(),h=d.desckey();return r({id:e,
description:h,prompts:g.map(function(a){return a.ui()}),element:m.fromDom(c.element()),url:d.url(),severity:d.severity(),repair:g.map(f).getOr(function(){return a.error("no repair")})})})}}}});k("c9","b s 1a 4h 1y 4b 4e o".split(" "),function(c,d,b,a,e,g,f,h){var l=function(e,f){c.each(e,function(b){f.get(b.severity()).fold(function(){h.warn("unknown severity for accessibility rule: ",b.id(),b.severity())},function(c){g.add(b.element(),[f.violation(),c.style()]);a.add(b.element(),c.attribute(),b.id())})});
d.from(e[0]).each(function(a){var c=a.element(),d=f.currentAttr();a=a.severity();b.set(c,d,a)})},m=function(a,d,e,g){a=f.descendants(a,"["+d+"]");c.each(a,function(a){b.remove(a,d)});b.set(e,d,g)},n=function(a,d){var g=f.descendants(a,"."+d.violation());c.each(g,function(a){e.remove(a,d.violation());b.remove(a,d.currentAttr());c.each(d.all(),function(c){e.remove(a,c.style());b.remove(a,c.attribute())})})},p=function(b,d,f){var g=function(c){return 0===a.read(b,c.attribute()).length};d.get(f).each(function(a){g(a)&&
e.remove(b,a.style())});c.forall(d.all(),g)&&e.remove(b,d.violation())},r=function(c,d,e,f){d.get(f).each(function(f){a.remove(c,f.attribute(),e);a.add(c,d.ignoreAttr(),e);f=d.currentAttr();b.remove(c,f)})},q=function(c,d,e,f){d.get(f).each(function(f){a.remove(c,f.attribute(),e);f=d.currentAttr();b.remove(c,f)})};return{manager:function(a){var b=a.content();return{start:function(b){l(b,a)},moveTo:function(c,d){b.body().each(function(b){m(b,a.currentAttr(),c,d)})},stop:function(){b.body().each(function(b){n(b,
a)})},ignore:function(b,c,d){r(b,a,c,d);p(b,a,d)},solve:function(b,c,d){q(b,a,c,d);p(b,a,d)}}}}});k("ca","b 1a 1y 3c 2q 2a".split(" "),function(c,d,b,a,e,g){var f=function(a){return function(b){c.each(b,a)}},h=f(e.remove),l=f(function(a){d.set(a,"class","")}),m=f(function(b){var c=g.children(b);a.before(b,c);e.remove(b)});return{remove:h,clearClasses:l,removeClass:function(a){return f(function(c){b.remove(c,a)})},removeAttr:function(a){return f(function(b){d.remove(b,a)})},unwrap:m}});k("70","b 7 s c9 33 2u ca".split(" "),
function(c,d,b,a,e,g,f){var h=function(a){return"data-"+e.resolve(a)},l=h("a11y-current-violation"),m=e.resolve("a11y-violation"),n=e.resolve("a11y-severity-info"),p=e.resolve("a11y-severity-warn"),r=e.resolve("a11y-severity-error"),q=h("a11y-ignore"),s=h("a11y-error"),t=h("a11y-warning"),u=h("a11y-info");g=g.immutableBag(["style","attribute"],[]);var v=g({style:r,attribute:s}),w=g({style:p,attribute:t}),x=g({style:n,attribute:u}),k=function(a){return"error"===a?b.some(v):"warning"===a?b.some(w):
"info"===a?b.some(x):b.none()};return{configure:function(a){a.addSelector(a.output(),"["+q+"]",f.removeAttr(q));c.each([a.output(),a.input(),a.history(),a.internal()],function(b){c.each([m,n,p,r],function(c){a.add(b,c,f.removeClass(c))});c.each([l,s,t,u],function(c){a.addSelector(b,"["+c+"]",f.removeAttr(c))})})},ignoreAttr:d.constant(q),manager:function(b){return a.manager({content:d.constant(b),violation:d.constant(m),currentAttr:d.constant(l),ignoreAttr:d.constant(q),get:k,all:d.constant([v,w,
x])})}}});k("d6",["21","ak","2a"],function(c,d,b){var a=function(a){return"img"===c.name(a)?1:d.getOption(a).fold(function(){return b.children(a).length},function(a){return a.length})};return{getEnd:a,isEnd:function(b,c){return a(b)===c},isStart:function(a,b){return 0===b}}});k("eg",["2u"],function(c){var d=c.immutable("element","offset"),b=c.immutable("element","deltaOffset"),a=c.immutable("element","start","finish"),e=c.immutable("begin","end");c=c.immutable("element","text");return{point:d,delta:b,
range:a,points:e,text:c}});k("f8","d6 eg 1a 21 ak 2a".split(" "),function(c,d,b,a,e,g){var f=function(a){return"false"===b.get(a,"contenteditable")},h=function(a){a=a[a.length-1];var b=c.getEnd(a);return d.point(a,b)};return{descend:function(b,c){var f=g.children(b);if(0===f.length)return d.point(b,c);if(c<f.length)return d.point(f[c],0);var f=f[f.length-1],h=a.isText(f)?e.get(f).length:g.children(f).length;return d.point(f,h)},descendUntilLeaf:function(a,b){var c=d.point(a,b),e=function(a){return f(a.element())?
c:g.child(a.element(),a.offset()).fold(function(){return a},function(a){return e(d.point(a,0))})},r=g.children(a);return 0<r.length&&b<r.length?e(d.point(r[b],0)):0<r.length&&b===r.length?e(h(r)):c}}});k("cb","5b 7 f8 2n l 6d 2o 3l 21 2q 29 2a 1s dg".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q){var s=function(b){var c=q(a.get(b,"padding-top"),10),d=q(a.get(b,"padding-bottom"),10);b=p.owner(b);return n.get(b).top()-(c+d)},t=function(a,l){var n=b.descend(a,l),p=e.fromText(c.zeroWidth()),r=e.fromTag("span");
f.append(r,p);f.before(n.element(),r);n=h.absolute(r);p=g.get(r);return{element:d.constant(r),bottom:d.constant(n.top()+p),pos:d.constant(n),cleanup:function(){m.remove(r)}}},u=function(a){var b=h.absolute(a),c=g.get(a);return{element:d.constant(a),bottom:d.constant(b.top()+c),pos:d.constant(b),cleanup:d.noop}},v=function(b,c){b.getSelection().each(function(d){b.body().each(function(e){b.win().each(function(b){a.reflow(e);var f=s(e),g=t(d.startContainer(),d.startOffset());c(b,f,g);g.cleanup()})})})},
w=function(a,b,c){a.body().each(function(d){a.win().each(function(a){c(a,s(d),b)})})},x=function(a,b,c){var d=a.innerHeight,e=c.pos();c.bottom()>d+b?(b=e.top()-d+1.5*g.get(c.element()),a.scrollTo(e.left(),b)):e.top()<b&&a.scrollTo(e.left(),e.top())},k=function(b,c,d,e){b.body().each(function(f){var h=g.get(b.element()),l;l=f.dom();l=r.max(l.offsetHeight,l.scrollHeight);var m=e.pos();e.bottom()>l?a.set(f,"min-height",e.bottom()+"px"):a.remove(f,"min-height");(m.top()>h+d||m.top()<d)&&c.scrollTo(m.left(),
m.top())})},B=function(a){v(a,x)},z=function(a,b){w(a,u(b),x)},A=function(a){v(a,d.curry(k,a))},C=function(a,b){w(a,u(b),d.curry(k,a))};return{cursorIntoView:function(a){(a.isInline()?B:A)(a)},elementIntoView:function(a,b){(a.isInline()?z:C)(a,b)},putInView:function(a,b,c,d){p.parent(d).each(function(e){var f=l.isText(d)||"br"===l.name(d)?e:d;e=g.get(c.element());var m=n.get(a),f=h.absolute(f),p=m.top(),q=p+e;(f.top()>q||f.top()<p)&&b.scrollTo(m.left(),r.max(0,f.top()-e/2))})},createMarker:t}});k("l2",
"7v 4z 73 33 1a 1y l 2o 21".split(" "),function(c,d,b,a,e,g,f,h,l){var m=function(a,c,d){a=f.fromTag(a);d=b.translate(d);return n(a,c,d)},n=function(b,e,f){f=c.labelledField(b,e,f);g.add(f.element(),a.resolve("form-group"));g.add(f.element(),a.resolve(e));"select"===l.name(b)&&(e=d.div(),g.add(e,a.resolve("select-wrap")),h.append(e,b),h.append(f.element(),e));return f};return{input:function(a,b){var c=m("input",a,b);e.setAll(c.field(),{type:"text"});return{element:c.element,input:c.field}},textarea:function(a,
b){var d=m("textarea",a,b);c.textarea(d.field());return{element:d.element,textarea:d.field}},common:m,commonWith:n}});k("g5","7v er 4z gp dv 7 73 33 46 47 1a 1y 3c".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r){var q=function(a){p.add(a,h.resolve("dialog-button-default"))},s=function(a){p.add(a,h.resolve("dialog-button"))},t=function(b,g,l){var m=a(b+g);p.add(m.element(),h.resolve("dialog-"+g));b=e(f.translate(l));m.content(b);n.set(m.element(),"tabindex","-1");c.textButton(m.element(),b.element());
return{enable:function(){m.enable();d.enable(m.element())},disable:function(){m.disable();d.disable(m.element())},element:m.element,name:m.name,destroy:m.destroy,content:m.content,disabled:m.disabled,click:m.click,events:m.events}},u=function(a){a=t(a,"ok","button.ok");q(a.element());return a},v=function(a){a=t(a,"cancel","button.cancel");s(a.element());return a};return{button:t,okCancel:function(a){var c=void 0!==a?a+"-":"";a=b.div();p.add(a,h.resolve(c+"dialog-controls"));var d=v(c),e=u(c);r.append(a,
[d.element(),e.element()]);c=l.create({ok:m([],e.events.click),cancel:m([],d.events.click)});return{element:g.constant(a),ok:g.constant(e),cancel:g.constant(d),destroy:function(){e.destroy();d.destroy()},events:c.registry}},makeNormal:s,makeDefault:q}});k("cc","7v gp gq dv l1 l2 g5 33 1a 1y 4b 2y".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p){var r=function(a,b){var d=a(),e=d.element();c.button(e,b);l.set(e,"tabindex","-1");d.events.click.bind(function(){p.focus(e)});return d},q=function(a,c){var e=
r(d,c);e.content(b([a,h.resolve("icon")]));l.set(e.element(),"title",c);return e};return{setDefaultAction:function(a){f.makeDefault(a)},setNormalButton:function(a){f.makeNormal(a)},makeTextButton:function(b,c,e){c=r(d,c);n.add(c.element(),b);c.content(a(e));return c},makeIconToggle:function(a,c,d){var f=r(e,d);f.content(b([c,h.resolve("icon")]));m.add(f.element(),h.resolve("choice-button"));l.set(f.element(),"data-value",a);l.set(f.element(),"title",d);return f},makeField:function(a,b,c){return g.commonWith(a,
b,c)},makeIconButton:q,makeIconStepperButton:function(a,b){var c=q(a,b);m.add(c.element(),h.resolve("stepper-button"));return c}}});k("cd",["s","73","9"],function(c,d,b){var a={"a11y.widget.ok.label":"button.ok","a11y.widget.ok.text":"button.ok","a11y.widget.ignore.label":"a11y.widget.ignore","a11y.widget.ignore.text":"a11y.widget.ignore","a11y.widget.repair.label":"a11y.widget.repair","a11y.widget.repair.text":"a11y.widget.repair","a11y.widget.repair.available":"a11y.widget.available","a11y.i1.description":"a11y.image.alttext.empty",
"a11y.i1.repair.info":"a11y.image.alttext.set","a11y.i1.repair.errors.empty":"a11y.image.alttext.validation.empty","a11y.i1.repair.errors.duplicate":"a11y.image.alttext.validation.filenameduplicate","a11y.i2.description":"a11y.image.alttext.filenameduplicate","a11y.i2.repair.info":"a11y.image.alttext.set","a11y.i2.repair.errors.empty":"a11y.image.alttext.validation.empty","a11y.i2.repair.errors.duplicate":"a11y.image.alttext.validation.filenameduplicate","a11y.t1.description":"a11y.table.caption.empty",
"a11y.t1.repair.info":"a11y.table.caption.set","a11y.t1.repair.errors.empty":"a11y.table.caption.validation.empty","a11y.t1.repair.errors.duplicate":"a11y.table.caption.validation.summaryduplicate","a11y.t2.description":"a11y.table.summary.empty","a11y.t2.repair.info":"a11y.table.summary.set","a11y.t2.repair.errors.empty":"a11y.table.summary.validation.empty","a11y.t2.repair.errors.duplicate":"a11y.table.summary.validation.captionduplicate","a11y.t3.description":"a11y.table.caption.summaryduplicate",
"a11y.t3.repair.info":"a11y.table.caption.set","a11y.t3.repair.errors.empty":"a11y.table.caption.validation.empty","a11y.t3.repair.errors.duplicate":"a11y.table.caption.validation.summaryduplicate","a11y.t4a.description":"a11y.table.rowscells.none","a11y.t4b.description":"a11y.table.headers.none","a11y.t4b.repair.info":"a11y.table.headers.set","a11y.t4b.repair.row":"table.row-header","a11y.t4b.repair.column":"table.column-header","a11y.t4b.repair.errors.none":"a11y.table.headers.validation.none",
"a11y.t4c.description":"a11y.table.headerscope.none","a11y.t4c.repair.info":"a11y.table.headerscope.set","a11y.t4c.repair.scope.row":"a11y.table.headerscope.scope.row","a11y.t4c.repair.scope.col":"a11y.table.headerscope.scope.col","a11y.t4c.repair.scope.rowgroup":"a11y.table.headerscope.scope.rowgroup","a11y.t4c.repair.scope.colgroup":"a11y.table.headerscope.scope.colgroup","a11y.d1.description":"a11y.heading.paragraphmisuse","a11y.d1.repair.info":"a11y.heading.set","a11y.d1.repair.block.h1":"block.h1",
"a11y.d1.repair.block.h2":"block.h2","a11y.d1.repair.block.h3":"block.h3","a11y.d1.repair.block.h4":"block.h4","a11y.d1.repair.block.h5":"block.h5","a11y.d1.repair.block.h6":"block.h6","a11y.d2.description":"a11y.heading.nonsequential","a11y.d3.description":"a11y.link.adjacent","a11y.d4.description":"a11y.list.paragraphmisuse","a11y.d5a.description":"a11y.contrast.largetext","a11y.d5b.description":"a11y.contrast.smalltext"};return{get:function(b){return c.from(a[b])},translate:function(c){var g=b.prototype.slice.call(arguments,
1);return d.translate.apply(void 0,[void 0!==a[c]?a[c]:c].concat(g))}}});k("ce",["2u"],function(c){return c.immutableBag(["rules"],[])});k("t8",["2i"],function(c){return{filterAccept:function(){return c.getOrDie("NodeFilter").FILTER_ACCEPT},showElement:function(){return c.getOrDie("NodeFilter").SHOW_ELEMENT}}});k("t9",["2u"],function(c){return c.immutableBag(["rule","element"],[])});k("l3",["b","2b","t8","t9","q"],function(c,d,b,a,e){var g=function(a){return b.filterAccept()},f=function(b,d){return c.bind(d,
function(c){return c.check()(b)?[a({rule:c,element:b})]:[]})},h=function(b,d){return c.bind(d,function(d){return c.map(d.check()(b),function(b){return a({rule:d,element:b})})})};return{audit:function(a,m){for(var n=[],p=c.partition(m,function(a){return a.walkable()}),r=p.pass,p=p.fail,q=e.createTreeWalker(a,b.showElement(),g,!1);q.nextNode();)n=n.concat(f(q.currentNode,r));r=h(a,p);n=n.concat(r);n.sort(function(a,b){var c=a.element(),e=b.element();return c===e?0:d.documentPositionPreceding(c,e)?1:
-1});return n}}});k("cf",["l3"],function(c){return function(d){return{audit:function(b){return c.audit(b,d.rules())}}}});k("yg",["2u"],function(c){return c.immutableBag("id wcag severity desckey url walkable check".split(" "),[])});k("yh",["7"],function(c){return{error:c.constant("error"),warning:c.constant("warning"),info:c.constant("info")}});k("yi",[],function(){return{match:function(c,d){return c.matches?c.matches(d):c.webkitMatchesSelector?c.webkitMatchesSelector(d):c.mozMatchesSelector?c.mozMatchesSelector(d):
c.msMatchesSelector?c.msMatchesSelector(d):!1}}});k("ta",["b","yg","yh","yi"],function(c,d,b,a){var e=function(a){return c.forall(a.childNodes,function(a){return/^(b|strong)$/i.test(a.nodeName)})};return d({id:"D1",wcag:"1.3.1",severity:b.warning(),desckey:"a11y.d1.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!0,check:function(b){return a.match(b,"p")?e(b):!1}})});k("tb",["b","yg","yh"],function(c,d,b){return d({id:"D2",wcag:"1.3.1",
severity:b.error(),desckey:"a11y.d2.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!1,check:function(a){a=a.querySelectorAll("h1, h2, h3, h4, h5, h6");var b,d=[];c.each(a,function(a){var c=parseInt(a.tagName.slice(1),10);b&&1<c-b&&d.push(a);b=c});return d}})});k("tc",["b","yg","yh"],function(c,d,b){return d({id:"D3",wcag:"2.4.4",severity:b.error(),desckey:"a11y.d3.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/navigation-mechanisms-refs.html",
walkable:!1,check:function(a){return c.filter(a.querySelectorAll("a + a"),function(a){return a.href===a.previousSibling.href})}})});k("yj",[],function(){var c=function(c){var b=c.nodeName;for(c=c.nextSibling;null!==c&&("#text"===c.nodeName||"BR"===c.nodeName);)c=c.nextSibling;return null!==c&&c.nodeName===b?c:!1};return{check:function(d,b){for(var a=d.querySelectorAll("p,h1,h2,h3,h4,h5,h6"),e=[],g=0;g<a.length;){var f,h=a[g];f=b;for(var l=c(h),h=f(h)?[h]:[];!1!==l&&f(l);)h.push(l),l=c(l);f=h;if(1<
f.length){e.push(f[0]);f=f[f.length-1];l=-1;for(h=0;h<a.length;h++)if(a[h]===f){l=h;break}f=l;g=-1===f?g+1:f}else g++}return e}}});k("td",["yg","yh","yj"],function(c,d,b){var a=function(a){return a.textContent.match(/^\s{0,}([a-z1-9]|i+)\s{0,}[.)-]/gmi)};return c({id:"D4o",wcag:"1.3.1",severity:d.error(),desckey:"a11y.d4.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!1,check:function(c){return b.check(c,a)}})});k("te",["yg","yh",
"yj"],function(c,d,b){var a=function(a){return a.textContent.match(/^\s{0,}(\*|-)\s{0,}/gmi)};return c({id:"D4u",wcag:"1.3.1",severity:d.error(),desckey:"a11y.d4.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!1,check:function(c){return b.check(c,a)}})});k("145",["2u"],function(c){var d=c.immutable("red","green","blue","alpha");return{rgbaColour:d,white:function(){return d(255,255,255,1)}}});k("11p",["145","1s"],function(c,d){return{calculateContrastRatio:function(b,
a){var c=d.max(b,a)+0.05,g=d.min(b,a)+0.05;return c/g},calculateLuminance:function(b){var a=function(a){return 0.03928>=a?a/12.92:d.pow((a+0.055)/1.055,2.4)},c=b.red()/255,g=b.green()/255;b=b.blue()/255;c=a(c);g=a(g);a=a(b);return 0.2126*c+0.7152*g+0.0722*a},composeColour:function(b,a){var e=b.alpha()+a.alpha()*(1-b.alpha()),g=(b.red()*b.alpha()+a.red()*a.alpha()*(1-b.alpha()))/e,f=(b.green()*b.alpha()+a.green()*a.alpha()*(1-b.alpha()))/e,h=(b.blue()*b.alpha()+a.blue()*a.alpha()*(1-b.alpha()))/e;
return c.rgbaColour(d.ceil(g),d.ceil(f),d.ceil(h),e)}}});k("146",["s","145"],function(c,d){return{parseColour:function(b){var a=function(a,b,e,l){a=parseInt(a,10);b=parseInt(b,10);e=parseInt(e,10);l=parseFloat(l);return c.some(d.rgbaColour(a,b,e,l))};if("transparent"===b)return a(0,0,0,0);var e=b.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/);if(null!==e)return a(e[1],e[2],e[3],1);b=b.match(/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/);return null!==b?a(b[1],b[2],b[3],b[4]):c.none()}}});k("11o",
"b s 11p 145 146 2m 1b 2n 2a".split(" "),function(c,d,b,a,e,g,f,h,l){var m=function(b,c){var d=h.get(b,"opacity");return 1>d?a.rgbaColour(c.red(),c.green(),c.blue(),c.alpha()*d):c};return{getBackgroundColor:function(n){var p=l.owner(n),r=g.getBody(p);n=[n].concat(l.parents(n,function(a){return f.eq(a,r)}));n=c.foldl(n,function(a,c){if(1===a.alpha())return a;var f=h.get(c,"background-color");return e.parseColour(f).bind(function(e){e=m(c,e);return 0<e.alpha()?d.some(b.composeColour(a,e)):d.none()}).getOr(a)},
a.rgbaColour(0,0,0,0));return 1>n.alpha()?b.composeColour(n,a.white()):n},getForegroundColor:function(a,c){var f=h.get(a,"color");return e.parseColour(f).bind(function(e){e=m(a,e);e=1>e.alpha()?b.composeColour(e,c):e;return d.some(e)})}}});k("yk",["s","11o","11p"],function(c,d,b){var a=function(a){var c=d.getBackgroundColor(a);return d.getForegroundColor(a,c).map(function(a){var d=b.calculateLuminance(c);a=b.calculateLuminance(a);return b.calculateContrastRatio(a,d)})};return{check:function(b,c){return a(b).filter(function(a){return a<
c}).isSome()},getRatio:a}});da("on",Number);k("yl","7 s 2m 2n 2a on 68".split(" "),function(c,d,b,a,e,g,f){var h=function(b){b=a.get(b,"font-weight");return"bold"===b||"bolder"===b?!0:/^[0-9]*$/.test(b)?700<=parseInt(b,10):!1},l=function(b){var c=a.get(b,"font-size");b=(new f(".*px")).test(c);c=c.match(/(\d*\.?\d*)(.*)/);return b&&null!==c?d.some(g(c[1])):d.none()};return{isLargeFont:function(a){var d=h(a),f=e.owner(a),f=b.getBody(f),g=l(f);return l(a).fold(c.constant(!1),function(a){return g.fold(function(){return 24<=
a||d&&19<=a},function(b){return a>=1.5*b||d&&a>=1.2*b})})}}});k("ym",["b","21","2a"],function(c,d,b){return{hasNonEmptyTextChild:function(a){a=b.children(a);return 0<c.filter(a,function(a){return d.isText(a)&&0<d.value(a).trim().length}).length}}});k("tf","yg yh yk yl ym l".split(" "),function(c,d,b,a,e,g){return c({id:"D5a",wcag:"1.4.3",severity:d.error(),desckey:"a11y.d5a.description",url:"https://www.w3.org/TR/UNDERSTANDING-WCAG20/visual-audio-contrast-contrast.html",walkable:!0,check:function(c){c=
g.fromDom(c);return e.hasNonEmptyTextChild(c)&&a.isLargeFont(c)&&b.check(c,3)}})});k("tg","yg yh yk yl ym l".split(" "),function(c,d,b,a,e,g){return c({id:"D5b",wcag:"1.4.3",severity:d.error(),desckey:"a11y.d5b.description",url:"https://www.w3.org/TR/UNDERSTANDING-WCAG20/visual-audio-contrast-contrast.html",walkable:!0,check:function(c){c=g.fromDom(c);return e.hasNonEmptyTextChild(c)&&!a.isLargeFont(c)&&b.check(c,4.5)}})});k("th",["yg","yh","yi"],function(c,d,b){return c({id:"I1",wcag:"1.1.1",severity:d.error(),
desckey:"a11y.i1.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/text-equiv-all.html",walkable:!0,check:function(a){return b.match(a,"img")&&(!1===a.hasAttribute("alt")||""===a.getAttribute("alt").trim())}})});k("ti",["yg","yh","yi"],function(c,d,b){return c({id:"I2",wcag:"1.1.1",severity:d.error(),desckey:"a11y.i2.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/text-equiv-all.html",walkable:!0,check:function(a){return b.match(a,"img[alt][src]")&&a.src.split("/").pop()===a.alt.split("/").pop()}})});
k("tj",["yg","yh","yi"],function(c,d,b){return c({id:"T1",wcag:"1.3.1",severity:d.error(),desckey:"a11y.t1.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!0,check:function(a){return b.match(a,"table")?(a=a.querySelector("caption"))?b.match(a,":empty"):!0:!1}})});k("tk",["yg","yh","yi"],function(c,d,b){return c({id:"T2",wcag:"1.3.1",severity:d.warning(),desckey:"a11y.t2.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",
walkable:!0,check:function(a){return b.match(a,"table")&&(a.querySelector("[rowspan]")||a.querySelector("[colspan]"))&&!a.hasAttribute("summary")}})});k("tl",["yg","yh","yi"],function(c,d,b){return c({id:"T3",wcag:"1.3.1",severity:d.error(),desckey:"a11y.t3.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!0,check:function(a){return b.match(a,"table")&&a.hasAttribute("summary")&&0<a.querySelectorAll("caption").length&&a.getAttribute("summary")===
a.querySelector("caption").innerHTML}})});k("tm",["yg","yh"],function(c,d){return c({id:"T4b",wcag:"1.3.1",severity:d.error(),desckey:"a11y.t4b.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!0,check:function(b){return"table"===b.nodeName.toLowerCase()&&0===b.querySelectorAll("th").length}})});k("tn",["yg","yh"],function(c,d){return c({id:"T4c",wcag:"1.3.1",severity:d.error(),desckey:"a11y.t4c.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",
walkable:!0,check:function(b){var a;"th"===b.nodeName.toLowerCase()?(a=!1===b.hasAttribute("scope"),b=!1===/row|col|rowgroup|colgroup/i.test(b.getAttribute("scope")),a=a||b):a=!1;return a}})});k("to",["yg","yh"],function(c,d){return c({id:"T4a",wcag:"1.3.1",severity:d.error(),desckey:"a11y.t4a.description",url:"http://www.w3.org/TR/UNDERSTANDING-WCAG20/content-structure-separation-programmatic.html",walkable:!0,check:function(b){return"table"===b.nodeName.toLowerCase()?0===b.querySelectorAll("tr").length||
0===b.querySelectorAll("td").length:!1}})});k("l4","b 7 s ta tb tc td te tf tg th ti tj tk tl tm tn to".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,v){var w=[a,e,g,f,h,l,m,n,p,r,q,s,u,v,t];return{get:function(a){return b.from(c.find(w,function(b){return b.name()===a}))},all:d.constant(w)}});k("cg",["l4"],function(c){return{get:function(d){return c.get(d)},all:function(){return c.all().slice()}}});k("l6",["s","4m","2u","1s"],function(c,d,b,a){return function(){var e=d([]),g=d(0),f=b.immutable("index",
"total","detail"),h=function(a){var b=e.get();if(0===b.length)return c.none();var d,h=g.get();d=b.length-1;a=h+a;d=a>d?0:0>a?d:a;g.set(d);return c.some(f(d,b.length,b[d]))};return{load:function(a){if(0===a.length)return c.none();g.set(0);e.set(a);return c.some(f(g.get(),a.length,a[0]))},backwards:function(){return h(-1)},current:function(){var a=e.get();return 0===a.length?c.none():c.some(f(g.get(),a.length,a[g.get()]))},resolve:function(){var b=e.get();if(0===b.length)return c.none();var b=b.slice(0,
g.get()).concat(b.slice(g.get()+1)),d=a.min(b.length-1,g.get());g.set(d);e.set(b);return 0===b.length?c.none():c.some(f(g.get(),b.length,b[g.get()]))},forwards:function(){return h(1)}}}});k("tp",["4g"],function(c){return{resolve:c.create("ephox-wheel").resolve}});k("l7",["v","tp","9"],function(c,d,b){return{resolve:function(a,b){return d.resolve(a.prefix()+"-"+b)},translate:function(a,d){var g=[(c.startsWith(d,a.tnames())?"":a.tnames()+".")+d].concat(b.prototype.slice.call(arguments,2));return a.translate.apply(null,
g)}}});k("ts",["l7"],function(c){var d=function(b,a,d,g,f){d=c.translate(f,d);g=c.translate(f,g);return b.makeTextButton(a,d,g)};return{defaultActionButton:function(b,a,c,g,f){a=d(b,a,c,g,f);b.setDefaultAction(a.element());return a},normalButton:function(b,a,c,g,f){a=d(b,a,c,g,f);b.setNormalButton(a.element());return a},button:d,toggleButton:function(b,a,d,g,f){g=c.translate(f,g);return b.makeIconToggle(a,d,g)},field:function(b,a,d,g,f){g=c.translate(f,g);return b.makeField(a,d,g)},icon:function(b,
a,d,g){d=c.translate(g,d);return b.makeIconStepperButton(a,d)}}});k("tq","b g2 8h 6 4z 7 s 54 46 2u 1a 1y l 2f 3c 31 32 l7 ts".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,v,w){var x=function(a,c,e,f,h,l){var m=r.fromTag("input");a=w.field(a,m,e,f,l);p.add(m,v.resolve(l,"input"));c=[b.input(m,d.input({execute:c}))];return{element:a.element,get:function(){var a={};a[e]=u.get(m);return a},update:function(a){a=h(a);u.set(m,a)},keylayouts:g.constant(c),destroy:g.noop}},k=function(a,d,e,h,l){var m=
r.fromTag("select");a=w.field(a,m,d,e,l);h=c.map(h,function(a){var b=r.fromTag("option");u.set(b,a.value());q.set(b,v.translate(l,a.text()));return b});s.append(m,h);h=[b.single(m,[],f.none())];return{element:a.element,get:function(){var a={};a[d]=u.get(m);return a},update:g.noop,keylayouts:g.constant(h),destroy:g.noop}},B=function(f,h,l,m,r){var q=e.div();p.add(q,v.resolve(r,"flow"));var u=c.map(m,function(a){return w.toggleButton(f,a.value(),a.icon(),a.textkey(),r)});m=c.map(u,function(a){return a.element()});
s.append(q,m);m=[b.flow(q,{item:g.constant(".ephox-pastry-statebutton")},d.flow({trigger:function(a){return t.descendant(a,".ephox-pastry-button").map(function(a){a.dom().click();return a})}}))];return{element:w.field(f,q,h,l,r).element,get:function(){return c.foldr(u,function(b,c){var d={};d[n.get(c.element(),"data-value")]=c.selected();return a.deepMerge(b,d)},{})},update:g.noop,keylayouts:g.constant(m),destroy:function(){c.each(u,function(a){a.destroy()})}}};return{generate:function(b,d,e,f){d=
d.getOr([]);var n=c.bind(d,function(a){return a.fold(function(a,b,c){return[a]},function(a,b,c){return[a]},function(a,b,d){return c.map(d,function(a){return a.value()})})}),p=0<n.length?m.immutableBag(n,[]):g.constant({}),r=l.create({execute:h([])}),q=function(){r.trigger.execute()},s=c.map(d,function(a){return a.fold(function(a,c,d){return x(b,q,a,c,d,f)},function(a,c,d){return k(b,a,c,d,f)},function(a,c,d){return B(b,a,c,d,f)})});c.each(s,function(a){a.update(e)});d=c.map(s,function(a){return a.element()});
var t=c.bind(s,function(a){return a.keylayouts()});return{elements:g.constant(d),get:function(){var b=c.foldr(s,function(b,c){return a.deepMerge(b,c.get())},{});return p(b)},keylayouts:g.constant(t),destroy:function(){c.each(s,function(a){a.destroy()});c.each(t,function(a){a.destroy()})},events:r.registry}}}});k("l8","a7 g2 8h 4z 7 s 54 46 1a 1y l 2f 2o 3c 2q l7 tq".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u){return function(v,w){var x=a.div();m.add(x,t.resolve(w,"assistance"));var k=t.resolve(w,
"assistance-invalid"),B=g.none(),z=n.fromTag("p");m.add(z,t.resolve(w,"repair-error"));l.set(z,"aria-live","polite");var A=function(){m.remove(x,k);s.remove(z)},C=h.create({execute:f([])}),D=b.dynamic(x,d.dynamic({})),F=[D];return{element:e.constant(x),keylayouts:e.constant(F),markInvalid:function(a){m.add(x,k);c.shout(x,a);p.set(z,a);r.append(x,z)},markValid:A,getChange:function(){return B.map(function(a){return a.get()})},destroy:function(){B.each(function(a){a.destroy()})},update:function(a){A();
a=a.detail();var b=a.prompts();B.each(function(a){a.destroy()});a=u.generate(v,b,a,w);B=g.some(a);s.empty(x);q.prepend(x,a.elements());a.events.execute.bind(function(){C.trigger.execute()});D.set(a.keylayouts())},events:C.registry}}});k("tr",["7"],function(c){return{title:c.constant("widget.title"),running:c.constant("widget.running"),previous:c.constant("widget.previous"),next:c.constant("widget.next"),issueCounter:c.constant("widget.issue.counter"),issueHelp:c.constant("widget.issue.help"),noIssue:c.constant("widget.issue.none"),
severity:function(c){return"severity."+c},repairLabel:c.constant("widget.repair.label"),repairText:c.constant("widget.repair.text"),repairAvailable:c.constant("widget.repair.available"),ignoreLabel:c.constant("widget.ignore.label"),ignoreText:c.constant("widget.ignore.text"),okLabel:c.constant("widget.ok.label"),okText:c.constant("widget.ok.text")}});k("l9","er a7 g2 8h 4z 7 46 47 2m 1y 2y 2o 3c 2q al l7 tr ts".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,v){return function(w,x){var k=e.div();
m.add(k,t.resolve(x,"commands"));var B=e.div();m.add(B,t.resolve(x,"commands-buttons"));var z=v.defaultActionButton(w,[t.resolve(x,"repair")],u.repairLabel(),u.repairText(),x),A=v.normalButton(w,[t.resolve(x,"ignore")],u.ignoreLabel(),u.ignoreText(),x),C=v.defaultActionButton(w,[t.resolve(x,"ok")],u.okLabel(),u.okText(),x),D=function(){r.append(B,[A.element(),z.element()])};D();var F=b.button({execute:function(a){a.dom().click()}}),F=[a.button(A.element(),F),a.button(z.element(),F),a.button(C.element(),
F)];p.append(k,B);var E=f.create({repair:h([],z.events.click),ignore:h([],A.events.click),done:h([],C.events.click)});return{element:g.constant(k),destroy:function(){z.destroy();A.destroy();C.destroy()},keylayouts:g.constant(F),focus:function(){var a=z.disabled()?z.element():A.element();n.focus(a)},update:function(a){q.remove(C.element());a=a.detail();s.isVisible(A.element())||D();a.prompts().fold(function(){z.disable();c.disable(z.element())},function(a){z.enable();c.enable(z.element());d.speak(l.body(),
t.translate(x,u.repairAvailable()))})},zero:function(a){q.empty(B);p.append(B,C.element());n.focus(C.element())},events:E.registry}}});k("la","a7 8h 4z 7 s 1a 2m 1y 3u l 2f 2o 3c 2q l7 tr 36".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u){return function(v,w){var x=b.div();h.add(x,s.resolve(w,"information"));g.set(x,"data-severity","info");var k=b.div();h.add(k,s.resolve(w,"icon"));var B=b.div();h.add(B,s.resolve(w,"description"));p.append(B,m.fromText(""));var z=m.fromTag("a");h.add(z,s.resolve(w,
"help-icon"));g.set(z,"href","javascript:void(0)");r.append(x,[k,B,z]);var A=l.bind(z,"click",function(){var a=g.get(z,"data-url");u.open(a,"","height=700,width=820,resizable=yes,scrollbars=yes")}),k=[d.single(z,[],e.none())];return{element:a.constant(x),destroy:function(){A.unbind()},keylayouts:a.constant(k),update:function(a){a=a.detail();var b=a.severity();g.set(x,"data-severity",b);c.speak(f.body(),s.translate(w,t.severity(b)));b=s.translate(w,a.description());n.set(B,b);c.speak(f.body(),b);g.set(z,
"title",s.translate(w,t.issueHelp()));g.set(z,"data-url",a.url());p.after(B,z)},zero:function(){g.set(x,"data-severity","success");var a=s.translate(w,t.noIssue());n.set(B,a);c.speak(f.body(),a);q.remove(z)}}}});k("lb",["4z","7","1y","2o","l7"],function(c,d,b,a,e){return function(g,f){var h=c.div(),l=c.span();b.add(l,e.resolve(f,"spin"));b.add(h,e.resolve(f,"loading"));a.append(h,l);return{element:d.constant(h),destroy:d.noop}}});k("lc","b l5 er a7 g2 8h 4z 7 s 46 47 2m 1y l 2f 2o 3c l7 tr ts".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,v,w,x){var k=function(a,b,c){var d=f.div();r.add(d,v.resolve(c,a));b.each(function(a){t.append(d,q.fromText(v.translate(c,a)))});return d};return function(q,z){var A=k("titlebar",l.none(),z),C=k("title",l.none(),z),D=k("title-text",l.some(w.title()),z),F=k("issue",l.some(w.running()),z);u.append(C,[D,F]);var E=f.div();r.add(E,v.resolve(z,"navigation"));var D=x.icon(q,v.resolve(z,"previous"),w.previous(),z),G=x.icon(q,v.resolve(z,"next"),w.next(),z),H=[D,
G],D=m.create({previous:n([],D.events.click),next:n([],G.events.click)});u.append(E,c.map(H,function(a){return a.element()}));t.append(A,C);var I=e.button({execute:function(a){a.dom().click()}}),G=c.map(H,function(a){return g.button(a.element(),I)}),L=function(a){a.disable();b.disable(a.element())},J=function(a){a.enable();b.enable(a.element())},K=function(){c.each(H,L)},M=function(){c.each(H,J)},N=function(){d.preserve(function(){t.after(C,E)},E)};return{element:h.constant(A),update:function(b){var c=
b.index()+1;b=b.total();c=v.translate(z,w.issueCounter(),c,b);s.set(F,c);a.speak(p.body(),c);(1===b?K:M)();N()},zero:function(){s.set(F,"&nbsp;");N();K()},keylayouts:h.constant(G),destroy:function(){c.each(H,function(a){a.destroy()})},events:D.registry}}});k("ch","b l5 4z 7 54 46 4m 1y 2o 3c 2q l6 l7 l8 l9 la lb lc".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,v){return function(w,x){var k=b.div();h.add(k,r.resolve(x,"widget"));var B=r.resolve(x,"loading");h.add(k,B);var z=v(w,x),A=t(w,x),
C=q(w,x),D=s(w,x),F=u(w,x);m.append(k,[z.element(),F.element()]);var E=g.create({showcase:e(["detail"]),ignored:e(["detail"]),solved:e(["detail"]),done:e([])}),G=function(a){c.each([z,A,C,D],function(b){b.update(a)});E.trigger.showcase(a.detail());d.preserve(function(){l.after(z.element(),A.element());l.after(A.element(),C.element());l.after(C.element(),D.element())},k)},H=function(a){a.fold(function(){l.after(z.element(),A.element());l.after(A.element(),D.element());n.remove(C.element());z.zero();
A.zero();D.zero()},G)},I=f(p());z.events.previous.bind(function(){I.get().backwards().each(G)});z.events.next.bind(function(){I.get().forwards().each(G)});var L=function(){var a=C.getChange().getOr({});I.get().current().each(function(b){var c=b.detail();c.repair()(c,a).fold(function(a){C.markInvalid(a)},function(a){C.markValid();a=I.get().resolve();E.trigger.solved(c);H(a);D.focus()})})};C.events.execute.bind(L);D.events.repair.bind(L);D.events.ignore.bind(function(){I.get().current().each(function(a){var b=
I.get().resolve();E.trigger.ignored(a.detail());H(b)})});D.events.done.bind(function(){E.trigger.done()});L=c.flatten([z.keylayouts(),A.keylayouts(),C.keylayouts(),D.keylayouts()]);return{element:a.constant(k),destroy:function(){c.each([z,A,C,D],function(a){a.destroy()})},load:function(a){n.remove(F.element());h.remove(k,B);a=I.get().load(a);H(a)},open:function(){l.append(k,F.element());h.add(k,B)},skip:function(){var a=I.get().resolve();H(a)},keylayouts:a.constant(L),events:E.registry}}});k("6z",
"b 7 c8 70 cb cc cd 46 47 ce cf cg 4h 2m ch".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s){return function(t){var u=a.ignoreAttr(),v={prefix:d.constant("accessibility-check"),translate:f.translate,tnames:d.constant("a11y")},w=s(g,v),v=p.all(),v=m({rules:v}),x=n(v),k=b(f.translate),B=a.manager(t.content()),z=function(a){a=x.audit(a.dom());a=k.convert(t,a);return c.filter(a,function(a){var b=a.element(),b=r.read(b,u);return!c.contains(b,a.id())})};w.events.showcase.bind(function(a){t.content().body().each(function(b){b=
a.detail().element();q.inBody(b)?(B.moveTo(b,a.detail().severity()),e.elementIntoView(t.content(),b)):w.skip()})});w.events.ignored.bind(function(a){a=a.detail();B.ignore(a.element(),a.id(),a.severity())});w.events.solved.bind(function(a){a=a.detail();B.solve(a.element(),a.id(),a.severity())});v=h.create({done:l([],w.events.done)});return{element:w.element,anchorName:d.constant("a11y-widget-anchor"),textkey:d.constant("action.a11ycheck"),dialogTextkey:d.constant("a11y.widget.title"),destroy:function(){w.destroy()},
keylayouts:w.keylayouts,openWidget:function(){t.content().hideInlineSelection();w.open();t.content().body().each(function(a){a=z(a);B.start(a);w.load(a)})},closeWidget:function(){B.stop()},events:v.registry}}});k("71",["s","4m"],function(c,d){var b=function(a){var b=d(c.none());return{clear:function(){b.get().each(a);b.set(c.none())},isSet:function(){return b.get().isSome()},set:function(d){b.get().each(a);b.set(c.some(d))}}};return{destroyable:function(){return b(function(a){a.destroy()})},unbindable:function(){return b(function(a){a.unbind()})},
api:function(){var a=d(c.none()),b=function(){a.get().each(function(a){a.destroy()})};return{clear:function(){b();a.set(c.none())},isSet:function(){return a.get().isSome()},set:function(d){b();a.set(c.some(d))},run:function(b){a.get().each(b)}}},value:function(){var a=d(c.none());return{clear:function(){a.set(c.none())},set:function(b){a.set(c.some(b))},isSet:function(){return a.get().isSome()},on:function(b){a.get().each(b)}}}}});k("cz","75 54 46 1y 2n 3u l 2o 2q 3t".split(" "),function(c,d,b,a,
e,g,f,h,l,m){return function(m,p){var r=b.create({open:d([]),close:d([])}),q=f.fromTag("div");a.add(q,c.resolve("layer-menus"));a.add(q,c.resolve("toolstrip"));h.append(m(),q);var s=!1,t=g.bind(q,"transitionend",function(){s||(e.remove(q,"display"),r.trigger.close())});return{element:function(){return q},destroy:function(){t.unbind();l.remove(q)},open:function(){s||(s=!0,e.set(q,"display","block"),e.reflow(q),r.trigger.open(),e.set(q,"opacity","1"))},close:function(){s&&(s=!1,e.remove(q,"opacity"))},
isClosed:function(){return!s},setContent:function(a){h.append(q,a)},events:r.registry}}});k("72","75 7v ap 8h 71 cz 73 33 54 46 1y 4b 4e".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r){return function(q,s,t,u){var v=q.content(),w=q.ui().tabstrip.element(),x=[s.element()],k="."+h.resolve(t)+", ."+c.resolve("more-button"),B=function(){var a=r.descendants(w,k);return x.concat(a)},z=e.api(),A=m.create({abort:l([]),open:l([]),close:l([])}),C=function(){v.events.mousedown.unbind(D);z.clear();F.off()},D=
function(){z.isSet()&&(s.closeWidget(),z.run(function(a){a.close()}))},F=b(D,B);s.events.done.bind(function(){D()});var E=a.multiple(s.element(),s.keylayouts());E.events.exit.bind(function(){A.trigger.abort()});return{destroy:function(){C();E.destroy();s.destroy();F.off()},events:A.registry,open:function(){F.on();s.openWidget();var a=g(q.ui().viewport,B);a.setContent(s.element());n.add(a.element(),u);var b=a.element();p.add(b,[h.resolve(s.anchorName()),h.resolve("side-widget-anchor")]);d.dialog(b,
f.translate(s.dialogTextkey()));a.open();a.events.close.bind(function(){v.focus();A.trigger.close();C()});z.set(a);E.enter();A.trigger.open();v.events.mousedown.bind(D)},close:D,isOpen:z.isSet}}});k("74",["b","c","6","73","1f"],function(c,d,b,a,e){var g=d.detect(),f=(d=g.os.isOSX())?"\u2318":"Ctrl",h=d?"\u21e7":"Shift",l={blockquote:[f,h,"9"],bold:[f,"B"],italic:[f,"I"],underline:[f,"U"],link:[f,"K"],help:[f,"?"],fullscreen:[f,h,"F"],indent:[f,"]"],outdent:[f,"["],undo:[f,"Z"],redo:d?[f,h,"Z"]:[f,
"Y"],search:[f,"F"]},m="fr nl sv ru de es it".split(" "),n=b.merge(l,{indent:[f,"M"],outdent:[f,h,"M"]}),p=function(a){var b=e.get();return c.contains(m,b)?n[a]:l[a]};b=function(a){a=p(a);return void 0===a?"":" "+a.join("")};var f=function(a){a=p(a);return void 0===a?"":" ("+a.join(" ")+")"},r=d?b:f;return{get:function(b,c){return g.os.isiOS()?a.get(b):a.get(b)+r(c)}}});k("5c","6z 70 71 72 73 33 6t 74 1y".split(" "),function(c,d,b,a,e,g,f,h,l){var m=g.resolve("inverted-dialog-widget");return function(n){var p=
n.filter();d.configure(p);var r=b.api(),q=function(){var b;b=c(n);b=a(n,b,"a11y-check",m);b.events.abort.bind(b.close);b.events.close.bind(t);r.set(b);b.open()},s=function(){r.run(function(a){a.close()})},t=function(){r.clear()};return{ui:f.ui({"a11ycheck.general":{toggle:!1,hasPopup:!1,value:"a11y-check",textkey:e.key("action.a11ycheck"),action:function(){(r.isSet()?s:q)()},updateGeneral:function(a){l.add(a.element(),g.resolve("a11y-check"))},icon:!0,tooltip:h.get}}),destroy:t}}});k("ld",["7","2n"],
function(c,d){var b=function(a,b,c){var h=d.get(b,a);c=parseInt(h,10)+40*c;(0<c?d.set:d.remove)(b,a,c+"px")},a={change:c.curry(b,"margin-right")};return{ltr:{change:c.curry(b,"margin-left")},rtl:a}});k("d0",["ld"],function(c){return function(d){return{change:function(b,a){return(d.directionAt(b).isRtl()?c.rtl:c.ltr).change(b,a)}}}});k("d1",["7","3t"],function(c,d){return{runTransaction:function(b,a,e,g){g=void 0!==g?g:c.noop;a.save();b.focus();e=e();d(function(){b.domChanged();b.uiChanged()},0);g();
a.save();return e}}});k("d2",["b","d1"],function(c,d){return{multiple:function(b,a,e){return function(g,f){var h=b.getSelection(),l=d.runTransaction(b,a,function(){return c.bind(f,function(a){return a.getSelection().bind(function(a){return e(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset()).map(function(a){return a.all()})}).getOr([])})},b.toEditing);h.each(function(a){b.setSelection(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset())});return l}},single:function(b,
a,c,g,f){return function(h,l){var m=g(b,h.startContainer(),h.startOffset()),n=g(b,h.endContainer(),h.endOffset()),p=d.runTransaction(b,a,function(){return c(m.element(),m.offset(),n.element(),n.offset())},b.toEditing);return f(b,p,m,n,h)}}}});k("d3",["b","d1"],function(c,d){return{multiple:function(b,a,e){return function(g,f){return d.runTransaction(b,a,function(){return c.bind(f,function(a){return a.getSelection().bind(function(a){return e(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset()).map(function(a){return a.all()})}).getOr([])})},
b.toEditing)}},single:function(b,a,c,g,f){return function(h,l){var m=g(b,h.startContainer(),h.startOffset()),n=g(b,h.endContainer(),h.endOffset()),p=d.runTransaction(b,a,function(){return c(m.element(),m.offset(),n.element(),n.offset())},b.toEditing);return f(b,p,m,n,h)}}}});k("d4",[],function(){return{update:function(c,d,b,a,e){return d.map(function(a){c.setSelection(a.start(),a.soffset(),a.finish(),a.foffset());return a.all()}).getOr([])}}});k("d5",["eg"],function(c){return{spot:function(d,b,a){return c.point(b,
a)}}});k("7c",["s","4n"],function(c,d){var b=d.generate([{none:[]},{multiple:["elements","environments"]},{single:["selection","environment"]}]);return{cata:function(a,b,c,d){return a.fold(b,c,d)},none:b.none,multiple:b.multiple,single:b.single,toSelection:function(a){return a.fold(c.none,function(a,b){return c.from(b[0]).bind(function(a){return a.getSelection()})},c.some)}}});k("97",[],function(){var c=function(c){return{fold:c}};return{on:function(d,b){return c(function(a,c,g){return c(d,b)})},
before:function(d){return c(function(b,a,c){return b(d)})},after:function(d){return c(function(b,a,c){return c(d)})}}});k("e7",["97","2u","l"],function(c,d,b){var a=d.immutable("start","soffset","finish","foffset"),e=d.immutable("start","soffset","finish","foffset"),g=d.immutable("start","finish");return{read:a,general:e,write:g,writeFromNative:function(a){var d=b.fromDom(a.startContainer),e=b.fromDom(a.endContainer);return g(c.on(d,a.startOffset),c.on(e,a.endOffset))}}});k("e8",[],function(){return{run:function(c,
d){if(c.getSelection)return d(c,c.getSelection());throw"No selection model supported.";}}});k("lf",["1b","2a"],function(c,d){return{after:function(b,a,e,g){var f=d.owner(b).dom().createRange();f.setStart(b.dom(),a);f.setEnd(e.dom(),g);b=c.eq(b,e)&&a===g;return f.collapsed&&!b}}});k("le",["e7","lf","l","2a"],function(c,d,b,a){var e=function(a){return d.after(b.fromDom(a.anchorNode),a.anchorOffset,b.fromDom(a.focusNode),a.focusOffset)},g=function(a,d){var f=b.fromDom(d.startContainer),g=b.fromDom(d.endContainer);
return e(a)?c.read(g,d.endOffset,f,d.startOffset):c.read(f,d.startOffset,g,d.endOffset)},f=function(a){return e(a)},h=function(b,c,d,e){return function(f){if(f.extend)f.collapse(b.dom(),c),f.extend(d.dom(),e);else{var g=a.owner(b).dom().createRange();g.setStart(d.dom(),e);g.setEnd(b.dom(),c);f.removeAllRanges();f.addRange(g)}}},l=function(a,b,c,e){return d.after(a,b,c,e)};return{read:function(){return{flip:g,isRtl:f}},write:function(){return{flip:h,isRtl:l}}}});k("ea",["e7","le","s","lf","l"],function(c,
d,b,a,e){var g=function(a,d){if(!0===f(a,d.start(),d.finish()).collapsed){var g=f(a,d.finish(),d.start());return!0===g.collapsed?b.none():b.some(c.general(e.fromDom(g.endContainer),g.endOffset,e.fromDom(g.startContainer),g.startOffset))}return b.none()},f=function(a,b,c){var d=m(a);b.fold(function(a){d.setStartBefore(a.dom())},function(a,b){d.setStart(a.dom(),b)},function(a){d.setStartAfter(a.dom())});c.fold(function(a){d.setEndBefore(a.dom())},function(a,b){d.setEnd(a.dom(),b)},function(a){d.setEndAfter(a.dom())});
return d},h=function(a,b){return f(a,b.start(),b.finish())},l=function(a,b){var c=h(a,b);return function(a){a.addRange(c)}},m=function(a){return a.document.createRange()};return{create:m,build:function(a,b){return g(a,b).fold(function(){return l(a,b)},function(a){return d.write().flip(a.start(),a.soffset(),a.finish(),a.foffset())})},toNative:h,forceRange:function(a,b){var c=f(a,b.start(),b.finish());return!0===c.collapsed?f(a,b.finish(),b.start()):c},toExactNative:function(b,c,d,e,f){var g=a.after(c,
d,e,f);b=b.document.createRange();g?(b.setStart(e.dom(),f),b.setEnd(c.dom(),d)):(b.setStart(c.dom(),d),b.setEnd(e.dom(),f));return b}}});k("e9","b ea l 21 4e m".split(" "),function(c,d,b,a,e,g){var f=function(a,b,d,f){var p=a.document.createRange();a=(g.is(b,f)?[b]:[]).concat(e.descendants(b,f));return c.filter(a,function(a){p.selectNodeContents(a.dom());return 1>p.compareBoundaryPoints(d.END_TO_START,d)&&-1<p.compareBoundaryPoints(d.START_TO_END,d)})};return{find:function(c,e,g){e=d.forceRange(c,
e);var n=b.fromDom(e.commonAncestorContainer);return a.isElement(n)?f(c,n,e,g):[]}}});k("lg",["b","e7","97","21"],function(c,d,b,a){var e=function(d,e){var h=a.name(d);return"input"===h?b.after(d):c.contains(["br","img"],h)?0===e?b.before(d):b.after(d):b.on(d,e)};return{beforeSpecial:e,preprocess:function(a){var c=a.start().fold(b.before,e,b.after);a=a.finish().fold(b.before,e,b.after);return d.write(c,a)}}});k("lh",["b","l","q"],function(c,d,b){return{fromElements:function(a,e){var g=(e||b).createDocumentFragment();
c.each(a,function(a){g.appendChild(a.dom())});return d.fromDom(g)}}});k("eb","e7 le ea lg s l lh".split(" "),function(c,d,b,a,e,g,f){var h=function(a,b){var c=b.getRangeAt(0),d=b.getRangeAt(b.rangeCount-1),e=a.document.createRange();e.setStart(c.startContainer,c.startOffset);e.setEnd(d.endContainer,d.endOffset);return e},l=function(a,b){return void 0!==b&&null!==b&&0<b.rangeCount?e.from(h(a,b)):e.none()};return{get:function(a,b){return l(a,b).map(function(a){var e=g.fromDom(a.startContainer),f=g.fromDom(a.endContainer);
return d.read().isRtl(b)?d.read().flip(b,a):c.read(e,a.startOffset,f,a.endOffset)})},set:function(c){return function(d,e){var f=a.preprocess(c),f=b.build(d,f);void 0!==e&&null!==e&&(e.removeAllRanges(),f(e))}},selectElementContents:function(a){return function(c,d){var e=b.create(c);e.selectNodeContents(a.dom());d.removeAllRanges();d.addRange(e)}},replace:function(a){return function(b,c){l(b,c).each(function(c){var d=f.fromElements(a,b.document);c.deleteContents();c.insertNode(d.dom())})}},replaceRange:function(c,
d){return function(e,g){var h=a.preprocess(c),h=b.toNative(e,h),l=f.fromElements(d,e.document);h.deleteContents();h.insertNode(l.dom())}},deleteRange:function(a,c,d,e){return function(f,g){b.toExactNative(f,a,c,d,e).deleteContents()}},cloneFragment:function(a,c,d,e){return function(f,h){var l=b.toExactNative(f,a,c,d,e).cloneContents();return g.fromDom(l)}},rectangleAt:function(a,c,d,f){return function(g,h){var l=b.toExactNative(g,a,c,d,f),u=l.getClientRects(),l=0<u.length?u[0]:l.getBoundingClientRect();
return 0<l.width||0<l.height?e.some(l):e.none()}},bounds:function(a){return function(c,d){var f=b.create(c);f.selectNode(a.dom());f=f.getBoundingClientRect();return 0<f.width||0<f.height?e.some(f):e.none()}},clearSelection:function(a,b){a.getSelection().removeAllRanges()},stringAt:function(a,c,d,e){return function(f,g){return b.toExactNative(f,a,c,d,e).toString()}}}});k("7s","e7 97 e8 e9 ea eb 1b l".split(" "),function(c,d,b,a,e,g,f,h){var l=function(a,c){b.run(a,g.set(c))},m=function(b,c,d){return a.find(b,
c,d)};return{get:function(a){return b.run(a,g.get)},set:l,setExact:function(a,b,e,f,g){b=c.write(d.on(b,e),d.on(f,g));l(a,b)},selectElementContents:function(a,c){b.run(a,g.selectElementContents(c))},replace:function(a,c){b.run(a,g.replace(c))},replaceRange:function(a,c,d){b.run(a,g.replaceRange(c,d))},deleteRange:function(a,c,d,e,f){b.run(a,g.deleteRange(c,d,e,f))},isCollapsed:function(a,b,c,d){return f.eq(a,c)&&b===d},cloneFragment:function(a,c,d,e,f){return b.run(a,g.cloneFragment(c,d,e,f))},rectangleAt:function(a,
c,d,e,f){return b.run(a,g.rectangleAt(c,d,e,f))},bounds:function(a,c){return b.run(a,g.bounds(c))},findWithin:m,findWithinExact:function(a,b,e,f,g,h){b=c.write(d.on(b,e),d.on(f,g));return m(a,b,h)},deriveExact:function(a,b){var d=e.forceRange(a,b);return c.general(h.fromDom(d.startContainer),d.startOffset,h.fromDom(d.endContainer),d.endOffset)},clearAll:function(a){b.run(a,g.clearSelection)},stringAt:function(a,c,d,e,f){return b.run(a,g.stringAt(c,d,e,f))}}});k("d7","7s d6 7 s 2m 1b 31 2a 1s".split(" "),
function(c,d,b,a,e,g,f,h,l){var m=function(b,c){return e.inBody(b)?a.some(l.max(0,l.min(c,d.getEnd(b)))):a.none()};return{findDescendants:function(a,b,d,e,f){var g=h.defaultView(a);return m(a,b).bind(function(b){return m(d,e).map(function(e){return c.findWithinExact(g.dom(),a,b,d,e,f)})}).getOr([])},findAncestors:function(a,c,d){return f.ancestor(a,d).fold(function(){return f.ancestor(c,d).toArray()},function(a){return f.ancestor(c,d).fold(b.constant([a]),function(b){return g.eq(a,b)?[a]:[a,b]})})}}});
k("79","97 d6 7 s d7 33 1b 21 2q 31 2a 1s".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p){var r="."+g.resolve("element-resize-container"),q=function(c){if(c.collapsed()||!f.eq(c.startContainer(),c.endContainer()))return a.none();var d=p.min(c.startOffset(),c.endOffset());return p.max(c.startOffset(),c.endOffset())===d+1?n.child(c.startContainer(),d).filter(function(a){return"img"===h.name(a)}).map(function(a){return{image:b.constant(a),container:b.constant(c.startContainer())}}):a.none()},s=function(a){return m.closest(a,
r)};return{detect:function(a){return a.getSelection().bind(function(a){return s(a.startContainer()).bind(function(c){return s(a.endContainer()).bind(function(c){return m.closest(a.startContainer(),r).bind(function(a){return m.descendant(a,"img").map(function(c){return{image:b.constant(c),container:b.constant(a)}})})})}).orThunk(function(){return q(a)})})},findContainer:s,selectionContains:function(b){b=e.findDescendants(b.startContainer(),b.startOffset(),b.endContainer(),b.endOffset(),"img");return 1===
b.length?a.some(b[0]):a.none()},remove:function(a,b,d){b.close();a.setRelativeSelection(c.before(d),c.before(d));l.remove(d)},select:function(a,b){s(b).each(function(b){a.setSelection(b,0,b,d.getEnd(b))})}}});k("u0",["b","7","s","2u"],function(c,d,b,a){var e=a.immutable("left","right"),g=function(a,e,g){e=a.property().children(e);a=c.findIndex(e,d.curry(a.eq,g));return-1<a?b.some({before:d.constant(e.slice(0,a)),after:d.constant(e.slice(a+1))}):b.none()};return{breakToLeft:function(a,b,c){return g(a,
b,c).map(function(d){var g=a.create().clone(b);a.insert().appendAll(g,d.before().concat([c]));a.insert().appendAll(b,d.after());a.insert().before(b,g);return e(g,b)})},breakToRight:function(a,b,c){return g(a,b,c).map(function(c){var d=a.create().clone(b);a.insert().appendAll(d,c.after());a.insert().after(b,d);return e(b,d)})},breakPath:function(c,d,e,g){var n=a.immutable("first","second","splits"),p=function(a,d,h){var t=n(a,b.none(),h);return e(a)?n(a,d,h):c.property().parent(a).bind(function(d){return g(c,
d,a).map(function(a){var c=[{first:a.left,second:a.right}],f=e(d)?d:a.left();return p(f,b.some(a.right()),h.concat(c))}).getOr(t)})};return p(d,b.none(),[])}}});k("u1",["b","7","s"],function(c,d,b){var a=function(a,b,d,l){d=b(a,d);return c.foldr(l,function(c,d){var h=b(a,d);return e(a,c,h)},d)},e=function(a,b,c){return b.bind(function(b){return c.filter(d.curry(a.eq,b))})};return{oneAll:function(c,d,e){if(0<e.length){var l=e[0];e=e.slice(1);c=a(c,d,l,e)}else c=b.none();return c}}});k("u2",["b","7",
"s","1s"],function(c,d,b,a){var e=function(e,g,l,m){var n=e.property().children(g);if(e.eq(g,l[0]))return b.some([l[0]]);if(e.eq(g,m[0]))return b.some([m[0]]);var p=function(a){a=c.reverse(a);var b=c.findIndex(a,d.curry(e.eq,g));return c.findIndex(n,d.curry(e.eq,b<a.length-1?a[b+1]:a[b]))};l=p(l);m=p(m);var p=a.min(l,m),r=a.max(l,m);return-1<l&&-1<m?b.some(n.slice(p,r+1)):b.none()},g=function(a,e,g,m){var n=void 0!==m?m:d.constant(!1);e=[e].concat(a.up().all(e));m=[g].concat(a.up().all(g));var p=
function(a){var b=c.findIndex(a,n);return-1<b?a.slice(0,b+1):a};g=p(e);var r=p(m);e=c.find(g,function(b){return c.exists(r,d.curry(a.eq,b))});e=b.from(e);return{firstpath:d.constant(g),secondpath:d.constant(r),shared:d.constant(e)}};return{subset:function(a,b,c){var d=g(a,b,c);return d.shared().bind(function(b){return e(a,b,d.firstpath(),d.secondpath())})},ancestors:g}});k("lz",["u0","u1","u2"],function(c,d,b){return{sharedOne:function(a,b,c){return d.oneAll(a,b,c)},subset:function(a,c,d){return b.subset(a,
c,d)},ancestors:function(a,c,d,f){return b.ancestors(a,c,d,f)},breakToLeft:function(a,b,d){return c.breakToLeft(a,b,d)},breakToRight:function(a,b,d){return c.breakToRight(a,b,d)},breakPath:function(a,b,d,f){return c.breakPath(a,b,d,f)}}});k("fp",["dy","lz"],function(c,d){var b=c();return{sharedOne:function(a,c){return d.sharedOne(b,function(b,c){return a(c)},c)},subset:function(a,c){return d.subset(b,a,c)},ancestors:function(a,c,g){return d.ancestors(b,a,c,g)},breakToLeft:function(a,c){return d.breakToLeft(b,
a,c)},breakToRight:function(a,c){return d.breakToRight(b,a,c)},breakPath:function(a,c,g){return d.breakPath(b,a,c,function(a,b,c){return g(b,c)})}}});k("yn",["1b","l","2o","21","2q"],function(c,d,b,a,e){return{forceAddBr:function(g,f){if("br"!==a.name(g)){var h=d.fromTag("br");a.isText(g)?(b.after(g,h),c.eq(f,g)||e.remove(g)):b.prepend(g,h)}},rootBr:function(a,c){b.before(a,d.fromTag("br"))}}});k("yo",["b","2a"],function(c,d){var b=function(a,g,f){var h=[];c.each(d.children(a),function(a){g(a)&&(h=
h.concat([a]));h=f(a)?h:h.concat(b(a,g,f))});return h},a=function(b,c){var f=d.children(b);return 0<f.length?(f=f[0],c(f)?b:a(f,c)):0<f.length?a(f[0]):b};return{descendants:b,plunge:a}});k("iu",["dj","d6","1b"],function(c,d,b){var a=function(a,c,d,h,l){return h(a).fold(function(){return!0},function(a){return b.eq(c,a)&&l(c,d)})};return{isLeft:function(b,g){return a(b,g.startContainer(),g.startOffset(),c.firstCursor,d.isStart)},isAtLeftEdge:function(b,g,f){return a(b,g,f,c.firstCursor,d.isStart)},
isRight:function(b,g){return a(b,g.startContainer(),g.startOffset(),c.lastCursor,d.isEnd)},isAtRightEdge:function(b,g,f){return a(b,g,f,c.lastCursor,d.isEnd)}}});k("nd","a b iu 7 ep 2u 1b 21 6h 4i ak v".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p){var r=function(a){a=h.name(a);return"td"===a||"th"===a},q=function(a){return"li"===h.name(a)||e.isBlock(a)},s=function(a){return"a"===h.name(a)},t=function(b,c,d){return m.closest(b,c,d).filter(a.not(d)).filter(a.not(r))};return{stopAt:function(b){return a.curry(f.eq,
b)},isList:function(a){a=h.name(a);return"ol"===a||"ul"===a},isAnchor:s,isHeading:function(a,b){var e=c.isArray(b)?b:[],e="h1 h2 h3 h4 h5 h6".split(" ").concat(e),f=h.name(a);return d.contains(e,f)},isCollapsed:function(a){return f.eq(a.startContainer(),a.endContainer())&&a.startOffset()===a.endOffset()},isRightEdge:function(a,c,d){var e=g.immutable("startContainer","startOffset");return b.isRight(a,e(c,d))},exitList:function(a){return 0===l.descendants(a,function(a){return h.isText(a)&&0<n.get(a).length&&
0<p.trim(n.get(a)).length||h.isElement(a)&&d.contains(["hr","img"],h.name(a))}).length},findBlock:function(a,b){return m.closest(a,q,b)},findValidHardBreak:function(a,b){return t(a,q,b)},findAnchorBreak:function(a,b){return t(a,s,b)}}});k("yp","5b b 1a 2f 21 4e ak 2a v".split(" "),function(c,d,b,a,e,g,f,h,l){var m=function(a){if(!e.isText(a))return!1;a=f.get(a).trim();return 0===a.length||0===a.replace(c.zeroWidth(),"").length},n=function(b){if(e.isText(b))return m(b);var c=a.get(b);b=h.children(b);
return""===l.trim(c)||d.forall(b,m)};return{vacant:function(a){a=g.descendants(a,"span,a");return d.filter(a,function(a){return"span"===e.name(a)?!(b.has(a,"class")&&0<b.get(a,"class").length)&&!b.has(a,"style")&&n(a):n(a)})},isEmpty:n,hasCursor:function(a,b){var c=void 0!==b?b:["hr","br","img","input"];return e.isText(a)?!1===m(a):d.contains(c,e.name(a))},isVacantText:m,hasNoContent:n}});k("tu","b 7 s yn yo nd yp 1a 21 2q 4e".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){var p=function(a){var c="li"===
l.name(a)?g.isList:d.constant(!1);return 0<e.descendants(a,f.hasCursor,c).length?b.none():b.some(e.plunge(a,c))},r=function(a){a=f.vacant(a);c.each(a,m.remove)},q=function(a,b){var d=n.descendants(b,a),d=c.filter(d,f.isEmpty);c.each(d,m.remove);f.isEmpty(b)&&m.remove(b)};return{vacate:r,emptyStyles:function(a){!0===h.has(a,"style")&&0===h.get(a,"style").length&&h.remove(a,"style")},needsCursor:p,postprocess:function(b,c,d){r(b);p(b).each(function(b){a.forceAddBr(b,c)})},lists:d.curry(q,"ul,ol"),blockquotes:d.curry(q,
"blockquote")}});k("tt",["b","7","fp","tu","1a"],function(c,d,b,a,e){var g=function(f,g){var l=b.breakToRight(f,g);l.each(function(b){b=b.right();c.each(["id"],d.curry(e.remove,b));a.emptyStyles(b)});return l};return{breakPath:function(a,c){return b.breakPath(a,c,g)}}});k("li","b 97 7 tt tu nd 2o".split(" "),function(c,d,b,a,e,g,f){return{breakQuote:function(h,l){var m=a.breakPath(l,g.stopAt(h));return m.second().map(function(a){var g=m.first();f.before(a,l);c.each([g,a],e.blockquotes);return{start:b.constant(d.on(l,
0)),finish:b.constant(d.on(l,0))}})}}});k("d8",["li"],function(c){return{breakQuote:c.breakQuote}});k("lj",["21","2a"],function(c,d){var b=function(a){return c.isElement(a)?a:d.parent(a).getOr(a)};return{bothMatch:function(a,c,d){a=b(a);c=b(c);return d(a)&&d(c)}}});k("lu",["ep","m"],function(c,d){return{isRootOrCell:function(b){return function(a){return b(a)||d.is(a,"td,th")}},isRootOrContainer:function(b){return function(a){return b(a)||c.isContainer(a)}}}});k("tv",["s"],function(c){var d=function(b,
a){return 0===b.length?!0:0===a.length?!1:b[0]<a[0]?!0:a[0]<b[0]?!1:d(b.slice(1),a.slice(1))};return{head:function(b){return 0<b.length?c.some(b[0]):c.none()},tail:function(b){return 0<b.length?c.some(b.slice(1)):c.none()},toLast:function(b){return 0<b.length?c.some(b[b.length-1]):c.none()},box:function(b){return[b]},isBefore:d}});k("mi",["b","7","4n","tv"],function(c,d,b,a){b=b.generate([{quasi:["elements"]},{block:["element"]},{container:["element","children"]},{fixture:["element"]}]);var e=function(a){return a.fold(function(a){return"@q["+
c.map(a,function(a){return a.dom().outerHTML||'"'+a.dom().nodeValue+'"'}).join(",")+"]"},function(a){return"@"+a.dom().nodeName.toLowerCase()+"("+a.dom().innerHTML+")"},function(a,b){return"#"+a.dom().nodeName.toLowerCase()+"("+c.map(b,e).join(",")+")"},function(a){return a.dom().nodeName.toLowerCase()})},g=function(a){var b=function(a){return[a]};return a.fold(d.identity,b,b,b)},f=d.constant(!0),h=d.constant(!1);return{cata:function(a,b,c,d,e){return a.fold(b,c,d,e)},quasi:b.quasi,block:b.block,
container:b.container,fixture:b.fixture,isQuasi:function(a){return a.fold(f,h,h,h)},isFixture:function(a){return a.fold(h,h,h,f)},isQuasiOrFixture:function(a){return a.fold(f,h,h,f)},toTarget:g,toString:e,toLastTarget:function(b){return a.toLast(g(b))}}});k("11q",["7"],function(c){var d=function(b,a){return{fold:b,label:c.constant(a)}};return{before:function(b){return d(function(a,c,d,f,h){return a(b)},"before")},after:function(b){return d(function(a,c,d,f,h){return c(b)},"after")},rest:function(b){return d(function(a,
c,d,f,h){return d(b)},"rest")},last:function(b){return d(function(a,c,d,f,h){return f(b)},"last")},invalid:function(b,a){return d(function(c,d,f,h,l){return l(b,a)},"invalid")}}});k("uf",["b","s","eg","h4","k2"],function(c,d,b,a,e){return{subdivide:function(g,f,h){var l=g.property().getText(f);h=c.filter(e.splits(l,h),function(a){return 0<a.length});if(1>=h.length)return[b.range(f,0,l.length)];g.property().setText(f,h[0]);var l=a.generate(h.slice(1),function(a,c){var e=g.create().text(a),e=b.range(e,
c,c+a.length);return d.some(e)},h[0].length),m=c.map(l,function(a){return a.element()});g.insert().afterAll(f,m);return[b.range(f,0,h[0].length)].concat(l)}}});k("yx",["7"],function(c){var d=function(b,a){return{fold:b,label:c.constant(a)}};return{none:function(){return d(function(b,a,c,d){return b()},"none")},start:function(b){return d(function(a,c,d,f){return c(b)},"start")},middle:function(b,a){return d(function(c,d,f,h){return f(b,a)},"middle")},end:function(b){return d(function(a,c,d,f){return f(b)},
"end")}}});k("ug",["yx"],function(c){return{determine:function(d){return d.before().fold(function(){return d.after().fold(function(){return c.none()},function(b){return c.start(b)})},function(b){return d.after().fold(function(){return c.end(b)},function(a){return c.middle(b,a)})})}}});k("11u",["7","s"],function(c,d){var b=c.constant(!1),a=c.constant(!0),e=function(e){return{isBoundary:function(){return e(a,b,b)},fold:e,toText:function(){return e(d.none,d.none,function(a,b){return d.some(a)})},is:function(a){return e(b,
b,function(b,c){return c.eq(b,a)})},len:function(){return e(c.constant(0),c.constant(1),function(a,b){return b.property().getText(a).length})}}};return{text:function(a,b){return e(function(c,d,e){return e(a,b)})},boundary:function(a,b){return e(function(c,d,e){return c(a,b)})},empty:function(a,b){return e(function(c,d,e){return d(a,b)})},cata:function(a,b,c,d){return a.fold(b,c,d)}}});k("158",["b","7"],function(c,d){return{boundAt:function(b,a,e,g){a=c.findIndex(b,d.curry(g,a));a=-1<a?a:0;e=c.findIndex(b,
d.curry(g,e));return b.slice(a,-1<e?e+1:b.length)}}});k("159",["b"],function(c){return{sliceby:function(d,b){var a=c.findIndex(d,b);return d.slice(0,a)}}});k("148",["4n"],function(c){c=c.generate([{include:["item"]},{excludeWith:["item"]},{excludeWithout:["item"]}]);return{include:c.include,excludeWith:c.excludeWith,excludeWithout:c.excludeWithout,cata:function(c,b,a,e){return c.fold(b,a,e)}}});k("15a",["b","148"],function(c,d){var b=function(a,b){var g=[],f=[];c.each(a,function(a){var c=b(a);d.cata(c,
function(){f.push(a)},function(){0<f.length&&g.push(f);g.push([a]);f=[]},function(){0<f.length&&g.push(f);f=[]})});0<f.length&&g.push(f);return g};return{splitby:function(a,c){return b(a,function(a){return c(a)?d.excludeWithout(a):d.include(a)})},splitbyAdv:b}});k("147",["158","159","15a"],function(c,d,b){return{splitby:function(a,c){return b.splitby(a,c)},splitbyAdv:function(a,c){return b.splitbyAdv(a,c)},sliceby:function(a,b){return d.sliceby(a,b)},boundAt:function(a,b,d,f){return c.boundAt(a,b,
d,f)}}});k("11v",["b","7","s","eg","147"],function(c,d,b,a,e){return{count:function(a){return c.foldr(a,function(a,b){return b.len()+a},0)},dropUntil:function(a,b){return e.sliceby(a,function(a){return a.is(b)})},gen:function(c,d){return c.fold(b.none,function(c){return b.some(a.range(c,d,d+1))},function(e){return b.some(a.range(e,d,d+c.len()))})},justText:function(a){return c.bind(a,function(a){return a.fold(d.constant([]),d.constant([]),function(a){return[a]})})}}});k("yu",["b","eg","11u","11v"],
function(c,d,b,a){var e=function(a,d,g){if(a.property().isText(d))return[b.text(d,a)];if(a.property().isEmptyTag(d))return[b.empty(d,a)];if(a.property().isElement(d)){var m=a.property().children(d),n=a.property().isBoundary(d)?[b.boundary(d,a)]:[];d=void 0!==g&&g(d)?[]:c.bind(m,function(b){return e(a,b,g)});return n.concat(d).concat(n)}return[]},g=function(b,c,g,m,n){b=e(b,m,n);c=a.dropUntil(b,c);c=a.count(c);return d.point(m,c+g)};return{typed:e,items:function(a,b,d){a=e(a,b,d);var g=function(a,
b){return a};return c.map(a,function(a){return a.fold(g,g,g)})},extractTo:function(a,b,c,e,n){return a.up().predicate(b,e).fold(function(){return d.point(b,c)},function(d){return g(a,b,c,d,n)})},extract:function(a,b,c,e){return a.property().parent(b).fold(function(){return d.point(b,c)},function(d){return g(a,b,c,d,e)})}}});k("yv",["b","7","yu"],function(c,d,b){var a=function(a,b){return"img"===b.property().name(a)?" ":"\n"};return{from:function(e,g,f){g=b.typed(e,g,f);return c.map(g,function(b){return b.fold(d.constant("\n"),
a,e.property().getText)}).join("")}}});k("yw",["eg","yu","11v","h4"],function(c,d,b,a){return{find:function(e,g,f,h){e=d.typed(e,g,h);e=a.generate(e,b.gen);return a.get(e,f).map(function(a){return c.point(a.element(),f-a.start())})}}});k("ue",["yu","yv","yw"],function(c,d,b){return{extract:function(a,b,d,f){return c.extract(a,b,d,f)},extractTo:function(a,b,d,f,h){return c.extractTo(a,b,d,f,h)},all:function(a,b,d){return c.items(a,b,d)},from:function(a,b,d){return c.typed(a,b,d)},find:function(a,c,
d,f){return b.find(a,c,d,f)},toText:function(a,b,c){return d.from(a,b,c)}}});k("11r",["b","ue","11u","147","148"],function(c,d,b,a,e){return{group:function(g,f,h){f=c.bind(f,function(a){return d.from(g,a,h)});f=a.splitbyAdv(f,function(a){return b.cata(a,function(){return e.excludeWithout(a)},function(){return e.excludeWith(a)},function(){return e.include(a)})});return c.filter(f,function(a){return 0<a.length})}}});k("149",["b","s"],function(c,d){return{common:function(b,a,e){a=[a].concat(b.up().all(a));
var g=[e].concat(b.up().all(e));e=c.find(a,function(a){return c.exists(g,function(c){return b.eq(c,a)})});return d.from(e)}}});k("14a",["b"],function(c){var d="table tbody thead tfoot tr ul ol".split(" ");return function(b){var a=b.property(),e=function(b,d){return a.parent(b).map(a.name).map(function(a){return!c.contains(d,a)}).getOr(!1)};return{validateText:function(b){return a.isText(b)&&e(b,d)}}}});k("11s",["b","7","ue","149","14a"],function(c,d,b,a,e){return{range:function(g,f,h,l,m){return g.eq(f,
l)?[f]:a.common(g,f,l).fold(function(){return[]},function(a){a=[a].concat(b.all(g,a,d.constant(!1)));var p=c.findIndex(a,d.curry(g.eq,f)),r=c.findIndex(a,d.curry(g.eq,l));a=-1<p&&-1<r?p<r?a.slice(p+h,r+m):a.slice(r+m,p+h):[];p=e(g);return c.filter(a,p.validateText)})}}});k("yy",["11r","11s"],function(c,d){return{range:function(b,a,c,g,f){return d.range(b,a,c,g,f)},group:function(b,a,d){return c.group(b,a,d)}}});k("yz",["2u"],function(c){return c.immutable("before","after")});k("ui",["b","s","yz",
"k2"],function(c,d,b,a){var e=function(b,c,d){b=b.property().getText(c);return a.splits(b,d)},g=function(a,b,d,m){if(!a.property().isText(b)||d===m)return b;if(d>m)return g(a,b,m,d);var n=a.property().getText(b).length;if(0===d&&m===n)return b;m=e(a,b,[d,m]);a.property().setText(b,m[0]);m=c.map(m.slice(1),function(b){return a.create().text(b)});n=m[0];a.insert().afterAll(b,m);return 0===d?b:n};return{split:function(a,c,g){if(!a.property().isText(c)||0>=g)return b(d.none(),d.some(c));if(g>=a.property().getText(c).length)return b(d.some(c),
d.none());g=e(a,c,[g]);a.property().setText(c,g[0]);g=a.create().text(g[1]);a.insert().after(c,g);return b(d.some(c),d.some(g))},splitByPair:g}});k("uh",["eg","yy","ui"],function(c,d,b){var a=function(a,e,h,l,m){h=b.split(a,e,h).after().fold(function(){return c.delta(e,1)},function(a){return c.delta(a,0)});m=b.split(a,l,m).before().fold(function(){return c.delta(l,0)},function(a){return c.delta(a,1)});return d.range(a,h.element(),h.deltaOffset(),m.element(),m.deltaOffset())},e=function(a,c,d,e,m){return[b.splitByPair(a,
c,d,m)]};return{nodes:function(b,c,d,l,m){return(b.eq(c,l)?e:a)(b,c,d,l,m)}}});k("ov",["uf","ug","uh","ui"],function(c,d,b,a){return{split:function(b,c,d){return a.split(b,c,d)},splitByPair:function(b,c,d,h){return a.splitByPair(b,c,d,h)},range:function(a,c,d,h,l){return b.nodes(a,c,d,h,l)},subdivide:function(a,b,d){return c.subdivide(a,b,d)},position:function(a,b){return d.determine(b)}}});k("yq",["7","11q","ov"],function(c,d,b){var a=function(a,c,e){var l=b.split(a,c,e);return b.position(a,l).fold(function(){return d.invalid(c,
e)},d.before,d.after,d.after)},e=function(a,b,c){a=a.property().children(b);return c===a.length?d.last(b):c<a.length?d.rest(a[c]):d.invalid(b,c)};return{atStartOf:function(b,d,h,l){var m=function(a){b.insert().before(a,l)};(b.property().isText(d)?a:e)(b,d,h).fold(m,function(a){b.insert().after(a,l)},m,function(a){b.insert().append(a,l)},c.noop)}}});k("u8",["yq"],function(c){return{atStartOf:function(d,b,a,e){c.atStartOf(d,b,a,e)}}});k("u3",["6","7","4n"],function(c,d,b){b=b.generate([{none:[]},{root:["target",
"block"]},{created:["target","block"]},{actual:["target","block"]}]);return c.merge(b,{toString:function(a){return a.fold(function(){return["block.none"]},function(a,b){return["block.root",a,b]},function(a,b){return["block.created",a,b]},function(a,b){return["block.actual",a,b]})},cata:function(a,b,c,d,h){return a.fold(b,c,d,h)},extract:function(a){var b=d.constant([]),c=function(a,b){return[b]};return a.fold(b,b,c,c)},extractEvenRoot:function(a){var b=d.constant([]),c=function(a,b){return[b]};return a.fold(b,
c,c,c)}})});k("tz",["s","eg"],function(c,d){var b=function(a,c){if(a.property().isText(c))return d.point(c,a.property().getText(c).length);var e=a.property().children(c);return 0<e.length?b(a,e[e.length-1]):d.point(c,e.length)},a=function(c,e,f){var g=c.property().children(e);return 0<g.length&&f<g.length?a(c,g[f],0):0<g.length&&c.property().isElement(e)&&g.length===f?b(c,g[g.length-1]):d.point(e,f)},e=function(a,b,d){return!a.property().isText(b)||0<a.property().getText(b).trim().length?c.none():
d(b).bind(function(b){return e(a,b,d).orThunk(function(){return c.some(b)})})},g=function(a,b){var c=e(a,b,a.query().nextSibling).getOr(b);if(a.property().isText(c))return d.point(c,0);var f=a.property().children(c);return 0<f.length?g(a,f[0]):d.point(c,0)},f=function(a,b){return a.property().isText(b)?a.property().getText(b).length:a.property().children(b).length},h=function(a,b){var c=e(a,b,a.query().prevSibling).getOr(b);if(a.property().isText(c))return d.point(c,f(a,c));var g=a.property().children(c);
return 0<g.length?h(a,g[g.length-1]):d.point(c,f(a,c))};return{toLast:b,toLeaf:a,toLower:function(a,b){var c=a.property().isText(b)?a.property().getText(b).length:a.property().children(b).length;return d.point(b,c)},freefallLtr:g,freefallRtl:h}});k("lm",["tz"],function(c){return{toLeaf:function(d,b,a){return c.toLeaf(d,b,a)},freefallLtr:function(d,b){return c.freefallLtr(d,b)},freefallRtl:function(d,b){return c.freefallRtl(d,b)}}});k("ty","b 7 s lm i7 lz".split(" "),function(c,d,b,a,e,g){var f=function(a,
b){return function(c){return a.eq(c,b)||a.property().parent(c).map(function(c){return a.eq(c,b)}).getOr(!1)}},h=function(a,c,d){return a.eq(c,d)?b.none():a.property().isBoundary(d)?a.query().nextSibling(d):a.property().isEmptyTag(d)?(c=f(a,c),c(d)?a.query().nextSibling(d):g.breakPath(a,d,c,g.breakToRight).second()):b.none()},l=function(a,c,d){if(a.eq(c,d))return b.none();if(a.property().isBoundary(d))return a.query().prevSibling(d);if(a.property().isEmptyTag(d)){var e=f(a,c);return e(d)?a.query().prevSibling(d):
a.query().prevSibling(d).map(function(b){return g.breakPath(a,b,e,g.breakToRight).first()})}return b.none()},m=function(a,d,e,f){return e(a,d,f).bind(function(e){var f=a.property().children(d),f=c.findIndex(f,function(b){return a.eq(b,e)});return-1<f?b.some(f):b.none()})},n=function(a,b){return a.property().isEmptyTag(b)||a.property().isBoundary(b)};return{create:function(b,c,f){if(n(b,f)||n(b,a.toLeaf(b,f,0).element()))return[f];var g=d.curry(n,b),t=d.curry(b.eq,c),u=e.seekLeft(b,f,g,t).bind(function(a){return m(b,
c,h,a)}).getOr(0),v=b.property().children(c);f=e.seekRight(b,f,g,t).bind(function(a){return m(b,c,l,a)}).getOr(v.length-1);return b.property().children(c).slice(u,f+1)}}});k("tw","b s u8 u3 ty 1s".split(" "),function(c,d,b,a,e,g){var f=function(a,b,c,e){return c(b)||e(b)?d.some(b):a.up().predicate(b,c,e)},h=function(b,c,d){d=d();b.insert().wrap(c,d);return a.created(c,d)},l=function(b,d,e,f){var g=f();b.insert().before(e[0],g);c.each(e,function(a){b.insert().append(g,a)});return a.created(d,g)},m=
function(c,d,f,m,s,t,u){if(t(f)){var v=c.property().children(d);if(m<v.length&&u(v[m]))return a.actual(f,v[m])}return s(d).fold(function(){return a.root(f,d)},function(s){if(t(f)){var u=s(),v=c.property().children(d),k=v[m];void 0!==k&&(s=e.create(c,d,k,s),c.insert().appendAll(u,0<s.length?s:[k]));b.atStartOf(c,d,g.min(v.count,m),u);return a.created(d,u)}c.property().isEmptyTag(f)?s=h(c,f,s):(u=e.create(c,d,f),s=0<u.length?l(c,f,u,s):h(c,f,s));return s})};return{single:function(b,c,d,e,g,h){return f(b,
d,c,h).fold(a.none,function(f){return h(f)?m(b,f,d,e,g,h,c):a.actual(d,f)})}}});k("m4",["4g"],function(c){return{resolve:c.create("ephox-soldier").resolve}});k("lq","b 7 s m4 1y 21 2q 4e 2a".split(" "),function(c,d,b,a,e,g,f,h,l){var m=a.resolve("quasi-block"),n=function(a){a=l.children(a);return 1===a.length&&"br"===g.name(a[0])},p=function(a){return e.has(a,m)&&!n(a)};return{condense:function(a){a=c.filter(a,function(a,b){if(!g.isElement(a))return!0;var c;e.has(a,m)&&n(a)&&(l.prevSibling(a).exists(p)||
l.nextSibling(a).exists(p))?(f.remove(a),c=!1):c=!0;return c});return c.map(a,function(a){var b=g.isElement(a)?[a].concat(h.descendants(a,"."+m)):[];c.each(b,function(a){e.remove(a,m)});return a})},register:function(a){return function(b){return a(b).map(function(a){return function(){var b=a();e.add(b,m);return b}})}},style:d.constant(m)}});k("nz",["dy","b","tw","lq","21"],function(c,d,b,a,e){var g=c();return{single:function(c,d,e,m,n){return b.single(g,c,d,e,a.register(m),n)},isBlock:function(a){return d.contains("ol p div ul table caption td th h1 h2 h3 h4 h5 h6 body blockquote pre".split(" "),
e.name(a))}}});k("mh",["7"],function(c){return{tag:function(){return"p"},nu:function(d){return c.curry(d.create().nu,"p")}}});k("tx",["s","4n"],function(c,d){var b=function(a){return 0<a.length?c.some(a[0]):c.none()},a=d.generate([{descend:["index"]},{leftOf:["rindex"]},{bounded:["lindex","rindex"]},{rightOf:["lindex"]},{all:[]}]);return{derive:function(c,d){return c.bind(b).fold(function(){return d.bind(b).fold(function(){return a.all()},function(b){return a.leftOf(b)})},function(c){return d.bind(b).fold(function(){return a.rightOf(c)},
function(b){return c===b?a.descend(c):a.bounded(c,b)})})},cata:function(a,b,c,d,l,m){return a.fold(b,c,d,l,m)}}});k("lp","s i7 ln tv mi tx ty".split(" "),function(c,d,b,a,e,g,f){var h=function(a,b,d){return c.from(a.property().children(b)[d])},l=function(a,b,c){var d=a.property().children(c),f=h(a,c,0).bind(function(e){return h(a,c,d.length-1).map(function(d){return m(a,b,c,e,d)})}).getOr([]);return e.container(c,f)},m=function(a,b,f,g,h){var l=n(a,f,b,g);return e.toLastTarget(l).filter(function(b){return!a.eq(h,
b)}).bind(function(e){return d.walk(a,e,d.sidestep,d.walkers().right()).bind(function(d){if(a.eq(f,d.item()))return c.none();d=m(a,b,f,d.item(),h);return c.some([l].concat(d))})}).getOrThunk(function(){return[l]})},n=function(a,c,d,g){if(b.isFormatting(a,g))return e.block(g);if(b.isEmptyTag(a,g))return e.fixture(g);if(b.isBlock(a,g)||b.isContainer(a,g))return l(a,d,g);a=f.create(a,c,g);return e.quasi(0<a.length?a:[g])},p=function(a,b,c){return n(a,c,b,c)},r=function(b,d,f,g,h,l,n,p){f=f.map(function(e){return q(b,
d,e,n.bind(a.tail),c.none())}).getOr([]);h=h.map(function(e){return q(b,d,e,c.none(),p.bind(a.tail))}).getOr([]);g=0===g.length?[]:m(b,d,l,g[0],g[g.length-1]);return[e.container(l,f.concat(g).concat(h))]},q=function(b,d,e,f,h){var l=b.property().children(e);f.bind(a.head).getOr(0);h.bind(a.head).getOr(l.length-1);var m=g.derive(f,h);return g.cata(m,function(c){return q(b,d,l[c],f.bind(a.tail),h.bind(a.tail))},function(a){return r(b,d,c.none(),l.slice(0,a),c.from(l[a]),e,f,h)},function(a,g){return r(b,
d,c.from(l[a]),l.slice(a+1,g),c.from(l[g]),e,f,h)},function(a){return r(b,d,c.from(l[a]),l.slice(a+1),c.none(),e,f,h)},function(){return[p(b,d,e)]})};return{categorise:p,within:function(b,d,e,f,g){return!0===a.isBefore(f,g)?q(b,d,e,c.some(f),c.some(g)):q(b,d,e,c.some(g),c.some(f))}}});k("mj","dy b 7 s mh mi lp lq 1y 1b l 2o 3c 21 2q ak".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t){var u=function(a,b){if("li"!==q.name(a))return!1;var c=d.foldl(b,function(a,b){return 1<a.quasi||0<a.nonlist?
a:g.cata(b,function(){return{quasi:1+a.quasi,nonlist:a.nonlist}},function(){return{quasi:a.quasi,nonlist:1+a.nonlist}},function(b){return{quasi:a.quasi,nonlist:(d.contains(["ul","ol"],q.name(b))?0:1)+a.nonlist}},function(){return{quasi:1+a.quasi,nonlist:a.nonlist}})},{quasi:0,nonlist:0});return 1>=c.quasi&&0===c.nonlist},v=function(a,b,c){return 0>=c.length?!0:d.contains(a,q.name(b))?2<c.length?!1:1===c.length?g.isQuasiOrFixture(c[0]):g.isQuasiOrFixture(c[0])&&g.isQuasiOrFixture(c[1])&&!d.forall(c,
g.isFixture):!1};return{wrap:function(a){if(0===a.length||1===a.length&&q.isText(a[0])&&0===t.get(a[0]).trim().length)return[];var b=n.fromTag(e.tag());l.add(b,h.style());p.before(a[0],b);r.append(b,a);return[b]},handleContainer:function(a,b,c,e){if(v(a,b,c))return[b];var f=u(b,c)?[b]:[];return f.concat(d.bind(c,function(a){return e(a,0<f.length)}))},hasSimpleContent:v,isNestedList:u,handleRoot:function(d,h){var l=f.categorise(c(),b.curry(m.eq,h),h,h,h),n=function(){return a.some(e.nu(c()))},p=a.none;
return g.cata(l,n,p,function(a,b){return v(d,a,b)||u(a,b)?p():n()},n)}}});k("lk","b 7 ep lu mi nz mj 21".split(" "),function(c,d,b,a,e,g,f,h){var l=["li","td","th","caption"],m=function(a,b){return e.cata(a,function(a){return!0===b?[]:f.wrap(a)},function(a){return[a]},function(a,b){return f.handleContainer(l,a,b,m)},function(a){return!0===b?[]:f.wrap([a])})};return{isRootContainer:a.isRootOrContainer,extract:function(a){return m(a,!1)},isCapable:function(a){return g.isBlock(a)||c.contains(l,h.name(a))},
canUse:function(a){return b.isFormatting(a)||c.contains(l,h.name(a))},quasi:d.curry(f.handleRoot,l),ascend:d.identity}});k("ip",["dy","lm"],function(c,d){var b=c();return{toLeaf:function(a,c){return d.toLeaf(b,a,c)},freefallLtr:function(a){return d.freefallLtr(b,a)},freefallRtl:function(a){return d.freefallRtl(b,a)}}});k("dk",["d6","s","2u"],function(c,d,b){var a=b.immutableBag(["start","soffset","finish","foffset","all"],[]),e=b.immutableBag(["start","soffset","finish","foffset"],[]);return{block:a,
inline:e,blockFrom:function(b){return 0<b.length?d.some(a({start:b[0],soffset:0,finish:b[b.length-1],foffset:c.getEnd(b[b.length-1]),all:b})):d.none()},inlineFrom:function(a){return a.map(function(a){return e({start:a.start(),soffset:a.soffset(),finish:a.finish(),foffset:a.foffset()})})}}});k("n0",["7","s","1b","2a"],function(c,d,b,a){var e=function(b,c){return c(b)?d.some([]):a.parent(b).bind(function(d){return a.findIndex(b).bind(function(a){return e(d,c).map(function(b){return b.concat([a])})})})},
g=function(b,c){return 0===c.length?d.some(b):a.child(b,c[0]).bind(function(a){return g(a,c.slice(1))})};return{path:function(a,g){var l=c.curry(b.eq,a);return b.eq(a,g)?d.some([]):e(g,l)},follow:g}});k("lo","d6 s eg ip fp 2u u3 nz 1b l n0 2o".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p){var r=g.immutable("ancestor","startPath","finishPath"),q=function(a,b,c){return e.ancestors(b,c,a).shared().bind(function(a){return n.path(a,b).bind(function(b){return n.path(a,c).map(function(c){return r(a,b,c)})})})},
s=function(a,b,c,e){var g=b.isRootContainer(a);c=h.single(b.isCapable,c,e,b.quasi,g);c=f.extractEvenRoot(c);return 1===c.length?d.some(c[0]).map(function(c){return b.ascend(c,a)}):d.none()},t=function(d,e,f,g){return d.isRootContainer(e)(f)?(g<c.getEnd(f)||d.isCapable(f)&&d.canUse(f)?f=a.toLeaf(f,g):(d=m.fromTag("br"),p.append(f,d),f=b.point(d,0)),f):b.point(f,g)};return{branch:function(a,b,c,e,f,g){var h=t(b,a,c,e),m=t(b,a,f,g);return s(a,b,h.element(),h.offset()).bind(function(c){return(l.eq(h.element(),
m.element())&&h.offset()===m.offset()?d.some(c):s(a,b,m.element(),m.offset())).bind(function(b){return l.eq(c,b)?d.some(r(c,[],[])):q(a,c,b)})})}}});k("e1","dy b d6 s eg ip ep dk lo lp lq 2m lf l 2o 21 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u){var v=function(c,f,h,l,m,n,r){c=f.isRootContainer(c)(h);f=!c&&p.inBody(h)?e.point(h,l):c||!f.isCapable(h)||p.inBody(h)?p.inBody(m.element())&&d.contains(["td","th"],t.name(h))?m:!p.inBody(h)&&p.inBody(n.element())&&"br"==t.name(n.element())?
n:g.toLeaf(r,0):e.point(r,l);b.getEnd(f.element());return f.offset()<=b.getEnd(f.element())?a.some(f):a.none()};return{applyOn:function(b,p,t,k,z,A,C){var D=r.after(t,k,z,A),F=p.isRootContainer(b)(t)?g.toLeaf(t,k):e.point(t,k),E=p.isRootContainer(b)(z)?g.toLeaf(z,A):e.point(z,A),G=g.toLeaf(t,k),H=g.toLeaf(z,A),I=l.branch(b,p,t,k,z,A).map(function(a){return m.within(c(),b,a.ancestor(),a.startPath(),a.finishPath())}).getOr([]),I=d.bind(I,p.extract);d.each(I,function(a){0===u.children(a).length&&f.isFormatting(a)&&
s.append(a,q.fromTag("br"))});var I=n.condense(I),L=C(I);return 0===L.length?a.none():v(b,p,t,k,F,G,L[D?L.length-1:0]).bind(function(a){return v(b,p,z,A,E,H,L[D?0:L.length-1]).map(function(b){return h.block({start:a.element(),soffset:a.offset(),finish:b.element(),foffset:b.offset(),all:L})})})}}});k("lr",["2n","bl","21"],function(c,d,b){var a=function(a){return function(b){return a}},e={start:d.onDirection("left","right"),end:d.onDirection("right","left"),justify:a("justify"),center:a("center"),"match-parent":a("match-parent")};
return{hasAlignment:function(a,d,h){b.isText(a)?a=!1:(d=c.get(a,d),a=(void 0!==e[d]?e[d](a):d)===h);return a}}});k("ls",["2n"],function(c){return function(d,b){return{is:function(a){return c.get(a,d)===b},remove:function(a){c.remove(a,d)},set:function(a){c.set(a,d,b)}}}});k("d9","b 7 lj lk e1 lr ls".split(" "),function(c,d,b,a,e,g,f){var h=function(a,b,c){return g.hasAlignment(c,a,b)},l=function(g,l,m){var n=f(l,m);return{run:function(b,d,f,g,h){return e.applyOn(b,a,d,f,g,h,function(a){var b=c.forall(a,
n.is)?n.remove:n.set;c.each(a,b);return a})},query:function(a,c){var e=d.curry(h,l,m);return b.bothMatch(a,c,e)},name:d.constant(g)}},m=l("JustifyLeft","text-align","left"),n=l("JustifyCenter","text-align","center"),p=l("JustifyRight","text-align","right"),l=l("JustifyFull","text-align","justify");return{justifyleft:d.constant(m),justifycentre:d.constant(n),justifyright:d.constant(p),justifyfull:d.constant(l)}});k("df",["s","2n","35"],function(c,d,b){var a=function(a){a=a.dom();if(b.isSupported(a)){var c=
a.style.marginLeft;return"auto"===a.style.marginRight&&"auto"===c}return!1};return{isCentered:a,divine:function(b){if(a(b))return c.some("center");var g=d.getRaw(b,"float").getOrThunk(function(){return d.get(b,"float")});return void 0!==g&&null!==g&&0<g.length?c.some(g):c.none()},getRaw:function(a){return d.getRaw(a,"float").getOr(null)},setCentered:function(a){d.setAll(a,{"margin-left":"auto","margin-right":"auto"})}}});k("da",["7","s","2n","df","21"],function(c,d,b,a,e){var g={left:{"float":"left",
margin:""},right:{"float":"right",margin:""},none:{"float":"none",margin:""},center:{"float":"",margin:"0 auto"}},f={none:{display:""},left:{display:""},right:{display:""},center:{display:"block"}},h=function(b,c){return a.divine(b).is(c)},l=function(a,c){var h="img"===e.name(a)&&void 0!==f[c]?f[c]:{};d.from(g[c]).each(function(c){b.setAll(a,c);b.setAll(a,h)})},m=function(a,b){return{run:function(a){l(a,b);return d.none()},query:function(a){return h(a,b)},name:c.constant(a)}},n=m("JustifyLeft","left"),
p=m("JustifyCenter","center"),r=m("JustifyRight","right"),m=m("FloatNone","none");return{floatnone:c.constant(m),floatleft:c.constant(n),floatcentre:c.constant(p),floatright:c.constant(r),queryIsFloat:h,runFloat:l}});k("u4",["2u"],function(c){return c.immutable("level","content","cruft","list","item")});k("lt",["u4"],function(c){return{level:function(d,b){return c(d.level()+b,d.content(),d.cruft(),d.list(),d.item())},list:function(d,b){return c(d.level(),d.content(),d.cruft(),b,d.item())}}});k("lv",
"dy b 7 s ep mh lu mi nz mj 21".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){var p=function(a){return h.cata(a,function(a){return m.wrap(a)},function(a){return[a]},function(a,b){return d.bind(b,p)},function(a){return m.wrap([a])})};return{isRootContainer:f.isRootOrContainer,extract:p,isCapable:function(a){return l.isBlock(a)||"li"===n.name(a)},canUse:function(a){return e.isFormatting(a)},quasi:function(b){return a.some(g.nu(c()))},ascend:b.identity}});k("u6",["b","ln","2u"],function(c,d,b){var a=b.immutable("elements",
"elementsTransformed"),e=b.immutable("original","replaced"),g=b.immutable("result","items");return{answer:a,write:function(b,h){var l=[],m=function(a){var c=b.create().nu("p");b.insert().appendAll(c,a);return c},n=function(a){if(0===a.length)throw"Cannot get tail of an empty array";return a.slice(1)},p=function(a,d){for(var e=b.create().clone(d[0].list()),h=[];0<d.length&&d[0].level()>=a;){var l;if(d[0].level()===a){var m=a;l=d;var r=l[0],k;k=r;var B=k.item(),z=B,z=b.property().children(z);c.each(z,
b.remove().remove);b.insert().appendAll(B,k.content());k=B;r=r.cruft();l=n(l);0<l.length&&l[0].level()>m&&(m=p(m+1,l),l=m.items(),b.insert().append(k,m.result()));b.insert().appendAll(k,r);l=g(k,l);l=g([l.result()],l.items())}else l=p(a+1,d),m=b.create().nu("li"),b.styles().set(m,"list-style-type","none"),b.attrs().remove(e,"id"),b.insert().append(m,l.result()),l=g([m],l.items());d=l.items();h=h.concat(l.result())}b.insert().appendAll(e,h);return g(e,d)},r=function(a){for(var c=[];0<a.length;){var h=
a[0];if(0===h.level()){var r;r=a[0];var v=r.content(),v=1===v.length&&d.isBlock(b,v[0])?v[0]:m(v);l.push(e(r.item(),v));r=g([v],n(a));a=r.items();c=c.concat(r.result());for(r=[];0<a.length&&0<a[0].level();)v=p(1,a),a=v.items(),r=r.concat([v.result()]);r=g(r,a);a=r.items();c=c.concat(r.result());0<h.cruft().length&&(c=c.concat([m(h.cruft())]))}else h=p(1,a),a=h.items(),c=c.concat([h.result()])}return g(c,a)}(h);if(0!==r.items().length)throw"Error - there should not be any remaining items to parse";
return a(r.result(),l)}}});k("u5",["b","u6"],function(c,d){var b=function(a){return c.foldl(a,function(a,b){var c=a.elements().concat(b.elements()),h=a.elementsTransformed().concat(b.elementsTransformed());return d.answer(c,h)},d.answer([],[]))};return{combine:b,write:function(a,e){var g=c.groupBy(e,function(b){return a.property().name(b.list())+"-"+a.styles().getRaw(b.list(),"list-style-type").getOr("default")}),g=c.map(g,function(b){return d.write(a,b)});return b(g)}}});k("mk",["dy","u5","u6"],
function(c,d,b){var a=c();return{groupWrite:function(b){return d.write(a,b)},write:function(c){return b.write(a,c)}}});k("ml","b 7 s ep 1b 21 6h 4e 31 1s".split(" "),function(c,d,b,a,e,g,f,h,l,m){var n=function(a,b,c){return l.closest(a,"li",c).bind(function(a){return b(a,c).map(function(b){return{item:d.constant(a),outerlist:d.constant(b)}})})},p=function(a,b){return c.findIndex(a,function(a){return e.eq(a,b)})};return{context:function(a,c,f,g,l){return n(a,f,l).bind(function(v){return n(c,f,l).bind(function(f){if(e.eq(v.outerlist(),
f.outerlist())){var l;if(e.eq(a,c))l=[v.item()];else{l=v.outerlist();var n=v.item(),s=f.item();l=h.descendants(l,"li");var n=p(l,n),u=p(l,s),s=m.min(n,u),n=m.max(n,u);l=(-1<s&&-1<n?b.some(l.slice(s,n+1)):b.none()).getOr([])}f=b.some({outerlist:v.outerlist,startItem:v.item,finishItem:f.item,writer:d.constant(g),selected:d.constant(l)})}else f=b.none();return f})})},immediate:function(a,b){return l.closest(a,"ul,ol",b)},topmost:function(d,e){var h=f.ancestors(d,function(b){return a.isList(b)||a.isContainer(b)},
e),l=c.findIndex(h,function(a){return!c.contains(["li","ol","ul"],g.name(a))});return 0<l&&l-1<h.length?b.some(h[l-1]):0<h.length?b.some(h[h.length-1]):b.none()}}});k("lw",["lt","mk","ml"],function(c,d,b){return{context:function(a,c,g){return b.context(a,c,b.topmost,d.write,g)},indent:function(a){return c.level(a,1)},outdent:function(a){return c.level(a,-1)}}});k("lx",["b","1b"],function(c,d){var b=function(a,b){var g=c.find(a,function(a){return d.eq(b,a)});return null!==g&&void 0!==g};return{operate:function(a,
d,g){return c.map(d,function(c){return b(g,c.item())?a(c):c})}}});k("u7",["b","s","2u"],function(c,d,b){var a=b.immutable("before","on","after");return{refine:function(b,g){var f=c.findIndex(b,g),h=a(b,d.none(),[]);if(-1===f)f=h;else var h=d.from(b[f]),l=b.slice(0,f),f=b.slice(f+1),f=a(l,h,f);return f}}});k("ly","b u4 u7 2n 21 4e m 2a".split(" "),function(c,d,b,a,e,g,f,h){var l=function(a,b){var d=g.children(a,"li,ol,ul");return c.bind(d,function(c){return"li"===e.name(c)?m(a,c,b):l(c,b+1)})},m=function(b,
c,e){var f=p(c),g="none"===a.get(c,"list-style-type")?[]:[d(e,f.before(),f.after(),b,c)];return f.on().fold(function(){return g},function(a){a=l(a,e+1);return g.concat(a)})},n=function(a){return f.is(a,"ol,ul")},p=function(a){a=h.children(a);return b.refine(a,n)};return{read:function(a){return l(a,1)}}});k("e3","b lx ly 7 s dk 1a 1b 2n 3c 2q 1s".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p){var r=function(a){a=a.elementsTransformed();c.each(a,function(a){l.transfer(a.original(),a.replaced(),["text-align"]);
f.transfer(a.original(),a.replaced(),["dir"])})},q=function(a,b){var d=c.find(b,function(b){return h.eq(b.original(),a)});return void 0!==d&&null!==d?d.replaced():a},s=function(a,c,f,h,l,p){if(0===a.selected().length)return e.none();var s=a.writer(),k=a.outerlist();a=a.selected();var A=b.read(k);p=p(a);p=d.operate(p,A,a);s=s(p);r(s);m.before(k,s.elements());n.remove(k);k=s.elementsTransformed();c=q(c,k);h=q(h,k);return e.some(g.block({start:c,soffset:f,finish:h,foffset:l,all:s.elements()}))};return{execute:function(b,
c,d,e,f,g){return s(b,c,d,e,f,a.constant(g))},executeUsing:s}});k("db","dy b lt lu e1 lv lw e3".split(" "),function(c,d,b,a,e,g,f,h){c();var l=function(a,b,c,f,h,l,m){return e.applyOn(a,g,b,c,f,h,function(a){d.each(a,function(a){m.change(a,l)});return a})},m=function(b,c){return function(d,e,g,m,u,v){var w=a.isRootOrCell(d);return f.context(e,m,d).fold(function(){return l(w,e,g,m,u,b,v)},function(a){return h.execute(a,e,g,m,u,c)})}};return{indent:function(a,b,c,d,e,g){return m(1,f.indent)(a,b,c,d,
e,g)},outdent:function(a,b,c,d,e,g){return m(-1,f.outdent)(a,b,c,d,e,g)}}});k("m0","dy b 7 s ep mh mi 21".split(" "),function(c,d,b,a,e,g,f,h){return{isRootContainer:function(a){return function(b){return a(b)||d.contains(["td","th","caption"],h.name(b))}},extract:function(a){return f.cata(a,function(a){return[a]},function(a){return[a]},function(a,b){return d.contains(["ol","ul"],h.name(a))?[a]:d.bind(b,f.toTarget)},function(a){return[a]})},isCapable:function(a){return e.isBlock(a)},canUse:b.constant(!1),
quasi:function(b){return a.some(g.nu(c()))},ascend:b.identity}});k("dc","b s fp dk m0 e1 1b l 2o 3c 2q 4e 31".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r){var q=function(a){return r.closest(a,"blockquote")},s=function(a){return b.sharedOne(q,a)},t=function(a,b,d,f,r){return g.applyOn(a,e,b,d,f,r,function(a){var b=h.fromTag("blockquote");0<a.length&&(l.before(a[0],b),m.append(b,a),b=p.descendants(b,"blockquote"),c.map(b,n.unwrap));return a})};return{toggle:function(b,c,e,g,h){return(f.eq(c,g)?q(c):
s([c,g])).fold(function(){return t(b,c,e,g,h)},function(b){n.unwrap(b);return d.some(a.block({start:c,soffset:e,finish:g,foffset:h,all:[]}))})},queryPoint:q,queryAll:s}});k("76","7 d0 d1 d2 d3 d4 d5 7c 79 d8 d9 da db dc 3t".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s){var t=function(b,d,e,f){var g=b.content(),l=b.undo();h.cata(b.selections().get(),c.noop,a.multiple(g,b.undo(),f),a.single(g,l,f,d,e))};s=function(a){return function(b){var c=0<a?r.indent:r.outdent,e=d(b.region()),h=b.content();
t(b,f.spot,g.update,function(a,b,d,f){return c(h.isRoot,a,b,d,f,e)})}};var u=function(a){return function(b){var d=b.content(),l=function(b,c,e,f){return a.run(d.isRoot,b,c,e,f)};h.cata(b.selections().get(),c.noop,e.multiple(d,b.undo(),l),e.single(d,b.undo(),l,f.spot,g.update))}},v=function(a){return function(c,d){l.detect(d.content()).each(function(e){b.runTransaction(d.content(),d.undo(),function(){(a.query(e.image())?p.floatnone():a).run(e.image());c.fireChanged(e.image())},d.content().toEditing)})}};
return{indent:s(1),outdent:s(-1),blockquote:function(a){var b=a.content();t(a,f.spot,g.update,function(a,c,d,e){return q.toggle(b.isRoot,a,c,d,e)})},justifyLeft:u(n.justifyleft()),justifyCentre:u(n.justifycentre()),justifyRight:u(n.justifyright()),justifyFull:u(n.justifyfull()),imageNone:v(p.floatnone()),imageLeft:v(p.floatleft()),imageCentre:v(p.floatcentre()),imageRight:v(p.floatright()),breakQuote:function(a,b,c){m.breakQuote(b,c).each(function(b){a.content().setRelativeSelection(b.start(),b.finish());
a.content().uiChanged()})}}});k("77",["a","b","7","s"],function(c,d,b,a){var e=function(b,c){var e=d.find(b,function(a){return a.value()===c});return a.from(e)};return{updateMenu:function(d,f,h,l,m){f.fold(d.clear,b.noop,function(b){(c.isString(b)?e(l,b):a.some(b)).each(d.select);m.each(function(a){a=a(b);d.selectElement(a)})});h.fold(d.disable,b.noop,d.enable);f.fold(d.untick,b.noop,function(a){a=c.isString(a)?a:a.value();d.tick(a)})}}});k("dd",["7","1a","2n"],function(c,d,b){return{attr:function(a,
b,g){var f=c.curry(d.set,a,b,g);a=c.curry(d.remove,a,b);0<g.length?f():a()},css:function(a,d,g){var f=c.curry(b.set,a,d,g);a=c.curry(b.remove,a,d);0<g.length?f():a()}}});k("jk",["4g"],function(c){return{resolve:c.create("ephox-salmon").resolve}});k("de",["7","jk","1a","2q","31"],function(c,d,b,a,e){var g=d.resolve("upload-image-container");d="data-"+d.resolve("image-blob");var f=function(a){b.remove(a,"class")};return{uploadContainer:c.constant(g),blobId:c.constant(d),cleanup:function(b){e.child(b,
"img").each(f);a.unwrap(b)}}});k("99","dd de 2u da 1a 2n df 6d 2r dg".split(" "),function(c,d,b,a,e,g,f,h,l,m){var n=b.immutableBag("url alt width height isLocal align".split(" "),["computedWidth","computedHeight"]),p=function(a,b){var c=e.get(a,b);return void 0!==c?c:""};return{divine:function(a){var b=g.getRaw(a,"width").getOr(""),c=g.getRaw(a,"height").getOr(""),m=g.getRaw(a,"width").getOrThunk(function(){return l.get(a)+"px"}),u=g.getRaw(a,"height").getOrThunk(function(){return h.get(a)+"px"}),
v=f.divine(a);return n({url:p(a,"src"),alt:p(a,"alt"),width:b,height:c,computedWidth:m,computedHeight:u,isLocal:e.has(a,d.blobId()),align:v})},properties:n,apply:function(b,d){e.get(b,"src")===d.url()||d.isLocal()||e.set(b,"src",d.url());c.attr(b,"alt",d.alt());c.css(b,"width",d.width());c.css(b,"height",d.height());d.align().each(function(c){a.runFloat(b,c)})}}});k("dh",["21","2a"],function(c,d){return{hasNoContent:function(b){var a=d.children(b);return c.isElement(b)&&(0===a.length||1===a.length&&
"br"===c.name(a[0]))}}});k("7a",["7"],function(c){var d=function(){return e(function(a,b,c){return a()},"off")},b=function(){return e(function(a,b,c){return b()},"unchanged")},a=function(a){return e(function(b,c,d){return d(a)},"on")},e=function(e,f){return{fold:e,map:function(c){return e(d,b,function(b){return a(c(b))})},label:c.constant(f)}};return{off:d,unchanged:b,on:a}});k("78","b 7 s 99 dh 79 7a 2u d9 dc 1b 31".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p){var r=h.immutable("alignment","quoted"),
q=function(a){return a.getSelection().fold(function(){return!1},function(a){var b=a.startContainer();a=a.endContainer();return n.eq(b,a)?m.queryPoint(b).isSome():m.queryAll([b,a]).isSome()})},s=[l.justifyleft(),l.justifycentre(),l.justifyright(),l.justifyfull()],t=function(d){return g.detect(d).fold(function(){return d.getSelection().bind(function(a){var d=c.find(s,function(b){return b.query(a.startContainer(),a.endContainer())});return null!==d&&void 0!==d?b.some(d.name()):b.none()}).fold(f.off,
f.on)},function(b){return a.divine(b.image()).align().fold(f.off,function(a){return"center"===a?f.on(l.justifycentre().name()):"right"===a?f.on(l.justifyright().name()):f.on(l.justifyleft().name())})})};return{read:function(a){var b=t(a);a=q(a)?f.on({}):f.off();return r(b,a)},alignment:t,inQuote:q,atQuoteBreak:function(a){return a.getSelection().bind(function(a){var c=a.startContainer();return a.collapsed()?p.closest(c,"blockquote").bind(function(a){return e.hasNoContent(c)?b.some({quote:d.constant(a),
element:d.constant(c)}):b.none()}):b.none()})}}});k("5d","75 7 s 76 77 73 78 79 6t 74 7a 54 46 2u q".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s){return function(s,u){var v=s.content(),w=s.shortcuts(),k=s.context(),y=r.create({analytics:p(["message","properties"])}),B=d.curry(a.indent,s),z=d.curry(a.outdent,s),A=d.curry(a.blockquote,s);w.events.indent.bind(B);w.events.outdent.bind(z);w.events.blockquote.bind(A);k.events.preLinebreak.bind(function(b){f.atQuoteBreak(s.content()).each(function(c){a.breakQuote(s,
c.quote(),c.element());b.handler().handle()})});var C=q.immutable("value","icon","textkey"),w=C("justifyleft",b.some(c.resolve("justifyleft")),g.key("alignment.left")),k=C("justifycenter",b.some(c.resolve("justifycenter")),g.key("alignment.center")),D=C("justifyright",b.some(c.resolve("justifyright")),g.key("alignment.right")),F=C("justifyfull",b.some(c.resolve("justifyfull")),g.key("alignment.justify")),E=C("justifyleft",b.some(c.resolve("justifyleft")),g.key("alignment.left")),G=C("justifycenter",
b.some(c.resolve("justifycenter")),g.key("alignment.center")),C=C("justifyright",b.some(c.resolve("justifyright")),g.key("alignment.right")),H=[w,k,D,F],I=[E,G,C],L=function(){return h.detect(v).fold(function(){return H},function(a){return I})},J={justifyleft:d.curry(a.imageLeft,u),justifycenter:d.curry(a.imageCentre,u),justifyright:d.curry(a.imageRight,u)},K={justifyleft:a.justifyLeft,justifycenter:a.justifyCentre,justifyright:a.justifyRight,justifyfull:a.justifyFull},M=function(a){return a.toLowerCase()},
N=b.none();return{ui:l.ui({"indent.general":{value:"indent",textkey:g.key("action.indent"),action:B,updateGeneral:d.identity,tooltip:m.get,toggle:!1},"outdent.general":{value:"outdent",textkey:g.key("action.outdent"),action:z,updateGeneral:d.identity,tooltip:m.get,toggle:!1},"blockquote.general":{value:"blockquote",textkey:g.key("action.blockquote"),action:A,updateGeneral:function(a){f.read(v).quoted().fold(a.deselect,d.noop,a.select)},tooltip:m.get,toggle:!0},"alignment.dropdown":{name:"alignment",
textkey:g.key("alignment.toolbar"),menuTextkey:g.key("alignment.menu"),action:function(a){var b=h.detect(v).fold(d.constant(K),d.constant(J));(void 0!==b[a]?b[a]:d.noop)(s)},updateDropdown:function(a){var c=L(),g=f.read(v).alignment().fold(function(){return 0<c.length?n.on(c[0].value()):n.off()},n.unchanged,n.on);a.populate([{label:b.none,items:d.constant(c)}]);e.updateMenu(a,g.map(M),n.on(),c,N)},values:H,render:N,tooltip:m.get,toggle:!1,describe:function(a){return g.translate("alignment.describe",
g.get(a.textkey()))}}}),events:y.registry,destroy:d.noop}}});k("7b",["b","d1"],function(c,d){return{multiple:function(b,a,e){return function(g,f){d.runTransaction(b,a,function(){c.each(f,e)},b.toEditing)}},single:function(b,a,c){return function(g,f){d.runTransaction(b,a,function(){c(f).each(function(a){b.setSelection(a.start(),a.soffset(),a.finish(),a.foffset())});b.backupSelection()},b.toEditing)}}}});k("m6",["dy","u8"],function(c,d){var b=c();return{atStartOf:function(a,c,g){d.atStartOf(b,a,c,g)}}});
k("dl",["7","lq","m4"],function(c,d,b){b=b.resolve("style-marker");return{styleSpan:c.constant(b),overrideSpan:c.constant("data-ephox-override"),quasiBlock:d.style}});k("dn",["d6","s","2u","2a"],function(c,d,b,a){var e=b.immutable("startContainer","startOffset","endContainer","endOffset"),g=b.immutable("start","soffset","finish","foffset");return{hare:e,fussy:g,fromHare:function(a){return g(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset())},fromFussy:function(a){return e(a.start(),
a.soffset(),a.finish(),a.foffset())},fussyFromElements:function(b){if(0===b.length)return d.none();var e=b[0];b=b[b.length-1];e=a.firstChild(e).getOr(e);b=a.lastChild(b).getOr(b);return d.some(g(e,0,b,c.getEnd(b)))}}});k("u9",["7s","4n"],function(c,d){var b=d.generate([{none:[]},{tempIn:["selection"]},{tempOut:["selection"]},{rangedIn:["selection"]},{rangedOut:["selection"]}]);return{detect:function(a,d){return a.getSelection().fold(function(){return b.none()},function(a){var f=d(a);return c.isCollapsed(a.startContainer(),
a.startOffset(),a.endContainer(),a.endOffset())?f?b.tempIn(a):b.tempOut(a):f?b.rangedIn(a):b.rangedOut(a)})}}});k("ua",["1a","2n","l"],function(c,d,b){var a=function(a,c){return b.fromTag(a,c.dom())},e=function(a,c,e){e=b.fromTag("span",e.dom());d.set(e,a,c);return e};return{nu:function(b,c,d,l){return"span"===d?e(b,c,l):a(d,l)},nuTag:a,nuAttr:function(a,d,e){e=b.fromTag("span",e.dom());c.set(e,a,d);return e},nuStyle:e}});k("h0",["b","s","2n","21","2a"],function(c,d,b,a,e){var g={"font-weight":{700:"bold",
400:"normal"}},f=function(a,b){if(a===b&&""!==b&&void 0!==b)return!0;var d=a.toLowerCase(),e=b.toLowerCase().split(" ");return c.contains(e,d)},h=function(a,b){if(void 0!==g[a]){var c=g[a][b];return void 0!==c?c:b}return b},l=function(a,b){var c=m(a,b);return h(b,c)},m=function(c,f){return(a.isText(c)?e.parent(c):d.some(c)).map(function(a){return b.get(a,f)}).getOr(void 0)};return{state:function(a,b,c){a=l(a,b);return"text-decoration"===b?f(c,a):c===a&&""!==a&&void 0!==a},rawState:function(a,c,d){a=
h(c,b.getRaw(a,c).getOr(void 0));return"text-decoration"===c?f(d,a):d===a&&""!==a&&void 0!==a},value:l}});k("yr",["b","s","2n","21","4i"],function(c,d,b,a,e){var g={"text-decoration":function(d,g,l,m){var n=function(g){return e.closest(g,function(e){return a.isElement(e)&&(c.contains(l,a.name(e))||b.getRaw(e,d).isSome())}).toArray()};m=n(m.startContainer()).concat(n(m.endContainer()));return c.exists(m,function(e){return c.contains(l,a.name(e))?!0:b.getRaw(e,d).exists(function(a){return g===a})})}};
return{handle:function(a,b,c){return void 0!==g[a]?d.some(g[a]):d.none()}}});k("ub","b 7 s h0 yr 1a 21 6m 31".split(" "),function(c,d,b,a,e,g,f,h,l){var m=function(a,b){return b.getSelection().map(function(b){return a(b)}).getOr(!1)},n=function(b,c,d,f){return e.handle(b,c).fold(function(){var d=a.state(f.startContainer(),b,c),e=a.state(f.endContainer(),b,c);return d||e},function(a){return a(b,c,d,f)})},p=function(a,b,c,e){return m(d.curry(n,a,b,c),e)},r=function(a,b){var c=h.closest(b.startContainer(),
a),d=h.closest(b.endContainer(),a);return c||d},q=function(a,b){return m(d.curry(r,a),b)},s=function(a,b){return c.contains(a,f.name(b))},t=function(a,c){var d="["+a+"]";return l.closest(c.startContainer(),d).bind(function(e){return l.closest(c.endContainer(),d).bind(function(c){var d=g.get(e,a);c=g.get(c,a);d=d.toLowerCase();c=c.toLowerCase();return d===c?b.some(d):b.none()})})};return{queriesStyle:function(a,b,c){return{queryOn:d.curry(n,a,b,c),query:d.curry(p,a,b,c)}},queryStyleOn:n,queriesTag:function(a){return{queryOn:d.curry(r,
a),query:d.curry(q,a)}},relatedStyle:function(b,c,d,e){(d=s(d,e))||(d="span"===f.name(e)&&a.state(e,b,c));return d},relatedTags:s,queryAttrSame:function(a,b){return b.getSelection().bind(function(b){return t(a,b)})},queryAttrIs:function(a,b,c){var d=b.toLowerCase(),e=function(b){return g.get(b,a).toLowerCase()===d};return l.closest(c.startContainer(),"["+a+"]").filter(e).orThunk(function(){return l.closest(c.endContainer(),"["+a+"]").filter(e)}).isSome()}}});k("14b","b s eg lm i7 ln 4n 2u".split(" "),
function(c,d,b,a,e,g,f,h){var l=f.generate([{none:["last","mode"]},{running:["next","mode"]},{split:["boundary","last","mode"]},{finished:["element","mode"]}]),m=h.immutable("start","soffset","finish","foffset"),n=function(c,d,e){e=a.toLeaf(c,e,0);return q(c,e.element())?r(c,d,e.element()).map(function(a){return b.point(a,0)}).getOr(e):e},p=function(a,b){return g.isFrame(a,b)||g.isBlock(a,b)||c.contains(["li"],a.property().name(b))},r=function(a,b,c){return e.seekRight(a,c,function(b){return!q(a,
b)&&!p(a,b)},b)},q=function(a,b){return a.property().isText(b)?a.property().parent(b).exists(function(b){return c.contains("table tbody thead tfoot tr ul ol".split(" "),a.property().name(b))}):!1},s=function(a,b,c,d,f){return e.walk(a,d,c,e.walkers().right()).fold(function(){return l.none(d,e.sidestep)},function(b){return a.eq(b.item(),f)?l.finished(f,b.mode()):p(a,b.item())?l.split(b.item(),d,b.mode()):l.running(b.item(),b.mode())})},t=function(a,b,c,e){return r(a,b,c).fold(function(){return d.none()},
function(f){return a.eq(f,e)?d.some(e):u(a,c,f)?t(a,b,f,e):p(a,f)?(f=n(a,b,f),d.some(f.element())):d.some(f)})},u=function(a,b,c){return a.property().parent(b).exists(function(b){return a.eq(b,c)})},v=function(a,b,c,f,g,h){return s(a,b,c,g,h).fold(function(a,b){return[{start:f,finish:a}]},function(c,d){return v(a,b,d,f,c,h)},function(c,l,m){var p={start:f,finish:l};return(u(a,g,c)?t(a,b,c,h):function(){var f=n(a,b,c);return a.eq(f.element(),c)?e.walk(a,c,e.advance,e.walkers().right()).map(function(a){return a.item()}):
d.some(f.element())}()).fold(function(){return[p]},function(c){return a.eq(c,h)?[p].concat({start:h,finish:h}):[p].concat(v(a,b,e.advance,c,c,h))})},function(a,b){return[{start:f,finish:a}]})},w=function(a,b,c){if(p(a,b)){var d=a.property().children(b);return 0<=c&&c<d.length?w(a,d[c],0):c===d.length?w(a,d[d.length-1],0):b}return b},k=function(a,b,c,d){c=w(a,c,d);return q(a,c)?r(a,b,c).getOr(c):c},y=function(a,b,d,f,g,h){var l=k(a,b,d,f),n=k(a,b,g,h);b=v(a,b,e.sidestep,l,l,n);return c.map(b,function(b,
c){var e=a.eq(b.start,d)?f:0,l;a.eq(b.finish,g)?l=h:(l=b.finish,l=a.property().isText(l)?a.property().getText(l).length:a.property().children(l).length);return m(b.start,e,b.finish,l)})},B=function(b,c,d,e,f,g){b.eq(d,f)?p(b,d)?(e=a.toLeaf(b,d,e),g=a.toLeaf(b,d,g),b=b.eq(e.element(),d)&&b.eq(g.element(),d)?[m(e.element(),e.offset(),g.element(),g.offset())]:B(b,c,e.element(),e.offset(),g.element(),g.offset())):b=[m(d,e,d,g)]:b=y(b,c,d,e,f,g);return b};return{collect:B}});k("14c",["i7","ov","4n"],function(c,
d,b){var a=b.generate([{leftEdge:["element"]},{between:["before","after"]},{rightEdge:["element"]}]),e=function(b,c,e){e=d.split(b,c,e);var g=function(){return a.rightEdge(c)};return d.position(b,e).fold(g,function(){return a.leftEdge(c)},a.between,g)},g=function(b,c,d,g){if(b.property().isText(c))return e(b,c,d);if(b.property().isEmptyTag(c))return g(c);b=b.property().children(c);c=0===d?a.leftEdge(c):d===b.length?a.rightEdge(c):0<d&&d<b.length?a.between(b[d-1],b[d]):a.rightEdge(c);return c};return{toLeft:function(b,
d,e,m){return g(b,e,m,a.leftEdge).fold(function(a){return a},function(a,b){return b},function(a){return c.after(b,a,d).getOr(a)})},toRight:function(b,d,e,m){return g(b,e,m,a.rightEdge).fold(function(a){return c.before(b,a,d).getOr(a)},function(a,b){return a},function(a){return a})}}});k("14d","b 7 s lz u0 u2".split(" "),function(c,d,b,a,e,g){var f=function(a,e,f,g){var h=a.property().children(e);e=function(e){e=c.findIndex(h,d.curry(a.eq,e));return-1<e?b.some(e):b.none()};f=f.bind(e).getOr(0);g=g.bind(e).getOr(h.length-
1);return-1<f&&-1<g?b.some(h.slice(f,g+1)):b.none()},h=function(b,c,e,f){return a.breakPath(b,c,function(a){return b.property().parent(a).fold(d.constant(!0),d.curry(b.eq,e))},f)},l=function(a,c,d,g){a.eq(c,g)?g=b.none():(g=h(a,g,c,e.breakToRight),g=b.some(g.first()));if(a.eq(c,d))d=b.none();else{var l=h(a,d,c,e.breakToLeft);0<l.splits().length&&a.insert().prepend(l.splits()[0].second(),d);d=b.some(l.second().getOr(d))}return f(a,c,d,g)},m=function(c,d,e,f,h){return g.ancestors(c,e,f,d).shared().orThunk(function(){return a.sharedOne(c,
function(a,e){return d(e)?b.some(e):c.up().predicate(e,d)},[e,f])}).map(h)},n=function(a,b,c,d,e){return m(a,b,c,d,e).bind(function(b){return l(a,b,c,d)})};return{fracture:function(a,c,e,f,g){g=void 0!==g?g:d.identity;a.eq(e,f)?(c=g(e),a=a.eq(c,e)?b.some([e]):l(a,c,e,e)):a=n(a,c,e,f,g);return a}}});k("11t","b s ov 14b 14c 14d".split(" "),function(c,d,b,a,e,g){var f=function(a,c,d,f,p,r,q){a.property().isText(d)&&a.eq(d,p)?(d=b.splitByPair(a,d,f,r),a=g.fracture(a,c,d,d,q)):(p=e.toRight(a,c,p,r),d=
e.toLeft(a,c,d,f),a=g.fracture(a,c,d,p,q));return a};return{fractures:function(b,d,e,g,p,r,q){e=a.collect(b,d,e,g,p,r);return c.bind(e,function(a,c){return f(b,d,a.start(),a.soffset(),a.finish(),a.foffset(),q).toArray()})},fracture:f}});k("ys",["dy","11t"],function(c,d){var b=c();return{fractures:function(a,c,g,f,h,l){return d.fractures(b,a,c,g,f,h,l)},fracture:function(a,c,g,f,h,l){return d.fracture(b,a,c,g,f,h,l)}}});k("uk",["eg","lf","2a"],function(c,d,b){return{makeTo:function(a,c,d){var f=b.owner(a).dom().createRange();
f.setStart(a.dom(),c);f.setEndBefore(d.dom());return f},makeFrom:function(a,c,d){var f=b.owner(c).dom().createRange();f.setStartAfter(a.dom());f.setEnd(c.dom(),d);return f},leftEdge:function(a,b,g,f){return d.after(a,b,g,f)?c.point(g,f):c.point(a,b)},rightEdge:function(a,b,g,f){return d.after(a,b,g,f)?c.point(a,b):c.point(g,f)}}});k("m8","b 1o 7 21 4e m".split(" "),function(c,d,b,a,e,g){var f=function(a,b){var c=d.keys(b).join(",");return(g.is(a,c)?[a]:[]).concat(e.descendants(a,c))};return{cleanse:function(d,
e){var g=f(d,e);c.each(g,function(c){var d=a.name(c);(void 0!==e[d]?e[d]:b.noop)(c)})}}});k("ud",["b","v"],function(c,d){return{onlyEphox:function(b){return void 0!==b&&null!==b&&0<b.trim().length?(b=b.split(/\s+/),c.filter(b,function(a){return d.startsWith(a,"ephox-")}).join(" ")):""}}});k("m9","b 6 ud 1a 2n 2q".split(" "),function(c,d,b,a,e,g){var f=function(a){g.unwrap(a)},h=function(b,c){e.remove(b,c);a.hasNone(b)&&f(b)},l=function(a){var b={};c.each(a,function(a){b[a]=m(f)});return b},m=function(b){return function(c){a.has(c,
"data-ignore")||b.apply(null,arguments)}};return{cssAndTag:function(a,b,c){a=l(a);c=function(a){h(a,b)};return d.merge(a,{span:m(c),font:m(c)})},tagList:l,removeStyle:m(h),removeAttribute:m(function(b,c){a.remove(b,c);a.hasNone(b)&&f(b)}),unwrap:m(f),unstyle:m(function(c){var d=a.get(c,"class");a.remove(c,"class");d=b.onlyEphox(d);0<d.length&&a.set(c,"class",d);a.remove(c,"style");a.hasNone(c)&&f(c)}),normal:function(b){a.remove(b,"data-ignore")},ignore:function(b){a.set(b,"data-ignore","true")}}});
k("yt","5b b ep 2f 21 2q 2a".split(" "),function(c,d,b,a,e,g,f){var h=function(a,b){var c=f.children(a);d.each(c,function(a){h(a,b)});b(a)},l=function(d){return e.isElement(d)&&!b.isEmptyTag(d)&&!b.isFrame(d)&&0===a.get(d).replace(c.zeroWidth(),"").length};return{wipeout:h,onEmpty:function(c){h(c,function(c){!e.isElement(c)||b.isFrame(c)||b.isEmptyTag(c)||0!==a.get(c).length?l(c)&&g.unwrap(c):g.remove(c)})},onQuasiEmpty:function(a){h(a,function(a){l(a)&&g.remove(a)})}}});k("uc","b 7 s ys ep uk dn m8 m9 yt 2m 2o 3c 2a".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,p,r,q){var s=function(a){return q.parent(a).fold(d.constant([]),function(a){return e.isBlock(a)?[a]:[a].concat(s(a))})},t=function(a,b){var d=[b].concat(s(b)),d=c.reverse(d),e=c.findIndex(d,a);return-1===e?b:0===e?d[0]:d[e-1]},u=function(a,b){c.each(b,function(b){h.cleanse(b,a);m.onQuasiEmpty(b)})};return{run:function(e,h,s,k){var B=g.leftEdge(s.startContainer(),s.startOffset(),s.endContainer(),s.endOffset());s=g.rightEdge(s.startContainer(),s.startOffset(),s.endContainer(),
s.endOffset());var z=d.curry(t,k.matches);h=a.fractures(h,B.element(),B.offset(),s.element(),s.offset(),z);h=c.bind(h,function(a){var d;if(0<a.length){d=k.purifiers();var f=(0,k.nu)(e);l.ignore(f);b.from(a[0]).bind(q.prevSibling).each(m.onQuasiEmpty);b.from(a[a.length-1]).bind(q.nextSibling).each(m.onQuasiEmpty);c.each(a,m.onQuasiEmpty);a=c.filter(a,n.inBody);0<a.length?(p.before(a[0],f),r.append(f,a),u(d,a),d=[f]):d=[]}else d=[];return d});c.each(h,l.normal);return f.fussyFromElements(h)}}});k("m7",
["b","1b","2a"],function(c,d,b){var a=function(c,e){return d.eq(c,e)?[]:b.parent(c).fold(function(){return[]},function(d){d=a(d,e);var f=b.findIndex(c).toArray();return d.concat(f)})},e=function(a,b){return a.slice(b+1)},g=function(a,b){return a.slice(0,b)},f=function(a,d,e,g){if(0===g.length)d(e);else{var p=g[0],r=g.slice(1);b.child(e,p).each(function(b){f(a,d,b,r)});e=b.children(e);p=a(e,p);c.each(p,d)}};return{one:function(a,b){a(b)},across:function(d,l,m,n){m=a(m,l);n=a(n,l);l=b.children(l);var p=
l.slice(0<m.length?m[0]+1:0,0<n.length?n[0]:l.length-1);c.each(p,d);0<m.length&&f(e,d,l[m[0]],m.slice(1));0<n.length&&f(g,d,l[n[0]],n.slice(1))}}});k("mv",["dy","ue"],function(c,d){var b=c();return{extract:function(a,c,g){return d.extract(b,a,c,g)},extractTo:function(a,c,g,f){return d.extractTo(b,a,c,g,f)},all:function(a,c){return d.all(b,a,c)},from:function(a,c){return d.from(b,a,c)},find:function(a,c,g){return d.find(b,a,c,g)},toText:function(a,c){return d.toText(b,a,c)}}});k("h2",["dy","ov"],function(c,
d){var b=c();return{split:function(a,c){return d.split(b,a,c)},splitByPair:function(a,c,g){return d.splitByPair(b,a,c,g)},range:function(a,c,g,f){return d.range(b,a,c,g,f)},subdivide:function(a,c){return d.subdivide(b,a,c)},position:function(a){return d.position(b,a)}}});k("uj","b h2 uk 21 2a 9".split(" "),function(c,d,b,a,e,g){var f=function(b,d,f){var g=e.children(d),h=0===f,l=f===g.length,m=0<g.length;return void 0!==b.empty&&c.contains(["br","hr","img"],a.name(d))?b.empty:void 0!==b.hasPrevious&&
m&&0<f&&f<g.length?b.hasPrevious:void 0!==b.hasNext&&m&&f<g.length-1?b.hasNext:void 0!==b.rightEdge&&m&&l?b.rightEdge:void 0!==b.first&&h?b.first:b.otherwise},h=function(a,b,c){return f(a.before.element,b,c)(b,c)},l=function(a,b,c){return f(a.after.element,b,c)(b,c)},m=function(a,b,c){c=d.split(b,c);var e=function(a){return function(){var c=g.prototype.slice.call(arguments,0),c=[b].concat(c);return a.apply(null,c)}};return d.position(c).fold(e(a.none),e(a.start),e(a.middle),e(a.end))},n=function(a,
b,c){return m(a.before.text,b,c)},p=function(a,b,c){return m(a.after.text,b,c)};return{prefix:function(b,c,d){return(a.isText(c)?n:h)(b,c,d)},postfix:function(c,d,e,f,g){d=b.rightEdge(d,e,f,g);return(a.isText(d.element())?p:l)(c,d.element(),d.offset())}}});k("qf","7 h2 uj uk 1b 21 2a 9".split(" "),function(c,d,b,a,e,g,f,h){var l=function(a,b){return a.bind(function(a){return b.map(function(b){return{left:c.constant(a),right:c.constant(b)}})})},m=function(a,b,c,e){b=d.splitByPair(b,c,e);return l(a.general.insertBefore(b),
a.general.insertAfter(b))},n=function(a,b,c,d){c=f.child(b,c);var e=d<f.children(b).length?f.child(b,d):f.lastChild(b);return c.bind(function(b){return e.bind(function(c){return l(a.general.insertBefore(b),a.general.insertAfter(c))})})};return{both:function(c,d,f,h,t){if(e.eq(d,h)){var u=g.isText(d)?m:n;return f>t?u(c,d,t,f):u(c,d,f,t)}u=a.leftEdge(d,f,h,t);d=b.postfix(c,d,f,h,t);c=b.prefix(c,u.element(),u.offset());return l(c,d)}}});k("ul","dy b 7 s ep 2u tt yt 1b 4i 2a".split(" "),function(c,d,
b,a,e,g,f,h,l,m,n){var p=g.immutable("inside","outside"),r=function(a){return n.parent(a).fold(b.constant(!0),function(a){return e.isBlock(a)||e.isContainer(a)})},q=function(e,f){var g=c(),h=[e].concat(g.up().all(e)),m=[f].concat(g.up().all(f)),g=d.find(h,function(a){return d.exists(m,b.curry(l.eq,a))});return a.from(g)},s=function(b){return p(b.second(),a.some(b.first()))},t=function(b){return p(a.some(b.first()),b.second())},u=function(c,d){var e=r(c)?c:m.ancestor(c,r).getOr(c);l.eq(c,e)?e=p(a.some(c),
a.none()):(e=f.breakPath(c,b.curry(l.eq,e)),e=d(e));return e};return{bridge:function(a,c){var d=u(a,s),e=u(c,t);return d.inside().bind(function(a){return e.inside().bind(function(c){return q(a,c).map(function(f){return{common:b.constant(f),left:b.constant(a),right:b.constant(c),wipeout:function(){d.outside().each(h.onEmpty);e.outside().each(h.onEmpty)}}})})})}}});k("um",["7","s","l","2o","2q"],function(c,d,b,a,e){return function(g,f){var h=function(a,f,g){var h=b.fromText(f);a(g,h);return d.some({element:c.constant(h),
cleanup:function(){e.remove(h)},splits:c.constant([])})},l=function(b){return{none:d.none,start:c.curry(h,a.before,b),end:c.curry(h,a.after,b),middle:function(c,d,e){return h(a.after,b,d)}}},m=function(b){var d=function(b){return function(c,d){a.appendAt(c,d,b)}};return{prepend:c.curry(h,a.prepend,b),before:c.curry(h,a.before,b),after:c.curry(h,a.after,b),insertAt:function(a,c){return h(d(c),b,a)},append:c.curry(h,a.append,b)}};return{before:{text:l(g),element:{hasPrevious:m(g).insertAt,first:m(g).prepend,
empty:m(g).before,otherwise:m(g).append}},after:{text:l(f),element:{hasNext:m(f).insertAt,rightEdge:m(f).append,empty:m(f).after,otherwise:m(f).append}},general:{insertBefore:m(g).before,insertAfter:m(f).after}}}});k("ma","5b 7s d6 7 eg ip mv iw ep 2u qf ul um".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r){var q=m.immutable("start","soffset","finish","foffset"),s=a.constant(!1),t=function(a){return l.isBlock(a)||l.isContainer(a)},u=function(a,c,l,m,n){var p=d.isCollapsed(c,l,m,n);c=g.toLeaf(c,l);
m=g.toLeaf(m,n);var r=f.extractTo(c.element(),c.offset(),t,s),u=f.extractTo(m.element(),m.offset(),t,s),k=function(c){return p||c.offset()!==b.getEnd(c.element())?c:h.after(c.element(),a).map(function(a){return e.point(a,0)}).getOr(c)},F=function(c){return p||0!==c.offset()?c:h.before(c.element(),a).map(function(a){return e.point(a,b.getEnd(a))}).getOr(c)};return function(){return f.find(r.element(),r.offset(),s).map(k).bind(function(a){return f.find(u.element(),u.offset(),s).map(F).map(function(b){return q(a.element(),
a.offset(),b.element(),b.offset())})})}};return{applyTo:function(a,b,d,e,f,g){var h=u(a,d,e,f,g);a=r(c.zeroWidth(),c.zeroWidth());return n.both(a,d,e,f,g).bind(function(a){return p.bridge(a.left().element(),a.right().element()).bind(function(c){b(c.common(),c.left(),c.right());a.left().cleanup();a.right().cleanup();c.wipeout();return h()})})}}});k("dq","7 m7 m8 m9 ma 1b".split(" "),function(c,d,b,a,e,g){return{doRemove:function(a,c,l){var m=function(a){b.cleanse(a,c)};return e.applyTo(a,function(a,
b,c){if(g.eq(b,c))d.one(m,b);else d.across(m,a,b,c)},l.startContainer(),l.startOffset(),l.endContainer(),l.endOffset())},allRules:c.constant({b:a.unwrap,strong:a.unwrap,i:a.unwrap,em:a.unwrap,u:a.unwrap,strike:a.unwrap,del:a.unwrap,s:a.unwrap,sup:a.unwrap,sub:a.unwrap,small:c.noop,span:a.unstyle,font:a.unstyle})}});k("m1","5b b 1o d6 7 s eg iw m6 dl dn u9 ua ub uc m9 dq 1y l 2o 21 ak".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,v,w,k,y,B){return function(z,A,C,D){C=[A].concat(C);var F=e.curry(r.nuTag,
A),E=e.curry(q.relatedTags,C),G=t.tagList(C),H=q.queriesTag(A),I={nu:F,matches:E,purifiers:e.constant(G)},L=function(a){var b=w.fromText(c.zeroWidth());l.atStartOf(a.startContainer(),a.startOffset(),b);return n.hare(b,0,b,1)},J=function(a,b,c){return y.isText(b)&&c===B.get(b).length?h.after(b,a).fold(function(){return f.point(b,c)},function(a){return f.point(a,0)}):f.point(b,c)},K=function(b,c,d){return y.isText(c)&&0===d?h.before(c,b).fold(function(){return f.point(c,d)},function(b){return f.point(b,
a.getEnd(b))}):f.point(c,d)},M=function(a,b){return b.map(function(b){var c=J(a,b.start(),b.soffset());b=K(a,b.finish(),b.foffset());return n.fussy(c.element(),c.offset(),b.element(),b.offset())})};C={nu:F,purifiers:e.constant(G),isStyled:e.constant(!0)};var N=["font-size"],S=function(a){return a.getSelection().map(function(a){var c=b.keys(D),c=d.difference(c,N);return d.forall(c,function(b){return q.queryStyleOn(b,D[b],[A],a)})}).getOr(!1)};return{run:function(a,b){var c=b.doc();return p.detect(b,
H.queryOn).fold(function(){return g.none()},function(b){b=L(b);u.doRemove(a,G,b);return g.some(n.fromHare(b))},function(a){a=L(a);var b=w.fromTag(A,c.dom());v.add(b,m.styleSpan());k.wrap(a.startContainer(),b);return g.some(n.fussy(a.startContainer(),1,a.startContainer(),1))},function(b){b=u.doRemove(a,G,b);return M(a,b)},function(c){return s.run(b.doc(),a,c,I)})},query:function(a){return H.query(a)||S(a)},deferred:e.constant(C),name:e.constant(z)}}});k("z0",["b","s"],function(c,d){var b=function(a,
b,c){return{groups:0<a.current.length?a.groups.concat({parent:a.parent,children:a.current}):a.groups,current:[c],parent:b}},a=function(a,b,c){return{groups:a.groups,current:a.current.concat([c]),parent:b}},e=function(c,e,h){return d.from(e.current[e.current.length-1]).bind(c.query().nextSibling).bind(function(b){return c.eq(b,h)?d.some(a):d.none()}).getOr(b)};return{textnodes:function(a,b){var d=c.foldl(b,function(b,c){return a.property().parent(c).fold(function(){return b},function(d){return e(a,
b,c)(b,d,c)})},{groups:[],current:[],parent:null});return 0<d.current.length?d.groups.concat({parent:d.parent,children:d.current}):d.groups}}});k("uo","b s eg ov z0 tz".split(" "),function(c,d,b,a,e,g){var f=function(b,c,d,e,f,g){c=a.range(b,c,d,e,f);return h(b,c,g)},h=function(a,b,d){if(0===b.length)return b;b=c.filter(b,function(b){return a.property().isText(b)&&0<a.property().getText(b).length});return c.map(b,function(b){var c=d();a.insert().before(b,c.element());c.wrap(b);return c.element()})},
l=function(a,c){return d.from(c[0]).map(function(d){var e=g.toLower(a,c[c.length-1]);return b.points(b.point(d,0),b.point(e.element(),e.offset()))})};return{wrapWith:f,wrapper:h,leaves:function(a,b,c,d,e,h){b=g.toLeaf(a,b,c);d=g.toLeaf(a,d,e);h=f(a,b.element(),b.offset(),d.element(),d.offset(),h);return l(a,h)},reuse:function(b,d,f,h,l,s,t){d=g.toLeaf(b,d,f);h=g.toLeaf(b,h,l);h=a.range(b,d.element(),d.offset(),h.element(),h.offset());h=e.textnodes(b,h);var u=function(a){return a.parent},v=function(a){var d=
t();b.insert().before(a.children[0],d.element());c.each(a.children,d.wrap);return d.element()};return c.map(h,function(a){return(b.property().children(a.parent).length===a.children.length&&s(a.parent)?u:v)(a)})}}});k("up",["7"],function(c){return function(d,b){return{element:c.constant(b),wrap:function(a){d.insert().append(b,a)}}}});k("un","5b 7 s eg u8 uo up 2u".split(" "),function(c,d,b,a,e,g,f,h){var l=function(c,e,f,g,h,l){c=m(c,e,f,g,h,l);e=c.cursor();e=a.points(a.point(e.element(),e.offset()),
a.point(e.element(),e.offset()));return b.some({range:d.constant(e),temporary:c.temporary,wrappers:c.wrappers})};h.immutable("span","cursor");var m=function(f,g,h,l,m,p){return f.property().parent(g).bind(function(e){var l=a.point(g,h),m;if(m=n(f,p,e))if(m=1===f.property().children(e).length)m=f.property().isText(g)&&f.property().getText(g)===c.zeroWidth();return m?b.some({cursor:d.constant(l),temporary:d.constant(!1),wrappers:d.constant([e])}):b.none()}).getOrThunk(function(){var b=g.dom().ownerDocument,
l=f.create().nu("span",b),b=f.create().text(c.zeroWidth(),b);f.insert().append(l,b);e.atStartOf(f,g,h,l);return{cursor:d.constant(a.point(b,1)),wrappers:d.constant([l]),temporary:d.constant(!0)}})},n=function(a,b,c){return"span"===a.property().name(c)&&!1===b(c)},p=function(c,e,h,l,m,p){var k=e.dom().ownerDocument,x=g.reuse(c,e,h,l,m,d.curry(n,c,p),function(){return f(c,c.create().nu("span",k))});return b.from(x[x.length-1]).map(function(b){var e=c.property().children(b).length;b=a.points(a.point(x[0],
0),a.point(b,e));return{wrappers:d.constant(x),temporary:d.constant(!1),range:d.constant(b)}})};return{spans:function(a,b,c,e,f,g){g=void 0!==g?g:d.constant(!1);return(a.eq(b,e)&&c===f?l:p)(a,b,c,e,f,g)}}});k("ow",["un","uo","up"],function(c,d,b){return{nu:function(a,c){return b(a,c)},wrapWith:function(a,b,c,f,h,l){return d.wrapWith(a,b,c,f,h,l)},wrapper:function(a,b,c){return d.wrapper(a,b,c)},leaves:function(a,b,c,f,h,l){return d.leaves(a,b,c,f,h,l)},reuse:function(a,b,c,f,h,l,m){return d.reuse(a,
b,c,f,h,l,m)},spans:function(a,b,d,f,h,l){return c.spans(a,b,d,f,h,l)}}});k("h3",["dy","ow"],function(c,d){var b=c();return{nu:function(a){return d.nu(b,a)},wrapWith:function(a,c,g,f,h){return d.wrapWith(b,a,c,g,f,h)},wrapper:function(a,c){return d.wrapper(b,a,c)},leaves:function(a,c,g,f,h){return d.leaves(b,a,c,g,f,h)},reuse:function(a,c,g,f,h,l){return d.reuse(b,a,c,g,f,h,l)},spans:function(a,c,g,f,h){return d.spans(b,a,c,g,f,h)}}});k("md",["b","h3","dl","4b","2n"],function(c,d,b,a,e){var g=function(e,
f,g){e.getSelection().each(function(n){d.spans(n.startContainer(),n.startOffset(),n.endContainer(),n.endOffset(),g).each(function(d){var g=d.temporary()?[b.styleSpan()]:[],m=d.range();c.each(d.wrappers(),function(b){a.add(b,g);f(b)});d=m.begin();m=m.end();e.setSelection(d.element(),d.offset(),m.element(),m.offset())})})},f=function(a,b,c,d){b(a);g(a,d,c)};return{style:function(a,b,c,d){return f(a,c,d,function(a){e.setAll(a,b)})},generic:f}});k("m2","7 s dl h0 md u9 ua ub uc m9 dq 1a 1y 1b 2n 21 31".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u){return function(v,k,x,y,B,z){var A=c.curry(f.nu,y,B,k),C=c.curry(h.relatedStyle,y,B,x),D=m.cssAndTag(x,y,B),F=h.queriesStyle(y,B,x),E=c.constant(!0),G=function(a,f){e.generic(a,c.noop,E,function(a){r.add(a,b.styleSpan());s.set(a,y,f);p.set(a,b.overrideSpan(),v);s.reflow(a)});return d.none()};k={nu:A,purifiers:c.constant(D),isStyled:function(b){return"span"===t.name(b)&&a.rawState(b,y,B)}};return{run:function(a,b){return g.detect(b,F.queryOn).fold(function(){return d.none()},
function(a){return G(b,z)},function(a){return G(b,B)},function(b){return n.doRemove(a,D,b)},function(d){return l.run(b.doc(),a,d,{nu:A,matches:C,purifiers:c.constant(D)})})},query:function(a){var c="["+b.overrideSpan()+'="'+v+'"]';return a.getSelection().bind(function(a){return u.closest(a.startContainer(),c).bind(function(b){return u.closest(a.endContainer(),c).bind(function(a){return q.eq(b,a)?s.getRaw(b,y).map(function(a){return a===B}):d.none()})})}).getOrThunk(function(){return F.query(a)})},
deferred:c.constant(k),name:c.constant(v)}}});k("m3","7 s dl md u9 ua ub uc m9 dq 1a 1y 21 2q 31".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s){return function(t,u){var v=function(a,b){return g.nuAttr(u,a,b)},k=function(a){return"span"===r.name(a)&&n.has(a,u)},x={span:function(a){l.removeAttribute(a,u)}},y=function(a,b){return f.queryAttrIs(u,a,b)},B=function(e,f){a.generic(f,c.noop,void 0,function(a){p.add(a,b.styleSpan());n.set(a,u,e)});return d.none()};return{run:function(a,b,f){return e.detect(b,
c.curry(y,f)).fold(function(){return d.none()},function(a){var b=["[",u,'="',f,'"]'].join("");s.closest(a.startContainer(),b).each(q.unwrap);return d.none()},function(a){return B(f,b)},function(b){return m.doRemove(a,x,b)},function(d){return h.run(b.doc(),a,d,{nu:c.curry(v,f),matches:k,purifiers:c.constant(x)})})},queryValue:function(a){return f.queryAttrSame(u,a)},name:c.constant(t)}}});k("di",["7","s","m1","m2","m3"],function(c,d,b,a,e){var g=a("bold","strong",["strong","b"],"font-weight","bold",
"normal"),f=a("italic","em",["em","i"],"font-style","italic","normal"),h=a("underline","span",["u"],"text-decoration","underline","none");a=a("strikethrough","span",["s","strike","del"],"text-decoration","line-through","none");e=e("language","lang");var l=b("superscript","sup",["sup","sub"],{"font-size":"smaller","vertical-align":"super"});b=b("subscript","sub",["sub","sup"],{"font-size":"smaller","vertical-align":"sub"});var m={bold:g,italic:f,underline:h,strikethrough:a,language:e,superscript:l,
subscript:b};return{bold:c.constant(g),italic:c.constant(f),underline:c.constant(h),strikethrough:c.constant(a),language:c.constant(e),superscript:c.constant(l),subscript:c.constant(b),search:function(a){return void 0!==m[a]?d.some(m[a]):d.none()}}});k("an",["7","di"],function(c,d){var b=function(a,b){return a.query(b)};return{bold:c.curry(b,d.bold()),italic:c.curry(b,d.italic()),underline:c.curry(b,d.underline()),strikethrough:c.curry(b,d.strikethrough()),superscript:c.curry(b,d.superscript()),subscript:c.curry(b,
d.subscript()),language:c.curry(function(a,b){return a.queryValue(b)},d.language())}});k("7d",["7a","2u","an"],function(c,d,b){var a=d.immutable("bold","italic","underline","strikethrough","superscript","subscript"),e=function(a,b){return a.on(function(a){return b(a)?c.on(!0):c.off()}).getOrThunk(c.off)};return{read:function(c){return a(e(c,b.bold),e(c,b.italic),e(c,b.underline),e(c,b.strikethrough),e(c,b.superscript),e(c,b.subscript))}}});k("14e",["2u"],function(c){return c.immutable("startContainer",
"startOffset","endContainer","endOffset")});k("152",["2u"],function(c){var d=c.immutable("item","start","finish","text"),b=c.immutable("items","abort"),a=function(a,b){var c=a.property().getText(b);return d(b,0,c.length,c)},e=function(a,c,d){return b([],!0)},g=function(a,c,d){return b([],!1)},f=function(a,c,e){var f=a.property().getText(c);return e(f).fold(function(){return b([d(c,0,f.length,f)],!1)},function(a){a=a[0]===a[1]?[]:[d(c,a[0],a[1],f.substring(a[0],a[1]))];return b(a,!0)})};return{detail:a,
fromItem:function(b,c){return b.property().isText(c)?a(b,c):d(c,0,0,"")},decide:function(a,b,c,d){return(a.property().isBoundary(b)?e:a.property().isEmptyTag(b)?e:d(a,b)?e:a.property().isText(b)?f:g)(a,b,c)}}});k("p1",["7"],function(c){return{all:function(d,b){for(var a=b.term(),e=[],g=a.exec(d);g;){var f=g.index+b.prefix(g),g=g[0].length-b.prefix(g)-b.suffix(g);e.push({start:c.constant(f),finish:c.constant(f+g)});a.lastIndex=f+g;g=a.exec(d)}return e}}});k("p2",["b","6","p1","9"],function(c,d,b,a){var e=
function(b){b=a.prototype.slice.call(b,0);b.sort(function(a,b){return a.start()<b.start()?-1:b.start()<a.start()?1:0});return b};return{search:function(a,f){var h=c.bind(f,function(e){var f=b.all(a,e.pattern());return c.map(f,function(a){return d.merge(e,{start:a.start,finish:a.finish})})});return e(h)}}});k("h5",["p1","p2"],function(c,d){return{findall:function(b,a){return c.all(b,a)},findmany:function(b,a){return d.search(b,a)}}});k("zh",["7","s","6j","h5","68"],function(c,d,b,a,e){var g=new e(b.wordbreak()+
"+","g"),f=c.constant(0),h=function(c){c=a.findall(c,b.custom(b.wordbreak(),f,f,d.none()));return d.from(c[c.length-1]).map(function(a){return a.start()})},l=function(a){a=a.search(g);return-1<a?d.some(a):d.none()};return{firstWord:function(a){return l(a).map(function(b){return a.substring(0,b+1)})},lastWord:function(a){return h(a).map(function(b){return a.substring(b)})},leftBreak:h,rightBreak:l,hasBreak:function(a){return l(a).isSome()}}});k("15v",["i7","zh"],function(c,d){var b=c.walkers(),a=b.left(),
b=b.right();return{left:{sibling:a.sibling,first:a.first,slicer:function(a){return d.leftBreak(a).map(function(b){return[b+1,a.length]})}},right:{sibling:b.sibling,first:b.first,slicer:function(a){return d.rightBreak(a).map(function(a){return[0,a]})}}}});k("15b",["b","i7","152","15v"],function(c,d,b,a){var e=function(a,f,h,l,m){f=d.walk(a,f,h,l).map(function(c){var d=b.decide(a,c.item(),l.slicer,m);c=d.abort()?[]:e(a,c.item(),c.mode(),l,m);return d.items().concat(c)}).getOr([]);return c.filter(f,
function(a){return 0<a.text().trim().length})};return{creepLeft:function(b,c,h){return e(b,c,d.sidestep,a.left,h)},creepRight:function(b,c,h){return e(b,c,d.sidestep,a.right,h)},flatten:function(a,d){return a.property().isText(d)?[b.detail(a,d)]:c.map(a.down().predicate(d,a.property().isText),function(c){return b.detail(a,c)})},isEmpty:function(a,b){return a.property().isText(b)?!1:0===a.down().predicate(b,a.property().isText).length}}});k("153",["7","s"],function(c,d){var b=function(a,b){return a.up().closest(b,
"[lang]",c.constant(!1)).map(function(b){return a.attrs().get(b,"lang")})};return{nu:function(a){var b=[],g=[],f=[],h=a,l=function(a){a.each(function(a){b.push(a)})},m=function(a){a.each(function(a){b=b.slice(0,b.length-1)})},n=function(){0<f.length&&g.push({lang:c.constant(h),details:c.constant(f)})},p=function(a){n();f=[];h=a},r=function(c){return c.or(d.from(b[b.length-1])).getOr(a)};return{openInline:function(a,b){var c=r(a);c!==h&&p(c);l(a)},closeInline:function(a,b){m(a)},addDetail:function(a){var b=
r(d.none());b!==h&&p(b);f.push(a)},addEmpty:function(a){a=r(d.none());p(a)},openBoundary:function(a,b){l(a);var c=r(a);p(c)},closeBoundary:function(a,b){m(a);var c=r(a);p(c)},done:function(){n();return g.slice(0)}}},calculate:b,softBounder:function(a){return function(c,g){var f=b(c,g);return!d.equals(a,f)}},strictBounder:function(a,c){return function(d,f){var h=b(d,f).getOr(a);return c!==h}}}});k("14f",["b","7","15b","152","153"],function(c,d,b,a,e){var g=function(c,e,g,m){var n=b.creepLeft(c,e,m);
m=b.creepRight(c,g,m);e=0<n.length?n[n.length-1]:a.fromItem(c,e);c=0<m.length?m[m.length-1]:a.fromItem(c,g);n=0===n.length&&0===m.length;return{left:d.constant(e),right:d.constant(c),isEmpty:d.constant(n)}};return{byBoundary:function(a,c){var e=d.constant(!1),e=g(a,c,c,e),m=e.isEmpty()&&b.isEmpty(a,c);return{left:e.left,right:e.right,isEmpty:d.constant(m)}},getEdges:g,byLanguage:function(f,g){var l=e.calculate(f,g),m=e.softBounder(l),n=b.creepLeft(f,g,m),m=b.creepRight(f,g,m),p=f.property().isText(g)?
[a.detail(f,g)]:[],r=c.reverse(n).concat(p).concat(m);return{all:d.constant(r),left:d.constant(n),middle:d.constant(p),right:d.constant(m),lang:d.constant(l)}}}});k("11w","5b b 7 s 14e 14f".split(" "),function(c,d,b,a,e,g){var f=function(a,e,f,n){n=a.property().getText(e);var p=d.filter(n.substring(0,f),function(a){return a!==c.zeroWidth()}).length,r=d.filter(n.substring(f,n.length),function(a){return a===c.zeroWidth()}).length;a=g.byLanguage(a,e);e=0===p&&0===a.left().length;f=f+r===n.length&&0===
a.right().length;return{all:a.all,leftEdge:b.constant(e),rightEdge:b.constant(f),text:b.constant(n)}};return{before:function(b,c,d,g,p){b=f(b,c,d,p);b.rightEdge()?c=a.none():(b=b.all(),0===b.length?c=a.none():(b=b[b.length-1],c=a.some(e(c,g,b.item(),b.finish()))));return c},after:function(b,c,d,g,p){b=f(b,c,d,p);b.leftEdge()?c=a.none():(b=b.all(),0===b.length?c=a.none():(b=b[0],c=a.some(e(b.item(),b.start(),c,g))));return c},both:function(b,c,d,f,g,r){return f===g?a.none():a.some(e(c,f,c,g))},neither:function(b,
c,d,g){b=f(b,c,d,g);b.leftEdge()||b.rightEdge()?b=a.none():(c=b.all(),0===c.length?b=a.none():(b=c[0],c=c[c.length-1],b=a.some(e(b.item(),b.start(),c.item(),c.finish()))));return b}}});k("14g",["2u"],function(c){return c.immutable("before","after")});k("11x",["s","14g","zh"],function(c,d,b){return{around:function(a,e){var g=a.substring(0,e),f=b.leftBreak(g).map(function(a){return a+1}),g=a.substring(e),g=b.rightBreak(g).map(function(a){return e+a}),h=d(f,g),l=d(c.some(e),c.some(e));return g.bind(function(a){return e===
a?c.some(l):c.none()}).getOrThunk(function(){return f.bind(function(a){return e===a?c.some(l):c.none()}).getOr(h)})}}});k("z1",["s","11w","11x"],function(c,d,b){return{word:function(a,e,g,f){if(!a.property().isText(e))return c.none();var h=a.property().getText(e),l=b.around(h,g);return l.before().fold(function(){return l.after().fold(function(){return d.neither(a,e,g,f)},function(b){return d.after(a,e,g,b,f)})},function(b){return l.after().fold(function(){return d.before(a,e,g,b,f)},function(c){return d.both(a,
e,g,b,c,f)})})}}});k("uq",["z1"],function(c){return{word:function(d,b,a,e){return c.word(d,b,a,e)}}});k("m5",["dy","uq"],function(c,d){var b=c();return{word:function(a,c,g){return d.word(b,a,c,g)}}});k("dm",["7s","7","m5"],function(c,d,b){var a=function(a,c,f){b.word(c,f,d.constant(!1)).each(function(b){a.setSelection(b.startContainer(),b.startOffset(),b.endContainer(),b.endOffset())})};return{expand:function(b){b.getSelection().each(function(d){c.isCollapsed(d.startContainer(),d.startOffset(),d.endContainer(),
d.endOffset())&&a(b,d.startContainer(),d.startOffset())})},expandWord:a}});k("dp","5b d6 s dl dn di dq 1a 2m 1y 1b 2o 3c 21 2q 31 m ak 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,v,k){var x=function(a){a=k.children(a);return 1===a.length&&q.isText(a[0])&&v.get(a[0])===c.zeroWidth()},y=function(b,c){return t.closest(b,"."+a.styleSpan()).bind(function(b){return t.closest(c,"."+a.styleSpan()).filter(function(a){return n.eq(b,a)})})},B=function(c,d,e){m.remove(d,a.styleSpan());return h.has(d,
a.overrideSpan())?z(c,d,e):b.some(e)},z=function(a,c,d){return A(c).bind(function(f){if(f.isStyled(c)){var g=D(f.nu,c);f=n.eq(c,d.start())?g:d.start();g=n.eq(c,d.finish())?g:d.finish();f=b.some(e.fussy(f,d.soffset(),g,d.foffset()))}else f=F(a,c,f.purifiers(),d);return f})},A=function(b){b=h.get(b,a.overrideSpan());return g.search(b).map(function(a){return a.deferred()})},C=function(a){k.prevSibling(a).each(function(a){q.isText(a)&&v.get(a)===c.zeroWidth()&&s.remove(a)})},D=function(a,b){var c=k.owner(b),
c=a(c);p.before(b,c);r.append(c,k.children(b));s.remove(b);return c},F=function(c,d,g,h){d=k.owner(d);var m=e.fromFussy(h);f.doRemove(c,g,m);c="["+a.overrideSpan()+"]";return u.one(c,d).bind(function(a){s.unwrap(a);return l.inBody(h.start())&&l.inBody(h.finish())?b.some(h):b.none()})};return{clean:function(a,b){if(x(b))s.unwrap(b);else{var c=e.fussy(b,0,b,k.children(b).length-1);B(a,b,c)}},isTransient:x,withinTransient:y,handleOverride:z,forceConvert:function(a){x(a)&&(C(a),A(a).bind(function(b){D(b.nu,
a)}))},apply:function(a,c,f,g,h){var l=e.fussy(c,f,g,h);return y(c,g).bind(function(c){if(x(c)){var f=k.children(c),f=n.eq(c,l.start())?e.fussy(f[0],0,f[0],d.getEnd(f[0])):l;s.unwrap(c);c=b.some(f)}else c=B(a,c,l);return c})}}});k("do","d6 s m6 dm dn dp dq 2o 2q 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m){var n=function(a,b){return a.action().run(a.isRoot(),a.environment())};return{override:function(a,b){var f=a.temp();g.handleOverride(a.isRoot(),f,e.fussy(f,0,f,c.getEnd(f)));return d.some(b)},insertAfter:function(a,
b){h.after(a.temp(),a.cursor());return d.some(b)},insertBefore:function(a,b){h.before(a.temp(),a.cursor());return d.some(b)},insertAt:function(a,c){var e=a.original();b.atStartOf(e.startContainer(),e.startOffset(),a.cursor());return d.some(c)},apply:n,applyIfOffCursor:function(a,b){var c=a.action().deferred().isStyled(a.temp()),f=a.cursor(),g=d.some(e.fussy(f,1,f,1));c?c=g:(a.environment().setSelection(f,0,f,0),c=n(a,b));return c},clearCursor:function(a,b){var c=a.cursor(),g=a.action().deferred();
f.doRemove(a.isRoot(),g.purifiers(),e.hare(c,0,c,1));return d.some(e.fussy(c,1,c,1))},applyOverCursor:function(a,b){var c=a.cursor();a.environment().setSelection(c,0,c,1);n(a,b);return d.some(e.fussy(c,1,c,1))},regrab:function(b,c){var d=b.environment(),f=b.original();d.setSelection(f.startContainer(),f.startOffset(),f.endContainer(),f.endOffset());a.expand(d);return d.getSelection().map(e.fromHare)},clearSelection:function(a,b){var c=a.action().deferred();return f.doRemove(a.isRoot(),c.purifiers(),
e.fromFussy(b))},applyIfOffRange:function(a,b){var c;a.action().deferred().isStyled(a.temp())?c=d.some(b):(a.environment().setSelection(b.start(),b.soffset(),b.finish(),b.foffset()),c=n(a,b));return c},unwrap:function(a,b){var f=a.temp(),g=m.children(f);l.unwrap(f);return 0===g.length?d.none():d.some(e.fussy(g[0],0,g[g.length-1],c.getEnd(g[g.length-1])))}}});k("7e","5b b dj d6 7 s 2u dk dl dm dn di do dp dq 1a 1b l".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,v){var k=f.immutable("environment",
"isRoot","cursor","temp","action","original"),x=function(c,d){return b.lastCursor(c).fold(e.constant(!0),function(b){return u.eq(b,d.startContainer())&&a.getEnd(b)===d.startOffset()})},y=function(a,c){return b.firstCursor(a).fold(e.constant(!0),function(a){return u.eq(a,c.startContainer())&&0===c.startOffset()})},B=function(a,b,e,f,h){var m=t.get(f,l.overrideSpan()),p=h.collapsed(),s=v.fromText(c.zeroWidth()),u=x(f,h),B=y(f,h),m=a.name()===m,J=k(e,b,s,f,a,h);a=m&&q.isTransient(f)?[r.unwrap]:p&&m&&
u?[r.insertAfter,r.override,r.applyIfOffCursor]:p&&m&&B?[r.insertBefore,r.override,r.applyIfOffCursor]:p&&m?[r.insertAt,r.override,r.clearCursor]:p&&u?[r.insertAt,r.override,r.applyOverCursor]:p&&B?[r.insertBefore,r.override,r.applyOverCursor]:p?[r.insertAt,r.override,r.applyOverCursor]:m?[r.override,r.regrab,r.clearSelection,r.applyIfOffRange]:[r.override,r.regrab,r.apply];return d.foldl(a,function(a,b){return a.bind(function(a){return b(J,a)})},g.some(n.fromHare(h)))};f=function(a,b,c){m.expand(c);
var d=c.getSelection().bind(function(d){return q.withinTransient(d.startContainer(),d.endContainer()).filter(function(a){return t.has(a,l.overrideSpan())}).fold(function(){return a.run(b,c)},function(e){return B(a,b,c,e,d)})});return h.inlineFrom(d)};return{bold:e.curry(f,p.bold()),italic:e.curry(f,p.italic()),underline:e.curry(f,p.underline()),strikethrough:e.curry(f,p.strikethrough()),superscript:e.curry(f,p.superscript()),subscript:e.curry(f,p.subscript()),removeformat:function(a,b){m.expand(b);
var c=b.getSelection().bind(function(b){var c=s.allRules();return s.doRemove(a,c,b)});return h.inlineFrom(c)},language:e.curry(function(a,b,c,d){c.getSelection().each(function(a){q.apply(b,a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset()).each(function(a){c.setSelection(a.start(),a.soffset(),a.finish(),a.foffset())})});m.expand(c);a=a.run(b,c,d);return h.inlineFrom(a)},p.language()),cleanup:q.clean,isTransient:q.isTransient,withinTransient:q.withinTransient,coalesce:q.forceConvert}});
k("5e","7 7b 7c 73 7d 6t 74 7a 54 46 7e".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){return function(p){var r=p.content(),q=p.shortcuts(),s=p.undo(),t=m.create({analytics:l(["message","properties"])}),u=function(a,b){var d=e.read(r);(void 0!==d[a]?d[a]():h.unchanged()).fold(b.deselect,c.noop,b.select)},v=function(a){var e=function(b){return a(r.isRoot,b)};return function(){b.cata(p.selections().get(),c.noop,d.multiple(r,s,e),d.single(r,s,e));r.uiChanged()}},k=v(n.bold),x=v(n.italic),y=v(n.underline),
B=v(n.strikethrough),z=v(n.subscript),A=v(n.superscript),v=v(n.removeformat);q.events.bold.bind(k);q.events.italic.bind(x);q.events.underline.bind(y);return{ui:g.ui({"bold.general":{toggle:!0,value:"bold",textkey:a.key("action.bold"),action:k,updateGeneral:c.curry(u,"bold"),icon:!0,tooltip:f.get},"italic.general":{toggle:!0,value:"italic",textkey:a.key("action.italic"),action:x,updateGeneral:c.curry(u,"italic"),icon:!0,tooltip:f.get},"underline.general":{toggle:!0,value:"underline",textkey:a.key("action.underline"),
action:y,updateGeneral:c.curry(u,"underline"),icon:!0,tooltip:f.get},"strikethrough.general":{toggle:!0,value:"strikethrough",textkey:a.key("action.strikethrough"),action:B,updateGeneral:c.curry(u,"strikethrough"),icon:!0,tooltip:f.get},"removeformat.general":{toggle:!1,value:"removeformat",textkey:a.key("action.removeformat"),action:v,updateGeneral:c.identity,icon:!0,tooltip:f.get},"subscript.general":{toggle:!0,value:"subscript",textkey:a.key("action.subscript"),action:z,updateGeneral:c.curry(u,
"subscript"),icon:!0,tooltip:f.get},"superscript.general":{toggle:!0,value:"superscript",textkey:a.key("action.superscript"),action:A,updateGeneral:c.curry(u,"superscript"),icon:!0,tooltip:f.get}}),events:t.registry,destroy:c.noop}}});k("dr",["b","d1"],function(c,d){return{multiple:function(b,a,e,g){return function(f,h){d.runTransaction(b,a,function(){c.each(h,e)},g)}},single:function(b,a,c,g){return function(f,h){d.runTransaction(b,a,function(){c(h)},g)}}}});k("93",["7","33","ca"],function(c,d,b){var a=
d.resolve("highlight-common"),e=d.resolve("highlight-placeholder");return{configure:function(c){c.add(c.output(),a,b.unwrap);c.add(c.history(),e,b.unwrap);c.add(c.output(),e,b.unwrap);c.add(c.output(),"ephox-custom-highlight",b.unwrap);c.add(c.history(),"ephox-custom-highlight",b.unwrap)},highlightClass:c.constant(a),customHighlightClass:c.constant("ephox-custom-highlight"),placeholderClass:c.constant(e)}});k("7n",["93","7a","2u","1y"],function(c,d,b,a){var e=b.immutable("content");return{hasSelection:function(a){return a.getSelection().fold(function(){return e(d.off())},
function(){return e(d.on(!0))})},isAnnotation:function(b){return a.has(b,"ephox-cram-annotation-wrap")||a.has(b,c.customHighlightClass())}}});k("mb",["ln"],function(c){var d=function(a,b,c){c=a.create().nu(c);var d=a.property().children(b);a.insert().append(b,c);a.insert().appendAll(c,d);return c},b=function(a,b,c){c=a.create().nu(c);var d=a.property().children(b);a.attrs().copyTo(b,c);a.insert().before(b,c);a.insert().appendAll(c,d);a.remove().remove(b);return c};return{blockTransform:function(a,
e,g){return(c.isFormatting(a,e)?b:d)(a,e,g)},nest:d,replace:b}});k("mc",["7"],function(c){return{tags:c.constant("address article aside audio blockquote canvas dd div dl fieldset figcaption figure footer form h1 h2 h3 h4 h5 h6 header hgroup hr li noscript ol output p pre section table tbody td tfoot th thead tr ul video".split(" "))}});k("e4",["b","7","s","mc"],function(c,d,b,a){return function(e){var g=function(a,g,l,m){var n=l.join(",");a=e.up().closest(a,n,m);g=e.up().closest(g,n,m);return a.isSome()&&
g.isSome()?(m=a.getOrDie("Just checked it was some."),g=g.getOrDie("Just checked it was some."),e.eq(m,g)?(l=c.find(l,d.curry(e.is,m)),l=void 0!==l&&null!==l?b.some(l):b.none()):l=b.none(),l):b.none()};return{query:function(b,c,d){c=c.concat(a.tags());return g(b.startContainer(),b.endContainer(),c,d)},queryAll:g}}});k("ds","dy b mb e1 lv e4".split(" "),function(c,d,b,a,e,g){var f=c(),h=g(f);return{query:function(a,b,c){return h.query(a,b,c)},apply:function(f,g,h,p,r,q){return a.applyOn(f,e,g,h,p,
r,function(a){return d.map(a,function(a){return b.blockTransform(c(),a,q)})})}}});k("dt",["md","dm","1a","1y"],function(c,d,b,a){return{background:function(a,b,f){c.style(a,{"background-color":b},d.expand,f)},addClass:function(b,g,f){c.generic(b,d.expand,f,function(b){a.add(b,g)})},foreground:function(a,b,f){c.style(a,{color:b},d.expand,f)},addAttribute:function(a){return function(g,f,h){c.generic(g,d.expand,h,function(c){b.set(c,a,f)})}},face:function(a,b,f){c.style(a,{"font-family":b},d.expand,
f)},size:function(a,b,f){c.style(a,{"font-size":b},d.expand,f)}}});k("7f","b 7 s d1 d2 dr d4 d5 7c 7n ds dt 1a 31".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q){var s=function(a,c,d,g,m){c=function(b,c,e,f){return a(d.isRoot,b,c,e,f)};var n=e.multiple(d,g,c),p=e.single(d,g,c,h.spot,f.update);return l.cata(m.get(),b.none,function(a,c){return b.some(n(a,c))},function(a,c){return b.some(p(a,c))})};return{transform:function(a,b,c,d,e){return s(function(a,b,c,d,f){return n.apply(a,b,c,d,f,e)},a,b,c,
d)},setClass:function(b,e,f,g,h,m){var n=function(b){q.closest(b,h).each(function(b){a.runTransaction(e,f,function(){r.set(b,"class",m)},e.toEditing)})};l.cata(g.get(),d.noop,function(a,b){c.each(a,n)},function(a,b){n(a.startContainer())})},inline:function(a,b,c,e,f){a=function(a){p.addClass(a,f,m.isAnnotation)};l.cata(e.get(),d.noop,g.multiple(b,c,a,b.toEditing),g.single(b,c,a,b.toEditing))},list:function(a,b,c,d,e){return s(a,b,c,d,e)}}});k("7g","b 6 s 73 2u 6m".split(" "),function(c,d,b,a,e,g){var f=
e.immutable("label","items"),h=function(c,d){return 0<d.length?[f(b.some(a.key(c)),d)]:[]};return{groups:function(a,e,n){var p=a.divisions(),r=c.map(p.blocks().concat(p.classblocks()),a.toCandidate),q=c.map(p.inlines(),a.toCandidate);a=c.map(p.objects(),a.toCandidate);a=c.foldr(a,function(a,b){var f;g.closest(e,b.base(),n)?(f=b.base(),f=c.contains(["a"],f)?d.merge(a,{link:a.link.concat([b])}):c.contains(["embed","img","object"],f)?d.merge(a,{media:a.media.concat([b])}):c.contains(["hr"],f)?d.merge(a,
{line:a.line.concat([b])}):c.contains(["li","ol","ul"],f)?d.merge(a,{list:a.list.concat([b])}):c.contains(["table","tr","td","th"],f)?d.merge(a,{table:a.table.concat([b])}):a):f=a;return f},{link:[],media:[],line:[],list:[],table:[]});return c.flatten([[f(b.none(),r)],h("block.label.inline",q),h("block.label.link",a.link),h("block.label.media",a.media),h("block.label.line",a.line),h("block.label.list",a.list),h("block.label.table",a.table)])}}});k("7i",[],function(){var c=function(c,b){return{fold:b}};
return{inline:function(d,b,a){return c("inline",function(c,g,f,h){return c(d,b,a)})},object:function(d,b,a,e){return c("object",function(c,f,h,l){return f(d,b,a,e)})},block:function(d,b,a){return c("block",function(c,g,f,h){return f(d,b,a)})},classblock:function(d,b,a,e){return c("classed block",function(c,f,h,l){return l(d,b,a,e)})},cata:function(c,b,a,e,g){return c.fold(b,a,e,g)}}});k("du","b 7 s p 7i 73".split(" "),function(c,d,b,a,e,g){var f="h1 h2 h3 h4 h5 h6 div p pre".split(" "),h="a embed hr img li object ol table td tr ul th".split(" "),
l=function(a){var c=a.indexOf("."),e;-1<c?(e=a.substring(0,c),a=a.substring(c+1),e=-1===a.indexOf(".")?b.some({tag:d.constant(e),clazz:d.constant(a)}):b.none()):e=b.none();return e},m=function(b,d){var g=b.tag(),l=b.clazz(),m=c.contains(f,g),n=c.contains(h,g);return(m?a.value(e.classblock):n?a.value(e.object):a.error("Rule must have object tag or block tag.")).map(function(a){var c=r(d,b,m);return a(g,l,c,d.style)})},n=function(a){return a.text.getOrThunk(function(){return g.key("block."+a.name)})},
p=function(a,b){return a.text.getOrThunk(function(){return g.pkey("tag.inline.class",[b])})},r=function(a,b,c){return a.text.getOrThunk(function(){var a=(c?"block":"tag")+"."+b.tag(),a=(g.has(a)?g.translate(a):b.tag())+" ("+b.clazz()+")";return g.raw(a)})};return{decipher:function(b){return l(b.name).fold(function(){return c.contains(f,b.name)?a.value(e.block(b.name,n(b),b.style)):a.error("Invalid style name: "+b.name)},function(c){return 0<c.tag().length?m(c,b):a.value(e.inline(c.clazz(),p(b,c.clazz()),
b.style))})}}});k("7h","b 1o 7 s du 7i 73 2u".split(" "),function(c,d,b,a,e,g,f,h){return function(l){var m=h.immutable("base","value","textkey","icon","styles","tag");l=c.map(l.styles,function(b){return{name:b.rule,text:a.from(b.text).map(f.raw),style:void 0===b.style?{}:b.style}});var n={};c.each(l,function(a){e.decipher(a).each(function(b){n[a.name]=b})});l=b.constant(!0);var p=b.constant(!1),r=function(a,b,c,d){return function(e){return g.cata(e,a,b,c,d)}},q=d.values(n),s=c.filter(q,r(p,p,p,l)),
t=c.filter(q,r(p,p,l,p)),u=c.filter(q,r(p,l,p,p)),v=c.filter(q,r(l,p,p,p));l=function(){var a=s.concat(u).concat(t).concat(v);return c.map(a,function(a){return g.cata(a,function(a,b,c){return"."+a},function(a,b,c,d){return a+"."+b},function(a,b,c){return a},function(a,b,c,d){return a+"."+b})})}();var k=function(b){return void 0!==n[b]?a.some(n[b]):a.none()},x=function(b){return g.cata(b,function(b,c,d){return m("span","."+b,c,a.none(),d,"span")},function(b,c,d,e){return m(b,b+"."+c,d,a.none(),e,"span")},
function(b,c,d){return m(b,b,c,a.none(),d,b)},function(b,c,d,e){return m(b,b+"."+c,d,a.none(),e,b)})},p=function(){var a=d.values(n);return c.map(a,x)}();return{candidateByName:function(a){return k(a).map(x)},toCandidate:x,ruleByName:k,divisions:function(){return{classblocks:b.constant(s),blocks:b.constant(t),objects:b.constant(u),inlines:b.constant(v)}},backup:function(b){return m(b,b,f.key("block."+b),a.none(),{},"span")},selectors:b.constant(l),everything:b.constant(p)}}});k("dw",["7","73"],function(c,
d){return{text:function(b){var a=d.get(b.textkey()),e=d.cata(b.textkey(),c.constant(!0),c.constant(!1),c.constant(!1));b=e&&void 0===a?b.value():a;return{text:c.constant(b),unknown:c.constant(e)}}}});k("7j","4z dv dw 73 33 1y 4b 2n l 2o".split(" "),function(c,d,b,a,e,g,f,h,l,m){return{format:function(b){var d=l.fromText(a.get(b.textkey())),f=c.div();g.add(f,e.resolve("format-element-"+b.tag()));h.setAll(f,b.styles());b=c.div();g.add(b,e.resolve("format-element-container"));m.append(f,d);m.append(b,
f);return b},face:function(a){var c=b.text(a),g=c.text(),g=d(g).element();h.setAll(g,{"font-family":a.value()});a=c.unknown()?[e.resolve("font-face-unknown")]:[];f.add(g,a);return g}}});k("me","7v er a7 4z 7 s 73 33 7a 54 46 1a 1y 2n 3u l 2o 2q".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,v){var k=function(b,d){var e=t.fromTag(b);c.hidden(e,!0);q.set(e,"list-style-type",d);for(var f=h.resolve("list-style-content"),g=0;3>g;g++){var l=t.fromTag("li"),m=a.span();r.add(m,f);u.append(l,m);u.append(e,
l)}return e},x=function(b,c){var d=f.translate(c),e=t.fromText(d),g=a.span();r.add(g,h.resolve("list-style-default"));p.set(b,"data-"+h.resolve("list-style"),"default");p.set(b,"title",d);u.append(g,e);return g};return function(a,q,z){var A=z(void 0===q||"default"===q?g.none():g.some(q)),C=t.fromTag("div");r.add(C,h.resolve("list-style-option"));z=void 0===q||"default"===q?x(C,"ul"===a?"list.unordered.default":"list.ordered.default"):k(a,q);u.append(C,z);a=f.translate(("ul"===a?"list.unordered.":
"list.ordered.")+q);p.set(C,"title",a);c.label(C,a);c.menuItemCheckbox(C);var D=b.describe(C,f.translate("aria.widget.navigation"));u.append(C,D);var F=n.create({action:m(["type","element"])}),E=function(){d.checked(C,!0);r.add(C,h.resolve("list-style-selected"))},G=function(){d.checked(C,!1);r.remove(C,h.resolve("list-style-selected"))},H=s.bind(C,"click",function(a){F.trigger.action(A,g.some(C))});return{element:e.constant(C),instance:A,style:q,update:function(a){(A.query(a)&&A.queryStyle(a)?l.on(!0):
l.off()).fold(G,e.noop,E)},select:E,deselect:G,events:F.registry,destroy:function(){H.unbind();v.remove(C);v.remove(D)}}}});k("dx","b g2 8h 4z 7 s me 33 54 46 1a 1y 2o 2q 31 1s".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t){var u="data-"+h.resolve("list-style");return function(v,k,x){var y=m.create({action:l(["type"])}),B=a.div();p.add(B,h.resolve("list-style-palette"));var z=c.map(v,function(a){return f("bullist"===k?"ul":"ol",a,x)});c.each(z,function(a){a.events.action.bind(function(a){a.element().each(D);
y.trigger.action(a.type())});r.append(B,a.element())});var A=function(){var a=t.floor(z.length/4)+(0<z.length%4?1:0);return b.grid(B,{cell:e.constant("."+h.resolve("list-style-option"))},a,4,d.grid({trigger:function(a){a.dom().click();return g.some(a)}}))}(),C=function(a){a=c.find(z,a);return g.from(a)},D=function(a){s.sibling(a,"["+u+'="default"]').filter(function(b){return b!==a}).bind(function(b){n.remove(b,u);n.set(a,u,"default")})};return{enter:A.enter,element:e.constant(B),update:function(a){c.each(z,
function(b){b.update(a)})},events:y.registry,destroy:function(a){A.isFocused()&&A.exit();A.destroy();c.each(z,function(a){a.destroy()});q.remove(B)},findDefault:function(){return C(function(a){return n.has(a.element(),u)}).map(function(a){return a.instance})}}}});k("7k","c a8 7 d0 7f dx 74 7a 54 46 2y 31".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p){return function(r){var q=r.region(),s=r.content(),t=r.undo(),u=r.keyboard(),v=r.listConstructor(),k=r.type(),x=r.styles(),y=r.textkey(),B=r.menuTextkey(),
z=v("default"),A=c.detect(),C=u.all();C.swallowKeys([d.ESCAPE()]);var D=m.create({abort:l([]),done:l([]),close:l([]),analytics:l(["message"])});C.events.escape.bind(function(a){D.trigger.abort()});var F=function(b){var c=e.list(function(c,d,e,f,g){return b.apply(c,d,e,f,g,a(q))},q,s,t,r.selections());D.trigger.done();s.focus();return c},E=function(){p.descendant(G.element(),'[data-ephox-polish-list-style="default"]').each(function(a){n.focus(a)})},G=g(x,k,v);G.events.action.bind(function(a){F(a.type())});
return{action:function(){var a=G.findDefault().getOr(z);F(a)},element:G.element,shortcut:!1,textkey:b.constant(y),menuTextkey:b.constant(B),label:b.constant(!1),name:b.constant(k),tooltip:f.get,toggle:!0,value:k,updateWidget:function(a){s.getSelection().each(function(c){var d=z.query(c)?h.on(!0):h.off();d.fold(a.deselect,b.noop,a.select);d.fold(a.release,b.noop,a.press);G.update(c)})},open:function(){A.deviceType.isTouch()||E();C.on()},close:function(){C.off();D.trigger.close()},icon:!0,events:D.registry,
enter:G.enter,destroy:function(){C.off();C.destroy();G.destroy()}}}});k("mf",["6","4n"],function(c,d){var b=d.generate([{mine:["element"]},{other:["element"]},{paragraphs:["elements"]}]);return c.merge(b,{cata:function(a,b,c,d){return a.fold(b,c,d)}})});k("mg","b s ep mf 2n 21 2a".split(" "),function(c,d,b,a,e,g,f){var h=function(a,b,c){var d=g.name(a);return e.getRaw(a,"list-style-type").fold(function(){return d===b&&c.isNone()},function(a){return c.exists(function(c){return d===b&&a===c})})};return{categorise:function(d,
e,g){d=c.groupBy(d,function(a){return b.isList(a)?!0:f.parent(a).map(function(a){return a.dom()}).getOr(!1)});return c.bind(d,function(d){return c.forall(d,b.isList)?c.map(d,function(b){return h(b,e,g)?a.mine(b):a.other(b)}):[a.paragraphs(d)]})}}});k("dz","b dj d6 7 s db mb mf mg 1a 2n l 2o 3c 21 f4 4e".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u){return function(v,k,x){var y=function(a){if("p"===s.name(a))return f.replace(v,a,"li");var b=p.fromTag("li");r.before(a,b);r.append(b,a);return b},
B=function(a){var b=p.fromTag(k);x.each(function(a){n.set(b,"list-style-type",a)});r.before(a[0],b);q.append(b,a);e.from(m.get(a[0],"dir")).each(function(a){m.set(b,"dir",a)});return b},z=function(a){var b=t.mutate(a,k);x.fold(function(){n.remove(b,"list-style-type")},function(a){n.set(b,"list-style-type",a)});return b},A=function(b){var c=a.constant(!0),d=a.constant(!1);return b.fold(c,d,d)},C=function(a,c){return function(f){return h.cata(f,function(f){var h=u.descendants(f,"li");return 0<h.length?
(f=h[0],h=h[h.length-1],f=d.firstCursor(f).getOr(f),h=d.lastCursor(h).getOr(h),g.outdent(a,f,0,h,b.getEnd(h),c).map(function(a){return a.all()})):e.none()},e.none,e.none).getOr([])}},D=function(a){return h.cata(a,function(a){return[a]},function(a){return[z(a)]},function(a){a=c.map(a,y);B(a);return a})};return{apply:function(a,b,d){d=l.categorise(d,k,x);a=c.forall(d,A)?C(a,b):D;return c.bind(d,a)}}}});k("e0","dy b 7 s ep mh mi mj 21 31".split(" "),function(c,d,b,a,e,g,f,h,l,m){var n=function(a){return f.cata(a,
function(a){return h.wrap(a)},function(a){return[a]},function(a,b){return e.isList(a)?[a]:d.bind(b,n)},function(a){return h.wrap([a])})};return{isRootContainer:function(a){return function(b){return a(b)||e.isContainer(b)&&"li"!==l.name(b)}},extract:n,isCapable:e.isBlock,canUse:b.constant(!1),quasi:function(){return a.some(g.nu(c()))},ascend:function(a,b){return m.closest(a,"ol,ul",b).getOr(a)}}});k("e2","lt mk ml 2n l 21".split(" "),function(c,d,b,a,e,g){var f=function(b,d,f){var g=e.fromTag(d);f.each(function(b){a.set(g,
"list-style-type",b)});return c.list(b,g)},h=function(b,c){var d=a.getRaw(b,"list-style-type");return c.fold(function(){return d.isNone()},function(a){return d.is(a)})},l=function(a,b,c){return g.name(a)===b&&h(a,c)};return{isAlready:l,convertOr:function(a,b,c){return function(d){return l(d.list(),a,b)?c(d):f(d,a,b)}},topContext:function(a,c,e){return b.context(a,c,b.topmost,d.groupWrite,e)},context:function(a,c,e){return b.context(a,c,b.immediate,d.groupWrite,e)},unapply:function(a){return c.level(a,
-1*a.level())}}});k("7o","dy b 7 s dz e0 e1 e2 e3 e4 2n 21 31".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r){var q=c(),s=m(q),t=function(b){b=d.map(b,function(a){return r.ancestor(a,"ul,ol")});var c=d.map(b,function(a){return a.fold(function(){return"-"},function(a){return p.name(a)+"-"+n.get(a,"list-style-type")})}),e=c[0];return d.forall(c.slice(1),function(a){return a===e})?b[0]:a.none()};c=function(a,c,d){var m=e(q,a,d),n=function(a,b,c,d,e,h){return f.applyOn(a,g,b,c,d,e,function(b){return m.apply(a,
h,b)})},p=function(b){b=b.selected();return 0<b.length&&t(b).map(function(b){return h.isAlready(b,a,d)}).getOr(!1)};return{query:function(b){return s.queryAll(b.startContainer(),b.endContainer(),["ul","ol"],c).exists(function(b){return b===a})},queryStyle:function(a){var b=d.fold(function(){return":not([style])"},function(a){return'[style*="list-style-type: '+a+';"]'});return q.up().closest(a.startContainer(),"ol, ul",c).exists(function(d){return q.up().closest(a.endContainer(),"ol, ul",c).exists(function(a){return d.dom()===
a.dom()?q.is(d,b):!1})})},apply:function(c,e,f,g,m,r){var q=function(){return n(c,e,f,g,m,r)},s=function(b,c){return l.executeUsing(b,e,f,g,m,function(){return h.convertOr(a,d,c)})},t=function(){return h.topContext(e,g,c).fold(q,function(a){return s(a,h.unapply)})};return h.context(e,g,c).fold(q,function(a){return p(a)?t():s(a,b.identity)})}}};return{unordered:b.curry(c,"ul"),ordered:b.curry(c,"ol")}});k("7l","7 s d0 7f 73 74 7a 7o".split(" "),function(c,d,b,a,e,g,f,h){var l=function(h,l,m,q){return function(m){var r=
q(m.content().isRoot,d.none());return{toggle:!0,value:h,textkey:e.key(l),icon:!0,tooltip:g.get,updateGeneral:function(a){m.content().getSelection().each(function(b){(r.query(b)?f.on(!0):f.off()).fold(a.deselect,c.noop,a.select)})},action:function(){a.list(function(a,c,d,e,f){return r.apply(a,c,d,e,f,b(m.region()))},m.region(),m.content(),m.undo(),m.selections());m.content().focus()}}}},m=l("bullist","action.bullist","ul",h.unordered);return{ol:l("numlist","action.numlist","ol",h.ordered),ul:m}});
k("7m",["b","7a","2u","ds"],function(c,d,b,a){var e=b.immutable("tag"),g=function(a,b){return c.contains(["label","li","td","th","normal"],b)?d.on(a.backup(b)):d.off()},f=function(b,c,e){return a.query(b,c.selectors(),e).fold(function(){return b.collapsed()?g(c,"normal"):d.off()},function(a){return c.candidateByName(a).map(d.on).getOrThunk(function(){return g(c,a)})})};return{read:function(a,b){var c=a.getSelection().fold(function(){return d.off()},function(c){return f(c,b,a.isRoot)});return e(c)}}});
k("5f","b c 7 s 7f 7c 7g 7h 7i 77 7j 7k 7l 73 7m 7n 6t 74 54 46 2u 7o 1a 2n 31 q 3t".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,v,k,x,y,B,z,A,C,D,F){var E=d.detect();return function(d,D){var I=x.create({analytics:k(["message"])}),L=h(D),J=d.region(),K=d.content(),M=d.undo(),N=a.some(n.format),S=K.isRoot,Q=function(a){E.deviceType.isiOS()&&c.each(c.groupBy(c.filter(c.map(a,function(a){return C.ancestor(a,"ul,ol",S).getOr(!1)}),b.identity),function(a){return a.dom()}),function(a){var b=A.get(a[0],
"list-style-type");A.set(a[0],"list-style-type","none");F(function(){A.set(a[0],"list-style-type",b)},0)})},P=function(){return g.cata(d.selections().get(),b.constant([]),function(a){return 0<a.length?f.groups(L,a[0]):[]},function(a,b){return f.groups(L,a.startContainer(),S)})},R=function(b){var c=t.hasSelection(K),d=s.read(K,L),e=P();b.populate(e);m.updateMenu(b,d.tag(),c.content(),L.everything(),a.none())},O=function(a){L.ruleByName(a).each(function(a){l.cata(a,function(a,b,c){e.inline(J,K,M,d.selections(),
a)},function(a,b,c,f){e.setClass(J,K,M,d.selections(),a,b)},function(a,b,f){e.transform(J,K,M,d.selections(),a).each(function(a){c.each(a,function(a){z.remove(a,"class")});Q(a)})},function(a,b,f,g){e.transform(J,K,M,d.selections(),a).each(function(a){c.each(a,function(a){z.set(a,"class",b)});Q(a)})});K.uiChanged()})},T=y.immutableBag("region content undo selections keyboard listConstructor type styles textkey menuTextkey".split(" "),[]),W=T({region:J,content:K,undo:M,selections:d.selections(),keyboard:d.keyboard(),
listConstructor:b.curry(B.unordered,S),type:"bullist",styles:["default","disc","circle","square"],textkey:q.key("action.bullist"),menuTextkey:q.key("list.unordered.menu")}),T=T({region:J,content:K,undo:M,selections:d.selections(),keyboard:d.keyboard(),listConstructor:b.curry(B.ordered,S),type:"numlist",styles:"default decimal upper-alpha lower-alpha upper-roman lower-roman lower-greek".split(" "),textkey:q.key("action.numlist"),menuTextkey:q.key("list.ordered.menu")}),X=function(a){return q.translate("block.describe",
q.get(a.textkey()))},W=b.curry(p,W),T=b.curry(p,T);return{ui:u.ui({"blocktag.dropdown":function(){return{name:"blocktag",textkey:q.key("block.styles"),menuTextkey:q.key("block.menu"),updateDropdown:R,action:O,values:L.everything(),render:N,tooltip:v.get,toggle:!1,describe:X}},"bullist.widget":W,"numlist.widget":T,"bullist.general":b.constant(r.ul(d)),"numlist.general":b.constant(r.ol(d))},b.identity),events:I.registry,destroy:b.noop}}});k("mm","b 7 ep lu mi nz mj 21".split(" "),function(c,d,b,a,e,
g,f,h){var l=["li"],m=function(a,b){return e.cata(a,function(a){return!0===b?[]:f.wrap(a)},function(a){return[a]},function(a,b){return"table"===h.name(a)?[a]:f.handleContainer(l,a,b,m)},function(a){return!0===b?[]:f.wrap([a])})};return{isRootContainer:a.isRootOrContainer,extract:function(a){return m(a,!1)},isCapable:function(a){return g.isBlock(a)||c.contains(l,h.name(a))},canUse:function(a){return b.isFormatting(a)||c.contains(l,h.name(a))},quasi:d.curry(f.handleRoot,l),ascend:d.identity}});k("mn",
["1a"],function(c){return function(d,b){return{is:function(a){return c.get(a,d)===b},remove:function(a){c.remove(a,d)},set:function(a){c.set(a,d,b)}}}});k("e5","b 7 lj mm e1 mn 2n bl 31".split(" "),function(c,d,b,a,e,g,f,h,l){var m=function(a,b){return l.closest(b,'[dir="rtl"],[dir="ltr"]').filter(a).isSome()},n=function(l,n,p){var t=g(n,p),u=function(a){t.set(a);f.reflow(a)},v=function(a){return h.getDirection(a)===p};return{run:function(b,d,f,g,h){return e.applyOn(b,a,d,f,g,h,function(a){c.each(a,
u);return a})},query:function(a,c){return b.bothMatch(a,c,d.curry(m,v))},name:d.constant(l)}},p=n("DirRtl","dir","rtl"),n=n("DirLtr","dir","ltr");return{dirLtr:d.constant(n),dirRtl:d.constant(p)}});k("7p","7 d3 d4 d5 7c e5 3t".split(" "),function(c,d,b,a,e,g,f){var h=function(g){return function(h){var n=function(a,b,c,d){return g.run(h.content().isRoot,a,b,c,d)};e.cata(h.selections().get(),c.noop,d.multiple(h.content(),h.undo(),n),d.single(h.content(),h.undo(),n,a.spot,b.update));f(function(){h.content().uiChanged()},
0)}};return{dirRtl:h(g.dirRtl()),dirLtr:h(g.dirLtr())}});k("7q",["7a","2u","e5","31"],function(c,d,b,a){var e=d.immutable("ltrdir","rtldir"),g=function(a,b){return b.query(a.startContainer(),a.endContainer())?c.on(!0):c.off()},f=function(b){return a.closest(b.startContainer(),"[dir]").isSome()||a.closest(b.endContainer(),"[dir]").isSome()};return{readDir:function(a){return a.getSelection().filter(f).map(function(a){return e(g(a,b.dirLtr()),g(a,b.dirRtl()))})}}});k("5g","7 7p 73 7q 6t 7a 54 46".split(" "),
function(c,d,b,a,e,g,f,h){return function(l){var m=l.content(),n=h.create({analytics:f(["message","properties"])}),p=function(b,d){a.readDir(m).map(function(a){return a[b]}).fold(g.unchanged,c.apply).fold(d.deselect,c.noop,d.select)};return{ui:e.ui({"ltrdir.general":{value:"ltrdir",textkey:b.key("directionality.ltrdir"),action:c.curry(d.dirLtr,l),updateGeneral:c.curry(p,"ltrdir"),toggle:!0},"rtldir.general":{value:"rtldir",textkey:b.key("directionality.rtldir"),action:c.curry(d.dirRtl,l),updateGeneral:c.curry(p,
"rtldir"),toggle:!0}}),events:n.registry,destroy:c.noop}}});k("ur",["dj","s","2a"],function(c,d,b){var a=function(a,b,c){a=a.createRange();a.selectNode(b.dom());a.collapse(c);return a},e=function(b,d,e){var g=b.createRange();g.selectNode(d.dom());var g=g.getBoundingClientRect(),n=e-g.left<g.right-e;return(n?c.firstCursor:c.lastCursor)(d).map(function(c){return a(b,c,n)})},g=function(b,c,e){var g=c.dom().getBoundingClientRect();return d.some(a(b,c,e-g.left<g.right-e))};return{search:function(a,c,d){return(0===
b.children(c).length?g:e)(a,c,d)}}});k("z2",["1s"],function(c){return{inRect:function(c,b,a){return b>=c.left&&b<=c.right&&a>=c.top&&a<=c.bottom},searchForPoint:function(d,b,a,e,g){if(0===g)return 0;if(b===e)return g-1;for(var f=1;f<g;f++){var h=d(f),l=c.abs(b-h.left);if(!(a>h.bottom)){if(a<h.top||l>e)return f-1;e=l}}return 0}}});k("us","z2 s k 2u 21 ak 2a 1s".split(" "),function(c,d,b,a,e,g,f,h){var l=a.immutable("node","doc","x","y","fullrect"),m=function(a){var b=function(b){var c=a.doc().createRange();
c.setStart(a.node().dom(),b);c.collapse(!0);return c},d=g.get(a.node()).length,e=a.x(),f=a.y(),h=a.fullrect().right,d=c.searchForPoint(function(a){return b(a).getBoundingClientRect()},e,f,h,d);return b(d)},n=function(a,e,f,g){var h=a.createRange();h.selectNode(e.dom());h=h.getClientRects();return b.findMap(h,function(a){return c.inRect(a,f,g)?d.some(a):d.none()}).map(function(b){return l(e,a,f,g,b)})},p=function(a,g,h,l){if(e.isText(g))return n(a,g,h,l);var m=a.createRange();g=f.children(g);return b.findMap(g,
function(b){m.selectNode(b.dom());return c.inRect(m.getBoundingClientRect(),h,l)?p(a,b,h,l):d.none()})};return{search:function(a,b,c,d){var e=a.createRange();e.selectNode(b.dom());e=e.getBoundingClientRect();c=h.max(e.left,h.min(e.right,c));d=h.max(e.top,h.min(e.bottom,d));return p(a,b,c,d).map(m)}}});k("mo",["ur","us","s","l","2a"],function(c,d,b,a,e){return{searchForRange:function(g,f,h){return b.from(g.elementFromPoint(f,h)).map(a.fromDom).bind(function(a){var b=function(){return c.search(g,a,
f)};return 0===e.children(a).length?b():d.search(g,a,f,h).orThunk(b)})}}});k("e6",["e7","mo","s","q"],function(c,d,b,a){var e=function(a,c,d){return b.from(a.caretPositionFromPoint(c,d)).bind(function(c){if(null===c.offsetNode)return b.none();var d=a.createRange();d.setStart(c.offsetNode,c.offset);d.collapse();return b.some(d)})},g=function(a,c,d){return b.from(a.caretRangeFromPoint(c,d))},f=a.caretPositionFromPoint?e:a.caretRangeFromPoint?g:d.searchForRange;return{find:function(a,b,d){return f(a.document,
b,d).map(c.writeFromNative)}}});k("7r",["e6"],function(c){return{find:c.find}});k("fz",["6","4n"],function(c,d){var b=d.generate([{blob:["id","blob","objurl","data"]},{url:["id","url","raw"]}]);return c.merge(b,{cata:function(a,b,c){return a.fold(b,c)}})});k("mp",["2i"],function(c){return function(){return new (c.getOrDie("FileReader"))}});k("ge",["2i"],function(c){return{createObjectURL:function(d){return c.getOrDie("URL").createObjectURL(d)},revokeObjectURL:function(d){c.getOrDie("URL").revokeObjectURL(d)}}});
k("ed","b 2z c fz 3s mp ge 1a".split(" "),function(c,d,b,a,e,g,f,h){b=b.detect();var l=function(a){var b=f.createObjectURL(a);return m(a,b)},m=function(b,c){return e.nu(function(e){var f=g();f.onload=function(f){var g=d.generate("image");f=a.blob(g,b,c,f.target);e(f)};f.readAsDataURL(b)})},n=function(a){return 1===a.length&&c.contains(a,"Files")},p=function(a){return!c.contains(a,"text/_moz_htmlcontext")},r=function(a){return c.contains(a,"Files")},q=function(a){return!0};return{multiple:function(a){return 0===
a.length?e.pure([]):e.mapM(a,l)},toFiles:function(a){return a.raw().target.files||a.raw().dataTransfer.files},isFiles:b.browser.isChrome()||b.browser.isSafari()||b.browser.isOpera()?r:b.browser.isFirefox()?p:b.browser.isIE()?n:q,fromImages:function(b){b=c.map(b,function(b){var c=d.generate("image");return a.url(c,h.get(b,"src"),b)});return e.pure(b)},single:l,singleWithUrl:m}});k("ec","b c ed 54 46 1y 3u".split(" "),function(c,d,b,a,e,g,f){d=d.detect();var h=d.browser.isIE()||d.browser.isSpartan()||
d.browser.isChrome()&&(d.os.isOSX()||d.os.isLinux());return{register:function(d,m,n){var p=e.create({dragover:a(["original"]),dragleave:a(["original"]),drop:a(["original"]),dragndropimages:a(["original","files"]),dragndrophtml:a(["original"])});m.each(function(a){var b=function(b){return function(){b(d,a)}};p.registry.dragover.bind(b(g.add));p.registry.dragleave.bind(b(g.remove));p.registry.drop.bind(b(g.remove))});m=function(a){return function(b){(!1===n||h)&&b.kill();a(b)}};var r=f.bind(d,"dragover",
m(p.trigger.dragover)),q=f.bind(d,"dragleave",m(p.trigger.dragleave)),s=f.bind(d,"drop",function(a){p.trigger.drop(a);a.kill();if(b.isFiles(a.raw().dataTransfer.types)){var d=b.toFiles(a);p.trigger.dragndropimages(a,d)}else c.contains(a.raw().dataTransfer.types,"text/html")&&p.trigger.dragndrophtml(a)});return{destroy:function(){r.unbind();q.unbind();s.unbind()},events:p.registry}}}});k("7t",["ec","ed","54","46"],function(c,d,b,a){return{forImages:function(e,g,f){e=c.register(e,g,f);var h=a.create({dragover:b(["original"]),
dragleave:b(["original"]),drop:b(["original"]),dragndropimages:b(["assets","x","y"]),dragndrophtml:b(["html","x","y"])});g=function(a,b){a.bind(function(a){b(a.original())})};e.events.dragndropimages.bind(function(a){var b=a.original();d.multiple(a.files()).get(function(a){h.trigger.dragndropimages(a,b.x(),b.y())})});e.events.dragndrophtml.bind(function(a){a=a.original();var b=a.raw().dataTransfer.getData("text/html");h.trigger.dragndrophtml(b,a.x(),a.y())});g(e.events.dragover,h.trigger.dragover);
g(e.events.dragleave,h.trigger.dragleave);g(e.events.drop,h.trigger.drop);return{destroy:e.destroy,events:h.registry}}}});k("mq",["4g"],function(c){return{resolve:c.create("ephox-arcade").resolve}});k("ee",["mq","b","1a","21"],function(c,d,b,a){var e="data-"+c.resolve("no-merge"),g="data-"+c.resolve("atomic");return{doNotMerge:function(c){a.isElement(c)&&b.set(c,e,"true")},shouldMerge:function(c){return a.isElement(c)&&!1===b.has(c,e)},setAtomic:function(c){a.isElement(c)&&b.set(c,g,"true")},isAtomic:function(c){return a.isElement(c)&&
"true"===b.get(c,g)},clear:function(c){a.isElement(c)&&d.each([e,g],function(a){b.remove(c,a)})}}});k("ut",["7","s","l","2o","2a"],function(c,d,b,a,e){return{addAfter:function(g){return function(f,h){var l=h.all(),m=g(f,h);d.from(l[l.length-1]).each(function(d){e.nextSibling(d).fold(function(){var c=b.fromTag("p");a.append(c,b.fromTag("br"));a.after(d,c)},c.noop)});return m}}}});k("qg",["7"],function(c){return function(d,b,a,e){return{context:d,profile:b,action:a,label:c.constant(e)}}});k("11y","b yn tu l 2o 21 2q 4e 2a".split(" "),
function(c,d,b,a,e,g,f,h,l){var m=function(d){var f=l.owner(d);d=h.descendants(d,"td,th");c.each(d,function(c){b.needsCursor(c).each(function(b){e.append(c,a.fromTag("br",f.dom()))})})},n=function(a){b.vacate(a);b.needsCursor(a).each(function(b){f.remove(a)})};return{populate:function(c){b.vacate(c);b.needsCursor(c).each(function(b){var c=a.fromTag("span");d.forceAddBr(b,c)})},purge:function(a){("table"===g.name(a)?m:n)(a)}}});k("z3",["b","ep","11y","2a"],function(c,d,b,a){var e=function(a,d){var e=
g(a),e=c.filter(e,d);c.each(e,b.purge)},g=function(b){var c=function(a){return[a]},d=a.prevSibling(b).map(c).getOr([]),c=a.nextSibling(b).map(c).getOr([]);return d.concat([b]).concat(c)};return{purge:function(a){e(a,d.isBlock)},purgeBy:e}});k("v0","z3 b ep 2n 21 6h 4e ak 2a".split(" "),function(c,d,b,a,e,g,f,h,l){var m=function(a){c.purgeBy(a,function(a){var c=b.isBlock(a)||"li"===e.name(a)||"ol"===e.name(a)||"ul"===e.name(a);if("li"===e.name(a)){var d;if(!(d=0===f.descendants(a,"ul,ol").length)){d=
f.descendants(a,"ul,ol,li");var h=f.descendants(a,"*");a=g.descendants(a,e.isText);d=d.length===h.length&&0===a.length}a=d}else a=!0;return c&&a})};return{purge:m,purgeAll:function(a){var b=f.descendants(a,"ol,ul,li");d.each([a].concat(b),m)},nesting:function(b){b=("li"===e.name(b)?[b]:[]).concat(f.descendants(b,"li"));d.each(b,function(b){var c=l.children(b);d.exists(c,function(a){return e.isText(a)?0<h.get(a).length:!d.contains(["ol","ul"],e.name(a))})||a.set(b,"list-style-type","none")})}}});k("z5",
"5b 7 s l 2o 2q 2a".split(" "),function(c,d,b,a,e,g,f){var h=function(e,f){var h=a.fromText(c.zeroWidth());e(f,h);return b.some({element:d.constant(h),cleanup:function(){g.remove(h)},splits:d.constant([])})},l=function(a,b){return a.map(function(a){return{element:d.constant(a),cleanup:d.noop,splits:d.constant(void 0!==b?b:[])}})},m=function(a,b){return h(e.before,a)},n=function(a,b){return h(e.after,a)},p=function(a,b){return h(e.append,a)},r=function(a,b){return h(e.prepend,a)},q=function(a,c){return function(d,
e){return a(d,e).fold(function(){return c(d,e)},b.some)}},s=function(a,c,d){return l(b.some(c),void 0!==c&&void 0!==d?[{first:c.dom(),second:d.dom()}]:[])};return{before:{text:{none:b.none,start:q(function(a,b){return l(f.prevSibling(a))},m),middle:s,end:s},element:{hasPrevious:function(a,b){return l(f.child(a,b-1))},rightEdge:p,first:r,empty:m,otherwise:r}},after:{text:{none:b.none,start:s,middle:function(a,c,d){return l(b.some(d),void 0!==c&&void 0!==d?[{first:c.dom(),second:d.dom()}]:[])},end:q(function(a,
b){return l(f.nextSibling(a))},n)},element:{hasNext:function(a,b){return l(f.child(a,b+1))},rightEdge:p,first:r,empty:n,otherwise:p}}}});k("vc",["7","uj","z5","9"],function(c,d,b,a){return{prefix:c.curry(d.prefix,b),postfix:c.curry(d.postfix,b)}});k("zj","7 s nd yp 2o 37 2q f4".split(" "),function(c,d,b,a,e,g,f,h){var l=function(b){return!g.descendant(b,function(b){return a.hasCursor(b,["hr","img"])})},m=function(a){var b=h.shallowAs(a,"p");e.before(a,b);f.remove(a);return d.some(b)};return{cleanup:function(a){var e=
a.second(),e=(b.isHeading(e)&&l(e)?m(e):d.none()).getOr(a.second());return{first:a.first,second:c.constant(e),mark:a.mark,splits:a.splits}}}});k("va","5b b 97 dj d6 7 s m6 ep yn vc tt tu zj yo nd 1b l 2o 21 ak 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,v,k,x,y,B){var z=function(a){return x.isElement(a)&&l.isInline(a)&&0===B.children(a).length},A=function(a){var b=v.fromText(c.zeroWidth());k.append(a,b);return b},C=function(a,b,c){return n.prefix(b,c).bind(function(b){var c=p.breakPath(b.element(),
t.stopAt(a));return c.second().map(function(d){return{first:g.constant(a),second:g.constant(d),mark:g.constant(b),splits:g.constant(c.splits().concat(b.splits()))}})})};return{soft:function(c,d,m){var n=function(a){var b;x.isText(a)?(b=y.get(a),b=-1===b.indexOf("\u00a0")&&0===b.trim().length):b=!1;return b?B.nextSibling(a).forall(n):!e.isStart(c,d)&&l.isBlock(a)},p=v.fromTag("br");h.atStartOf(c,d,p);B.nextSibling(p).fold(function(){return e.getEnd(c)===d&&t.findBlock(c,m).bind(a.lastCursor).fold(g.constant(!1),
function(a){var b="br"===x.name(a)?p:c;return u.eq(b,a)})},n)&&k.after(p,v.fromTag("br"));return f.some({start:g.constant(b.after(p)),finish:g.constant(b.after(p))})},hard:function(a,c,e,f,h){return C(a,c,e).map(q.cleanup).map(function(a){d.each([f.getOr(a.first()),a.second()],function(b){r.postprocess(b,a.mark().element(),h)});t.findValidHardBreak(a.second(),h).orThunk(function(){m.rootBr(a.second(),a.mark().element())});var c=s.plunge(a.second(),g.constant(!1)),c=z(c)?A(c):c;a.mark().cleanup();
return{start:g.constant(b.on(c,0)),finish:g.constant(b.on(c,0))}})},rupture:C}});k("v9",["97","7","s","l","2o"],function(c,d,b,a,e){var g=function(a,c,e){return b.some({start:d.constant(a(c,e)),finish:d.constant(a(c,e))})};return{doubleBr:function(b){e.after(b,a.fromTag("br"));var d=a.fromTag("br");e.after(b,d);return g(c.after,d,0)},emptyParagraph:function(b){var d=a.fromTag("p"),l=a.fromTag("br");e.append(d,l);e.after(b,d);return g(c.on,l,0)}}});k("11z",[],function(){return{box:function(c){return[c]}}});
k("zk",["7","11z","nd"],function(c,d,b){return{processes:function(a){return{stopper:b.stopAt(a),wrapper:d.box,post:c.noop}}}});k("zl","b s 11z nd 3c 21 2q 2a".split(" "),function(c,d,b,a,e,g,f,h){var l=function(a,b,c){d.from(c[c.length-1]).each(function(a){e.append(a,m(h.children(b)));f.empty(b)})},m=function(b){return c.filter(b,function(b){return!(g.isElement(b)&&a.isList(b)&&0===h.children(b).length)})};return{processes:function(c){return{stopper:a.stopAt(c),wrapper:b.box,post:l}}}});k("zm","b 7 ep yn tu nd 1a 2n l 2o 3c 21 37 2q 2a".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s){var t=function(a,b){q.remove(a);return b},u=function(b,c){var d=l.fromTag("p");n.append(d,c);m.before(b,d);q.remove(b);e.needsCursor(d).each(function(b){a.forceAddBr(b,l.fromTag("span"))});return[d]},v=function(a){var d=s.children(a),d=(r.descendant(a,b.isFormatting)?t:u)(a,d);c.each(d,function(b){p.isElement(b)&&(f.transfer(a,b,["dir"]),h.transfer(a,b,["text-align"]))});return d};return{processes:function(a){return{stopper:g.stopAt(a),wrapper:v,post:d.noop}}}});
k("vb","b 97 7 tt tu zk zl zm 3c 21 31".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){return{exit:function(p,r){return n.ancestor(p,"ol,ul",r).bind(function(q){var s=n.ancestor(q,"li,ol,ul",r).fold(function(){return h.processes(q)},function(a){return"li"===m.name(a)?f.processes(a):g.processes(q)}),t=a.breakPath(p,s.stopper);return t.second().map(function(a){var f=t.first(),g=s.wrapper(p);l.before(a,g);s.post(f,a,g);c.each([f,a],e.lists);return{start:b.constant(d.on(g[0],0)),finish:b.constant(d.on(g[0],
0))}})})}}});k("nc","s v9 va vb nd 31".split(" "),function(c,d,b,a,e,g){var f=function(d,f,m,n){return g.closest(f,"li",n).fold(function(){return b.hard(d,f,m,c.none(),n)},function(d){d=e.exitList(d)?a.exit(d,n):b.hard(d,f,m,c.some(d),n);return d})};return{hard:function(a,g,m){return e.findValidHardBreak(a,m).fold(function(){return e.findAnchorBreak(a,m).fold(function(){return b.soft(a,g,m)},function(f){return!0===e.isRightEdge(f,a,g)?d.doubleBr(f):b.hard(f,a,g,c.none(),m)})},function(b){return f(b,
a,g,m)})},soft:b.soft,rupture:b.rupture}});k("vd",["2u"],function(c){return c.immutable("cursor","blocks")});k("ne","b 97 7 s vc tu va nd vd uk 1b".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){var p=function(a,c,f,g){return e.postfix(a,c,f,g).map(function(e){var h=m.leftEdge(a,c,f,g);m.makeTo(h.element(),h.offset(),e.element()).deleteContents();return{start:b.constant(d.before(e.element())),finish:b.constant(d.before(e.element())),mark:e.element}})},r=function(a,b,c,d){return p(a,b,c,d).bind(function(a){return f.soft(a.mark(),
0)})},q=function(b,c,d,e,g){return p(b,c,d,e).bind(function(b){return h.findValidHardBreak(b.mark(),g).bind(function(c){return f.hard(c,b.mark(),0,a.none(),g)})})},s=function(a,b){c.each(a,function(a){g.postprocess(a,b)})};return{soft:r,hard:function(a,c,d,e,f){var g=h.findValidHardBreak(a,f),m=h.findValidHardBreak(d,f),k=g.fold(function(){var b=r(a,c,d,e);return l(b,[])},function(b){return m.fold(function(){var f=r(a,c,d,e);return l(f,[b])},function(g){var h=n.eq(b,g)?q(a,c,d,e,f):p(a,c,d,e);return l(h,
[b,g])})});return k.cursor().map(function(a){var c=k.blocks(),d;d=a.start().fold(b.identity,b.identity,b.identity);s(c,d);return a})},rupture:function(a,b,c,d,e){return p(a,b,c,d).bind(function(a){return h.findValidHardBreak(a.mark(),e).bind(function(b){return f.rupture(b,a.mark(),0)})})}}});k("z4","vc va nc nd ne q".split(" "),function(c,d,b,a,e,g){return{point:function(a,c,d){return b.rupture(a,c,d)},range:function(a,b,c,d,g){return e.rupture(a,b,c,d,g)},ruptureUntil:function(b,e,l,m,n,p){var r=
c.postfix(b,e,l,m);return function(b,c){return a.findValidHardBreak(b,n).map(p).bind(function(a){return d.rupture(a,b,c)})}(b,e).bind(function(a){return r.map(function(b){var c=g.createRange();c.setStartAfter(a.first().dom());c.setEndBefore(b.element().dom());c.deleteContents();b.cleanup();a.mark().cleanup();return a.first()})})}}});k("uu","z3 v0 b s m6 z4 3c 2a".split(" "),function(c,d,b,a,e,g,f,h){var l=function(b,c,d){if(0<b.length){var g=b[0],h=b.slice(1);e.atStartOf(c,d,g);f.after(g,h);return a.some(b[b.length-
1])}return a.none()};return{split:function(e,l,p){var r=void 0===p?c.purge:p;return g.point(e.block(),e.element(),e.offset()).bind(function(c){var e=l.all();f.before(c.second(),e);c.mark().cleanup();r(c.first());r(c.second());b.each([c.first(),c.second()],d.nesting);c=b.reverse(e);c=b.find(c,function(a){return h.parent(a).isSome()});return a.from(c)})},merge:function(a,b){var c=h.children(b.single());return l(c,a.element(),a.offset())},nest:function(a,b){return l(b.all(),a.element(),a.offset())},
insertMany:l,insertChildren:function(a,b){var c=h.children(a);return l(c,b.element(),b.offset())},fallback:function(a,b,c){return l(c,b.startContainer(),b.startOffset())}}});k("uw",["b","7","s","31"],function(c,d,b,a){return{lists:function(e){return c.foldr(e,function(b,c){return b.bind(function(b){return a.closest(c,"ol,ul").map(function(a){return[a].concat(b)})})},b.some([])).map(function(a){return{all:d.constant(a)}})},from:function(a){return{all:d.constant(a)}}}});k("ux","6 dj 7 s ep 2u 1b 21 4i 31 ak 2a".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,p){var r=g.immutable("left","right"),q=function(a){return e.isFormatting(a)||e.isContainer(a)},s=function(a,b,c,d){return l.closest(c,a,b)},t=function(a){return function(b,c,d){return a(b,c.element(),c.offset()).bind(function(c){return a(b,d.element(),d.offset()).map(function(a){return r(c,a)})})}},u=function(a){var b=t(a);return function(a,c,d){return b(a,c,d).filter(function(a){return f.eq(a.left(),a.right())})}};return{inline:function(b,c,d){return l.closest(c,q,
b).fold(function(){return a.some(c)},function(d){return b(d)?a.some(c):a.none()})},formatter:b.curry(s,e.isFormatting),container:function(a,c,d){return l.closest(c,e.isContainer,a).filter(b.not(a))},inListItem:function(a,b,c){return m.closest(b,"li",a)},inList:function(a,b,c){return m.closest(b,"ol,ul",a)},inTableCell:function(a,b,c){return m.closest(b,"td,th",a)},setBlock:function(a,d){return c.deepMerge(a,{block:b.constant(d)})},both:t,shared:u,sharedPredicate:function(a){a=b.curry(s,a);return u(a)},
entireRoot:function(a,b,c){return l.closest(b.element(),a).filter(function(c){var e=function(a){return f.eq(a,b.element())};return a(b.element())&&0===b.offset()||h.isText(b.element())&&0===b.offset()&&d.firstCursor(c).map(e).getOr(!1)}).filter(function(b){var e=function(a){return f.eq(a,c.element())};return a(c.element())&&c.offset()>=p.children(b).length-1||h.isText(c.element())&&c.offset()>=n.get(c.element()).length&&d.lastCursor(b).map(e).getOr(!1)}).map(function(a){return r(a,a)})}}});k("uv",
"v0 uu uw ux 6m 4e 31".split(" "),function(c,d,b,a,e,g,f){return{insertOne:function(a,f){var m=g.children(f.single(),"li");return 1!==m.length||e.descendant(m[0],"ol,ul")?d.split(a,b.from(m),c.purge):d.insertChildren(m[0],a)},insertMany:function(b,e){return f.ancestor(b.block(),"ol,ul").bind(function(f){f=a.setBlock(b,f);return d.split(f,e,c.purgeAll)})}}});k("uy",["b","7","s","21"],function(c,d,b,a){var e=function(a){return function(c){return(1===c.length?b.some(c[0]):b.none()).filter(a).map(function(a){return{single:d.constant(a)}})}},
g=function(a){return function(e){var g=c.find(e,a);return(void 0!==g&&null!==g?b.some(e):b.none()).map(function(a){return{all:d.constant(a)}})}};return{oneOf:e,anyOf:g,noneOf:function(a){return function(e){var g=c.find(e,a);return(void 0===g||null===g?b.some(e):b.none()).map(function(a){return{all:d.constant(a)}})}},allOf:function(a){return function(e){return c.forall(e,a)?b.some({all:d.constant(e)}):b.none()}},any:b.some,oneOfTag:function(b){return e(function(c){return a.name(c)===b})},anyOfTag:function(b){return g(function(c){return a.name(c)===
b})},single:function(a){return b.some({single:d.constant(a)})},all:function(a){return b.some({all:d.constant(a)})}}});k("uz","b 7 s ep 21 4e 31".split(" "),function(c,d,b,a,e,g,f){var h=function(a){return 1===a.length?f.closest(a[0],"ol,ul").map(function(a){return{single:d.constant(a)}}):b.none()};return{list:h,listItem:function(a){return h(a).bind(function(a){a=g.descendants(a.single(),"li");return 1===a.length?b.some({single:d.constant(a[0])}):b.none()})},partialList:function(f){if(2!==f.length)return b.none();
var g=f[0],h=f[1];if(a.isFormatting(g)||a.isContainer(g)||c.contains(["ol","ul","li"],e.name(g))||!c.contains(["ol","ul"],e.name(h)))return b.none();e.name(h);return b.some({all:d.constant(f),list:d.constant(h),inline:d.constant(g)})}}});k("mr","ut qg ee uu uv uw ux uy uz 7 ep".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){var p=f.formatter,r=f.inline,q=f.container,s=function(a){return n.isFormatting(a)&&!1===b.shouldMerge(a)};c=[d(f.inListItem,l.list,e.insertOne,"List"),d(f.inListItem,g.lists,e.insertMany,
"Many lists"),d(r,h.anyOf(s),a.nest,"Copying formatting (NO MERGE) into root"),d(r,h.oneOf(n.isFormatting),a.merge,"Copying formatting into root"),d(p,h.anyOfTag("hr"),a.split,"insert hr into formatter"),d(p,h.anyOf(s),a.split,"Copying one formatting block (NO MERGE) into formatting"),d(p,h.oneOf(n.isFormatting),a.merge,"Copying one formatting block into formatting"),d(p,h.anyOf(n.isFormatting),a.split,"Copying many formatting blocks into formatting"),d(p,h.anyOfTag("table"),c.addAfter(a.split),"Copying tables into formatting"),
d(p,h.anyOf(n.isContainer),a.split,"Copying container blocks into formatting"),d(q,h.all,a.nest,"Fallback pasting into container.")];return{context:function(a,b,c){return b.context(a.isRoot,c.startContainer(),c.startOffset()).map(function(a){return{block:m.constant(a),element:c.startContainer,offset:c.startOffset}})},rules:m.constant(c),fallback:a.fallback}});k("v1",["7","eg","lf"],function(c,d,b){return{force:function(a){var e=b.after(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset()),
g=e?d.point(a.endContainer(),a.endOffset()):d.point(a.startContainer(),a.startOffset());a=e?d.point(a.startContainer(),a.startOffset()):d.point(a.endContainer(),a.endOffset());return{left:c.constant(g),right:c.constant(a)}}}});k("v2","z3 b dj 7 s ep z4 vc uk 1b l 2o 3c 21 2q 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t){var u=function(a,b){var c=a.original(),d=h.postfix(c.left().element(),c.left().offset(),c.right().element(),c.right().offset()),f=b.all();return d.bind(function(b){l.makeTo(c.left().element(),
c.left().offset(),b.element()).deleteContents();b.cleanup();r.append(a.left(),f);b=t.children(a.right());r.append(a.left(),b);s.remove(a.right());return e.from(f[f.length-1])})},k=function(a,c){if(!m.eq(a.left(),a.right()))throw"replaceContents used in the wrong context";var d=a.left();s.empty(d);var f=c.all();r.append(d,f);return b.lastCursor(d).or(e.from(f[f.length-1]))};return{replace:function(a,b){if(m.eq(a.left(),a.right())){var c=b.all();a.canvas().replaceSelection(c);return e.from(c[c.length-
1])}return u(a,b)},replaceContents:k,replaceContentsWrapP:function(b,c){var d=n.fromTag("p");r.append(d,c.all());return k(b,{all:a.constant([d])})},replaceWhole:function(a,b){var c=b.all();r.after(a.left(),c);s.remove(a.left());return e.from(c[c.length-1])},merge:function(a,b){var c=t.children(b.single());a.canvas().replaceSelection(c);return e.from(c[c.length-1])},split:function(a,b,g){var h=void 0===g?c.purge:g;g=a.original().left();var l=a.original().right();return f.range(g.element(),g.offset(),
l.element(),l.offset(),a.canvas().isRoot).bind(function(a){var c=b.all();r.before(a.second(),c);a.mark().cleanup();d.each([a.first(),a.second()],h);return e.from(c[c.length-1])})},fallback:function(a,b,d){a.replaceSelection(d);e.from(d[0]).each(c.purge);e.from(d[d.length-1]).each(c.purge);return e.from(d[d.length-1])}}});k("v3","s l 2o 3c 21 31 2a".split(" "),function(c,d,b,a,e,g,f){return{insertAll:function(b,d){var e=d.all();a.after(b,e);return c.from(e[e.length-1])},insertChildren:function(b,d){var e=
f.children(d.single());a.after(b,e);return c.some(e[e.length-1])},insertSingle:function(a,d){b.after(a,d.single());return c.some(d.single())},insertFlat:function(e,f){var g=d.fromTag("li");a.append(g,[f.inline(),f.list()]);b.after(e,g);return c.some(f.list())},insertNested:function(f,l){var m=d.fromTag("li");a.append(m,[l.inline(),l.list()]);var n=g.ancestor(f,"ol,ul").fold(function(){var a=d.fromTag(e.name(l.list()));b.append(a,m);return a},function(){return m});b.after(f,n);return c.some(l.list())}}});
k("v4","v0 b 7 z4 4e 2a".split(" "),function(c,d,b,a,e,g){var f=function(c,d,e,f){f=void 0!==f?f:b.identity;var g=d.original(),q=g.left(),g=g.right();return a.ruptureUntil(q.element(),q.offset(),g.element(),g.offset(),d.canvas().isRoot,f).bind(function(a){var b=c(a,e);h(a);return b},void 0!==f?f:b.identity)},h=function(a){var b=e.ancestors(a,"ol,ul");0<b.length&&d.each([c.purgeAll,c.nesting],function(a){a(b[b.length-1])})};return{postprocess:h,onList:function(a,b,c){return f(a,b,c,function(a){return g.parent(a).getOr(a)})},
onItem:function(a,c,d){return f(a,c,d,b.identity)}}});k("ms","qg ee v0 ux uy v1 uz v2 v3 v4 7 ep 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r){var q=a.formatter,s=n.curry(m.onItem,l.insertSingle),t=n.curry(m.onList,l.insertAll),u=n.curry(m.onItem,l.insertChildren),k=n.curry(m.onItem,l.insertFlat);l=n.curry(m.onItem,l.insertNested);c=[c(a.sharedPredicate(d.isAtomic),e.all,h.replaceWhole,"selection: inside something atomic, so just replace the whole thing"),c(a.shared(a.inListItem),f.listItem,
function(a,b){return h.merge(a,b)},"selection: same item, paste: singleton"),c(a.shared(a.inListItem),f.list,function(a,c){return h.split(a,{all:n.constant(r.children(c.single()))},b.purgeAll)},"selection: same item, paste: single list"),c(a.shared(a.inListItem),f.partialList,l,"selection: same item, paste: partial"),c(a.shared(a.inListItem),e.noneOf(p.isBlock),h.replace,"selection: same item, paste: no blocks"),c(a.shared(a.inListItem),e.all,t,"selection: same item, paste: any"),c(a.both(a.inListItem),
f.listItem,s,"selection: diff items, paste: singleton"),c(a.both(a.inListItem),f.list,u,"selection: diff items, paste: single list"),c(a.both(a.inListItem),f.partialList,k,"selection: diff items, paste: partial"),c(a.both(a.inListItem),e.all,t,"selection: diff items, paste: any"),c(a.both(q),e.anyOfTag("hr"),h.split,"selection: inside formatter, paste: split"),c(a.both(q),e.noneOf(p.isBlock),h.replace,"range no blocks"),c(a.both(q),e.anyOf(function(a){return p.isFormatting(a)&&!1===d.shouldMerge(a)}),
h.split,"range 1 formatting block"),c(a.both(q),e.oneOf(p.isFormatting),h.merge,"range 1 formatting block"),c(a.both(q),e.all,h.split,"range anything > formatters"),c(a.entireRoot,e.noneOf(p.isBlock),h.replaceContentsWrapP,"complete body, not inserting a block: wrap in P and replace the contents"),c(a.entireRoot,e.all,h.replaceContents,"complete body: replace the contents")];return{context:function(a,b,c){var d=g.force(c);return b.context(a.isRoot,d.left(),d.right()).map(function(b){return{left:b.left,
right:b.right,original:n.constant(d),canvas:n.constant(a)}})},rules:n.constant(c),fallback:h.fallback}});k("ef","mr ms b d6 7 s eg".split(" "),function(c,d,b,a,e,g,f){var h=function(a,c,d,f,h){return b.foldl(a,function(a,b){return a.orThunk(function(){return f(c,b,d).bind(function(a){return b.profile(h).map(function(c){return{action:b.action,target:e.constant(c),ctx:e.constant(a)}})})})},g.none())},l=function(b){var c=a.getEnd(b);return f.point(b,c)},m=function(a,b,e,f,g,m){var u={getSelection:a,
replaceSelection:b,isRoot:e};return u.getSelection().bind(function(a){var b=a.collapsed()?c:d,e=a.collapsed()?g.concat(b.rules()):m.concat(b.rules());return h(e,u,a,b.context,f).fold(function(){return b.fallback(u,a,f)},function(a){return a.action(a.ctx(),a.target())}).map(l)})};return{insertAtCursor:function(a,b,c,d){return m(a,b,c,d,[],[])},insertAtCursorWith:m}});k("7u","ee ef b e7 97 7s s k 1a 21 4i".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){var p=function(a){return m.isElement(a)&&"false"===
l.get(a,"contenteditable")},r=function(a){return a().map(function(a){a=b.map([a.startContainer(),a.endContainer()],function(a){return n.closest(a,p)});return h.cat(a)}).getOr([])},q=function(a,d,e){b.each(a,d);d=e();b.each(a,c.clear);return d},s=function(a,b){return q(a,c.setAtomic,b)},t=function(a,b,c,e,f,g){var h=r(a);return s(h,function(){return d.insertAtCursorWith(a,b,c,e,f,g)})},u=function(a,b,c,d){b=t(a.getSelection,a.replaceSelection,a.isRoot,b,c,d);a.domChanged();a.undoChanged();return b},
k=function(a,b){return u(a,b,[],[])};return{insertAtCursorWith:u,insertAtCursor:k,insertAtCursorWithInstructions:function(a,b,c){return q(c,a,function(){return k(b,c)})},insertAt:function(b,c,d){d=t(function(){return f.some(c)},function(d){b.win().each(function(b){var f=a.write(e.on(c.startContainer(),c.startOffset()),e.on(c.endContainer(),c.endOffset()));g.replaceRange(b,f,d)})},b.isRoot,d,[],[]);b.domChanged();b.undoChanged();return d}}});k("5h","7r 7s 7t s 7u 54 46 48".split(" "),function(c,d,
b,a,e,g,f,h){return function(l){var m=f.create({insertAssets:g(["assets"]),insertHtml:g(["html"])}),n=l.content(),p=a.none(),r=function(a){n.win().each(function(b){c.find(b,a.x(),a.y()).each(function(a){d.set(b,a)})})},q=function(a){r(a);m.trigger.insertAssets(a.assets())},s=function(a){r(a);a=a.html();l.undo().save();a=h.fromHtml(a);e.insertAtCursor(n,a)};n.events.ready.bind(function(c){var d=a.none();p=a.some(b.forImages(c.api().canvas(),d,!0));p.each(function(a){a.events.dragndropimages.bind(q);
a.events.dragndrophtml.bind(s)})});return{events:m.registry,destroy:function(a){p.each(function(a){a.destroy()})}}}});k("7w",["7","73"],function(c,d){return{editor:function(b,a){var e=c.curry(d.translate,a?"aria.label.fullscreen":"aria.label.editor");return b.fold(c.identity,e)}}});k("6a",["6","7","s"],function(c,d,b){return function(a){var e=function(){return c.merge(null===a.project.apiKey?{}:{headers:{"textbox-api-key":a.project.apiKey}},{xhrFields:{withCredentials:!0}})},g=function(a){var c=a+
(-1===a.indexOf("?")?"?":"&")+"url=";return function(a){return b.some(c+encodeURIComponent(a))}},g=void 0===a.imageEdit.proxy?b.none:g(a.imageEdit.proxy);return{headers:e,mediatorHeaders:function(){var a=e().headers;return void 0===a?{}:a},proxy:g,destroy:d.noop}}});k("ei",["b","7","mv","2f"],function(c,d,b,a){return{toText:function(a){return c.map(a,function(a){return b.toText(a,d.constant(!1))}).join("").trim()},toHtml:function(b){return c.map(b,a.getOuter).join("")}}});k("4a",["7"],function(c){return{styleSpan:c.constant("ephox-hare-style-span"),
base:c.constant("ephox-candy-mountain"),active:c.constant("ephox-candy-mountain-active")}});k("z6","b c 4a 7 54 46 1a 1y 1b 3u l 2y 2f 4i q 36".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t){var u=d.detect();return function(d){var k="true"===f.get(d,"contenteditable");f.set(d,"contenteditable","true");var x=m.bind(d,"keydown",function(a){M.trigger.keydown(a)}),y=m.bind(d,"keyup",function(a){M.trigger.keyup(a)}),B=m.bind(d,"keypress",function(a){M.trigger.keypress(a)}),z=m.bind(d,"mousedown",
function(a){M.trigger.mousedown(a)}),A=m.bind(d,"mouseout",function(a){M.trigger.mouseout(a)}),C=m.bind(d,"mouseup",function(a){M.trigger.mouseup(a)}),D=m.bind(d,"contextmenu",function(a){M.trigger.contextmenu(a)}),F=m.bind(d,"cut",function(a){M.trigger.cut(a)}),E=m.bind(d,"copy",function(a){M.trigger.copy(a)}),G=m.bind(d,"paste",function(a){M.trigger.paste(a)}),H=u.browser.isFirefox()?"focus":"focusin",I=m.bind(d,H,function(a){M.trigger.focus(a)}),L=m.bind(d,"focusout",function(a){M.trigger.focusOut(a)}),
J=m.bind(d,"dblclick",function(a){M.trigger.dblclick(a)}),K=function(a){return l.eq(d,a)},M=g.create({keydown:e(["original"]),keyup:e(["original"]),keypress:e(["original"]),mousedown:e(["original"]),mouseup:e(["original"]),mouseout:e(["original"]),contextmenu:e(["original"]),cut:e(["original"]),copy:e(["original"]),paste:e(["original"]),focus:e(["original"]),dblclick:e(["original"]),focusOut:e(["original"])});return{win:a.constant(t),doc:a.constant(n.fromDom(s)),body:a.constant(d),get:function(){return r.get(d)},
set:function(a){r.set(d,a)},focus:function(){u.browser.isIE()?d.dom().setActive(!0):p.focus(d)},focused:function(){return s.activeElement===d.dom()},blur:function(){d.dom().blur()},destroy:function(){k||f.remove(d,"contenteditable");c.each([x,y,B,z,C,A,D,F,E,G,I,L,J],function(a){a.unbind()})},events:M.registry,background:a.noop,foreground:a.noop,hasRange:function(a){return q.closest(a.startContainer(),K).isSome()&&q.closest(a.endContainer(),K).isSome()},isActive:function(){return h.has(d,b.active())}}}});
k("120","c 7r e7 97 7s 7 ip 4n l 2y 2o 21 31".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r){var q=g.constant(!1),s=c.detect(),t=s.browser.isIE()||s.browser.isSpartan()?2:5,u=h.generate([{above:["element"]},{below:["element"]}]),k=function(a,b,c){return function(b){return e.bounds(a,b).fold(q,c)}},w=function(a,b){return k(a,b,function(a){return b>a.top+a.height-t})},x=function(a,b){return k(a,b,function(a){return b<a.top+t})};return function(c,g,h){var q=function(a){var b=f.freefallRtl(g).element();
return r.ancestor(b,"table").filter(w(c,a)).map(u.above)},t=function(a,b){a.kill();e.set(c,b);h()};return function(e){var h=e.y();q(h).orThunk(function(){var a=f.freefallLtr(g).element();return r.ancestor(a,"table").filter(x(c,h)).map(u.below)}).fold(function(){if("html"===p.name(e.target())){var a=e.x(),b=e.y();d.find(c,a,b).each(function(a){var b=function(a){return r.closest(a,'[contenteditable="false"]').isSome()},c=a.start().fold(b,b,b),b=a.finish().fold(b,b,b);(c||b)&&s.browser.isIE()||m.focus(g);
t(e,a)})}},function(c){var d=l.fromHtml("<p><br /></p>");c.fold(function(a){n.after(a,d)},function(a){n.before(a,d)});t(e,b.write(a.on(d,0),a.on(d,0)))})}}});k("126",["e7","7s","j9"],function(c,d,b){return{clearAll:function(a){d.clearAll(a)},get:function(a){return d.get(a).map(function(a){return b(a.start(),a.soffset(),a.finish(),a.foffset())})},set:function(a,b){d.setExact(a,b.startContainer(),b.startOffset(),b.endContainer(),b.endOffset())},setExact:function(a,b,c,f,h){d.setExact(a,b,c,f,h)},setRelative:function(a,
b,g){b=c.write(b,g);d.set(a,b)},replace:function(a,b){d.replace(a,b)}}});k("121",["126","54","46","6e","3t"],function(c,d,b,a,e){return function(g){var f=null,h=function(){f=null;c.get(g.win()).each(function(a){a.collapsed()&&g.focused()&&l.trigger.loiter(a.startContainer(),a.startOffset())})},l=b.create({loiter:d(["node","offset"])});return{reset:function(){null!==f&&(a(f),f=null);f=e(h,1E3)},destroy:function(){null!==f&&(a(f),f=null)},events:l.registry}}});k("122","7 s k eh 54 46 2m 1b 21 4i m".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n){var p=function(a,d){var e=c.curry(h.eq,f.body()),g=d.join(", ");return b.findMap(a,function(a){return m.ancestor(a,function(a){return n.is(a,g)},e)}).isSome()};return function(b,c){var f=d.none(),m=a.tap(function(){m.control.block();var a=b();a.each(function(a){var b=function(){n.trigger.nodeChanged(a.startContainer(),a.startOffset(),f.map(function(a){return a.startContainer()}))};f.fold(b,function(d){var e=h.eq,f=a.startContainer(),g=a.endContainer(),m=d.startContainer(),
n=d.endContainer(),r=d.startOffset()!==a.startOffset();d=d.endOffset()!==a.endOffset();e(m,f)&&e(n,g)&&!(!l.isText(f)&&r||!l.isText(g)&&d)||!1!==p([a.startContainer()],c)||b()})});f=a;m.control.unblock()}),n=g.create({nodeChanged:e(["node","offset","prev"])});return{update:function(){m.instance()},clear:function(){f=d.none()},events:n.registry}}});k("123",["7","1b","l","2y"],function(c,d,b,a){var e=function(b,e){return{toEditor:b,toOld:c.curry(a.focus,e),isSet:function(){return a.active().exists(function(a){return d.eq(a,
e)})}}},g=function(a,d,g,m){m=m.dom().activeElement;return a()?{toEditor:d,toOld:c.noop,isSet:c.constant(!0)}:void 0===m||null===m?{toEditor:g,toOld:c.noop,isSet:c.constant(!1)}:e(g,b.fromDom(m))};return{build:g,toEditor:function(a,b,c,d){g(a,b,c,d).toEditor()}}});k("124",["s"],function(c){return function(){var d=c.none();return{get:function(){return d},restore:function(b){d.each(b)},update:function(b){d=b.or(d)},clear:function(){d=c.none()}}}});k("125",["97","126","6m","31"],function(c,d,b,a){var e=
function(a){return b.closest(a.startContainer(),'[contenteditable="false"]')&&b.closest(a.endContainer(),'[contenteditable="false"]')};return{focus:function(b,f,h){f=f().filter(e);f.each(function(e){a.closest(e.endContainer(),'[contenteditable="false"]').each(function(a){d.setRelative(b.win(),c.after(a),c.after(a))})});b.focus();f.each(function(a){h(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset())})}}});k("z7","c 120 121 122 123 124 125 126 7 ip 54 46 47 3k 3u l 29 o q 36".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,k,w,x){var y=c.detect();return function(c,u){var A=function(){return M().orThunk(F.get)},C=s.bind(c.body(),"click",d(c.win(),c.body(),l.noop)),D=a(A,u),F=g(),E=function(){D.update();K()},G=function(){F.restore(function(a){N(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset())})};D.events.nodeChanged.bind(function(a){X.trigger.nodeChanged(a.node(),a.offset(),a.prev());X.trigger.uiStale()});c.events.keyup.bind(function(a){X.trigger.keyup(a.original());
E();H.reset();X.trigger.interaction()});c.events.mouseout.bind(function(a){K()});c.events.mouseup.bind(function(a){X.trigger.mouseup(a.original());E();H.reset();X.trigger.interaction()});var H=b(c);H.events.loiter.bind(function(a){X.trigger.loiter(a.node(),a.offset())});var I=function(){M().isNone()?G():K()},L=function(){c.isActive()&&(I(),f.focus(c,A,Q))},J=function(){X.trigger.domChanged()},K=function(){var a=M();F.update(a)},M=function(){return h.get(x).filter(c.hasRange)},N=function(a,b,c,d){try{h.setExact(x,
a,b,c,d)}catch(e){k.log("Skipping restoring invalid cursor position")}},S=function(a){R(function(b){c.isActive()&&a();E()},e.build(c.focused,I,L,t.fromDom(w)))},Q=function(a,b,c,d){S(function(){N(a,b,c,d)})},P=function(a,b){var c=h.get(x);G();var d=a(b);b.toOld();c.each(function(a){N(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset());y.browser.isSpartan()&&(b.isSet()||b.toOld())});return d},R=function(a,b){var c=a(b);b.toOld();return c},O=function(a){var b=e.build(c.focused,I,L,t.fromDom(w));
return(M().isSome()?R:P)(a,b)},T=function(a){return function(){var b=arguments;return O(function(c){c.toEditor();return a(b)})}}(function(a){w.execCommand.apply(w,a);K()}),W=function(a,b){return q(a,b)},X=p.create({nodeChanged:n(["node","offset","prev"]),loiter:n(["node","offset"]),uiStale:n([]),domChanged:n([]),interaction:n([]),keyup:n(["original"]),mouseup:n(["original"]),keydown:r(["original"],c.events.keydown),keypress:r(["original"],c.events.keypress),mousedown:r(["original"],c.events.mousedown),
contextmenu:r(["original"],c.events.contextmenu),cut:r(["original"],c.events.cut),copy:r(["original"],c.events.copy),paste:r(["original"],c.events.paste),focus:r(["original"],c.events.focus),focusOut:r(["original"],c.events.focusOut),dblclick:r(["original"],c.events.dblclick)});return{win:c.win,doc:c.doc,body:c.body,canvas:c.body,getContent:c.get,setContent:c.set,resetContent:function(a){c.set(a);F.clear();D.clear();a=m.freefallLtr(c.body());Q(a.element(),a.offset(),a.element(),a.offset());J()},blur:c.blur,
focus:function(){e.toEditor(c.focused,I,L,t.fromDom(w))},uiChanged:function(){O(function(){X.trigger.uiStale()})},domChanged:J,clearSelection:function(){h.clearAll(x)},getSelection:A,setSelection:Q,setRelativeSelection:function(a,b){S(function(){h.setRelative(x,a,b)})},backupSelection:K,replaceSelection:function(a){M().fold(function(){G();M().each(function(){h.replace(x,a);E()})},function(b){h.replace(x,a);E()})},execCommand:T,destroy:function(){c.destroy();H.destroy();C.unbind()},events:X.registry,
background:c.background,foreground:c.foreground,translateScreen:W,translateLocation:W}}});k("z8",["b","2u","1b","4y"],function(c,d,b,a){var e=d.immutable("doc","href");return function(){var d=[],f=function(a,c){return function(d){return b.eq(a,d.doc())&&c===d.href()}};return{addLinkIfMissing:function(b,l){c.find(d,f(b,l))||(d.push(e(b,l)),a.addStylesheet(l,b))}}}});k("z9",["b","9"],function(c,d){return function(){var b=null,a=[],e=function(){return null!==b},g=function(){c.each(a,function(a){f(a)})},
f=function(a){setTimeout(function(){a.apply(null,b)},0)};return{get:function(b){e()?f(b):a.push(b)},set:function(){b=d.prototype.slice.call(arguments);g();a=[]},isSet:e}}});k("v5","b 7v z6 z7 z8 z9 7 1a 2n l 2f 21 2q 2a 68".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s){var t=e();return function(e,k,w){var x=m.fromTag("div");d.presentation(x);l.set(x,"display","none");var y=n.get(e);(function(a){var b=q.owner(e);c.each(a,function(a){t.addLinkIfMissing(b,a)})})(k);k=g();var B=b(e),z=a(B,w);k.set(z);
return{element:function(){return e},onCanvas:function(a){a(z.canvas())},initial:f.constant(y),placeholder:function(){return x},tabindex:function(a){h.set(e,"tabindex",a)},destroy:function(){r.remove(x);z.destroy()},loaded:k.get,extract:function(a){var b=p.name(e),c=new s("^<"+b+" .*?>",""),b=new s("<\\/"+b+">$","");return a.replace(c,"").replace(b,"")},isInline:f.constant(!0)}}});k("127",["7"],function(c){return function(d,b){var a=d.doc();return{execCommand:function(d){var g=arguments,f=d.toLowerCase(),
h=c.die("This should not be in hare."),h={fontsize:h,forecolor:h,fontname:h,bgcolor:h,inserthtml:h,blockquote:h};(void 0!==h[f]?h[f]:function(){a.dom().execCommand.apply(a.dom(),g)})();b.update()}}}});k("128",["125","j9","126","7","6m"],function(c,d,b,a,e){return function(e){var f=function(){return b.get(e.win())},h=function(a,c,f,h){a=d(a,c,f,h);b.set(e.win(),a)};return{clearSelection:function(){b.clearAll(e.win())},getSelection:f,replaceSelection:function(a){b.replace(e.win(),a)},setSelection:h,
setRelativeSelection:function(a,c){b.setRelative(e.win(),a,c)},restore:a.noop,backup:a.noop,nativeCall:a.apply,focus:function(){c.focus(e,f,h)},destroy:a.noop,clear:a.noop}}});k("129","j9 126 7 s 3u 2y o q".split(" "),function(c,d,b,a,e,g,f,h){var l=function(){f.log("The previous selection could not be restored. Defaulting to the current selection.")};return function(f,n){var p=a.none(),r=e.bind(n,"blur",function(a){q()}),q=function(){d.get(f.win()).fold(b.noop,function(b){p=a.some(b)})},s=function(b,
c){try{c(f.win(),b),p=a.some(b)}catch(d){l()}},t=function(a){s(a,d.set)},u=function(){p.each(t)},k=function(a){var b=h.activeElement;a=a();null!==b&&void 0!==b&&b!==h.activeElement&&void 0!==b.focus&&b.focus();return a};return{clearSelection:function(){g.hasFocus(n)&&d.clearAll(f.win())},getSelection:function(){return g.hasFocus(n)?d.get(f.win()):p},replaceSelection:function(a){g.hasFocus(n)||u();d.replace(f.win(),a)},setSelection:function(a,d,e,f){k(function(){var h=c(a,d,e,f);g.hasFocus(n)?t(h):
s(h,b.noop)})},setRelativeSelection:function(a,b){k(function(){try{d.setRelative(f.win(),a,b)}catch(c){l()}q()})},restore:u,backup:q,nativeCall:function(a){return k(function(){g.hasFocus(n)||u();return a()})},focus:function(){if(h.activeElement!==n.dom()){var a=p;f.focus();a.each(t)}else d.get(f.win()).fold(u,b.noop)},destroy:function(){r.unbind()},clear:function(){p=a.none()}}}});k("za","c 120 121 122 127 128 129 9u ip 54 46 47 3u 3l 29".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s){return function(t,
u,k){var w=c.detect(),x=w.browser.isIE()||w.browser.isSpartan()?f(t,u):g(t),y=r.bind(t.doc(),"click",d(t.win(),t.body(),x.backup)),B=function(){return x.getSelection()},z=a(B,k),A=e(t,z);(w.browser.isChrome()||w.browser.isSafari())&&A.execCommand("defaultParagraphSeparator",!1,"p");z.events.nodeChanged.bind(function(a){H.trigger.nodeChanged(a.node(),a.offset(),a.prev());H.trigger.uiStale()});t.events.keyup.bind(function(a){x.backup();z.update(a)});var C=h(z.update,300);t.events.mouseup.bind(function(a){x.backup();
C.throttle(a)});var D=b(t);D.events.loiter.bind(function(a){H.trigger.loiter(a.node(),a.offset())});k=function(){D.reset();H.trigger.interaction()};t.events.keyup.bind(k);t.events.mouseup.bind(k);var F=function(){H.trigger.domChanged()},E=function(a,b,c,d){x.setSelection(a,b,c,d);z.update()},G=function(a,b){return q.absolute(u).translate(a,b)},H=n.create({nodeChanged:m(["node","offset","prev"]),loiter:m(["node","offset"]),uiStale:m([]),domChanged:m([]),interaction:m([]),keydown:p(["original"],t.events.keydown),
keyup:p(["original"],t.events.keyup),keypress:p(["original"],t.events.keypress),mousedown:p(["original"],t.events.mousedown),mouseup:p(["original"],t.events.mouseup),contextmenu:p(["original"],t.events.contextmenu),cut:p(["original"],t.events.cut),copy:p(["original"],t.events.copy),paste:p(["original"],t.events.paste),focus:p(["original"],t.events.focus),focusOut:p(["original"],t.events.focusOut),dblclick:p(["original"],t.events.dblclick)});return{win:t.win,doc:t.doc,body:t.body,canvas:t.doc,getContent:t.get,
setContent:t.set,resetContent:function(a){t.set(a);x.clear();z.clear();a=l.freefallLtr(t.body());E(a.element(),a.offset(),a.element(),a.offset());F()},blur:t.blur,focus:function(){x.focus()},uiChanged:function(){H.trigger.uiStale()},domChanged:F,clearSelection:function(){x.clearSelection()},getSelection:B,setSelection:E,setRelativeSelection:function(a,b){x.setRelativeSelection(a,b);z.update()},backupSelection:function(){x.backup()},replaceSelection:function(a){x.replaceSelection(a);z.update()},execCommand:function(){var a=
arguments;x.nativeCall(function(){A.execCommand.apply(null,a);H.trigger.uiStale()})},destroy:function(){x.destroy();t.destroy();D.destroy();y.unbind()},events:H.registry,background:t.background,foreground:t.foreground,translateScreen:G,translateLocation:function(a,b){var c=s.get(t.doc());return G(a,b).translate(-c.left(),-c.top())}}}});k("15c",["7","9u","s","3u"],function(c,d,b,a){return function(e){return{background:c.noop,foreground:c.noop,focus:c.noop,keydown:c.noop,mousedown:b.some,mouseup:b.some,
selectionchange:function(b,c){var e=d(b,300);return a.bind(c,"selectionchange",e.throttle)}}}});k("15w",["7","29"],function(c,d){return{unbound:function(){return{unbind:c.noop}},saveScroll:function(b,a){var c=d.get(b);a();var g=d.get(b);c.top()===g.top()&&c.left()===g.left()||b.dom().defaultView.scrollTo(c.left(),c.top())}}});k("15d","15w 7 s l 2a q 36".split(" "),function(c,d,b,a,e,g,f){return function(h,l){return{background:d.noop,foreground:d.noop,focus:function(b,d,h){c.saveScroll(a.fromDom(g),
function(){c.saveScroll(e.owner(h),function(){l.browser.isSpartan()&&f.getSelection().removeAllRanges();h.dom().focus()})})},keydown:d.noop,mousedown:b.some,mouseup:b.some,selectionchange:c.unbound}}});k("15e",["15w","7","s","21","2a"],function(c,d,b,a,e){return function(g){var f=function(c){return"body"===a.name(c.target())||"html"===a.name(c.target())?b.none():b.some(c)};return{background:function(a,b,c){e.owner(b).dom().defaultView.focus()},foreground:function(a,b,c){void 0!==a.focus&&a.focus()},
focus:d.noop,keydown:function(a){void 0!==a.focus&&a.focus()},mousedown:function(a){return f(a)},mouseup:function(a){return f(a)},selectionchange:c.unbound}}});k("14h",["c","15c","15d","15e"],function(c,d,b,a){var e=c.detect(),g=e.deviceType.isiOS()?a:e.deviceType.isAndroid()?d:b;return{get:function(a){return g(a,e)}}});k("14i",["s","l"],function(c,d){var b=function(a){a=a.dom();try{var b=a.contentWindow?a.contentWindow.document:a.contentDocument;return void 0!==b&&null!==b?c.some(d.fromDom(b)):c.none()}catch(g){return console.log("Error reading iframe: ",
a),console.log("Error was: "+g),c.none()}};return{doc:function(a){return b(a).fold(function(){return a},function(a){return a})}}});k("13w",["14i","2m"],function(c,d){return{write:function(b,a){if(!d.inBody(b))throw"Internal error: attempted to write to an iframe that is not in the DOM";var e=c.doc(b).dom();e.open();e.writeln(a);e.close()}}});k("12a","b c 4a 14h 7 14i 13w 54 46 4b 3u 2f 31 q".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q){var s=d.detect(),t=function(a){var b=s.browser.isChrome()&&
s.os.isWindows()||s.browser.isSafari()?' style="min-height: 100%; height: 100%;"':"",d=a.base.fold(e.constant(""),function(a){return'<base href="'+a+'" />'}),f=a.editorStyles.concat(a.stylesheets),f=c.map(f,function(a){return'<link rel="stylesheet" type="text/css" href="'+a+'" />'});a=0===a.documentStyles.length?"":'<style type="text/css">'+a.documentStyles+"</style>";return"<!doctype html><html"+b+"><head>"+d+f.join("")+a+'</head><body contenteditable="true" spellcheck="false"></body></html>'};return function(d,
k){f.write(d,t(k));var w=d.dom().contentWindow,x=g.doc(d),y=r.descendant(x,"body").getOrDie();m.add(y,[b.base(),b.active()]);var B=s.browser.isFirefox(),z=l.create({keydown:h(["original"]),keyup:h(["original"]),keypress:h(["original"]),mousedown:h(["original"]),mouseup:h(["original"]),contextmenu:h(["original"]),cut:h(["original"]),copy:h(["original"]),paste:h(["original"]),focus:h(["original"]),dblclick:h(["original"]),focusOut:h(["original"])}),A=a.get(z),C=n.bind(x,"keydown",function(a){A.keydown(w);
z.trigger.keydown(a)}),D=n.bind(x,"keyup",function(a){z.trigger.keyup(a)}),F=n.bind(x,"keypress",function(a){z.trigger.keypress(a)}),E=n.bind(x,"mousedown",function(a){A.mousedown(a).fold(function(){a.kill()},z.trigger.mousedown)}),G=n.bind(x,"mouseup",function(a){A.mouseup(a).fold(function(){a.kill()},z.trigger.mouseup)}),H=n.bind(x,"contextmenu",function(a){z.trigger.contextmenu(a)}),I=n.bind(x,"cut",function(a){z.trigger.cut(a)}),L=n.bind(x,"copy",function(a){z.trigger.copy(a)}),J=n.bind(x,"paste",
function(a){z.trigger.paste(a)}),K=n.bind(x,B?"focus":"focusin",function(a){z.trigger.focus(a)}),M=n.bind(x,"focusout",function(a){z.trigger.focusOut(a)}),N=n.bind(x,"dblclick",function(a){z.trigger.dblclick(a)}),S=A.selectionchange(function(a){z.trigger.mouseup(a)},x),Q=n.bind(x,"touchstart",function(a){z.trigger.mousedown(a)}),P=n.bind(x,"touchend",function(a){z.trigger.mouseup(a);R()}),R=function(){A.foreground(w,d,y)};return{win:e.constant(w),doc:e.constant(x),body:e.constant(y),get:function(){return p.get(y)},
set:function(a){p.set(y,a)},focus:function(){A.focus(w,d,y)},focused:function(){return q.activeElement===d.dom()},blur:function(){y.dom().blur()},destroy:function(){c.each([C,D,F,E,G,H,I,L,J,K,M,S,N,Q,P],function(a){a.unbind()})},events:z.registry,background:function(){A.background(w,d,y)},foreground:R}}});k("12b",["4g"],function(c){return{resolve:c.create("ephox-hare").resolve}});k("zb","12a 12b z9 7 s 1a 1y 3u l 2q su".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){return function(p){var r=l.fromTag("iframe");
f.add(r,d.resolve("content-iframe"));var q=e.none(),s=b(),t=h.bind(r,"load",function(){t.unbind();var b=n.onShow(r,function(){q.each(a.apply);q=e.none();s.set(c(r,p))});q=e.some(b)});return{element:function(){return r},tabindex:function(a){g.set(r,"tabindex",a)},destroy:function(){m.remove(r);t.unbind();q.each(a.apply)},loaded:s.get}}});k("v6",["za","zb","z9","7","3t"],function(c,d,b,a,e){return function(g,f){var h=d(g),l=b(),m=a.noop;h.loaded(function(a){var b=c(a,h.element(),f);e(function(){l.set(b);
m=b.destroy},0)});return{element:h.element,onCanvas:function(a){l.get(function(b){a(b.canvas())})},initial:a.constant(""),placeholder:h.element,tabindex:h.tabindex,extract:a.identity,destroy:function(){m();h.destroy()},loaded:l.get,isInline:a.constant(!1)}}});k("mw","c v5 v6 7 s eh 54 46 3k 3u".split(" "),function(c,d,b,a,e,g,f,h,l,m){var n=function(b){var d=e.none(),n=g.tap(function(a,b,c){z.trigger.nodeChanged(a,b,c)});b.loaded(function(a){d=e.some(a);var b=c.detect();if(b.browser.isFirefox()){try{a.execCommand("enableObjectResizing",
!1,!1)}catch(f){}try{a.execCommand("enableInlineTableEditing",!1,!1)}catch(g){}}a.events.nodeChanged.bind(function(a){n.instance(a.node(),a.offset(),a.prev())});a.events.loiter.bind(function(a){z.trigger.loiter(a.node(),a.offset())});a.events.uiStale.bind(function(){z.trigger.uiStale()});a.events.domChanged.bind(function(){z.trigger.domChanged()});a.events.interaction.bind(function(){z.trigger.interaction()});a.events.keyup.bind(function(a){z.trigger.keyup(a.original())});a.events.keydown.bind(function(a){z.trigger.keydown(a.original())});
a.events.keypress.bind(function(a){z.trigger.keypress(a.original())});a.events.mousedown.bind(function(a){z.trigger.mousedown(a.original())});var h=function(a){z.trigger.mouseup(a.original())},l=function(a){if(3===a.original().raw().which){var b=m.capture(a.original().target(),"contextmenu",function(c){z.trigger.contextmenu(c);z.trigger.mouseup(a.original());b.unbind()});a.original().kill()}else h(a)},l=b.browser.isSpartan()?l:h;a.events.mouseup.bind(l);var p=function(a){z.trigger.contextmenu(a.original())},
l=function(a){3===a.original().raw().which&&!0===a.original().raw().isTrusted?a.original().kill():p(a)},b=b.browser.isSpartan()?l:p;a.events.contextmenu.bind(b);a.events.cut.bind(function(a){z.trigger.cut(a.original())});a.events.copy.bind(function(a){z.trigger.copy(a.original())});a.events.paste.bind(function(a){z.trigger.paste(a.original())});a.events.focus.bind(function(a){z.trigger.focus(a.original())});a.events.focusOut.bind(function(a){z.trigger.focusOut(a.original())});a.events.dblclick.bind(function(a){z.trigger.dblclick(a.original())});
a.resetContent(u);z.trigger.ready(a);z.trigger.loaded();a.uiChanged()});var s=function(){return d.map(function(a){return a.win()})},t=function(){return d.map(function(a){return a.doc()})},u=b.initial(),k=function(){d.each(function(a){a.focus()})},w=function(){return d.bind(function(a){return a.getSelection()})},x=function(a,b,c,e){d.each(function(d){d.setSelection(a,b,c,e)})},y=function(a,b){d.each(function(c){c.setRelativeSelection(a,b)})},B=function(){var a=arguments;d.each(function(b){b.execCommand.apply(null,
a)})},z=h.create({nodeChanged:f(["node","offset","prev"]),loiter:f(["node","offset"]),uiStale:f([]),domChanged:f([]),interaction:f([]),keydown:f(["original"]),keyup:f(["original"]),keypress:f(["original"]),mousedown:f(["original"]),mouseup:f(["original"]),contextmenu:f(["original"]),cut:f(["original"]),copy:f(["original"]),paste:f(["original"]),focus:f(["original"]),focusOut:f(["original"]),dblclick:f(["original"]),ready:f(["api"]),loaded:f([])});return{element:b.element,tabindex:b.tabindex,onCanvas:b.onCanvas,
win:s,doc:t,body:function(){return d.map(function(a){return a.body()})},getContent:function(){return d.fold(function(){return u},function(a){return a.getContent()})},setContent:function(a){d.fold(function(){u=a},function(b){b.setContent(a)})},resetContent:function(a){d.fold(function(){u=a},function(b){b.resetContent(a)})},blur:function(){d.each(function(a){a.blur()})},focus:k,uiChanged:function(){d.each(function(a){a.uiChanged()})},domChanged:function(){d.each(function(a){a.domChanged()})},clearSelection:function(){d.each(function(a){a.clearSelection()})},
getSelection:w,setSelection:x,setRelativeSelection:y,backupSelection:function(){d.each(function(a){a.backupSelection()})},replaceSelection:function(a){d.each(function(b){b.replaceSelection(a)})},execCommand:B,lockdown:function(a){var b=n.control.isBlocked();n.control.block();a();b||n.control.unblock()},destroy:function(){b.destroy()},events:z.registry,background:function(){d.fold(a.identity,function(a){a.background()})},foreground:function(){d.fold(a.identity,function(a){a.foreground()})},on:function(b){return s().bind(function(c){return t().map(function(d){return b({win:a.constant(c),
doc:a.constant(d),execCommand:B,getSelection:w,setSelection:x,setRelativeSelection:y,focus:k})})})},translateScreen:function(a,b){return d.fold(function(){return l(a,b)},function(c){return c.translateScreen(a,b)})},translateLocation:function(a,b){return d.fold(function(){return l(a,b)},function(c){return c.translateLocation(a,b)})},placeholder:b.placeholder,extract:b.extract,isInline:b.isInline}};return{frame:function(a,c){var d=b(a,c);return n(d)},detached:function(a,b,c){a=d(a,b,c);return n(a)}}});
k("ig","a 1o 7s 7 52 2n l 2f 2o 2q 3t".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){var p=function(a,b){if(void 0!==a&&c.isFunction(a.setData))try{return d.each(b,function(b,c){a.setData(c,b())}),!0}catch(e){return!1}else return!1},r=function(a,c,d){var e=f.fromTag("div",a.doc().dom());g.setAll(e,{position:"absolute",top:"-1000px"});c=c["text/html"]();h.set(e,c);l.append(a.body(),e);var p=a.getSelection();b.selectElementContents(a.win(),e);n(function(){m.remove(e);p.each(function(b){a.setSelection(b.startContainer(),
b.startOffset(),b.endContainer(),b.endOffset())});n(d,0)},0)},q=function(a){return function(b,d,e){var f=b.raw();if(!c.isString(f.type)||"copy"!==f.type.toLowerCase()&&"cut"!==f.type.toLowerCase())throw"Can only set the clipboard with a cut or copy event";if(!c.isFunction(d["text/html"]))throw"Must provide at least text/html data function when setting clipboard contents";p(f.clipboardData,d)?(b.kill(),n(e,0)):a(d,e)}},s=e.exactly(["doc","win","body","getSelection","setSelection"]);return{register:function(b){s(b);
b=a.curry(r,b);return{setClipboard:q(b)}},textMime:a.constant("text/plain"),htmlMime:a.constant("text/html")}});k("mx",["21","eq"],function(c,d){var b=d(c.isComment,"comment");return{get:function(a){return b.get(a)},getOption:function(a){return b.getOption(a)},set:function(a,c){b.set(a,c)}}});k("if","b 7 r s k ig mx 21 v".split(" "),function(c,d,b,a,e,g,f,h,l){var m={clipboardType:d.constant("x-textbox/html"),findClipboardTags:function(b){b=e.cat(c.map(b,function(b){if(h.isComment(b)){var c=f.get(b);
if(l.contains(c,"x-textbox/html"))return a.some(b)}return a.none()}));return 0===b.length?a.none():a.some(b)}};return{intraFlag:d.constant(m),buildClipboardContents:function(a,c){var e={};e["x-textbox/html"]=d.constant("true");e[g.textMime()]=b.cached(a);e[g.htmlMime()]=b.cached(function(){return"\x3c!-- x-textbox/html --\x3e"+c()});return e},ignoreSelectors:d.constant([".ephox-sloth-bin"])}});k("ej","mw 7 if 33 4b 2n 2o 31 o".split(" "),function(c,d,b,a,e,g,f,h,l){var m=function(a,b){return{editable:d.constant(a),
connect:b}},n=function(a,d){var e=c.frame(d,b.ignoreSelectors());e.events.ready.bind(function(b){b=b.api().body();a.updateUi(b)});return m(e,function(a){f.append(a,e.element())})},p=function(n,p){0!==p.stylesheets.length&&l.log("You have attempted to declare the following stylesheets for use in textbox.io: ["+p.stylesheets.join(", ")+"]. User stylesheets are not used in inline editing mode and have been ignored.");0!==p.documentStyles.length&&l.log('You have attempted to declare the following document styles for use in textbox.io: "'+
p.documentStyles+'". Document styles are not used in inline editing mode and have been ignored.');p.base.fold(d.noop,function(a){l.log('You have attempted to declare the following content base URL for use in textbox.io: "'+a+'". Content base URL is not used in inline editing mode and has been ignored.')});var s=c.detached(p.inline,p.editorStyles,b.ignoreSelectors());return m(s,function(b){f.append(b,s.placeholder());b=h.ancestor(b,".ephox-polish-editor-container").getOr(b);g.set(s.placeholder(),"display",
"none");e.add(b,[a.resolve("inline-editor-container"),a.resolve("layer-editor")])})};return{build:function(a,b){return(void 0!==b.inline?p:n)(a,b)}}});k("ek",["s","29"],function(c,d){return function(b){var a=c.none(),e=c.none(),g=function(){a.each(function(a){b.setSelection(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset())});e.each(function(a){b.win().each(function(b){b.scrollTo(a.left(),a.top())})})},f=function(){a=c.none();e=c.none()};return{restore:function(){g();f()},save:function(){a=
b.getSelection();e=b.doc().map(d.get)},get:function(){return a},clear:f,attempt:function(b){a=b.or(a)}}}});k("my","5b b c l 2o 2a".split(" "),function(c,d,b,a,e,g){var f=b.detect().browser.isFirefox(),h=function(b){d.each(b,function(b){g.nextSibling(b).isNone()&&e.after(b,a.fromText(c.zeroWidth()))})};return{configure:function(a){f&&a.addSelector(a.input(),"a",h)}}});k("9q",[],function(){return{get:function(c){return c.dom().textContent},set:function(c,d){c.dom().textContent=d}}});k("el","5b b 7 my 33 ca dl 7e 1a 1y l 2o 2q 4e 9q".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s){var t=e.resolve("content-eph-wrapper"),u=e.resolve("content-eph-extra"),k=e.resolve("content-eph-general"),w=function(a){d.each(a,function(a){m.remove(a,f.styleSpan());l.remove(a,f.overrideSpan());(l.hasNone(a)||h.isTransient(a))&&r.unwrap(a)})},x=function(a){d.each(a,function(a){m.remove(a,f.quasiBlocks)})},y=function(a){d.each(a,function(a){var b=l.get(a,"style");l.set(a,"style",b.replace(/"/g,"'"))})},B=function(a){d.each(a,function(a){if(0===s.get(a).length&&
0===q.descendants(a,"br,img,hr").length){var b=n.fromText(c.zeroWidth());p.append(a,b)}})};return{configure:function(b){b.add(b.internal(),t,g.unwrap);b.add(b.internal(),u,g.remove);b.add(b.internal(),k,g.remove);b.add(b.internal(),f.quasiBlocks,x);b.add(b.output(),t,g.unwrap);b.add(b.output(),u,g.remove);b.add(b.output(),k,g.remove);b.add(b.output(),f.styleSpan(),w);b.add(b.output(),f.quasiBlocks,x);b.addSelector(b.internal(),"noscript",g.remove);b.addSelector(b.input(),"[style]",y);b.addSelector(b.input(),
"td,th",B);b.addSelector(b.paste(),"[style]",y);b.addSelector(b.paste(),"td,th",B);a.configure(b)},markerWrapper:b.constant(t),markerExtra:b.constant(u),markerGeneral:b.constant(k)}});k("12c",["4g"],function(c){return{resolve:c.create("ephox-cereal").resolve}});k("zc","12c b 7 1a 1y 4b 31 dg".split(" "),function(c,d,b,a,e,g,f,h){var l=c.resolve("start-cursor"),m=c.resolve("finish-cursor"),n="data-"+c.resolve("start-offset"),p="data-"+c.resolve("finish-offset"),r=function(b){a.remove(b,n);a.remove(b,
p);g.remove(b,[l,m]);""===a.get(b,"class")&&a.remove(b,"class")},q=function(b,c){var d=a.get(b,c);return h(d,10)};return{setInfo:function(b,c,f,g){d.each([b,c],r);e.add(b,l);e.add(c,m);a.set(b,n,f);a.set(c,p,g)},clearInfo:r,findStart:function(a){return f.descendant(a,"."+l).map(function(a){return{token:b.constant(a),offset:b.constant(q(a,n))}})},findFinish:function(a){return f.descendant(a,"."+m).map(function(a){return{token:b.constant(a),offset:b.constant(q(a,p))}})}}});k("12d",["2u"],function(c){return c.immutable("token",
"remove","extra")});k("zd",["zc","12d","7"],function(c,d,b){return{use:function(a,c){return d(c,b.noop,[])},extract:function(a){return{remove:b.curry(c.clearInfo,a),element:b.constant(a)}}}});k("ze","12d 12c 7 s 1y 2n l 2o 2q 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m){var n=d.resolve("pre-cursor-token"),p=d.resolve("post-cursor-token"),r=d.resolve("first-cursor-token"),q=function(){var a=f.fromTag("span");g.set(a,"display","none");return a},s=function(a){var d=b.curry(l.remove,a);return c(a,d,[a])},
t=function(b){return e.has(b,n)?m.nextSibling(b):e.has(b,p)?m.prevSibling(b):e.has(b,r)?m.parent(b):a.none()};return{pre:function(a,b){var c=q();h.before(b,c);e.add(c,n);return s(c)},post:function(a,b){var c=q();h.after(b,c);e.add(c,p);return s(c)},first:function(a,b){var c=q();h.prepend(a,c);e.add(c,r);return s(c)},extract:function(a){return t(a).map(function(c){return{remove:b.curry(l.remove,a),element:b.constant(c)}})}}});k("12e",["2u"],function(c){var d=c.immutable("element","offset");c=c.immutable("startContainer",
"startOffset","endContainer","endOffset");return{point:d,range:c}});k("12f","12c 7 1y l 2o 4e 2a".split(" "),function(c,d,b,a,e,g,f){var h=c.resolve("text-node-wrapper"),l=function(a){return b.has(a,h)};return{create:function(){var c=a.fromTag("span");b.add(c,h);return c},findIn:function(a){return g.children(a,"."+h)},isWrap:l,inWrap:function(a){return f.parent(a).fold(d.constant(!1),function(a){return l(a)})},child:function(b){return f.child(b,0).fold(function(){var c=a.fromText("");e.append(b,c);
return c},d.identity)}}});k("12g","12f b l 2o 2q 2a".split(" "),function(c,d,b,a,e,g){var f=function(f){f=c.findIn(f);d.each(f,function(c){0===g.children(c).length&&a.before(c,b.fromText(""));e.unwrap(c)})},h=function(a){g.parent(a).each(e.unwrap)};return{unwrap:function(a){(c.inWrap(a)?h:f)(a)}}});k("zf","zc 12e 12f 12g zd ze 7 1b lf 21 2q".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){var p=function(a,b,c,d){return h.eq(a,b)?g.first(a,b):m.isElement(b)&&!d(b)?e.use(a,b):c(a,b)};return{extractFrom:function(c,
e){c.remove();e.remove();var g=function(c){var d=b.isWrap(c)?n.unwrap:a.unwrap,e=b.isWrap(c)?b.child(c):c;return{target:f.constant(e),unwrap:f.curry(d,c)}},h=g(c.element()),l=g(e.element()),m=d.range(h.target(),c.offset(),l.target(),e.offset());return{remove:function(){h.unwrap();l.unwrap()},getSelection:function(){return m}}},same:function(a,b,d,e,f){a=p(a,b,g.pre,f);c.setInfo(a.token(),a.token(),d,e);return[a]},diff:function(a,b,d,e,f,h){var m=l.after(b,d,e,f),n=m?g.pre:g.post;b=p(a,b,m?g.post:
g.pre,h);a=p(a,e,n,h);c.setInfo(b.token(),a.token(),d,f);return[b,a]}}});k("12h","12f b 7 2o 21 2a".split(" "),function(c,d,b,a,e,g){var f=function(a){return g.parent(a).fold(b.constant(!1),function(a){return c.isWrap(a)})},h=function(b){return d.foldr(b,function(b,d){if(e.isText(d)&&!f(d)){var g=c.create();a.wrap(d,g);return[g].concat(b)}return b},[])};return{wrap:function(a){var b=g.children(a),b=0<b.length?b:[a];return c.isWrap(a)?[]:h(b)}}});k("zg",["zc","12g","12h","b","7"],function(c,d,b,a,
e){var g=function(a){a.remove()};return{combine:function(f,h){var l=a.bind(f,b.wrap),m=a.bind(h,function(a){return a.extra()});return{extra:e.constant(m),wrappers:e.constant(l),remove:function(){a.each(h,function(a){c.clearInfo(a.token())});a.each(f,d.unwrap);a.each(h,g)}}}}});k("v7","zc zd ze zf zg 7 1b".split(" "),function(c,d,b,a,e,g,f){var h=function(b,c,d,f,g,h){var l=[c,f];b=a.diff(b,c,d,f,g,h);return e.combine(l,b)},l=function(b,c,d,f,g,h){f=[c];b=a.same(b,c,d,g,h);return e.combine(f,b)},m=
function(a,c){return c(a).map(function(a){var c=b.extract(a.token()).getOrThunk(function(){return d.extract(a.token())});return{remove:c.remove,offset:a.offset,element:c.element}})},n=function(a){return m(a,c.findStart).bind(function(b){return m(a,c.findFinish).map(function(a){return{startMarker:g.constant(b),finishMarker:g.constant(a)}})})};return{insertAt:function(a,b,c,d,e,g){return(f.eq(b,d)?l:h)(a,b,c,d,e,g)},extract:function(b){return n(b).map(function(b){return a.extractFrom(b.startMarker(),
b.finishMarker())})}}});k("mz",["v7"],function(c){return{insert:function(d,b,a){d=c.insertAt(d,b.startContainer(),b.startOffset(),b.endContainer(),b.endOffset(),a);return{extra:d.extra,wrappers:d.wrappers,remove:d.remove}},extract:function(d){return c.extract(d).map(function(b){return{remove:b.remove,getSelection:b.getSelection}})}}});k("em","mz b e7 97 d6 7 el 1a 1y n0 2f f4 2a 1s".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q){var s=function(a,b){d.each(a,function(a){l.add(a,b)})},t=function(a){var b=
function(){return r.parent(a).map(function(a){return"false"===h.get(a,"contenteditable")}).getOr(!1)};return"false"===h.get(a,"contenteditable")||b()};return{extract:function(a){return c.extract(a)},getSelection:function(c){var d=c.getSelection();c=d.startContainer();var f=d.startOffset(),g=d.endContainer(),d=d.endOffset(),h=e.getEnd(c),l=e.getEnd(g);return 0<=f&&f<=h&&0<=d&&d<=l?b.write(a.on(c,f),a.on(g,d)):b.write(a.before(c),a.before(c))},remove:function(a){a.remove()},serialise:function(a,b){return m.path(a,
b.startContainer()).bind(function(d){return m.path(a,b.endContainer()).bind(function(e){var h=p.deep(a);return m.follow(h,d).bind(function(a){return m.follow(h,e).map(function(d){d={startContainer:g.constant(a),startOffset:g.constant(b.startOffset()),endContainer:g.constant(d),endOffset:g.constant(b.endOffset())};d=c.insert(h,d,t);s(d.wrappers(),f.markerWrapper());s(d.extra(),f.markerExtra());return n.get(h)})})})})}}});k("12i",["2u"],function(c){return c.immutable("word","left","right")});k("12j",
["b","s","12i"],function(c,d,b){var a=["'","\u2018","\u2019"],e=c.bind(a,function(a){return c.map(["twas"],function(b){return a+b})}),g=function(a){var c=a.word();return b(c.substring(1),d.some(c.charAt(0)),a.right())},f=function(b){return c.contains(a,b)},h=function(a){var b=a.word(),d=c.exists(e,function(a){return-1<b.indexOf(a)})?2:1,h=b.substring(0,d);return c.forall(h,f)&&!f(b.charAt(d))?g(a):a},l=function(a){var c=a.word();2<=c.length&&f(c.charAt(c.length-1))&&!f(c.charAt(c.length-2))&&(c=a.word(),
a=b(c.substring(0,c.length-1),a.left(),d.some(c.charAt(c.length-1))));return h(a)};return{scope:l,text:function(a){a=b(a,d.none(),d.none());return l(a).word()}}});k("zi","b s 6j h5 12i 12j 68".split(" "),function(c,d,b,a,e,g,f){return{words:function(f){var l=b.unsafetoken(b.wordchar()+"+"),l=a.findall(f,l),m=f.length;return c.map(l,function(a){var b=a.start(),c=a.finish();a=f.substring(b,c);b=0<b?d.some(f.charAt(b-1)):d.none();c=c<m?d.some(f.charAt(c)):d.none();a=e(a,b,c);return g.scope(a)})}}});
k("v8",["zh","zi"],function(c,d){return{identify:function(b){return d.words(b)},isWord:function(b,a){return!c.hasBreak(a)}}});k("n1",["dy","v8"],function(c,d){var b=c();return{identify:function(a){return d.identify(a)},isWord:function(a){return d.isWord(b,a)}}});k("en","c s eg n1 dm 21 2a".split(" "),function(c,d,b,a,e,g,f){var h=c.detect(),l=function(a,c){return g.isText(a)?d.some(b.point(a,c)):0===f.children(a).length?d.none():f.child(a,c).bind(function(a){return l(a,0)})},m=function(a,b,c){a.on(function(a){e.expandWord(a,
b,c)})},n=function(b,c){var d=b.dom().createRange();d.setStart(c.startContainer().dom(),c.startOffset());d.setEnd(c.endContainer().dom(),c.endOffset());return a.isWord(d.cloneContents().textContent)};return{correct:function(a){a.getSelection().each(function(b){a.doc().each(function(c){n(c,b)&&l(b.startContainer(),b.startOffset()).each(function(c){(!b.collapsed()||a.isInline()&&h.browser.isIE())&&m(a,c.element(),c.offset())})})})},expand:function(a){a.on(e.expand);a.backupSelection()}}});da("n3",Image);
k("n2","54 46 1a 3u l n3".split(" "),function(c,d,b,a,e,g){return function(){var a=d.create({fail:c(["url","image"]),success:c(["url","image"]),start:c(["url"])}),h=function(a,b,c){var d=a.dom();d.addEventListener(b,c,!1);return{unbind:function(){d.removeEventListener(b,c,!1)}}},l=function(c){var d=b.get(c,"src"),e=h(c,"load",function(){e.unbind();g.unbind();(!0===c.dom().complete?a.trigger.success:a.trigger.fail)(d,c)}),g=h(c,"error",function(){e.unbind();g.unbind();a.trigger.fail(d,c)})};return{go:function(b){a.trigger.start(b);
var c=new g;c.src=b;l(e.fromDom(c))},monitor:l,events:a.registry}}});k("gf",["b","3s","7","p"],function(c,d,b,a){var e=function(a,b){return a.bind(function(a){return a.fold(function(){return d.pure(a)},function(a){return b(a)})})},g=function(b){return d.pure(a.value(b))},f=function(b){return d.nu(function(c){b.then(function(b){c(a.value(b))},function(b){c(a.error(b))})})},h=function(b){return b.map(a.value)};return{fromPromise:f,error:function(b){return d.pure(a.error(b))},map:function(a,b){return a.map(function(a){return a.map(b)})},
bind:e,pure:g,fromChain:function(a){return function(b){return c.foldl(a,function(a,b){return e(a,function(a){return b(a)})},g(b))}},fromFuture:h,pToFR:function(a){return b.compose(f,a)},fToFR:function(a){return b.compose(h,a)},effect:function(a){return function(b){b.each(function(){a()});return b}}}});k("eo","n2 3s p gf 1a n3".split(" "),function(c,d,b,a,e,g){var f=function(a){return d.nu(function(d){if(!0===a.dom().complete)d(b.value(a));else{var e=c();h(e,d);e.monitor(a)}})},h=function(a,c){a.events.success.bind(function(a){c(b.value(a.image()))});
a.events.fail.bind(function(a){c(b.error("Unable to download image "+a.url()))})};return{load:function(a){return d.nu(function(b){var d=c();h(d,b);d.go(a)})},loadIfNeeded:function(b){return!0===b.dom().complete||void 0===e.get(b,"src")?a.pure(b):f(b)}}});k("7x","ee 5b c 97 7s 3s 7 s eg eh 7u ei ej ek el em en eo c1 54 46 47 ep 1y 1b 3u l 48 2o 21 4e ak 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,k,w,x,y,B,z,A,C,D,F,E,G,H,I,L,J){var K=b.detect();return function(b,N,S,Q,P){s.configure(b);
var R=h.none();b={inline:S.inline,base:h.from(S.base),editorStyles:[S.css+"/content.css"],stylesheets:S.stylesheets,documentStyles:S.documentStyles};Q=r.build(Q,b);var O=Q.editable();null!==S.tabindex&&O.tabindex(S.tabindex);void 0!==P.clean&&O.setContent(P.clean);O.events.loaded.bind(function(){if(void 0!==P.clean){var a=O.getContent();P.clean===a&&W(P.marked,!1)}a=O.body().getOrDie();R=h.some(D.bind(a,"dblclick",function(a){u.correct(O)}))});O.events.ready.bind(function(a){w.addClasses(a.api().body())});
var T=function(){return O.getSelection().bind(function(a){var b=O.body().getOrDie("content should not return a selection if body is not yet available");return t.serialise(b,a)}).getOr(O.getContent())},W=function(a,b){O.body().each(function(c){O.setContent(a);t.extract(c).fold(function(){O.setSelection(c,0,c,0)},function(a){var b=t.getSelection(a);t.remove(a);O.setRelativeSelection(b.start(),b.finish())});if(!K.deviceType.isiOS()){var d=I.descendants(c,"img");b?g.mapM(d,k.loadIfNeeded).get(function(){Z()}):
Z()}})},X=y.create({nodeChanged:x(["node","offset","prev"]),undoChanged:x([]),loiter:B(["node","offset"],O.events.loiter),uiStale:B([],O.events.uiStale),domChanged:B([],O.events.domChanged),interaction:B([],O.events.interaction),keydown:B(["original"],O.events.keydown),keyup:B(["original"],O.events.keyup),keypress:B(["original"],O.events.keypress),mousedown:B(["original"],O.events.mousedown),mouseup:B(["original"],O.events.mouseup),contextmenu:B(["original"],O.events.contextmenu),copy:B(["original"],
O.events.copy),paste:B(["original"],O.events.paste),focus:B(["original"],O.events.focus),focusOut:B(["original"],O.events.focusOut),dblclick:B(["original"],O.events.dblclick),ready:B(["api"],O.events.ready),loaded:B([],O.events.loaded),background:x([]),foreground:x([]),scrollToCursor:x([]),scrollToElement:x(["element"]),toEditing:x([]),toReading:x([])});O.events.nodeChanged.bind(function(a){X.trigger.nodeChanged(a.node(),a.offset(),a.prev());aa()});var V=m.tap(function(){X.trigger.undoChanged()}),
aa=function(){V.instance()},ca=function(a){V.instance();var b=V.control.isBlocked();V.control.block();a=a();b||V.control.unblock();V.instance();return a},Z=function(){X.trigger.scrollToCursor()},ba=m.tap(function(){O.focus()});S=function(a){return function(){var b=arguments;J.parent(O.element()).fold(function(){a.apply(null,b)},function(c){var d=c.dom().scrollTop;a.apply(null,b);c.dom().scrollTop=d})}}(O.execCommand);var ia=function(a){return H.isText(a)&&(K.browser.isSafari()||0===L.get(a).length)||
H.isElement(a)&&!z.isEmptyTag(a)&&!z.isBlock(a)},ga=function(a){var b=F.fromText(d.zeroWidth());G.after(a,b);return b},fa=function(a,b){var c=J.children(a);if(b>=c.length)return l.point(a,b);var d=c[b];return H.isElement(d)&&!z.isEmptyTag(d)?fa(c[b],0):l.point(a,b)},Y={onCanvas:O.onCanvas,element:O.element,isInline:O.isInline,win:O.win,doc:O.doc,body:O.body,getContent:O.getContent,setContent:O.setContent,resetContent:O.resetContent,focus:function(){ba.instance()},blur:O.blur,uiChanged:O.uiChanged,
domChanged:O.domChanged,undoChanged:aa,clearSelection:O.clearSelection,getSelection:O.getSelection,getSelectionStart:function(){return O.getSelection().map(function(a){return a.startContainer()})},setSelection:O.setSelection,setRelativeSelection:O.setRelativeSelection,backupSelection:O.backupSelection,replaceSelection:O.replaceSelection,execCommand:S,insertHtmlAtCursor:function(b){var d=E.fromHtml(b);ca(function(){n.insertAtCursorWithInstructions(c.doNotMerge,Y,d).each(function(b){var c=b.element();
J.parent(c).each(function(b){b=ia(c)?ga(c):c;O.setRelativeSelection(a.after(b),a.after(b));O.getSelection().each(function(a){a=fa(a.startContainer(),a.startOffset());O.setSelection(a.element(),a.offset(),a.element(),a.offset())});N.input(d)})})})},on:O.on,destroy:function(){R.each(function(a){a.unbind()});O.destroy()},events:X.registry,state:function(){return{clean:O.getContent(),marked:T()}},serialize:T,deserialize:function(a){W(a,!0)},background:function(){O.background();X.trigger.background()},
foreground:function(){O.foreground();X.trigger.foreground()},isRoot:function(a){return O.body().fold(f.constant(!1),function(b){return C.eq(b,a)})},selectWord:function(){u.expand(O)},cursor:function(){return q(O)},activate:function(){ba.control.unblock()},deactivate:function(){ba.control.block()},cursorIntoView:Z,elementIntoView:function(a){X.trigger.scrollToElement(a)},placeholder:O.placeholder,connect:Q.connect,translateScreen:O.translateScreen,translateLocation:O.translateLocation,extract:O.extract,
runOrOnLoaded:function(a){O.body().fold(function(){O.events.ready.bind(function(b){a(b.api().body())})},function(b){a(b)})},getSelectedText:function(){return O.getSelection().bind(function(a){if(a.collapsed())return h.none();a=e.cloneFragment(O.win().getOrDie(),a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset());a=J.children(a);return h.some(p.toText(a))})},toEditing:function(){X.trigger.toEditing()},toReading:function(){X.trigger.toReading()},undoOperation:ca,markAsEphemeral:function(a){A.add(a,
s.markerGeneral())},hideInlineSelection:function(){O.isInline()&&(O.backupSelection(),O.clearSelection())}};return Y}});k("et",["7"],function(c){return{get:c.constant({onShortcut:function(c,b){c.bind(b)}})}});k("n4",["g0","33","1a"],function(c,d,b){var a="data-"+d.resolve("context-type");return{nu:function(d,g,f){d=c.item(d,f.value(),f.text());b.set(d,a,g);b.setAll(d,f.attrs());return d},type:function(c){return b.get(c,a)}}});k("n5","75 b 7v g0 k1 s n4 4b".split(" "),function(c,d,b,a,e,g,f,h){return{derive:function(l,
m,n){m=d.map(m,function(a){var e=n[a],m=e.primary(),s=e.submenus();return d.map(m,function(d){var e=f.nu(l,a,d),m=s.hasOwnProperty(d.value())&&void 0!==s[d.value()]?[c.resolve("menu-more")]:[],n=void 0!==s[d.value()];b.menuItem(e,g.some(d.text()),g.some(n));h.add(e,m);return e})});m=d.filter(m,function(a){return 0<a.length});return d.flatten(e.intersperseThunk(m,function(){return[a.separator(l)]}))}}});k("n6","b 7v g0 s n4 73 3c".split(" "),function(c,d,b,a,e,g,f){return{derive:function(h,l,m){return c.bind(l,
function(l){var p=m[l].secondary();return c.map(p,function(m){var p=b.submenu(h,m.value(),[]);d.menu(p,g.get(m.textkey()));m=c.map(m.items(),function(b){var c=e.nu(h,l,b);d.menuItem(c,a.some(b.text()),a.none());return c});f.append(p,m);return p})})}}});k("eu","b 1o 7v g0 6 s n4 n5 n6 73 33 4m 1y 3c 2q".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s){return function(t){var u=p({}),k=p([]),w={},x=g.none();return{structure:u.get,all:k.get,main:function(){return k.get()[0]},update:function(f){c.each(k.get(),
function(a){s.remove(a)});x=g.some(f);var p=d.keys(w);d.each(w,function(a){a.assign(x)});var z=d.tupleMap(w,function(a,b){return{k:b,v:a.situation(f)}}),A=h.derive(t,p,z),C=l.derive(t,p,z),p=c.foldr(p,function(a,b){return e.merge(a,z[b].submenus())},{});if(0===A.length)k.set([]);else{var D=a.mainmenu(t,n.resolve("main-context-menu"),[]);q.append(D,A);b.menu(D,m.translate("aria.context.menu.generic"));A=[D].concat(C);c.each(A,function(a){r.add(a,n.resolve("layer-menus"))});k.set(A);u.set(p)}},handle:function(a){var b=
f.type(a),b=w[b];void 0!==b&&b.handle(a)},register:function(a,b){w[a]=b}}}});k("n7",["k5"],function(c){return{mainmenu:function(d,b,a,e,g,f){return c.main(d,b,a,e,g,f)},submenu:function(d,b,a,e,g){return c.submenu(d,b,a,e,g)}}});k("ev","n7 7 n8 6x n9 na nb 3k l q".split(" "),function(c,d,b,a,e,g,f,h,l,m){return{makeshift:function(c,p,r,q,s,t,u,k,w){return{recalculate:d.noop,isAnchored:d.constant(!1),place:function(d){var p=c.doc().getOr(l.fromDom(m)),p=c.isInline()?h(r,q):g.translate(b.fixedOrigin(),
p,r,q),B=a(p.left(),p.top(),s,t),p=u.isRtl()?e.allRtl():e.all(),B=b.box(B);d=d.panel();f.fixed(B,d,k,p,void 0===w?{}:w)}}},mainmenu:function(a,b,d,e){return c.mainmenu(a.uiContainer,a.bounds,b,d,e)},submenu:function(a,b,d){return c.submenu(a.uiContainer,a.bounds,b,d)}}});k("7y","a5 a6 b er c 4z 7 s es et eu 79 ev aj ew 2u 3k 2n 3l 21 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,u,k,w,x,y){var B=t.immutable("target","x","y"),z=e.detect().browser,A=function(e,t,A,E,G,H){A=t.doc().getOrDie();
var I=n(A),L=u(0,0);A=m.get();var J=l.fromUnsafe(t),K=c.menuSystem(G.uiContainer,f.constant("context"),d.menu({focusActive:!0})),M=c.popup(K.sandbox,G.bounds,e,[],q.editorContainer());H=g.div();var N=M.initMenu(H),S=function(a){I.update(a.target());var b=T(),c=[K.sandbox()];if(0<b.all.length){var d=a.x(),e=a.y();L=u(d,e);N.setContent(b.main);R(N);N.open();K.open(c,b.main);return h.some(a)}return h.none()},Q=function(a){return t.getSelection().bind(function(a){return function(){return p.selectionContains(a).fold(function(){return x.isText(a.startContainer())?
y.parent(a.startContainer()):h.some(a.startContainer())},function(a){return h.some(a)})}().map(function(a){var b=w.viewport(a),b=t.translateScreen(b.left(),b.top());return B(a,b.left(),b.top())})})},P=function(a){var b;b=a.original();b=z.isIE()&&10>=z.version.major?u(b.raw().clientX,b.raw().clientY):u(b.x(),b.y());b=t.translateScreen(b.left(),b.top());return B(a.original().target(),b.left(),b.top())},R=function(a){var b;b=s(14,10);b=r.makeshift(t,G,L.left(),L.top(),0,0,e.uiDirection(),b);G.show(a,
b)},O=function(){N.close();var a=T();b.each(a.all,function(a){k.set(a,"display","none")});J.end()};N.events.close.bind(function(){K.close()});var T=function(){var a=I.all();return{all:a,main:a[0],submenus:a.slice(1)}};t.events.contextmenu.bind(function(a){var b=P(a);S(b).orThunk(function(){return Q().bind(S)}).each(function(b){a.original().raw().preventDefault()})});A.onShortcut(E.events.context,function(){Q().each(S)});K.events.open.bind(function(){var a=I.structure(),b=T();K.update(a);M.registerMenus(b.submenus);
R(N);K.setActiveMenu(b.main)});K.events.itemAction.bind(function(a){I.handle(a.item())});K.events.itemHover.bind(function(a){J.begin()});K.events.reveal.bind(function(b){a.expanded(b.trigger());M.expandMenu(b.menu(),b.trigger(),N);R(N)});K.events.collapse.bind(function(b){M.hideMenu(b.menu());b.item().each(a.collapsed)});K.events.itemAction.bind(O);K.events.escaped.bind(function(){O();t.focus()});t.events.mousedown.bind(O);return{register:I.register,destroy:function(){N.destroy();K.destroy()}}};return function(a,
c,d,e,g){var h=[],l={register:function(a,b){h=h.concat([{name:a,feature:b}])},destroy:f.noop};c.events.loaded.bind(function(f){l=A(a,c,d,e,g);b.each(h,function(a){l.register(a.name,a.feature)})});return{register:function(a,b){l.register(a,b)},destroy:function(){l.destroy()}}}});k("ex","c 7 s 1a l 2o 21 2q 2a 3t".split(" "),function(c,d,b,a,e,g,f,h,l,m){var n=c.detect().browser,p=function(a){var c=e.fromHtml("<p><br></p>");g.append(a,c);return b.some(c)},r=function(a){var c=l.children(a);return 0===
c.length?p(a):1===c.length&&"br"===f.name(c[0])?(h.empty(a),p(a)):b.none()},q=function(b){return 1===b.dom().childNodes.length?l.firstChild(b).fold(d.constant(!1),function(b){return"br"===f.name(b)&&a.has(b,"_moz_editor_bogus_node")}):!1},s=function(a){return r(a).orThunk(function(){var c;n.isFirefox()&&q(a)?(h.empty(a),c=p(a)):c=b.none();return c})};return{listen:function(a){a.events.nodeChanged.bind(function(b){b=b.node();a.isRoot(b)&&s(b).each(function(b){a.setSelection(b,0,b,0)})})}}});k("ey",
[],function(){return function(){var c=!0;return{isHandled:function(){return c},handle:function(){c=!1}}}});k("85",["7","7e","2a"],function(c,d,b){return{onNodeChange:function(a,b){a.events.nodeChanged.bind(function(c){c.prev().each(function(c){d.withinTransient(c,c).each(function(c){b.atomic(function(){d.cleanup(a.isRoot,c)})})})});return{destroy:c.noop}},onLinebreak:function(a){a.getSelection().each(function(c){b.parent(c.startContainer()).each(function(b){d.coalesce(b);a.setSelection(c.startContainer(),
c.startOffset(),c.endContainer(),c.endOffset())})})}}});k("a1",["b","a8","7"],function(c,d,b){var a=function(a,b){var d=b.original(),d=d.raw().which||d.raw().keycode;return c.contains(a,d)},e=b.curry(a,d.ENTER()),g=b.curry(a,d.SPACE()),f=b.curry(a,d.BACKSPACE()),h=b.curry(a,d.DEL()),l=b.curry(a,d.LEFT().concat(d.UP())),m=b.curry(a,d.RIGHT().concat(d.DOWN())),n=b.curry(a,d.TAB());d=b.curry(a,d.ESCAPE());return{isEnter:e,isSpace:g,isBackspace:f,isDel:h,isTab:n,isLeftOrUp:l,isRightOrDown:m,isEscape:d}});
k("ez",["nc","nd","ne"],function(c,d,b){var a=function(a,b,c,h){return d.isCollapsed(a)?b(a.startContainer(),a.startOffset(),h):c(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset(),h)};return{soft:function(d,g){return a(d,c.soft,b.soft,g)},hard:function(d,g){return a(d,c.hard,b.hard,g)}}});k("7z","7 ex ey 85 a1 54 46 ez".split(" "),function(c,d,b,a,e,g,f,h){return function(l,m){var n=f.create({preLinebreak:g(["handler"]),postLinebreak:g([])});d.listen(l);var p=function(c){m.save();
l.getSelection().each(function(d){var e=b();n.trigger.preLinebreak(e);l.getSelection().each(function(b){e.isHandled()&&(c?h.soft:h.hard)(b,l.isRoot).each(function(b){l.setRelativeSelection(b.start(),b.finish());a.onLinebreak(l);l.domChanged();l.cursorIntoView()});n.trigger.postLinebreak()})})};l.events.keydown.bind(function(a){e.isEnter(a)&&(a.original().raw().preventDefault(),p(a.original().raw().shiftKey))});return{linebreak:p,destroy:c.noop,events:n.registry}}});k("f0",["4e"],function(c){return function(d,
b){return{find:function(a){return c.descendants(a,d)},cleaner:b}}});k("h6",["b","l","2f"],function(c,d,b){var a=function(a,b){c.each(b,function(b){var c=b.find(a);b.cleaner(c,a)})};return{filterHtml:function(c,g){var f=d.fromTag("div");f.dom().innerHTML=c;a(f,g);return b.get(f)},filterDom:a}});k("nf",[],function(){return function(){var c=[];return{add:function(d){c.push(d)},get:function(){return c.slice(0)}}}});k("f1",["s","h6","nf"],function(c,d,b){return function(){var a={},e=function(b){return c.from(a[b])};
return{get:e,getOrInit:function(c){var d=a[c];void 0===d&&(a[c]=b(),d=a[c]);return d},filterDom:function(a,b){e(a).each(function(a){d.filterDom(b,a.get())})},filterHtml:function(a,b){return e(a).fold(function(){return b},function(a){return d.filterHtml(b,a.get())})}}}});k("f2",["6h"],function(c){return function(d,b){return{find:function(a){return c.descendants(a,d)},cleaner:b}}});k("80",["7","6p","f0","f1","f2"],function(c,d,b,a,e){return function(g){var f=a(),h=c.constant("internal"),l=c.constant("output"),
m=c.constant("input"),n=c.constant("history"),p=c.constant("paste"),r=function(a,c,d){a=f.getOrInit(a);c=b(c,d);a.add(c)},q=function(a,b,c){a=f.getOrInit(a);b=e(b,c);a.add(b)};g=d(g,r,q);return{add:function(a,b,c){r(a,"."+b,c)},addSelector:r,addPredicate:q,filterHtml:f.filterHtml,filterDom:f.filterDom,internal:h,output:l,input:m,paste:p,history:n,customFilters:c.constant(g),state:g.state,destroy:c.noop}}});k("81","7 73 6t 74 54 46".split(" "),function(c,d,b,a,e,g){return function(f,h,l){var m=!1,
n=g.create({maximize:e(["layout"]),restore:e(["layout"]),analytics:e(["message"]),select:e([]),deselect:e([])}),p=function(){n.trigger.maximize(l.alternate)},r=function(){n.trigger.restore(l.alternate)},q=function(a){m?a.select():a.deselect()},s=function(){n.trigger.analytics("fullscreen_"+(m?"off":"on"));f.focus();(m?r:p)()},t=function(b,c){var e=d.key(m?"action.toggle.fullscreen":"action.fullscreen");return a.get(e,c)};h.events.fullscreen.bind(s);h=b.ui({"fullscreen.general":function(){return{toggle:!0,
value:"fullscreen",textkey:d.key("action.fullscreen"),tooltip:t,action:s,updateGeneral:q,icon:!0,shortcut:!0,selected:m}}},c.identity);var u=b.actions({maximize:p,restore:r});return{ui:h,actions:u,select:function(){m=!0},deselect:function(){m=!1},destroy:c.noop,events:n.registry}}});k("ve",["5b","b","s","2u","68"],function(c,d,b,a,e){var g=a.immutable("ch","offset"),f=function(a,b){return g(a.charAt(b),b)};return{previous:function(a,d){for(var e=d.getOr(a.length)-1;0<=e;e--)if(a.charAt(e)!==c.zeroWidth())return b.some(f(a,
e));return b.none()},next:function(a,d){for(var e=d.getOr(0)+1;e<a.length;e++)if(a.charAt(e)!==c.zeroWidth())return b.some(f(a,e));return b.none()},rfind:function(a,c){c.lastIndex=-1;var e=d.reverse(a).join(""),f=e.match(c);return void 0!==f&&null!==f&&0<=f.index?b.some(e.length-1-f.index):b.none()},lfind:function(a,c){c.lastIndex=-1;var d=a.match(c);return void 0!==d&&null!==d&&0<=d.index?b.some(d.index):b.none()}}});k("vf","7 s eg lm i7 no ln 4n".split(" "),function(c,d,b,a,e,g,f,h){var l=e.walkers().left(),
m=e.walkers().right(),n=h.generate([{abort:[]},{kontinue:[]},{finish:["info"]}]),p=h.generate([{aborted:[]},{edge:["element"]},{success:["info"]}]),r=function(a,b){return f.isEmptyTag(a,b)||a.property().isBoundary(b)},q=function(a,b,c,f,g,h,l){var m=function(){return l.fold(p.aborted,p.edge)},s=function(f){return e.walk(a,b,c,h).fold(m,function(b){return q(a,b.item(),b.mode(),d.none(),g,h,f)})};if(r(a,b))return m();if(a.property().isText(b)){var t=a.property().getText(b);return g(a,n,b,t,f).fold(m,
function(){return s(d.some(b))},p.success)}return s(l)},s=function(c,e,f,h){f=a.toLeaf(c,e,f);return c.property().isText(e)?d.none():g.left(c,f.element(),c.property().isText,h).map(function(a){return b.point(a,c.property().getText(a).length)})},t=function(c,e,f,h){f=a.toLeaf(c,e,f);return c.property().isText(e)?d.none():g.right(c,f.element(),c.property().isText,h).map(function(a){return b.point(a,0)})},u=function(a,d,e){var f=c.curry(r,a);return s(a,d,e,f).orThunk(function(){return t(a,d,e,f)}).getOr(b.point(d,
e))};return{repeatLeft:function(a,b,c,f){b=u(a,b,c);return q(a,b.element(),e.sidestep,d.some(b.offset()),f,l,d.none())},repeatRight:function(a,b,c,f){b=u(a,b,c);return q(a,b.element(),e.sidestep,d.some(b.offset()),f,m,d.none())}}});k("ng","7 s eg i7 ve vf 52".split(" "),function(c,d,b,a,e,g,f){var h=f.exactly(["regex","attempt"]),l=function(a,b,c,d){return g.repeatLeft(a,b,c,d)},m=function(a,b,c,d){return g.repeatRight(a,b,c,d)},n=function(e,f,g){var h=c.constant(!1);if(!e.property().isText(f))return d.none();
var l=e.property().getText(f);return g<=l.length?d.some(b.point(f,g)):a.seekRight(e,f,e.property().isText,h).bind(function(a){return n(e,a,g-l.length)})};return{previousChar:function(a,b){return e.previous(a,b)},nextChar:function(a,b){return e.next(a,b)},repeatLeft:l,repeatRight:m,expandLeft:function(a,b,c,d){var f=h(d);return l(a,b,c,function(a,b,c,d,g){a=g.getOr(d.length);return e.rfind(d.substring(0,a),f.regex()).fold(function(){return b.kontinue()},function(a){return f.attempt(b,c,d,a)})})},expandRight:function(a,
b,c,d){var f=h(d);return m(a,b,c,function(a,b,c,d,g){var h=g.getOr(0);return e.lfind(d.substring(h),f.regex()).fold(function(){return b.kontinue()},function(a){return f.attempt(b,c,d,h+a)})})},scanRight:n}});k("i8",["dy","ng"],function(c,d){var b=c();return{previousChar:function(a,b){return d.previousChar(a,b)},nextChar:function(a,b){return d.nextChar(a,b)},repeatLeft:function(a,c,g){return d.repeatLeft(b,a,c,g)},repeatRight:function(a,c,g){return d.repeatRight(b,a,c,g)},expandLeft:function(a,c,g){return d.expandLeft(b,
a,c,g)},expandRight:function(a,c,g){return d.expandRight(b,a,c,g)},scanRight:function(a,c){return d.scanRight(b,a,c)}}});k("f3","7s 7 s eg ip 6j i8 2u 1b 21 2a 68".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p){var r=h.immutable("before","after"),q=function(a,b,c,d,e){return y(c).fold(function(){var c=C(a,b,d);return r(c,e)},function(f){var g=D(c,f);return g.length>a?r(d,e):B(b).fold(function(){var b=A(a-g.length,f,e+g);return r(d,b)},function(c){var h=D(c,b);return h.length>a-g.length?r(d,e+g):q(a-
g.length-h.length,c,f,h+d,e+g)})})};h=function(b,c,d,e){return b.finish(a.point(c,e))};var s={regex:function(){return new p(g.wordchar(),"i")},attempt:h},t={regex:function(){return new p(g.wordbreak(),"i")},attempt:h},u=function(a,b){return a.offset()===b.offset()&&l.eq(a.element(),b.element())},k=function(b){return a.point(b,m.value(b).length)},w=function(b){return a.point(b,0)},x=function(a,c,d){var e=function(c){c=d(c);return u(a,c)?b.none():b.some(c)};return c(a.element(),a.offset(),s).fold(b.none,
e,function(a){return c(a.element(),a.offset(),t).fold(b.none,e,function(a){return b.some(a)})})},y=function(a){return x(a,f.expandRight,k)},B=function(a){return x(a,f.expandLeft,w)},z=function(a,b,c,e,f,g){return a(c).fold(d.constant(e),function(d){var h=f(c,d);return h.length+e.length>b||0===h.length?e:z(a,b,d,g(e,h),f,g)})},A=function(a,b,c){return z(y,a,b,c,D,function(a,b){return a+b})},C=function(a,b,c){return z(B,a,b,c,function(a,b){return D(b,a)},function(a,b){return b+a})},D=function(a,b){var d=
n.defaultView(a.element()).dom();return c.stringAt(d,a.element(),a.offset(),b.element(),b.offset())};return{beforeAfter:r,anchorText:function(a,b){var c=e.freefallLtr(b);return y(c).map(function(b){var d=D(c,b);return d+A(a-d.length,b,"")}).getOr("")},flankingText:function(a,b){if(0===a)return r("","");var c=e.freefallLtr(b),d=e.freefallRtl(b);return q(a,c,d,"","")},extendRightAndLeft:q,extendWordsSearch:z,extendWordsRight:A,extendWordsLeft:C,wordSearch:x,wordLeft:B,wordRight:y,pointEq:u,boundaryPointRight:k,
boundaryPointLeft:w,textBetweenPoints:D,wordSeeker:s,wordBreakSeeker:t}});k("9p","b s f3 79 ep 2u 1a 1b l 3c f4 31 m 9q 2a 1s".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t){var u=function(a,b){try{return a()}catch(c){if(12===c.code)return b();throw c;}},k=function(a){return p.closest(a,"a[href]")},w=function(a,b){return k(a).bind(function(a){return k(b).filter(function(b){return h.eq(a,b)})})},x=g.immutable("element","innerText","before","after"),y=function(a){return r.is(a,"a[href]")?[a]:
r.all("a[href]",a)};return{contentLink:function(b){return b.getSelection().bind(function(c){return a.detect(b).fold(function(){return w(c.startContainer(),c.endContainer())},function(a){return d.some(a.image()).bind(k)})})},sharedLink:w,findLinkTargets:function(a){return r.all("h1,h2,h3,h4,h5,h6,div[id],p[id],span[id],a[id],a[name]",a)},linkTargetText:function(a,c){var d=q.get(c).length,f=n.deep(c),d=b.anchorText(d,f);if(e.isBlock(c))return x(c,d,"","");f=b.flankingText(t.max(0,a-d.length),c);return x(c,
d,f.before(),f.after())},linkTargetFastText:function(a,b){var c=q.get(b),c=50<c.length?c.substr(0,50):c;return x(b,c,"","")},all:y,many:function(a){return c.bind(a,y)},hrefUrl:function(a,b){return u(function(){return r.all('a[href="'+b+'"]',a)},function(){var d=y(a);return c.filter(d,function(a){return f.get(a,"href")===b})})},anchorTarget:function(a,b){return u(function(){return r.one("#"+b+',a[name="'+b+'"]',a)},function(){var e=s.owner(a).dom();return d.from(e.getElementById(b)).map(l.fromDom).orThunk(function(){var e=
r.all("[name]",a);return d.from(c.find(e,function(a){return f.get(a,"id")===b||f.get(a,"name")===b}))})})}}});k("82","b 7 s 9p 54 46 n".split(" "),function(c,d,b,a,e,g,f){return function(){var h={inputLinks:"insertLink"},l=g.create({internal:e(["command","data"])}),m=function(a,d){b.from(h[a]).fold(function(){throw new f("invalid internal event:",a);},function(a){c.each(d,function(b){l.trigger.internal(a,b)})})};return{input:function(b){b=a.many(b);m("inputLinks",b)},destroy:d.noop,events:l.registry}}});
k("f5",["nh","3u","q"],function(c,d,b){return function(a,b){var g=c(),f=d.bind(b,"keydown",g.keydown),h=d.bind(b,"keypress",g.keypress),l=function(a){g.keydown(a.original())},m=function(a){g.keypress(a.original())};a.events.keydown.bind(l);a.events.keypress.bind(m);return{off:g.off,on:g.on,swallowShortcuts:g.swallowShortcuts,yieldShortcuts:g.yieldShortcuts,swallowChars:g.swallowChars,yieldChars:g.yieldChars,swallowKeys:g.swallowKeys,yieldKeys:g.yieldKeys,destroy:function(){f.unbind();h.unbind();a.events.keydown.unbind(l);
a.events.keypress.unbind(m)},events:g.events}}});k("f6",["nh"],function(c){return function(d){var b=c(),a=function(a){b.keydown(a.original())},e=function(a){b.keypress(a.original())};d.events.keydown.bind(a);d.events.keypress.bind(e);return{off:b.off,on:b.on,swallowShortcuts:b.swallowShortcuts,yieldShortcuts:b.yieldShortcuts,swallowChars:b.swallowChars,yieldChars:b.yieldChars,swallowKeys:b.swallowKeys,yieldKeys:b.yieldKeys,events:b.events,destroy:function(){d.events.keydown.unbind(a);d.events.keypress.unbind(e)}}}});
k("f7",["nh","3u"],function(c,d){return function(b){var a=c(),e=d.bind(b,"keydown",a.keydown),g=d.bind(b,"keypress",a.keypress);return{off:a.off,on:a.on,swallowShortcuts:a.swallowShortcuts,yieldShortcuts:a.yieldShortcuts,swallowChars:a.swallowChars,yieldChars:a.yieldChars,swallowKeys:a.swallowKeys,yieldKeys:a.yieldKeys,destroy:function(){e.unbind();g.unbind()},events:a.events}}});k("83",["7","f5","f6","f7"],function(c,d,b,a){return function(e,g){return{all:function(){return d(e,g.element())},container:function(b){return a(b)},
editor:function(){return b(e)},destroy:c.noop}}});k("f9",["j9","eg","i8","21"],function(c,d,b,a){var e=function(c,e){var h=d.point(c,e);return a.isText(c)?b.scanRight(c,e).getOr(h):h};return{handle:function(a){var b=e(a.startContainer(),a.startOffset());a=e(a.endContainer(),a.endOffset());return c(b.element(),b.offset(),a.element(),a.offset())}}});k("12k",["d6","4n","21","2a"],function(c,d,b,a){var e=d.generate([{onText:["element","offset"]},{firstText:["parent","child","offset"]},{beforeText:["parent",
"child","offset"]},{afterText:["parent","child"," offset"]},{lastText:["parent","child","offset"]},{onElement:["element","offset"]}]);return{detect:function(d,f){if(b.isText(d))return e.onText(d,f);var h=a.children(d);return 0===h.length?e.onElement(d,f):0===f&&b.isText(h[0])?(0,e.firstText)(d,h[0],0):f===h.length&&b.isText(h[h.length-1])?(h=h[f-1],(0,e.lastText)(d,h,c.getEnd(h))):f<h.length&&b.isText(h[f])?(0,e.beforeText)(d,h[f],0):0<f&&b.isText(h[f-1])?(h=h[f],(0,e.afterText)(d,h,c.getEnd(h))):
e.onElement(d,f)},cata:function(a,b,c,d,e,n,p){return a.fold(b,c,d,e,n,p)}}});k("14j",["7","s"],function(c,d){return function(b){return{backup:c.identity,restore:c.constant(d.none()),element:c.constant(b)}}});k("14k",["2u"],function(c){return c.immutable("startContainer","startOffset","endContainer","endOffset")});k("12o",["4g"],function(c){return{resolve:c.create("ephox-newt").resolve}});k("zo",["12o","1y","2n","l"],function(c,d,b,a){var e=c.resolve("cursor-marker");return{generator:function(c){var f=
null;return{getOrInit:function(){var h;null===f?(h=a.fromTag("span",c.dom()),d.add(h,e),b.set(h,"display","none")):h=f;return f=h}}},isCursor:function(a){return d.has(a,e)}}});k("12l","b 14j 14k zo 7 s 1b 2o 2q 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m){var n=function(a,c){return{element:e.constant(c),backup:e.identity,restore:function(){var c=b(a,0,a,0);return g.some(c)}}},p=function(b){b=m.children(b);return c.filter(b,e.not(a.isCursor))},r=function(a,c){return{element:e.constant(c),backup:e.identity,
restore:function(){var c=p(a).length,c=b(a,c,a,c);return g.some(c)}}},q=function(a){return m.parent(a).bind(function(d){var e=p(d),e=c.findIndex(e,function(b){return f.eq(a,b)});return-1<e?g.some(b(d,e,d,e)):g.none()})},s=function(a,c){return{backup:function(){h.before(a,c)},restore:function(){var a=m.nextSibling(c);l.remove(c);return a.map(function(a){return q(a).getOrThunk(function(){return b(a,0,a,0)})})},element:e.constant(c)}};return{place:function(a,b,c){var e=m.children(a);return 0===e.length?
n(a,c):e.length===b?r(a,c):0===b?n(a,c):b>e.length?d(c):s(e[b],c)}}});k("12m",["14k","zo","7","s"],function(c,d,b,a){var e=function(a,b){return b().fold(function(){return d.generator(a).getOrInit()},function(a){return a.element()})},g=function(b){b=b();b.backup();return a.some(b)},f=function(a,b){var d=a.or(b),e=b.or(a);return d.bind(function(a){return e.map(function(b){return c(a.startContainer(),a.startOffset(),b.startContainer(),b.startOffset())})})};return{ltr:function(c,d,m){var n=a.none(),p=
a.none();return{backup:function(){p=g(d);n=g(m)},restore:function(){return n.bind(function(a){return p.bind(function(b){var c=a.restore();b=b.restore();return f(c,b)})})},element:b.curry(e,c,function(){return p})}},rtl:function(c,d,m){var n=a.none(),p=a.none();return{backup:function(){n=g(m);p=g(d)},restore:function(){return p.bind(function(a){return n.bind(function(b){var c=a.restore();b=b.restore();return f(b,c)})})},element:b.curry(e,c,function(){return n})}}}});k("12n","14j 14k d6 7 iw h2 2o 2q".split(" "),
function(c,d,b,a,e,g,f,h){var l=function(b,c,g){return{backup:function(){f.before(c,g)},restore:function(){var a=e.after(g,b).map(function(a){return d(a,0,a,0)});h.remove(g);return a},element:a.constant(g)}},m=function(c,g,l){return{backup:function(){f.after(g,l)},restore:function(){var a=e.before(l,c).map(function(a){var c=b.getEnd(a);return d(a,c,a,c)});h.remove(l);return a},element:a.constant(l)}};return{place:function(a,b,d,e){b=g.split(b,d);return g.position(b).fold(function(){return c(e)},function(b){return l(a,
b,e)},function(b,c){return m(a,b,e)},function(b){return m(a,b,e)})}}});k("pd",["2u"],function(c){return c.immutable("result","cursor")});k("zn","12k 12l 12m 12n pd zo lf 2a".split(" "),function(c,d,b,a,e,g,f,h){var l=function(b,e,f){var g=function(c,d,e){return a.place(b,d,e,f)};return c.cata(e,function(c,d){return a.place(b,c,d,f)},g,g,g,g,function(a,b){return d.place(a,b,f)})},m=function(a,b,d,e){e=e.getOrInit();b=c.detect(b,d);return l(a,b,e)},n=function(a,b){a.backup();var c=b(a.element());return e(c,
a.restore())};return{inspect:m,runOnRange:function(a,c,d,e,l,k){var v=h.owner(c),w=(f.after(c,d,e,l)?b.rtl:b.ltr)(v,function(){return m(a,e,l,g.generator(v))},function(){return m(a,c,d,g.generator(v))});return n(w,k)},runOnCursor:n}});k("vl",["zn","zo","1b","2a"],function(c,d,b,a){var e=function(a,b,d,e,g,p){return c.runOnRange(a,b,g>d?d:g,b,g>d?g:d,p)},g=c.runOnRange;return{point:function(b,e,g,m){var n=a.owner(e),n=d.generator(n);b=c.inspect(b,e,g,n);return c.runOnCursor(b,m)},range:function(a,
c,d){return(b.eq(c.startContainer(),c.endContainer())?e:g)(a,c.startContainer(),c.startOffset(),c.endContainer(),c.endOffset(),d)}}});k("ni","vl pd s 2m 1y 2y 2a".split(" "),function(c,d,b,a,e,g,f){var h=function(a,c){return function(a,e){var f=e(c);return d(f,b.none())}},l=function(a,b){return function(d,e){return c.point(a,b.startContainer(),b.startOffset(),n(d,e))}},m=function(a,b){return function(d,e){return c.range(a,b,n(d,e))}},n=function(a,b){return function(c){e.add(c,a);return b(c)}};return{diagnose:function(b,
c){var d=c.startContainer(),e=c.endContainer(),n=f.owner(d);return a.inBody(d)&&a.inBody(e)&&g.active(n).forall(a.inBody)?c.collapsed()?l(b,c):m(b,c):h(b,c.startContainer())}}});k("fa",["7","ni","33","ca","2m"],function(c,d,b,a,e){return function(g,f){var h=b.resolve("ops-eph-cursor");g.add(g.internal(),h,a.remove);g.add(g.output(),h,a.remove);var l=function(a){var b=function(b){b=d.diagnose(f.isRoot,b)(h,a);b.cursor().each(function(a){e.inBody(a.startContainer())&&e.inBody(a.endContainer())&&f.getSelection().each(function(b){f.setSelection(a.startContainer(),
a.startOffset(),a.endContainer(),a.endOffset())})});return b.result()};return function(){return f.getSelection().fold(a,b)}};return{destroy:c.noop,run:function(a){return l(a)()}}}});k("84",["f8","f9","fa","1b","21"],function(c,d,b,a,e){return function(g,f){var h=b(g,f),l=function(b,c){return!a.eq(b.startContainer(),c.startContainer())||!a.eq(b.endContainer(),c.endContainer())||b.startOffset()!==c.startOffset()||b.endOffset()!==c.endOffset()},m=function(a,b){var c=a(),e=d.handle(b);f.getSelection().forall(function(a){return l(a,
e)})&&f.setSelection(e.startContainer(),e.startOffset(),e.endContainer(),e.endOffset());return c};return{destroy:function(){},run:h.run,preserve:function(a){f.getSelection().each(function(b){var d=c.descend(b.startContainer(),b.startOffset());b=c.descend(b.endContainer(),b.endOffset());a(d.element(),b.element());f.setSelection(d.element(),d.offset(),b.element(),b.offset())})},lightweightWith:function(a,b){return e.isText(b.startContainer())&&e.isText(b.endContainer())?m(a,b):h.run(a)},preserveOffset:m,
preserveAndRestore:function(a){var b=f.getSelection();a=a();var c=f.getSelection();b.each(function(a){c.each(function(b){l(a,b)&&f.setSelection(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset())})});return a},adapt:function(a){f.getSelection().each(function(b){h.run(function(){a(b.startContainer(),b.endContainer())})})},pure:function(a){f.getSelection().each(function(b){a(b.startContainer(),b.endContainer())})},atomic:function(a){return h.run(a)}}}});k("nj",["7","73","6t","54","46"],
function(c,d,b,a,e){return function(){var g=e.create({back:a([]),abort:a([])});return{ui:b.ui({"back.general":{toggle:!1,value:"mobile-back",textkey:d.key("toolbar.backbutton"),action:function(){g.trigger.back()},updateGeneral:c.noop,icon:!0,label:!0}}),events:g.registry,destroy:c.noop}}});k("zp",["7","p"],function(c,d){return function(b,a){return d.error({small:c.constant(b),big:c.constant(a)})}});k("zq",["b","p"],function(c,d){return{fold:function(b,a){return c.foldr(b,function(b,c){return b.bind(function(b){return a(c).map(function(a){return[a].concat(b)})})},
d.value([]))}}});k("zr",["a","1o","zp","zq","p"],function(c,d,b,a,e){var g=function(a,c){var f=c.groups(),g=f[a];return void 0===g?b("Unknown group: "+a,["No binding for group: "+a+". Known groups: "+d.keys(f)]):e.value(g)},f=function(a,b){var d=c.isArray(a)?{label:"",items:a}:a;return e.value(d)},h=function(b,c,d,e,f){return a.fold(c,function(a){return f.item(a,d,e,f)}).map(function(a){return{category:b,items:a}})};return{build:function(a,b,d,e){return(c.isString(a)?g:f)(a,b).bind(function(a){return h(a.label,
a.items,b,d,e)})}}});k("zs",["a","1o","zp","p"],function(c,d,b,a){var e=function(c,e,f,g){e=e.commands();f=e[c];return void 0===f?b("Unknown command: "+c,["No binding for command: "+c+". Known commands: "+d.keys(e)]):a.value(f)},g=function(a,b,c,d){return(void 0===a.items?f:d.menu)(a,b,c,d)},f=function(a,c,d,e){return void 0===d?b("You need a custom action factory to use this",[]):d(a)};return{build:function(a,b,d,f){return(c.isString(a)?e:g)(a,b,d,f)}}});k("vv",["2i"],function(c){return{parse:function(d){return c.getOrDie("JSON").parse(d)},
stringify:function(d,b,a){return c.getOrDie("JSON").stringify(d,b,a)}}});k("zt","a b zp zq p vv".split(" "),function(c,d,b,a,e,g){var f=function(a){return d.forall(a,c.isArray)?e.value(a):d.exists(a,c.isArray)?b("Menu items must be a single array or an array where every element is an array",["Menu items must be a single array or an array where every element is an array.","Contents of menu: "+g.stringify(a)]):e.value([a])};return{build:function(c,d,e,n){if(void 0===c.label||void 0===c.items||0===c.items.length)return b("Invalid toolbar configuration for menu",
["Invalid menu. Must be an object containing label and items.","Contents of menu: "+g.stringify(c)]);var p=c.menuLabel?c.menuLabel:c.label;return f(c.items).bind(function(b){return a.fold(b,function(a){return n.group(a,d,e,n)})}).map(function(a){return{name:c.id,textkey:c.label,menuTextkey:p,type:"submenu",contentFocus:!1,enabled:!0,icon:c.icon,commands:a}})}}});k("vm","a b 1o zp zq zr zs zt p vv".split(" "),function(c,d,b,a,e,g,f,h,l,m){var n=b.map({group:g.build,item:f.build,menu:h.build},function(a,
b){return function(){if(4!==arguments.length)throw"Incorrect usage of builder ["+b+"]. Only given: "+arguments.length;return a.apply(null,arguments)}}),p=function(b){if(void 0===b.items)return a("Invalid group, no items specified",["Invalid group, no items specified: "+b.label]);var e=b.items;return c.isArray(e)?(b=d.bind(e,function(a,b){return c.isString(a)||c.isArray(a)||void 0!==a.label&&c.isArray(a.items)?[]:["Invalid group at index: "+b+". Must be either a string, an array or an object containing label and items. Was: "+
m.stringify(a)]}),0===b.length?l.value(e):a("Invalid toolbar configuration for groups",b)):a("Invalid toolbar, items is not an array",["Invalid toolbar, items is not an array: "+m.stringify(b)])};return{build:function(a,b,c){return p(a).bind(function(a){return e.fold(a,function(a){return n.group(a,b,c,n)})})}}});k("vq",["b","7","i4"],function(c,d,b){var a=function(){return b.isSmallTouch()},e=function(a,b){return{feature:a.feature,command:a.command,type:"pre_flatmenu",items:b}};return{shouldFlatten:a,
never:d.constant("never_flatten"),streamline:function(a){var b=function(a){return c.bind(a,function(a){return"never_flatten"===a.flatten?[a]:"submenu"===a.type?c.bind(a.commands,function(a){return b(a.items)}):"pre_flatmenu"===a.type?c.map(a.items,function(b){return{feature:a.feature,type:"general",command:b}}):[a]})};return c.map(a,function(a){var c=b(a.items);return{category:a.category,items:c}})},setup:function(c,f){var h=e(c,f);return b.choice([{predicate:a,value:d.constant(h)}],c)},make:e}});
k("vn",["7","s","73","vq","i4"],function(c,d,b,a,e){var g=function(a,b){return{predicate:a,value:c.constant(b)}};return function(c,h,l,m,n){var p=function(a,b){return a()?b:{feature:d.none()}};l=p(function(){return!c&&e.isLargeDesktop()},{feature:l.ui(),command:"fullscreen",type:"general",unsupported:"Fullscreen is not supported in inline mode"});n=e.choice([g(e.isLargeDesktop,{feature:m.fileupload().ui(),command:"fileupload",type:"general"}),g(e.isLargeTouch,{feature:m.fileupload().ui(),command:"fileupload",
type:"menu"})],a.make({feature:m.fileupload().ui(),command:"fileupload"},n.allowLocalImages?["camera"]:[]));var r=p(e.isLargeDesktop,{feature:m.accessibility().ui(),command:"a11ycheck",type:"general"}),p=p(e.isLarge,{feature:m.specialchar().ui(),command:"specialchar",type:"general"}),q=e.choice([g(e.isLarge,{feature:m.blocktag().ui(),command:"bullist",type:"split-widget"})],{feature:m.blocktag().ui(),command:"bullist",type:"general"}),s=e.choice([g(e.isLarge,{feature:m.blocktag().ui(),command:"numlist",
type:"split-widget"})],{feature:m.blocktag().ui(),command:"numlist",type:"general"}),t={feature:m.formatting().ui(),command:"superscript",type:"general"},k={feature:m.formatting().ui(),command:"subscript",type:"general"},v={feature:m.formatting().ui(),command:"strikethrough",type:"general"},w={feature:m.font().ui(),command:"fontface",type:"dropdown"},x=e.choice([g(e.isTouch,{feature:m.font().ui(),command:"fontsize",type:"general"})],{feature:m.font().ui(),command:"fontsize",type:"inline-widget"}),
y={feature:m.font().ui(),command:"fontcolor",type:"widget"},B={feature:m.spelling().hasAutocorrect()?m.macros().ui():d.none(),command:"autocorrect",type:"general"},z={feature:m.spelling().ui(),command:"spelling",type:m.spelling().hasDropdown()?"dropdown":"general"},A={feature:m.macros().ui(),command:"capitalisation",type:"general"},C={feature:m.help().ui(),command:"help",type:"general"},D={feature:m.wordcount().ui(),command:"wordcount",type:"general"};return{link:{feature:m.link().ui(),command:"link",
type:"general"},wordcount:D,media:{feature:m.media().ui(),command:"media",type:"general"},hr:{feature:m.horizontalrule().ui(),command:"horizontalrule",type:"general"},specialchar:p,fileupload:n,table:{feature:m.table().ui(),command:"table",type:"widget"},undo:{feature:h.ui(),command:"undo",type:"general"},redo:{feature:h.ui(),command:"redo",type:"general"},styles:{feature:m.blocktag().ui(),command:"blocktag",type:"dropdown"},language:{feature:m.parlance().ui(),command:"parlance",type:"dropdown"},
ltrdir:{feature:m.directionality().ui(),command:"ltrdir",type:"general"},rtldir:{feature:m.directionality().ui(),command:"rtldir",type:"general"},bold:{feature:m.formatting().ui(),command:"bold",type:"general"},italic:{feature:m.formatting().ui(),command:"italic",type:"general"},underline:{feature:m.formatting().ui(),command:"underline",type:"general"},strikethrough:v,superscript:t,subscript:k,ul:q,ol:s,removeformat:{feature:m.formatting().ui(),command:"removeformat",type:"general"},alignment:{feature:m.alignindent().ui(),
command:"alignment",type:"dropdown"},outdent:{feature:m.alignindent().ui(),command:"outdent",type:"general"},indent:{feature:m.alignindent().ui(),command:"indent",type:"general"},blockquote:{feature:m.alignindent().ui(),command:"blockquote",type:"general"},"font-menu":{name:"font",textkey:b.key("font.menu-button"),menuTextkey:b.key("font.menu"),type:"submenu",contentFocus:!0,commands:[{category:"Font-menu",items:[w,x,y,t,k,v]}]},"font-face":w,"font-size":x,"font-color":y,fullscreen:l,find:{feature:m.findreplace().ui(),
command:"find",type:"general"},accessibility:r,usersettings:{name:"usersettings",textkey:b.key("cog.menu-button"),menuTextkey:b.key("cog.menu"),type:"submenu",flatten:a.never(),contentFocus:!0,commands:[{category:"a",items:[D]},{category:"b",items:[z,B,A]},{caetgory:"",items:[C]}]}}}});k("vo","a 1o zp vv 7 s p k2 73".split(" "),function(c,d,b,a,e,g,f,h,l){return function(){return{make:function(m){var n=function(c){return b(l.translate("errors.toolbar.missing.custom.string",c),['The required property "'+
c+'" for a custom command must be a string. It was: '+a.stringify(m[c]),"Properties specified in custom command: "+d.keys(m).join(", "),"Definition specified for custom command: "+a.stringify(m)])};if(!c.isString(m.id))return n("id");if(!c.isString(m.text))return n("text");n={};n[m.id]=e.constant({general:function(){return{toggle:!1,value:h.cssSanitise(m.id),textkey:l.raw(m.text),action:m.action,updateGeneral:e.identity,icon:void 0!==m.icon?m.icon:!1}}});return f.value({feature:g.some(n),command:m.id,
type:"general"})}}}});k("vp",["73"],function(c){return function(){var d={id:"insert",label:c.key("insert.menu-button"),menuLabel:c.key("insert.menu"),items:[["link","fileupload","media","table"],["specialchar","hr"]]};return{undo:{label:c.key("category.undo"),items:["undo","redo"]},insert:{label:c.key("category.insert"),items:[d]},style:{label:c.key("category.style"),items:["styles"]},language:{label:c.key("category.language"),items:["language","ltrdir","rtldir"]},emphasis:{label:c.key("category.emphasis"),
items:["bold","italic","underline"]},align:{label:c.key("category.align"),items:["alignment"]},listindent:{label:c.key("category.listindent"),items:["ul","ol","outdent","indent","blockquote"]},format:{label:c.key("category.format"),items:["font-menu","removeformat"]},tools:{label:c.key("category.tools"),items:["find","accessibility","fullscreen","usersettings"]},"table-tools":{label:c.key("category.table"),items:["table-tools"]},"image-tools":{label:c.key("category.image"),items:["image-tools","crop-tools"]}}}});
k("nk","vm c 6 7 vn vo vp vq".split(" "),function(c,d,b,a,e,g,f,h){var l=g(),m=function(a,b){return a.bind(function(a){return b.map(function(b){return a.concat(b)})})};return{config:function(g,p,r){return function(q,s,t,k){q=e(q,s,t,k,r);q=b.deepMerge(q,p);k={"table-tools":{feature:k.table().ui(),command:"cell",type:"palette"},"image-tools":{feature:k.imageEdit().ui(),command:"edit",type:"palette"},"crop-tools":{feature:k.imageEdit().ui(),command:"crop",type:"palette"}};q={forItems:a.constant({commands:a.constant(q),
groups:f}),forContextual:a.constant({commands:a.constant(k),groups:f})};k=c.build({items:g.items},q.forItems(),l.make);q=c.build({items:g.contextual},q.forContextual(),l.make);s=d.detect().deviceType.isTouch()?h.streamline:a.identity;return m(k,q).map(s)}}}});k("12p","b 7 l 2y 21 3t".split(" "),function(c,d,b,a,e,g){var f=function(a){return function(a){g(function(){a()},0)}};return{resume:function(g){g.focus();var l=b.fromDom(g.document.body);(a.active().exists(function(a){return c.contains(["input",
"textarea"],e.name(a))})?f(l):d.apply)(function(){a.active().each(a.blur);a.focus(l)})}}});k("12q",["1a","1u","dg"],function(c,d,b){return{safeParse:function(a,e){var g=b(c.get(a,e),10);return d(g)?0:g}}});k("12r",["b","7s","d6","l","2a"],function(c,d,b,a,e){var g=function(a){return{left:a.left,top:a.top,width:2,height:a.height}},f=function(f){if(f.collapsed){var l=a.fromDom(f.startContainer);return e.parent(l).bind(function(a){return d.rectangleAt(f.startContainer.ownerDocument.defaultView,l,f.startOffset,
a,b.getEnd(a)).map(g).map(c.pure)}).getOr([])}return f.getClientRects()};return{getRectangles:function(a){a=a.getSelection();return void 0!==a&&0<a.rangeCount?f(a.getRangeAt(0)):[]}}});k("12s",["4g"],function(c){return{resolve:c.create("ephox-nomad").resolve}});k("zu","12p 12q 12r 12s 7 s 1a 3u l 1s 36".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){var p="data-"+a.resolve("last-outer-height"),r=function(a){return{top:e.constant(a.top),bottom:e.constant(a.top+a.height)}},q=function(a){a=b.getRectangles(a);
return 0<a.length?g.some(a[0]).map(r):g.none()},s=function(a){a=d.safeParse(a,p);var b=n.innerHeight;return a>b?g.some(a-b):g.none()};return{setup:function(a,b){var d=l.fromDom(b.document.body),e=h.bind(l.fromDom(a),"resize",function(){s(d).each(function(a){q(b).each(function(c){c=c.top()>b.innerHeight||c.bottom()>b.innerHeight?m.min(a,c.bottom()-b.innerHeight+50):0;0!==c&&b.scrollTo(b.pageXOffset,b.pageYOffset+c)})});f.set(d,p,n.innerHeight)});f.set(d,p,n.innerHeight);return{toEditing:function(){c.resume(b)},
destroy:function(){e.unbind()}}}}});k("o5",["2i"],function(c){return function(d){return new (c.getOrDie("Event"))(d)}});k("g1",["o5"],function(c){var d=function(b){var a=c("Event");a.initEvent(b,!0,!0);return a};return{event:function(b,a){var c=d(a);b.target().dom().dispatchEvent(c)},target:function(b,a){var c=d(a);b.dom().dispatchEvent(c)}}});k("gy",["g1"],function(c){return function(d){return{closeMenus:function(b){b=b?b.target():d;c.target(b,"mousedown")}}}});k("zv","7 s 54 46 3u l 1s 2s 2t 36".split(" "),
function(c,d,b,a,e,g,f,h,l,m){var n=function(){var a=m.matchMedia("(orientation: portrait)").matches;return{isPortrait:c.constant(a)}};return{get:n,onChange:function(){var c=a.create({ready:b(["orientation"]),change:b(["orientation"])}),f=g.fromDom(m),q=null,s=e.bind(f,"orientationchange",function(){h(q);var a=n();c.trigger.change(a);t(function(){c.trigger.ready(a)})}),t=function(a){h(q);var b=m.innerHeight,c=0;q=l(function(){b!==m.innerHeight?(h(q),a(d.some(m.innerHeight))):20<c&&(h(q),a(d.none()));
c++},50)};return{onAdjustment:t,events:c.registry,destroy:function(){s.unbind()}}}}});k("zw",["1a","l","2o","31"],function(c,d,b,a){return{tag:function(){var e=a.first("head").getOrDie(),g=a.first('meta[name="viewport"]').getOrThunk(function(){var a=d.fromTag("meta");c.set(a,"name","viewport");b.append(e,a);return a}),f=c.get(g,"content");return{maximize:function(){c.set(g,"content","width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0")},restore:function(){void 0!==f&&null!==
f&&0<f.length?c.set(g,"content",f):c.remove(g,"content")}}}}});k("zx",["7","3u"],function(c,d){return function(b){return function(a,e){var g=d.bind(b,"touchmove",a.move),f=d.bind(b,"touchend",a.drop);return{element:c.constant(b),start:c.noop,stop:c.noop,destroy:function(){g.unbind();f.unbind()}}}}});k("12t","7 s 2n 31 2r 1s".split(" "),function(c,d,b,a,e,g){var f=function(a,b){var c=e.get(a);return g.floor(b/100*c)},h=function(b,c){return a.ancestor(c,"td,th").fold(function(){return f(b,98)},function(a){return f(a,
94)})},l=function(a,b,c){var d=b.dom().width;a=h(a,b);return g.max(0,g.min(a,d+c))},m=function(a,b,c){return b.dom().height+c};return{compare:function(a,b){var d=b.deltaX()-a.deltaX(),e=b.deltaY()-a.deltaY(),f=b.deltaDistance()-a.deltaDistance();return{deltaX:c.constant(d),deltaY:c.constant(e),deltaDistance:c.constant(f)}},extract:function(a){var b=a.raw().touches;if(2>b.length)return d.none();a=g.abs(b[0].clientX-b[1].clientX);var b=g.abs(b[0].clientY-b[1].clientY),e=g.sqrt(g.pow(a,2)+g.pow(b,2));
return d.some({deltaX:c.constant(a),deltaY:c.constant(b),deltaDistance:c.constant(e)})},resize:function(a,c,d){var f=b.getRaw(c,"height"),s=b.getRaw(c,"width"),t=0<d.deltaDistance()?1:-1,k=t*g.abs(d.deltaX()),v=t*g.abs(d.deltaY());d=l(a,c,k);t=m(a,c,v);k=g.abs(k)>g.abs(v);b.setAll(c,{height:k?"auto":t+"px",width:k?d+"px":"auto",transform:"translate3d(0, 0, 0)"});e.get(c)>h(a,c)&&(f.each(function(a){b.set(c,"height",a)}),s.each(function(a){b.set(c,"width",a)}))}}});k("zy","wp ib s 12t 4m 2n 3u 21".split(" "),
function(c,d,b,a,e,g,f,h){return function(l,m,n,p){var r=e(b.none());n=c.mode({compare:a.compare,extract:a.extract,sink:n,mutate:function(b,c){r.get().each(function(b){a.resize(m,b,c)})}});var q=d.transform({},{mode:n}),s=f.bind(l,"touchstart",function(a){"img"===h.name(a.target())&&2===a.raw().touches.length&&(r.set(b.some(a.target())),q.on(),q.go(m))});q.events.stop.bind(function(){r.get().each(function(a){g.remove(a,"transform")});p()});return{destroy:function(){s.unbind();q.destroy()}}}});k("vr",
"b c zu gy zv zw 7 s 71 zx zy 1y 2n 3u l 2y q 36".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,k,v){var w=6<=d.detect().os.version.major;return function(d,y,B){var z=B.toolbar.element(),A=g.tag(),C=[],D=s.fromDom(k),F=a(z),E=null,G=l.api(),H=h.none(),I=function(){G.run(function(a){a.toEditing()})},L=function(){F.closeMenus()},J=function(){d.getSelection().each(function(a){a=a.collapsed()?"0px":"23px";r.set(z,"margin-top",a)})},K=function(a){r.set(z,"margin-top","0px")},M=function(){var a=[q.bind(z,
"touchmove",F.closeMenus)];C=d.doc().map(function(a){return y||!0===w?[]:[q.bind(a,"selectionchange",J),q.bind(D,"focusin",K)]}).getOr([]).concat(a)},N=function(){c.each(C,function(a){a.unbind()})};return{enter:function(){d.body().each(function(a){d.doc().each(function(c){d.win().each(function(g){t.focus(a);E=e.onChange();var l=m(c),l=n(c,a,l,f.noop);H=h.some(l);g=b.setup(v,g);G.set(g);d.events.toEditing.bind(I);E.events.change.bind(L)})})});p.add(z,"ephox-polish-mobile-show");B.toolbar.refresh();
A.maximize();M()},exit:function(){G.clear();d.events.toEditing.unbind(I);E.events.change.unbind(L);null!==E&&E.destroy();A.restore();N()},destroy:function(){H.each(function(a){a.destroy()});N()}}}});k("vs","b 7v 4z 7 73 33 54 46 1y 2n 3u l 2o 2q 3t".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s){return function(){var s=p.fromTag("div");l.add(s,g.resolve("disabled-mask"));var k=!1,v=b.div();l.add(v,g.resolve("content-container"));var w=b.div();d.hidden(w,!0);l.add(w,g.resolve("tap-icon"));r.append(v,
w);var x=b.div();l.add(x,g.resolve("disclosure"));r.append(x,p.fromText(e.translate("taptoedit")));r.append(v,x);r.append(s,v);d.textButton(s,v);var y=h.create({fullscreen:f([])}),B=function(a){var b=s.dom().getClientRects()[0];return c.forall(a,function(a){return a.pageY>=b.top&&a.pageY<=b.top+b.height&&a.pageX>=b.left&&a.pageX<=b.left+b.width})},z=[n.bind(s,"touchmove",function(a){k=!0}),n.bind(s,"touchend",function(a){var b=a.raw().changedTouches;B(b)&&!k&&(a.kill(),y.trigger.fullscreen())}),n.bind(s,
"touchstart",function(a){k=!1}),n.bind(s,"click",function(a){a.kill();y.trigger.fullscreen()})];return{element:a.constant(s),events:y.registry,destroy:function(){c.each(z,function(a){a.unbind()});q.remove(w);q.remove(x);q.remove(v);q.remove(s)},show:function(){m.remove(s,"display")},hide:function(){m.set(s,"display","none")}}}});k("nl","cb 33 vr vs 1y 2y 2o".split(" "),function(c,d,b,a,e,g,f){return function(h,l,m,n,p,r){var q=r.element(),s=b(h,p.fillscreen,r),t=function(){s.enter();n.actions().maximize()},
k=function(){var b=a();f.append(r.element(),b.element());b.events.fullscreen.bind(function(a){n.actions().maximize()})};return{init:function(){r.socket(h);h.events.scrollToCursor.bind(function(){c.cursorIntoView(h)})},loaded:function(){var a=!0===p.fillscreen;(e.has(q,d.resolve("fullscreen-maximized"))||a?t:k)()},restoreEditor:function(){n.actions().restore();s.exit()},destroy:function(){h.body().each(g.blur)}}}});k("fb",["7","nj","nk","nl"],function(c,d,b,a){return function(e,g,f,h,l){var m=h.toolbar.items,
n=function(c){var n=a(e,g,f,l,h,c),q=d();c=b.config({items:[["back"]].concat(m),contextual:[]},{back:{feature:q.ui(),command:"back",type:"general"}},{allowLocalImages:h.allowLocalImages});q.events.back.bind(function(){n.restoreEditor()});return{init:n.init,loaded:n.loaded,config:c,destroy:function(){n.destroy();q.destroy()}}};return{tabbed:n,full:n,destroy:c.noop}}});k("fc",["7","nk","nl"],function(c,d,b){return function(a,e,g,f,h){var l=f.toolbar.items,m=function(c){var m=b(a,e,g,h,f,c);c=d.config({items:l,
contextual:[]},{},{allowLocalImages:f.allowLocalImages});return{init:m.init,loaded:m.loaded,config:c,destroy:function(){m.destroy()}}};return{tabbed:m,full:m,destroy:c.noop}}});k("fd",["7","cb","nk"],function(c,d,b){return function(a,e,g,f){e=function(e){return{init:function(){e.socket(a);a.events.scrollToCursor.bind(function(){d.cursorIntoView(a)});a.events.toEditing.bind(a.focus)},loaded:c.noop,config:b.config(f.toolbar,{},{allowLocalImages:f.allowLocalImages}),destroy:c.noop}};return{tabbed:e,
full:e,destroy:c.noop}}});k("zz",["b","1a","2n","4e"],function(c,d,b,a){var e=function(a){return a.body().map(function(a){a=b.get(a,"background-color");return void 0!==a&&""!==a?"background-color:"+a+"!important":"background-color:rgb(255,255,255)!important;"}).getOr("background-color:rgb(255,255,255)!important;")};return{clobberStyles:function(b,f){var h=function(a){return function(b){var c=d.get(b,"style"),c=void 0===c?"no-styles":c.trim();c!==a&&(d.set(b,"data-ephox-mobile-fullscreen-style",c),
d.set(b,"style",a))}},l=a.ancestors(b,"*"),m=c.bind(l,function(b){return a.siblings(b,"*")}),n=e(f);c.each(m,h("display:none!important;"));c.each(l,h("position:absolute!important;top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;"+n))},restoreStyles:function(){var b=a.all("[data-ephox-mobile-fullscreen-style]");c.each(b,function(a){var b=d.get(a,"data-ephox-mobile-fullscreen-style");"no-styles"!==b?d.set(a,
"style",b):d.remove(a,"style");d.remove(a,"data-ephox-mobile-fullscreen-style")})}}});k("vt","zw 7 s 33 vs zz 1y 2n q".split(" "),function(c,d,b,a,e,g,f,h,l){return function(m,n){var p=c.tag(),r=b.none(),q=e();return{maximize:function(){r=b.some(l.body.scrollTop);h.set(q.element(),"display","none");f.add(m,a.resolve("fullscreen-maximized"));g.clobberStyles(m,n);p.maximize()},restore:function(){g.restoreStyles();f.remove(m,a.resolve("fullscreen-maximized"));p.restore();h.remove(q.element(),"display");
r=r.bind(function(a){l.body.scrollTop=a;return b.none()})},destroy:function(){q.destroy()},mask:d.constant(q)}}});k("12u",["2n","l","2y","2o","2q"],function(c,d,b,a,e){return{input:function(g,f){var h=d.fromTag("input");c.setAll(h,{opacity:"0",position:"absolute",top:"-1000px",left:"-1000px"});a.append(g,h);b.focus(h);f(h);e.remove(h)}}});k("go",["2y","3t"],function(c,d){return{refreshInput:function(b){var a=b.dom().selectionStart,e=b.dom().selectionEnd,g=b.dom().selectionDirection;d(function(){b.dom().setSelectionRange(a,
e,g);c.focus(b)},50)},refresh:function(b){var a=b.getSelection();if(0<a.rangeCount){var c=a.getRangeAt(0);b=b.document.createRange();b.setStart(c.startContainer,c.startOffset);b.setEnd(c.endContainer,c.endOffset);a.removeAllRanges();a.addRange(b)}}}});k("12v",["go","1b","l","2y"],function(c,d,b,a){return{resume:function(e,g){a.active().each(function(b){d.eq(b,g)||a.blur(b)});e.focus();a.focus(b.fromDom(e.document.body));c.refresh(e)}}});k("100","b gy 12u 12v 7 2m 3u 2y 21".split(" "),function(c,d,
b,a,e,g,f,h,l){return{stubborn:function(e,n,p,r,q){var s=d(q),t=function(){a.resume(e,p)},k=f.bind(n,"keydown",function(a){c.contains(["input","textarea"],l.name(a.target()))||(s.closeMenus(void 0),t())});return{toReading:function(){b.input(g.body(),h.blur)},toEditing:t,onToolbarTouch:function(a){},destroy:function(){k.unbind()}}},timid:function(b,c,d,f,g){return{toReading:function(){h.blur(d)},toEditing:function(){a.resume(b,d)},onToolbarTouch:function(){h.blur(d)},destroy:e.noop}}}});k("12w",["s",
"54","46","3u"],function(c,d,b,a){return{touch:function(e){var g=b.create({touchstart:d(["raw"]),touchend:d(["raw"])}),f=!1,h=c.none(),l=a.capture(e,"touchstart",function(b){f=!0;h=c.some(a.capture(e,"touchend",function(a){f=!1;g.trigger.touchend(a.raw());m()}));g.trigger.touchstart(b.raw())}),m=function(){h.each(function(a){a.unbind()})};return{isTouching:function(){return f},events:g.registry,destroy:function(){l.unbind();m()}}}}});k("14l","7s 12u 12s 2m 3l 31 2a".split(" "),function(c,d,b,a,e,
g,f){var h=function(a){a=f.documentElement(a);var c=b.resolve("unfocused-selection");return g.descendant(a,"."+c).bind(function(a){return e.absolute(a).top})};return{switchSelection:function(b,e,f){var g=f.isActive,h=!1;return{on:function(){g()||(h=!1,f.update(),e.save(),c.clearAll(b))},off:function(){g()&&!h&&(f.clear(),e.restore())},fakeOut:function(){h=!0;d.input(a.body(),e.restore)}}},inView:function(a,b,c){return function(){return h(b).map(function(b){var c=a.dom().scrollTop;return 0<b()-c})}}}});
k("14m",[],function(){return{onScroll:function(c,d,b,a){var e=function(){c()||g()},g=function(){a.events.touchend.unbind(e);a.isTouching()?a.events.touchend.bind(e):(b().getOr(!0)?d.off:d.fakeOut)()};return{start:function(){a.events.touchend.unbind(e);d.on()},stop:g,destroy:function(){a.events.touchend.unbind(e)}}}}});k("12x",["14l","14m"],function(c,d){return{toFake:c.switchSelection,inView:c.inView,onScroll:d.onScroll}});k("15f",["s","k"],function(c,d){return{findDevice:function(b,a){return d.findMap([{width:320,
height:480,keyboard:{portrait:300,landscape:240}},{width:320,height:568,keyboard:{portrait:300,landscape:240}},{width:375,height:667,keyboard:{portrait:305,landscape:240}},{width:414,height:736,keyboard:{portrait:320,landscape:240}},{width:768,height:1024,keyboard:{portrait:320,landscape:400}},{width:1024,height:1366,keyboard:{portrait:380,landscape:460}}],function(d){return b<=d.width&&a<=d.height?c.some(d.keyboard):c.none()}).getOr({portrait:a/5,landscape:b/4})}}});k("14n",["zv","15f","2n","6d",
"36"],function(c,d,b,a,e){var g=d.findDevice(e.screen.width,e.screen.height),f=function(b){b=a.get(b);var d=c.get().isPortrait(),f=d?g.portrait:g.landscape;return b-((d?e.screen.height:e.screen.width)-e.innerHeight>f?0:f)};return{getGreenzone:f,updatePadding:function(c,d){var e=f(d),e=a.get(d)-e;b.set(c,"padding-bottom",e+"px")}}});k("131","b 3m 12q 14n 12s 7 4n 1a 2n 6d 4e 1u dg 36".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q){var s=f.generate([{fixed:["element","offsetY"]},{scroller:["element",
"offsetY"]}]),t="data-"+e.resolve("position-y-fixed"),k="data-"+e.resolve("scrolling"),v="data-"+e.resolve("last-window-height"),w=function(a){return b.safeParse(a,t)},x=function(a){var b=w(a);return("true"===h.get(a,k)?s.scroller:s.fixed)(a,b)},y=function(a){var b=h.get(a,"style");l.setAll(a,{position:"absolute",top:"0px"});h.set(a,t,"0px");return{restore:function(){h.set(a,"style",b||"");h.remove(a,t)}}},B=function(a,b,c){var e=h.get(c,"style");d.register(c);l.setAll(c,{position:"absolute",height:b+
"px",width:"100%",top:a+"px"});h.set(c,t,a+"px");h.set(c,k,"true");return{restore:function(){d.deregister(c);h.set(c,"style",e||"");h.remove(c,t);h.remove(c,k)}}},z=function(a,b){var c=q.innerHeight;h.set(a,v,c+"px");return c-b};return{findFixtures:function(a){a=n.descendants(a,"["+t+"]");return c.map(a,x)},takeover:function(c,d,e){var f=y(e),n=m.get(e),p=z(c,n),r=B(n,p,c),n=function(){var a=q.innerHeight,d=b.safeParse(c,v);return a>d},s=function(){var b=m.get(e),f=z(c,b);h.set(c,t,b+"px");l.set(c,
"height",f+"px");a.updatePadding(d,c)};a.updatePadding(d,c);return{setViewportOffset:function(a){h.set(c,t,a+"px");s()},isExpanding:n,isShrinking:g.not(n),refresh:s,restore:function(){f.restore();r.restore()}}},getYFixedData:w}});k("14o",["s","1s","2s","2t"],function(c,d,b,a){var e=function(a,b,e){return d.abs(a-b)<=e?c.none():a<b?c.some(a+e):c.some(a-e)};return{create:function(){var c=null;return{animate:function(f,h,l,m,n,p){b(c);var r=function(a){b(c);n(a)};c=a(function(){var a=f();e(a,h,l).fold(function(){b(c);
n(h)},function(e){m(e,r);var l=f();if(l!==e||d.abs(l-h)>d.abs(a-h))b(c),n(h)})},p)}}},adjust:e}});k("12z","3s 12q 131 14o 12s 7 1a 2n 1s dg 36".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){var p=a.create(),r="data-"+e.resolve("last-scroll-top"),q=function(a){a=h.getRaw(a,"top").getOr(0);return m(a,10)},s=function(a){return m(a.dom().scrollTop,10)},t=function(a,c){var d=c+b.getYFixedData(a)+"px";h.set(a,"top",d)};return{moveScrollAndTop:function(a,b,d){return c.nu(function(c){var e=g.curry(s,a);p.animate(e,
b,15,function(b){a.dom().scrollTop=b;h.set(a,"top",q(a)+15+"px")},function(e){a.dom().scrollTop=b;h.set(a,"top",d+"px");c(b)},10)})},moveOnlyScroll:function(a,b){return c.nu(function(c){var e=g.curry(s,a);f.set(a,r,e());var h=l.abs(b-e()),h=l.ceil(h/10);p.animate(e,b,h,function(b,c){d.safeParse(a,r)!==a.dom().scrollTop?c(a.dom().scrollTop):(a.dom().scrollTop=b,f.set(a,r,b))},function(d){a.dom().scrollTop=b;f.set(a,r,b);c(b)},10)})},moveOnlyTop:function(a,b){return c.nu(function(c){var d=g.curry(q,
a),e=function(b){h.set(a,"top",b+"px")},f=l.abs(b-d()),f=l.ceil(f/10);p.animate(d,b,f,e,function(a){e(b);c(b)},10)})},moveWindowScroll:function(a,b,d){return c.nu(function(c){var e=function(c){t(a,c);t(b,c);n.scrollTo(0,c)};p.animate(function(){return n.pageYOffset},d,15,e,function(a){e(a);c(a)},10)})}}});k("12y",["go","14n","12z","7","dg"],function(c,d,b,a,e){return{scrollIntoView:function(e,f,h,l){var m=d.getGreenzone(f);e=a.curry(c.refresh,e);h>m||l>m?b.moveOnlyScroll(f,f.dom().scrollTop-m+l).get(e):
0>h&&b.moveOnlyScroll(f,f.dom().scrollTop+h).get(e)}}});k("130","b 3s 12z 131 2n dg".split(" "),function(c,d,b,a,e,g){var f=function(a,c){return a.fold(function(a,b){e.set(a,"top",c+b+"px");return d.pure(b)},function(a,d){var f=c+d,h=e.getRaw(a,"top").getOr(d),h=f-g(h,10),h=a.dom().scrollTop+h;return b.moveScrollAndTop(a,h,f)})};return{updatePositions:function(b,e){var g=a.findFixtures(b),g=c.map(g,function(a){return f(a,e)});return d.par(g)}}});k("132","b 12r 12v 12s 1y 4b 2n 3u l 2o 3c 2q 2a".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,p,r){return function(q,s){var t=q.document,k=l.fromTag("div");e.add(k,a.resolve("unfocused-selections"));m.append(l.fromDom(t.documentElement),k);var v=h.bind(k,"touchstart",function(a){a.prevent();b.resume(q,s);x()}),w=function(b){var c=l.fromTag("span");g.add(c,[a.resolve("layer-editor"),a.resolve("unfocused-selection")]);f.setAll(c,{left:b.left+"px",top:b.top+"px",width:b.width+"px",height:b.height+"px"});return c},x=function(){p.empty(k)};return{update:function(){x();
var a=d.getRectangles(q),a=c.map(a,w);n.append(k,a)},isActive:function(){return 0<r.children(k).length},destroy:function(){v.unbind();p.remove(k)},clear:x}}});k("133",["2l","7","4m"],function(c,d,b){return function(a){var e=b(c.pure({}));return{start:function(b){var f=c.nu(function(c){return a(b).get(c)});f.get(d.identity);e.set(f)},idle:function(a){e.get().get(function(){a()})}}}});k("101","12w zv 12x 12r 12y 12z 130 131 132 133 7 9u s 2m 2n 3u l 1s 2s 6e o dg 2t 3t 36".split(" "),function(c,d,b,
a,e,g,f,h,l,m,n,p,r,q,s,t,k,v,w,x,y,B,z,A,C){var D=function(b,c,d,e,h,l){var q=m(function(a){return g.moveWindowScroll(b,c,a)}),s=function(){var b=a.getRectangles(l);return r.from(b[0]).bind(function(a){var b=a.top-c.dom().scrollTop;return b>C.innerHeight+5||-5>b?r.some({top:n.constant(b),bottom:n.constant(b+a.height)}):r.none()})},v=p(function(){q.idle(function(){f.updatePositions(d,e.pageYOffset).get(function(a){s().each(function(a){c.dom().scrollTop=c.dom().scrollTop+a.top()});q.start(0);h.refresh()})})},
1E3),w=t.bind(k.fromDom(e),"scroll",function(){0>e.pageYOffset||v.throttle()});f.updatePositions(d,e.pageYOffset).get(n.identity);return{unbind:w.unbind}};return{setup:function(a){var f=a.cWin(),m=a.ceBody(),p=a.socket(),r=a.toolstrip(),v=a.toolbar(),w=a.contentElement(),x=a.cursor(),y=a.keyboardType();a=a.isScrolling();var B=h.takeover(p,m,r),z=y(f,q.body(),w,r,v),A=d.onChange();A.events.ready.bind(B.refresh);A.onAdjustment(function(){B.refresh()});var P=t.bind(k.fromDom(C),"resize",function(){B.isExpanding()&&
B.refresh()}),R=D(r,p,q.body(),C,B,f),O=l(f,w),T=function(){O.clear()},r=b.toFake(f,x,O),m=b.inView(p,m,v),W=c.touch(k.fromDom(f)),X=b.onScroll(a,r,m,W);return{toEditing:function(){z.toEditing();T()},toReading:function(){z.toReading()},onToolbarTouch:function(a){z.onToolbarTouch(a)},refreshSelection:function(){O.isActive()&&O.update()},clearSelection:T,highlightSelection:function(){O.update()},scrollIntoView:function(a,b){e.scrollIntoView(f,p,a,b)},updateToolbarPadding:n.noop,setViewportOffset:function(a){B.setViewportOffset(a);
g.moveOnlyTop(p,a).get(n.identity)},syncHeight:function(){s.set(w,"height",w.dom().contentWindow.document.body.scrollHeight+"px")},selectionScrollStarted:function(){X.start()},selectionScrollStopped:function(){X.stop()},destroy:function(){B.restore();A.destroy();R.unbind();P.unbind();z.destroy();X.destroy();W.destroy();O.destroy()}}}}});k("134",["12s","1a"],function(c,d){var b="data-"+c.resolve("horizontal-scroll"),a=function(a){var b;(b=0<a.dom().scrollTop)||(a.dom().scrollTop=1,b=0!==a.dom().scrollTop,
a.dom().scrollTop=0);return b},e=function(a){var b;(b=0<a.dom().scrollLeft)||(a.dom().scrollLeft=1,b=0!==a.dom().scrollLeft,a.dom().scrollLeft=0);return b};return{markAsHorizontal:function(a){d.set(a,b,"true")},hasScroll:function(c){return"true"===d.get(c,b)?e:a}}});k("102",["134","7","s","3u","31"],function(c,d,b,a,e){var g=function(a){var c=a.dom().scrollTop,d=a.dom().scrollHeight;a=a.dom().offsetHeight;return 0>=c?b.some(1):c+a>=d?b.some(d-a-1):b.none()},f=function(a){g(a).each(function(b){a.dom().scrollTop=
b})},h=function(b,c){return a.bind(b,"touchstart",function(a){c(a.target()).each(f)})};return{fixEdges:f,exclusive:function(b,f){return a.bind(b,"touchmove",function(a){e.closest(a.target(),f).filter(c.hasScroll).fold(function(){a.raw().preventDefault()},d.noop)})},link:function(a,b){return h(a,d.constant(b))},ancestor:function(a,b){return h(a,function(a){return e.closest(a,b)})},indirect:h,markAsHorizontal:function(a){c.markAsHorizontal(a)}}});k("pe",["5b","l","2o","2q","2a"],function(c,d,b,a,e){var g=
function(a){return d.fromText(c.zeroWidth(),a.dom())};return{runAndRemove:function(c,h){var l=e.owner(c),m=d.fromTag("span",l.dom());b.append(m,g(l));b.prepend(c,m);l=h(m);a.remove(m);return l},enrichAndRemove:function(c,d){var l=g(e.owner(c));b.append(c,l);var m=d(c);a.remove(l);return m}}});k("hi","pd 7 s c7 pe ni 2u 3k 2m 2n 6d 3l 21 2a al 2r dg".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,k){var v=f.immutable("left","top","width","height","direction","absolute"),w=function(b){return{position:d.constant(a.find(b)),
width:d.constant(t.getOuter(b)),height:d.constant(n.getOuter(b))}},x=function(a){var b=m.get(a,"display");return{backup:function(){m.set(a,"display","inline-block")},restore:function(){m.set(a,"display",b)}}},y={backup:d.noop,restore:d.noop},B=function(a){return r.isElement(a.startContainer())?b.some(a.startContainer()):r.isElement(a.endContainer())?b.some(a.endContainer()):q.parent(a.startContainer()).filter(r.isElement).orThunk(function(){return q.parent(a.endContainer()).filter(r.isElement)})},
z=function(b,c){return B(c).fold(function(){return v(0,0,0,b.uiDirection(),h(0,0))},function(c){var d=a.find(c),e=t.get(c),f=n.get(c),g=p.absolute(c);return v(d.left(),d.top(),e,f,b.directionAt(c),g)})},A=function(a,b,c,d){return g.diagnose(a,c)(d,function(a){var d=s.isVisible(a)||"br"===r.name(a)?y:x(a);d.backup();var f;if(l.inBody(a)){var g=e.enrichAndRemove(a,w);f=g.position();var h=g.width(),g=g.height(),m=b.directionAt(a);a=p.absolute(a);f=v(f.left(),f.top(),h,g,m,a)}else f=z(b,c);d.restore();
return f})},C=function(a,d,f,g){var h=f.startContainer(),l=f.startOffset();if("body"===r.name(h)&&0===l){var n=f.startContainer();a=k(m.get(n,"padding-top"),10);g=k(m.get(n,"padding-left"),10);var q=e.runAndRemove(n,w),h=q.position(),l=q.width(),q=q.height();d=d.directionAt(n);n=p.absolute(n);f=c(v(h.left()+g,h.top()+a,l,q,d,n),b.some(f))}else f=A(a,d,f,g);return f},D=function(a,b,c,d,e){b.focus();a=C(b.isRoot,a,c,e);a.cursor().each(function(a){b.setSelection(a.startContainer(),a.startOffset(),a.endContainer(),
a.endOffset())});a=a.result();d(a)};return{insertAt:D,insertAtCursor:function(a,b,c,d){b.getSelection().each(function(e){D(a,b,e,c,d)})}}});k("103",["7","3u","21"],function(c,d,b){return function(a){return function(e,g){var f=d.bind(a,"touchmove",e.move),h=d.bind(a,"touchend",e.drop),l=d.bind(a,"gesturestart",function(a){"img"===b.name(a.target())&&a.prevent()});return{element:c.constant(a),start:c.noop,stop:c.noop,destroy:function(){f.unbind();h.unbind();l.unbind()}}}}});k("vu","b 3m 7r 7s 100 101 gy zv 102 9u s 71 hi 33 zy 103 2u 1y 1b 2n 3u l 2y 6d 3l 31 2s 6e q 2t 3t 36".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,t,k,v,w,x,y,B,z,A,C,D,F,E,G,H,I,L){return function(E,I,M,N,S,Q,P,R){var O=[],T=Q.toolbar.element(),W=Q.banners(),X=Q.viewport(),V=n.none(),aa=f(T),ca=null,Z=p.api(),ba=n.none(),ia=d.event(X),ga=k.immutableBag("cWin ceBody socket toolstrip toolbar contentElement cursor keyboardType isScrolling".split(" "),[]),fa=function(){Z.run(function(a){a.highlightSelection()})},Y=function(){Z.run(function(a){a.refreshSelection()})},na=function(a){var b=C.absolute(a).top()-
X.dom().scrollTop;Z.run(function(c){c.scrollIntoView(b,b+A.get(a))})},ea=function(){r.insertAtCursor(N,E,function(a){var b=a.absolute().top()-X.dom().scrollTop;Z.run(function(c){c.scrollIntoView(b,b+a.height())})})},$=function(a){ea();Z.run(function(a){a.syncHeight()})},U=function(a){var b=A.get(T);Z.run(function(a){a.setViewportOffset(b)});Y();$()},ja=function(a){na(a.element())},ha=m($,300),la=function(){aa.closeMenus()},da=function(){ka();var a=H(function(){0===L.pageYOffset&&(F(a),$())},100)},
za=function(){Z.run(function(a){a.clearSelection()})},Aa=function(){za();ha.throttle()},sa=function(){Z.run(function(a){a.toEditing()})},ta=function(){Z.run(function(a){a.toReading()})},ma=function(a){Z.run(function(b){b.onToolbarTouch(a)})},ka=function(){(h.get().isPortrait()?v.remove:v.add)(Q.element(),q.resolve("mobile-landscape"))},oa=function(a){var b=x.get(a,"background-color");void 0!==b&&""!==b&&x.set(a,"-webkit-tap-highlight-color",b)},qa=function(c){var d=E.win().getOrDie(),e=function(e){z.focus(c);
e=e.raw().changedTouches[0];b.find(d,e.pageX,e.pageY).each(function(b){a.set(d,b)})},f=E.doc().map(function(a){var b=t(a),b=s(a,c,b,$);ba=n.some(b);var d=B.fromDom(a.dom().documentElement);return[y.bind(a,"touchend",function(a){(w.eq(d,a.target())||w.eq(c,a.target()))&&e(a)})]}).getOr([]),g=[y.capture(T,"touchstart",function(a){fa();ma(a)}),y.bind(c,"touchstart",za),y.bind(c,"click",ua),y.bind(T,"touchmove",aa.closeMenus)];O=f.concat(g)},ua=function(a){a.kill()};return{exit:function(){E.body().each(function(a){x.remove(W,
"display");x.set(Q.viewport(),"overflow","hidden");V=V.bind(function(a){a.unbind();return n.none()});v.remove(T,q.resolve("mobile-show"));Z.clear();z.blur(a);x.remove(a,"padding-top");c.each(O,function(a){a.unbind()});P.restore();E.events.keyup.unbind(Aa);E.events.domChanged.unbind(ha.throttle);E.events.scrollToCursor.unbind(ha.throttle);E.events.scrollToElement.unbind(ja);E.events.domChanged.unbind(Y);E.events.nodeChanged.unbind(Y);E.events.toEditing.unbind(sa);E.events.toReading.unbind(ta);ca.events.change.unbind(la);
ca.events.ready.unbind(da);Q.toolbar.events.transitionend.unbind(U);null!==ca&&ca.destroy()})},enter:function(a){E.body().each(function(a){E.win().each(function(b){ca=h.onChange();P.maximize();qa(a);z.focus(a);V=n.some(l.exclusive(M,"."+d.scrollable()));x.getRaw(T,"overflow-x").is("auto")&&D.descendant(T,".ephox-chameleon-toolbar").each(function(a){l.markAsHorizontal(a);d.register(a)});oa(a);ka();G.body.scrollTop=0;v.add(T,q.resolve("mobile-show"));Q.toolbar.refresh();x.set(W,"display","block");D.descendant(T,
".ephox-chameleon-toolbar").each(function(c){Z.set(g.setup(ga({cWin:b,ceBody:a,socket:X,toolstrip:T,toolbar:c,contentElement:E.element(),cursor:E.cursor(),keyboardType:e.stubborn,isScrolling:ia.isScrolling})))});E.events.keyup.bind(Aa);E.events.domChanged.bind(ha.throttle);E.events.scrollToCursor.bind(ha.throttle);E.events.scrollToElement.bind(ja);E.events.domChanged.bind(Y);E.events.nodeChanged.bind(Y);E.events.toEditing.bind(sa);E.events.toReading.bind(ta);ca.events.change.bind(la);ca.events.ready.bind(da);
Q.toolbar.events.transitionend.bind(U);$()})})},destroy:function(){ba.each(function(a){a.destroy()});V.each(function(a){a.unbind()});ia.destroy()}}}});k("nm","7 vt vu l 2y 2f 2o 2a q".split(" "),function(c,d,b,a,e,g,f,h,l){return function(m,n,p,r,q){var s=d(q.element(),m),t=a.fromDom(l),k=m.element(),v=c.constant(!0===r.fillscreen),w=b(m,n,t,p,k,q,s,v),x=function(b){var c=h.children(b),d;if(!(d=0===c.length)){if(c=1===c.length)c=g.get(b),c=10===c.charCodeAt(0)&&10===c.charCodeAt(1);d=c}d&&(c=a.fromHtml("<p><br></p>"),
f.append(b,c));w.enter()},y=function(a){f.append(q.element(),s.mask().element());s.mask().events.fullscreen.bind(function(a){w.enter()})},B=function(a){(v()?x:y)(a)};return{init:function(){q.socket(m)},loaded:function(){m.body().each(B)},restoreEditor:function(){m.body().each(e.blur);m.element().dom().focus();m.element().dom().blur();w.exit();e.focus(s.mask().element())},destroy:function(){m.body().each(e.blur);w.destroy();s.destroy()}}}});k("fe",["7","nj","nk","nm"],function(c,d,b,a){return function(e,
g,f,h){var l=h.toolbar.items;return{tabbed:function(c){var n=a(e,g,f,h,c),p=d();c=b.config({items:[["back"]].concat(l),contextual:[]},{back:{feature:p.ui(),command:"back",type:"general"}},{allowLocalImages:h.allowLocalImages});p.events.back.bind(function(){n.restoreEditor()});return{init:n.init,loaded:n.loaded,config:c,destroy:function(){n.destroy();p.destroy()}}},full:c.die("mobile does not support fullscreen layout"),destroy:c.noop}}});k("ff",["7","nk","nm"],function(c,d,b){return function(a,e,
g,f){var h=f.toolbar.items;return{tabbed:function(c){var m=b(a,e,g,f,c);c=d.config({items:h,contextual:[]},{},{allowLocalImages:f.allowLocalImages});return{init:m.init,loaded:m.loaded,config:c,destroy:function(){m.restoreEditor();m.destroy()}}},full:c.die("mobile does not support fullscreen layout"),destroy:c.noop}}});k("86","c fb fc fd fe ff".split(" "),function(c,d,b,a,e,g){var f=c.detect();return function(c,l,m,n,p){return(f.deviceType.isiOS()?!0===p.fillscreen?g:e:f.deviceType.isAndroid()?!0===
p.fillscreen?b:d:a)(c,l,m,p,n)}});k("nn",["1","vv","7","s","o"],function(c,d,b,a,e){var g=function(){try{var b=c.localStorage;b.setItem("__storage_test__","__storage_test__");b.removeItem("__storage_test__");return a.some(b)}catch(d){return a.none()}}().fold(function(){var a={};return{getItem:function(b){return a[b]},setItem:function(b,c){a[b]=c}}},function(a){return{getItem:function(b){return a.getItem("ephox.textboxio."+b)},setItem:function(b,c){a.setItem("ephox.textboxio."+b,c)}}}),f=function(b,
c){return a.from(g.getItem(b)).map(d.parse).getOr(c)},h=function(a){return f(a,{})},l=function(a,b){var c=d.stringify(b);g.setItem(a,c)};return{read:h,readOr:f,write:l,access:function(a){return{read:b.curry(h,a),write:b.curry(l,a)}}}});k("fg",["nn","4m"],function(c,d){return function(b,a){var e=c.readOr(b,a),g=d(e),f=function(a){g.set(a)};return{setAndCache:function(a){f(a);c.write(b,a)},set:f,get:function(){return g.get()}}}});k("87",["7","fg"],function(c,d){return function(b){var a=d("native.spelling",
b.nativeSpelling),e=d("spelling",b.spelling),g=d("autocorrect",b.autocorrect),f=d("linkpreviews",b.linkpreviews),h=d("capitalisation",b.capitalisation);return{spelling:c.constant(e),nativeSpelling:c.constant(a),autocorrect:c.constant(g),linkpreviews:c.constant(f),capitalisation:c.constant(h),state:function(){return{nativeSpelling:a.get(),spelling:e.get(),autocorrect:g.get(),linkpreviews:f.get(),capitalisation:h.get()}},destroy:c.noop}}});k("fh",["5b","97","7","l","2o"],function(c,d,b,a,e){var g=function(b,
d,e){d.body().each(function(g){e.save();var n=a.fromHtml(c.zeroWidth());b(g,n);d.setSelection(n,0,n,0)})};return{upOrLeft:function(a,c,l){a.setRelativeSelection(d.before(l),d.before(l));a.getSelection().fold(function(){g(e.prepend,a,c)},b.noop)},right:function(a,c,l){a.setRelativeSelection(d.after(l),d.after(l));a.getSelection().fold(function(){g(e.append,a,c)},b.noop)}}});k("fi","d6 s iw 1b 6m 2a".split(" "),function(c,d,b,a,e,g){return{left:function(a,h,l){return a(h)&&c.isStart(h,l)?d.none():c.isStart(h,
l)?b.before(h,a).filter(function(a){return!e.ancestor(a,"head")}):a(h)&&0<l?g.child(h,l-1):d.none()},right:function(a,h,l){return a(h)&&c.isEnd(h,l)?d.none():c.isEnd(h,l)?b.after(h,a).filter(function(b){return a(b)||e.ancestor(b,"body")}):a(h)&&l<c.getEnd(h)?g.child(h,l+1):d.none()},isFirstInContent:function(b,c){return b.body().map(function(b){b=g.children(b);return a.eq(b[0],c)}).getOr(!1)},isLastInContent:function(b,c){return b.body().map(function(b){b=g.children(b);return 0<b.length&&a.eq(b[b.length-
1],c)}).getOr(!1)}}});k("fj",["b","s"],function(c,d){var b=function(a,b){return a.getSelection().bind(function(c){return c.collapsed()?b(a.isRoot,c.startContainer(),c.startOffset()):d.none()})},a=function(a,b){return c.foldr(a,function(a,c){return c(b).or(a)},d.none())};return{get:function(c,d,f){return b(c,f).bind(function(b){return a(d,b)})}}});k("88",["fh","fi","fj","2q"],function(c,d,b,a){return function(e,g,f){var h=g.all();h.on();var l=[];h.events.backspace.bind(function(){b.get(e,l,d.left).each(a.remove)});
g=function(a){var g=a.stopper();b.get(e,l,d.left).each(function(a){g();c.upOrLeft(e,f,a)})};h.events.right.bind(function(a){var g=a.stopper();b.get(e,l,d.right).each(function(a){g();c.right(e,f,a)})});h.events.left.bind(g);h.events.up.bind(g);return{registerSkip:function(a){l.push(a)},destroy:function(){h.destroy()}}}});k("89",["7","s","bt","8p"],function(c,d,b,a){return function(e,g){(g.error?d.some(g.error):d.none()).map(function(c){return b(a.get(c.name,[c]))}).each(e.displayBanner);return{destroy:c.noop}}});
k("nr",["2u"],function(c){return{response:c.immutable("selection","kill")}});k("fl",[],function(){var c=function(a){return function(b){return b===a}},d=c(38),b=c(40);return{ltr:{isBackward:c(37),isForward:c(39)},rtl:{isBackward:c(39),isForward:c(37)},isUp:d,isDown:b,isNavigation:function(a){return 37<=a&&40>=a}}});k("ns",["7r","e7","7s"],function(c,d,b){return function(a){return{getRect:function(a){return a.dom().getBoundingClientRect()},getRangedRect:function(c,d,f,h){return b.rectangleAt(a,c,d,
f,h)},getSelection:function(){return b.get(a)},fromSitus:function(c){return b.deriveExact(a,c)},situsFromPoint:function(b,d){return c.find(a,b,d)},clearSelection:function(){b.clearAll(a)},setSelection:function(c){b.setExact(a,c.start(),c.soffset(),c.finish(),c.foffset())},setRelativeSelection:function(c,g){b.set(a,d.write(c,g))},selectContents:function(c){b.selectElementContents(a,c)},getInnerHeight:function(){return a.innerHeight},getScrollY:function(){return a.scrollY},scrollBy:function(b,c){a.scrollBy(b,
c)}}}});k("o0",["4g"],function(c){return{resolve:c.create("ephox-darwin").resolve}});k("ie",["o0","7"],function(c,d){var b=c.resolve("selected"),a=c.resolve("last-selected"),e=c.resolve("first-selected");return{selectedClass:d.constant(b),lastSelectedClass:d.constant(a),firstSelectedClass:d.constant(e)}});k("104",["7","s","qc"],function(c,d,b){var a=function(a,b){return b.column()>=a.startCol()&&b.column()+b.colspan()-1<=a.finishCol()&&b.row()>=a.startRow()&&b.row()+b.rowspan()-1<=a.finishRow()};
return{inSelection:function(a,b){var c=b.column(),d=b.column()+b.colspan()-1,l=b.row(),m=b.row()+b.rowspan()-1;return c<=a.finishCol()&&d>=a.startCol()&&l<=a.finishRow()&&m>=a.startRow()},isWithin:a,isRectangular:function(e,g){for(var f=!0,h=c.curry(a,g),l=g.startRow();l<=g.finishRow();l++)for(var m=g.startCol();m<=g.finishCol();m++)f=f&&b.getAt(e,l,m).exists(h);return f?d.some(g):d.none()}}});k("vx",["fq","qc","104","1b","1s"],function(c,d,b,a,e){var g=function(b,g,l){g=d.findItem(b,g,a.eq);var m=
d.findItem(b,l,a.eq);return g.bind(function(a){return m.map(function(b){return c.bounds({startCol:e.min(a.column(),b.column()),finishCol:e.max(a.column()+a.colspan()-1,b.column()+b.colspan()-1),startRow:e.min(a.row(),b.row()),finishRow:e.max(a.row()+a.rowspan()-1,b.row()+b.rowspan()-1)})})})};return{getAnyBox:g,getBox:function(a,c,d){return g(a,c,d).bind(function(c){return b.isRectangular(a,c)})}}});k("vw","b 7 qc 104 vx 1b".split(" "),function(c,d,b,a,e,g){return{moveBy:function(a,c,d,e){return b.findItem(a,
c,g.eq).bind(function(c){var g=0<d?c.row()+c.rowspan()-1:c.row();c=0<e?c.column()+c.colspan()-1:c.column();return b.getAt(a,g+d,c+e).map(function(a){return a.element()})})},intercepts:function(f,g,l){return e.getAnyBox(f,g,l).map(function(e){e=b.filterItems(f,d.curry(a.inSelection,e));return c.map(e,function(a){return a.element()})})}}});k("ny",["b8","qb","qc","vw","vx"],function(c,d,b,a,e){var g=function(a){a=d.fromTable(a);return b.generate(a)};return{moveBy:function(b,d,e){return c.table(b).bind(function(c){c=
g(c);return a.moveBy(c,b,d,e)})},intercepts:function(b,c,d){b=g(b);return a.intercepts(b,c,d)},getBox:function(a,b,c){a=g(a);return e.getBox(a,b,c)}}});k("nx","b ie 7 s fp ny 1y 1b 6k 4e 31".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){var p="."+d.selectedClass(),r=l.addClass(d.selectedClass()),q=l.removeClasses([d.selectedClass(),d.lastSelectedClass(),d.firstSelectedClass()]),s=function(a){a=m.descendants(a,p);c.each(a,q)},t=function(a){return n.ancestor(a,"table")},k=function(b,c){return h.eq(b,c)?
a.some([b]):e.sharedOne(t,[b,c]).bind(function(a){return g.intercepts(a,b,c)})},v=function(b){b=c.find(b,l.hasClass(d.lastSelectedClass()));return a.from(b)},w=function(a){return n.ancestor(a,"table").bind(function(c){return n.descendant(c,"."+d.firstSelectedClass()).bind(function(c){return k(c,a).map(function(d){return{boxes:b.constant(d),start:b.constant(c),finish:b.constant(a)}})})})};return{clear:s,identify:k,retrieve:function(b){b=m.descendants(b,p);return 0<b.length?a.some(b):a.none()},shiftSelection:function(a,
b,c){return v(a).bind(function(a){return g.moveBy(a,b,c).bind(w)})},isSelected:function(a){return f.has(a,d.selectedClass())},selectRange:function(a,b,e,g){s(a);c.each(b,r);f.add(e,d.firstSelectedClass());f.add(g,d.lastSelectedClass())},getEdges:function(a){return n.descendant(a,"."+d.firstSelectedClass()).bind(function(c){return n.descendant(a,"."+d.lastSelectedClass()).bind(function(a){return e.sharedOne(t,[c,a]).map(function(d){return{first:b.constant(c),last:b.constant(a),table:b.constant(d)}})})})}}});
k("nt","nr nx e7 97 7s d6 s 1b 31".split(" "),function(c,d,b,a,e,g,f,h,l){var m=function(e,l,m,q){return!h.eq(m,q)&&(l=d.identify(m,q).getOr([]),0<l.length)?(d.selectRange(e,l,m,q),f.some(c.response(f.some(b.write(a.on(m,0),a.on(m,g.getEnd(m)))),!0))):f.none()};return{sync:function(a,b,c,d,g,h){return e.isCollapsed(c,d,g,h)?f.none():l.closest(c,"td,th").bind(function(c){return l.closest(g,"td,th").bind(function(d){return m(a,b,c,d)})})},detect:m,update:function(a,b,c,e){return d.shiftSelection(e,
a,b).map(function(a){d.clear(c);d.selectRange(c,a.boxes(),a.start(),a.finish());return a.boxes()})}}});k("105",["2u"],function(c){var d=c.immutableBag(["left","top","right","bottom"],[]);return{nu:d,moveUp:function(b,a){return d({left:b.left(),top:b.top()-a,right:b.right(),bottom:b.bottom()-a})},moveDown:function(b,a){return d({left:b.left(),top:b.top()+a,right:b.right(),bottom:b.bottom()+a})},moveBottomTo:function(b,a){var c=b.bottom()-b.top();return d({left:b.left(),top:a-c,right:b.right(),bottom:a})},
moveTopTo:function(b,a){var c=b.bottom()-b.top();return d({left:b.left(),top:a,right:b.right(),bottom:a+c})},getTop:function(b){return b.top()},getBottom:function(b){return b.bottom()},translate:function(b,a,c){return d({left:b.left()+a,top:b.top()+c,right:b.right()+a,bottom:b.bottom()+c})},toString:function(b){return"("+b.left()+", "+b.top()+") -> ("+b.right()+", "+b.bottom()+")"}}});k("106",["105","d6","s","21"],function(c,d,b,a){var e=function(a){return c.nu({left:a.left,top:a.top,right:a.right,
bottom:a.bottom})};return{getBoxAt:function(c,f,h){return a.isElement(f)?b.some(c.getRect(f)).map(e):a.isText(f)?(c=0<=h&&h<d.getEnd(f)?c.getRangedRect(f,h,f,h+1):0<h?c.getRangedRect(f,h-1,f,h):b.none(),c.map(e)):b.none()},getEntireBox:function(c,f){return a.isElement(f)?b.some(c.getRect(f)).map(e):a.isText(f)?c.getRangedRect(f,0,f,d.getEnd(f)).map(e):b.none()}}});k("vz","105 106 7 s iw ep 4n 4i 1s".split(" "),function(c,d,b,a,e,g,f,h,l){var m=f.generate([{none:[]},{retry:["caret"]}]),n=function(a,
c,e){return h.closest(c,g.isBlock).fold(b.constant(!1),function(b){return d.getEntireBox(a,b).exists(function(a){return e.left()<a.left()||1>l.abs(a.right()-e.left())||e.left()>a.right()})})};f={point:c.getBottom,adjuster:function(a,b,d,e,f){var g=c.moveDown(f,5);return 1>l.abs(d.bottom()-e.bottom())?m.retry(g):d.top()>f.bottom()?m.retry(g):d.top()===f.bottom()?m.retry(c.moveDown(f,1)):n(a,b,f)?m.retry(c.translate(g,5,0)):m.none()},move:c.moveDown,gather:e.after};var p=function(b,c,e,f,g){return 0===
g?a.some(f):b.situsFromPoint(f.left(),c.point(f)).bind(function(h){return h.start().fold(a.none,function(h,l){return d.getEntireBox(b,h,l).bind(function(d){return c.adjuster(b,h,d,e,f).fold(a.none,function(a){return p(b,c,e,a,g-1)})}).orThunk(function(){return a.some(f)})},a.none)})},r=function(b,c,d){return b.point(c)>d.getInnerHeight()?a.some(b.point(c)-d.getInnerHeight()):0>b.point(c)?a.some(-b.point(c)):a.none()},q=function(a,b,c){var d=a.move(c,5),e=p(b,a,c,d,100).getOr(d);return r(a,e,b).fold(function(){return b.situsFromPoint(e.left(),
a.point(e))},function(c){b.scrollBy(0,c);return b.situsFromPoint(e.left(),a.point(e)-c)})};return{tryUp:b.curry(q,{point:c.getTop,adjuster:function(a,b,d,e,f){var g=c.moveUp(f,5);return 1>l.abs(d.top()-e.top())?m.retry(g):d.bottom()<f.top()?m.retry(g):d.bottom()===f.top()?m.retry(c.moveUp(f,1)):n(a,b,f)?m.retry(c.translate(g,5,0)):m.none()},move:c.moveUp,gather:e.before}),tryDown:b.curry(q,f),ieTryUp:function(a,b){return a.situsFromPoint(b.left(),b.top()-5)},ieTryDown:function(a,b){return a.situsFromPoint(b.left(),
b.bottom()+5)},getJumpSize:b.constant(5)}});k("w0",["d6","fp","4n","1b","31"],function(c,d,b,a,e){var g=b.generate([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),f=function(a){return e.closest(a,"tr")};return{verify:function(b,l,m,n,p,r){return e.closest(n,"td,th").bind(function(m){return e.closest(l,"td,th").map(function(e){return a.eq(m,e)?a.eq(n,m)&&c.getEnd(m)===p?r(e):g.none("in same cell"):d.sharedOne(f,[m,e]).fold(function(){var a=b.getRect(e),c=b.getRect(m);return c.right>
a.left&&c.left<a.right?g.success():r(e)},function(a){return r(e)})})}).getOr(g.none("default"))},cata:function(a,b,c,d,e){return a.fold(b,c,d,e)},adt:g}});k("135","b 7 s 2u 1b 4i 4e 31 2a".split(" "),function(c,d,b,a,e,g,f,h,l){var m=a.immutable("ancestor","descendants","element","index"),n=a.immutable("parent","children","element","index"),p=function(a,f){var g=c.findIndex(a,d.curry(e.eq,f));return-1<g?b.some(g):b.none()};return{childOf:function(a,b){return g.closest(a,function(a){return l.parent(a).exists(function(a){return e.eq(a,
b)})})},indexOf:p,indexInParent:function(a){return l.parent(a).bind(function(b){var c=l.children(b);return p(c,a).map(function(d){return n(b,c,a,d)})})},selectorsInParent:function(a,b){return l.parent(a).bind(function(c){var d=f.children(c,b);return p(d,a).map(function(b){return n(c,d,a,b)})})},descendantsInAncestor:function(a,b,c){return h.closest(a,b).bind(function(b){var d=f.descendants(b,c);return p(d,a).map(function(c){return m(b,d,a,c)})})}}});k("107","w0 e7 97 d6 s eg 135 21 ak 2a".split(" "),
function(c,d,b,a,e,g,f,h,l,m){var n=function(a){return"br"===h.name(a)},p=function(a,b,c){return b(a,c).bind(function(a){return h.isText(a)&&0===l.get(a).trim().length?p(a,b,c):e.some(a)})},r=function(a,b,c){return c.traverse(b).orThunk(function(){return p(b,c.gather,a)}).map(c.relative)},q=function(a,b){return m.child(a,b).filter(n).orThunk(function(){return m.child(a,b-1).filter(n)})},s=function(a,c,d,e){return q(c,d).bind(function(c){return e.traverse(c).fold(function(){return p(c,e.gather,a).map(e.relative)},
function(a){return f.indexInParent(a).map(function(a){return b.on(a.parent(),a.index())})})})};return{tryBr:function(a,b,c,e){return(n(b)?r(a,b,e):s(a,b,c,e)).map(function(a){return d.write(a,a)})},process:function(b){return c.cata(b,function(a){return e.none("BR ADT: none")},function(){return e.none()},function(a){return e.some(g.point(a,0))},function(b){return e.some(g.point(b,a.getEnd(b)))})}}});k("vy","105 106 vz w0 107 c d6 s eg 1b 21".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){var p=g.detect(),
r=function(b,c,d){return b.getSelection().bind(function(f){return e.tryBr(c,f.finish(),f.foffset(),d).fold(function(){return h.some(l.point(f.finish(),f.foffset()))},function(c){c=b.fromSitus(c);c=a.verify(b,f.finish(),f.foffset(),c.finish(),c.foffset(),d.failure);return e.process(c)})})},q=function(b,d,e,g,l,n){return 0===n?h.none():u(b,d,e,g,l).bind(function(p){var r=b.fromSitus(p),r=a.verify(b,e,g,r.finish(),r.foffset(),l.failure);return a.cata(r,function(){return h.none()},function(){return h.some(p)},
function(a){return m.eq(e,a)&&0===g?s(b,e,g,c.moveUp,l):q(b,d,a,0,l,n-1)},function(a){return m.eq(e,a)&&g===f.getEnd(a)?s(b,e,g,c.moveDown,l):q(b,d,a,f.getEnd(a),l,n-1)})})},s=function(a,c,e,f,g){return d.getBoxAt(a,c,e).bind(function(c){return k(a,g,f(c,b.getJumpSize()))})},k=function(a,b,c){return p.browser.isChrome()||p.browser.isSafari()||p.browser.isFirefox()||p.browser.isSpartan()?b.otherRetry(a,c):p.browser.isIE()?b.ieRetry(a,c):h.none()},u=function(a,b,c,e,f){return d.getBoxAt(a,c,e).bind(function(b){return k(a,
f,b)})};return{handle:function(a,b,c){return r(a,b,c).bind(function(d){return q(a,b,d.element(),d.offset(),c,20).map(a.fromSitus)})}}});k("nu","nr nt vy c e7 97 7 s 1b 37 31 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p){var r=a.detect(),q=function(a,b){return m.ancestor(a,function(a){return p.parent(a).exists(function(a){return l.eq(a,b)})})},s=function(a,c,d,e,g){return n.closest(e,"td,th").bind(function(e){return n.closest(e,"table").bind(function(l){return q(g,l)?b.handle(a,c,d).bind(function(a){return n.closest(a.finish(),
"td,th").map(function(b){return{start:f.constant(e),finish:f.constant(b),range:f.constant(a)}})}):h.none()})})};return{navigate:function(a,b,d,f,l){return r.browser.isFirefox()||r.browser.isIE()?h.none():s(a,b,d,f,l).map(function(a){a=a.range();return c.response(h.some(e.write(g.on(a.start(),a.soffset()),g.on(a.finish(),a.foffset()))),!0)})},select:function(a,b,c,e,f,g){return s(a,c,e,f,g).bind(function(a){return d.detect(b,c,a.start(),a.finish())})}}});k("nv",["nx","7","s","1b","31"],function(c,
d,b,a,e){var g=function(a){return e.closest(a,"td,th")};return function(a,d){var e=b.none(),m=function(){e=b.none()};return{mousedown:function(a){c.clear(d);e=g(a.target())},mouseover:function(b){e.each(function(e){c.clear(d);g(b.target()).each(function(b){var g=c.identify(e,b).getOr([]);1<g.length&&(c.selectRange(d,g,e,b),a.selectContents(b))})})},mouseup:function(){e.each(m)}}}});k("nw",["vz","w0","97","iw","2a"],function(c,d,b,a,e){return{down:{traverse:e.nextSibling,gather:a.after,relative:b.before,
otherRetry:c.tryDown,ieRetry:c.ieTryDown,failure:d.adt.failedDown},up:{traverse:e.prevSibling,gather:a.before,relative:b.before,otherRetry:c.tryUp,ieRetry:c.ieTryUp,failure:d.adt.failedUp}}});k("fk","nr fl ns nt nu nv nw nx 97 7 s k 2u".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r){var q=r.immutable("rows","cols");return{mouse:function(a,c){var d=b(a),d=g(d,c);return{mousedown:d.mousedown,mouseover:d.mouseover,mouseup:d.mouseup}},keyboard:function(g,r,k){var v=b(g),w=function(){h.clear(r);return n.none()};
return{keydown:function(b,g,s,z,A,C){var D=b.raw().which,F=!0===b.raw().shiftKey;return h.retrieve(r).fold(function(){return d.isDown(D)&&F?m.curry(e.select,v,r,k,f.down,z,g):d.isUp(D)&&F?m.curry(e.select,v,r,k,f.up,z,g):d.isDown(D)?m.curry(e.navigate,v,k,f.down,z,g):d.isUp(D)?m.curry(e.navigate,v,k,f.up,z,g):n.none},function(b){var e=function(e){return function(){return p.findMap(e,function(c){return a.update(c.rows(),c.cols(),r,b)}).fold(function(){return h.getEdges(r).map(function(a){var b=d.isDown(D)||
C.isForward(D)?l.after:l.before;v.setRelativeSelection(l.on(a.first(),0),b(a.table()));h.clear(r);return c.response(n.none(),!0)})},function(a){return n.some(c.response(n.none(),!0))})}};return d.isDown(D)&&F?e([q(1,0)]):d.isUp(D)&&F?e([q(-1,0)]):C.isBackward(D)&&F?e([q(0,-1),q(-1,0)]):C.isForward(D)&&F?e([q(0,1),q(1,0)]):d.isNavigation(D)&&!1===F?w:n.none})()},keyup:function(b,c,e,f,g){return h.retrieve(r).fold(function(){var h=b.raw().which;return!0===b.raw().shiftKey===!1?n.none():d.isNavigation(h)?
a.sync(r,k,c,e,f,g):n.none()},n.none)}}}}});k("fm",["nx","ny"],function(c,d){return{retrieve:function(b){return c.retrieve(b)},retrieveBox:function(b){return c.getEdges(b).bind(function(a){return d.getBox(a.table(),a.first(),a.last())})},clear:function(b){c.clear(b)}}});k("fn","j9 d6 iu s eg ip iw nz 1b lf 21 4i ak 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q){return function(s){var k=function(a){return!s.isRoot(a)&&(h.isBlock(a)||"li"===n.name(a))},u=function(a){return n.isText(a)&&0===r.get(a).trim().length},
v=function(a,b,c,d){return p.closest(a,function(a){return q.parent(a).exists(s.isRoot)},s.isRoot).fold(function(){return e.point(a,b)},function(f){return c(f,a,b)?d(f):e.point(a,b)})},w=function(a,c){var g=function(b){return f.before(b,s.isRoot).fold(function(){return e.point(a,c)},function(a){return u(a)?g(a):e.point(a,d.getEnd(a))})};return p.closest(a,function(a){return k(a)&&q.prevSibling(a).isSome()},s.isRoot).fold(function(){return v(a,c,b.isAtLeftEdge,g)},function(d){return k(a)||b.isAtLeftEdge(d,
a,c)?g(d):e.point(a,c)})},x=function(a,c){var d=function(b){return f.after(b,s.isRoot).fold(function(){return e.point(a,c)},function(a){return u(a)?d(a):e.point(a,0)})};return p.closest(a,function(a){return k(a)&&q.nextSibling(a).isSome()},s.isRoot).fold(function(){return v(a,c,b.isAtRightEdge,d)},function(f){return k(a)||b.isAtRightEdge(f,a,c)?d(f):e.point(a,c)})};return{getSelection:function(b){return b.getSelection().bind(function(b){if(!l.eq(b.startContainer(),b.endContainer())){if(m.after(b.startContainer(),
b.startOffset(),b.endContainer(),b.endOffset())){var f=g.toLeaf(b.startContainer(),b.startOffset()),h=g.toLeaf(b.endContainer(),b.endOffset()),f=d.isStart(f.element(),f.offset())?w(f.element(),f.offset()):e.point(b.startContainer(),b.startOffset());b=d.isEnd(h.element(),h.offset())?x(h.element(),h.offset()):e.point(b.endContainer(),b.endOffset());return a.some(c(f.element(),f.offset(),b.element(),b.offset()))}f=g.toLeaf(b.startContainer(),b.startOffset());h=g.toLeaf(b.endContainer(),b.endOffset());
f=d.isEnd(f.element(),f.offset())?x(f.element(),f.offset()):e.point(b.startContainer(),b.startOffset());b=d.isStart(h.element(),h.offset())?w(h.element(),h.offset()):e.point(b.endContainer(),b.endOffset());return a.some(c(f.element(),f.offset(),b.element(),b.offset()))}return a.some(b)})}}}});k("fo",["b","ie","4b","6k"],function(c,d,b,a){return{configure:function(b){c.each([b.output(),b.internal()],function(g){var f=[d.lastSelectedClass(),d.firstSelectedClass(),d.selectedClass()],h=c.map(f,function(a){return"."+
a}).join(",");b.addSelector(g,h,function(b){c.each(b,a.removeClasses(f))})})}}});k("fr",["4x"],function(c){var d=function(a){return 0===a.button},b=function(a,b){return{bind:function(d,f){return c.bind(d,a,b,f)}}};return{realClick:b("click",function(a){return 6===a.mozInputSource||0===a.mozInputSource?!1:void 0!==a.isTrusted&&!0!==a.isTrusted?!1:!0}),leftDown:b("mousedown",d),leftPressedOver:b("mouseover",function(a){return void 0===a.buttons?!0:0!==(a.buttons&1)}),leftUp:b("mouseup",d)}});k("8a",
"b fk fl fm c dj d6 7 s 7c fn fo 54 46 fp 4m b8 3u fr 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,k,u,v,w,x){var y=e.detect();return function(e,z,A){p.configure(z);var C=n(A),D=q.create({beforeScan:r([]),afterScan:r([])});z=function(){A.body().each(function(b){A.getSelection().each(function(c){s.sharedOne(u.table,[c.startContainer(),c.endContainer()]).fold(function(){a.clear(b)},h.noop)})})};(y.browser.isChrome()||y.browser.isSafari())&&A.events.contextmenu.bind(z);A.events.nodeChanged.bind(z);
var F=k([]);A.runOrOnLoaded(function(a){var c=x.defaultView(a).dom(),f=d.mouse(c,a),g=d.keyboard(c,a,A.isRoot);F.set([w.leftDown.bind(a,f.mousedown),w.leftPressedOver.bind(a,f.mouseover),w.leftUp.bind(a,f.mouseup),v.bind(a,"keyup",function(a){a.raw().shiftKey&&b.isNavigation(a.raw().which)&&A.getSelection().each(function(b){g.keyup(a,b.startContainer(),b.startOffset(),b.endContainer(),b.endOffset()).each(function(b){l(a,b)})},h.noop)}),v.bind(a,"keydown",function(a){A.getSelection().each(function(c){D.trigger.beforeScan();
var d=e.directionAt(c.endContainer()).isRtl()?b.rtl:b.ltr;g.keydown(a,c.startContainer(),c.startOffset(),c.endContainer(),c.endOffset(),d).each(function(b){l(a,b)});D.trigger.afterScan()})})]);var l=function(a,b){b.kill()&&a.kill();b.selection().each(function(a){A.setRelativeSelection(a.start(),a.finish())})}});var E=function(a){return{win:a.win,doc:a.doc,execCommand:a.execCommand,getSelection:function(){return C.getSelection(a)},setSelection:a.setSelection,setRelativeSelection:a.setRelativeSelection,
focus:a.focus}},G=function(a,b){return{doc:b.doc,win:b.win,execCommand:b.execCommand,focus:b.focus,setSelection:h.noop,setRelativeSelection:h.noop,getSelection:function(){return l.some(H(a))}}},H=function(a){var b=g.firstCursor(a).getOr(a);a=g.lastCursor(a).getOr(a);return{startContainer:h.constant(b),startOffset:h.constant(0),endContainer:h.constant(a),endOffset:h.constant(f.getEnd(a))}};return{get:function(){return A.on(function(b){return A.body().fold(m.none,function(d){return a.retrieve(d).fold(function(){return A.getSelection().fold(m.none,
function(a){return m.single(a,E(b))})},function(a){var d=c.map(a,function(a){return G(a,b)});return m.multiple(a,d)})})}).getOrThunk(m.none)},surround:H,events:D.registry,destroy:function(){var a=F.get();c.each(a,function(a){a.unbind()})}}}});k("fs","b 6 nh 7 3u l".split(" "),function(c,d,b,a,e,g){return function(f){f=d.merge({scopes:[g.fromDom(document)],shortcuts:[],swallow:!1},f);var h=b(f),l=[],m=[];c.each(f.scopes,function(a){l.push(e.bind(a,"keydown",h.keydown).unbind);m.push(e.bind(a,"keypress",
h.keypress).unbind)});return{off:h.off,on:h.on,destroy:function(){c.each(l,a.apply);c.each(m,a.apply)},events:h.events,swallowShortcuts:h.swallowShortcuts,yieldShortcuts:h.yieldShortcuts,swallowChars:h.swallowChars,yieldChars:h.yieldChars,swallowKeys:h.swallowKeys,yieldKeys:h.yieldKeys}}});k("8b","b c fs a8 7 s k 54 46 2u".split(" "),function(c,d,b,a,e,g,f,h,l,m){var n=function(b){var c=d.detect(),e=c.os.isOSX(),f=c.os.isLinux(),g=e?a.META():a.CTRL(),c=[[g,"Z"]],h=e?[[a.META(),a.SHIFT(),"Z"]]:f?[[a.CTRL(),
"Y"],[a.CTRL(),a.SHIFT(),"Z"]]:[[a.CTRL(),"Y"]],l=[[a.SHIFT(),121]],n=e?[[a.ALT(),121]]:[[121]],p=[[g,a.SHIFT(),"F"]],f=e?[[a.META(),a.ALT(),"U"]]:f?[[a.CTRL(),a.ALT(),"U"]]:[[a.CTRL(),a.SHIFT(),"U"]],e=e?[[a.CTRL(),a.ALT(),"H"]]:[[a.CTRL(),a.SHIFT(),"H"]],k=[[g,"B"]],z=[[g,"I"]],A=[[g,"U"]],C=[[g,221],[g,"M"]],D=[[g,219],[g,a.SHIFT(),"M"]],F=[[g,a.SHIFT(),"9"]],E=[[g,"K"]],g=[[g,"F"]],G=m.immutable("keys","trigger");return{undo:G(c,b.trigger.undo),redo:G(h,b.trigger.redo),context:G(l,b.trigger.context),
toolbar:G(n,b.trigger.toolbar),bold:G(k,b.trigger.bold),italic:G(z,b.trigger.italic),underline:G(A,b.trigger.underline),indent:G(C,b.trigger.indent),outdent:G(D,b.trigger.outdent),link:G(E,b.trigger.link),search:G(g,b.trigger.search),blockquote:G(F,b.trigger.blockquote),help:G(e,b.trigger.help),fullscreen:G(p,b.trigger.fullscreen),plaincode:G(f,b.trigger.plaincode)}},p=function(a,b){return function(d){return c.contains(a,d)?g.some(b):g.none()}};return function(a,d){var m=l.create({undo:h([]),redo:h([]),
context:h([]),toolbar:h([]),plaincode:h([]),bold:h([]),italic:h([]),underline:h([]),indent:h([]),outdent:h([]),link:h([]),blockquote:h([]),search:h([]),help:h([]),fullscreen:h([])}),k=n(m),u=[k.undo,k.redo,k.context,k.toolbar],v=[k.plaincode,k.bold,k.italic,k.underline,k.indent,k.outdent,k.link,k.search,k.blockquote,k.help,k.fullscreen],u=(k=!0===d.features)?u.concat(v):u,w=c.bind(u,function(a){return a.keys()}),x=c.map(u,function(a){return p(a.keys(),a.trigger())}),y=g.none();a.onCanvas(function(a){a=
b({scopes:[a],shortcuts:w});y=g.some(a);a.swallowShortcuts(w);a.events.command.bind(function(a){var b=a.command();f.findMap(x,function(a){return a(b)}).each(e.apply)});a.on()});return{isHelpShortcutEnabled:e.constant(k),events:m.registry,destroy:function(){y.each(function(a){a.destroy()})}}}});k("o1",["b","s","2u"],function(c,d,b){var a=function(a){return function(b){return b.key()===a}},e=b.immutable("key","value");return{put:function(b,d,h,l,m){var n=void 0!==l?l:e,p=void 0!==m?m:a(d);b=c.foldl(b,
function(a,b){var c=p(b)?n(d,h):b;return{updated:p(b)||a.updated,acc:a.acc.concat([c])}},{updated:!1,acc:[]});return b.updated?b.acc:b.acc.concat([n(d,h)])},get:function(b,e,h){e=void 0!==h?h:a(e);b=c.find(b,e);return d.from(b)}}});k("o2",["2u"],function(c){return c.immutable("popup","anchor")});k("ft",["b","o1","o2","al"],function(c,d,b,a){return function(){var e=[],g=function(){e=c.filter(e,function(b){return a.isVisible(b.popup().panel())})};return{recalculate:function(){g();c.map(e,function(a){a.anchor().recalculate(a.popup())})},
dismiss:function(){g();c.map(e,function(a){a.anchor().isAnchored()||a.popup().close()})},update:function(a,c){e=d.put(e,a,c,b,function(b){return b.popup()===a})},destroy:function(){}}}});k("fu",["7","3u","29"],function(c,d,b){return{bind:function(a,c){var g=b.get(a);return{unbind:d.bind(a,"scroll",function(d){d=b.get(a);d.top()===g.top()&&d.left()===g.left()||c(d);g=d}).unbind}}}});k("8c","b 7v a8 4z 7 r ft 33 1y 3u l 2o fu 31 m 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,s,k){return function(d,
n,w){var x=f(),y=d.isInline()?e.noop:g.cached(function(){B=r.bind(d.doc().getOrDie(),function(a){x.dismiss();d.focus()})}),B=null,z=a.div();l.add(z,h.resolve("ui-container"));w.updateUi(z);d.events.loaded.bind(function(){var a=d.placeholder(),a=q.ancestor(a,"."+h.resolve("socket")).bind(k.parent).getOr(a);p.prepend(a,z)});var A=m.bind(z,"keydown",function(a){var d;if(d=c.contains(b.BACKSPACE(),a.raw().which))d=a.target(),d=e.curry(s.is,d),d=!c.exists(["textarea","input",'[contenteditable="true"]'],
d);d&&a.kill()});return{uiContainer:e.constant(z),refresh:x.recalculate,bounds:n,show:function(a,b){y();x.update(a,b);b.place(a)},destroy:function(){null!==B&&B.unbind();x.destroy();A.unbind()}}}});k("fv","7 jo 54 46 6e 3t".split(" "),function(c,d,b,a,e,g){return function(f,h,l){f=d(l,f);l=function(){var a=g(function(){e(a);m.trigger.expired()},h);return{clear:function(){e(a)}}};var m=a.create({expired:b([]),close:b([])}),n=0<h?l():{clear:c.noop};f.events.close.bind(function(){n.clear();m.trigger.close()});
return{element:f.element,action:f.action,destroy:f.destroy,events:m.registry}}});k("8d","7 fv 7q 33 1y 3u 6m".split(" "),function(c,d,b,a,e,g,f){return function(h,l,m,n,p,r,q,s){var k=q.layout.build(h,l,m,n,p,r,q,s),u=g.bind(k.element(),"mousedown",function(a){f.closest(a.target(),'input,div[contenteditable="true"],textarea,.ephox-polish-dialog.ephox-polish-help-modal,select,.ephox-polish-bottom-bar,.ephox-polish-side-bar')||a.prevent()});(function(){var d=e.toggler(k.element(),a.resolve("content-ltr")),
f=e.toggler(k.element(),a.resolve("content-rtl")),g=function(){var a=r.uiDirection().isRtl(),b=a?f.on:f.off;(a?d.off:d.on)();b()};h.events.uiStale.bind(function(){b.readDir(h).fold(g,function(a){a.ltrdir().fold(d.off,c.noop,d.on);a.rtldir().fold(f.off,c.noop,f.on);d.isOn()===f.isOn()&&g()})})})();return{element:k.element,connect:k.connect,viewport:k.viewport,socket:k.socket,showMessage:function(a,b,e){a=d(a,b,e);b=c.curry(k.hideBanner,a);a.events.expired.bind(b);k.displayBanner(a);return b},displayBanner:k.displayBanner,
hideBanner:k.hideBanner,init:k.init,refocus:k.tabstrip.refocus,tabstrip:k.tabstrip,refresh:k.refresh,position:k.position,state:k.state,destroy:function(){k.destroy();u.unbind()}}}});k("fw",[],function(){return{isDefaultEmpty:function(c){return/^\s*<p>\s*<br\s?\/?>\s*<\/p>\s*$/.test(c)}}});k("w1",["s"],function(c){return function(d){var b=void 0!==d?d.slice(0):[];return{pop:function(){return c.from(b.pop())},push:function(a){b.push(a)},peek:function(){return c.from(b[b.length-1])},pushAll:function(a){b=
b.concat(a)},clear:function(){b=[]},isEmpty:function(){return 0===b.length},size:function(){return b.length},state:function(){return b.slice(0)}}}});k("o3",["b","w1","54","46"],function(c,d,b,a){return function(e){var g=a.create({changed:b([])}),f=e.initial,h=d(e.undo),l=d(e.redo),m=function(a){h.isEmpty()&&h.push(f);h.push(a);g.trigger.changed()},n=function(a,b){b(h.peek().getOr(f),a)?(h.pop(),h.push(a)):(m(a),l.clear())};return{save:n,checkChanged:function(a,b){return!b(h.peek().getOr(f),a)},undo:function(a,
b){n(a,b);return h.pop().bind(function(a){h.isEmpty()||(l.push(a),g.trigger.changed());return h.peek()})},redo:function(a,b){b(h.peek().getOr(f),a)||l.clear();return l.pop().bind(function(a){m(a);return h.peek()})},reset:function(a){f=a;h.clear();l.clear()},state:function(){return{initial:f,undo:h.state(),redo:l.state()}},rewrite:function(a){var b=a(f),e=c.map(h.state(),a);a=c.map(l.state(),a);f=b;h=d(e);l=d(a)},events:g.registry}}});k("fx",["o3"],function(c){return{fromInitial:function(d){return c({initial:d,
undo:[],redo:[]})},fromState:function(d){return c(d)}}});k("8e","b 7 eh 73 fw 6t 74 54 46 47 2u 2m fx".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r){var q=n.immutable("clean","marked"),k=function(a){return q(a.clean,a.marked)},t=function(a,b){return{initial:b(a.initial),undo:c.map(a.undo,b),redo:c.map(a.redo,b)}},u=function(a){return{clean:a.clean(),marked:a.marked()}};return function(c,n,x,y,B){var z=r.fromState(t(B,k)),A=l.create({changed:m([],z.events.changed),undo:h([]),redo:h([])}),C=function(a,
b){var d;if(!(d=""===a.clean()&&e.isDefaultEmpty(b.clean()))){d=c.filterHtml(c.internal(),a.clean());var f=c.filterHtml(c.internal(),b.clean());d=d===f}return d},D=function(){var a=c.filterHtml(c.history(),n.getContent()),b=c.filterHtml(c.history(),n.serialize());return q(a,b)},F=function(a){return n.deserialize(a.marked())};B=function(){var a=D();z.undo(a,C).each(F);n.domChanged();n.toEditing();A.trigger.undo()};var E=function(){var a=D();z.redo(a,C).each(F);n.domChanged();n.toEditing();A.trigger.redo()},
G=b.tap(function(a,b){if(a()){var c=D();z.save(c,b)}}),H=function(){G.instance(function(){return n.getSelectionStart().exists(p.inBody)},C)},I=function(a){var b=G.control.isBlocked();G.control.block();a=a();b||G.control.unblock();return a};x.editor().events.space.bind(H);x.editor().events.enter.bind(H);y.events.undo.bind(B);y.events.redo.bind(E);n.events.undoChanged.bind(H);n.events.loiter.bind(H);x=g.ui({"undo.general":{toggle:!1,value:"undo",textkey:a.key("action.undo"),action:B,shortcut:!0,updateGeneral:d.identity,
tooltip:f.get},"redo.general":{toggle:!1,value:"redo",textkey:a.key("action.redo"),action:E,shortcut:!0,updateGeneral:d.identity,tooltip:f.get}});return{undo:B,redo:E,save:H,checkChanged:function(){var a=D();return z.checkChanged(a,C)},reset:function(a){z.reset(q(a,a))},destroy:d.noop,state:function(){return t(z.state(),u)},rewrite:function(a,b){var c=function(c){return c.replace(a,b)};z.rewrite(function(a){return q(c(a.clean()),c(a.marked()))})},transaction:function(a){H();a=I(a);H();return a},disable:I,
replaceTop:function(){G.instance(d.constant(!0),d.constant(!0))},ui:x,events:A.registry}}});k("9z",["4n"],function(c){c=c.generate([{aboveView:["item"]},{inView:["item"]},{belowView:["item"]}]);return{aboveView:c.aboveView,inView:c.inView,belowView:c.belowView,cata:function(c,b,a,e){return c.fold(b,a,e)}}});k("8f","b 71 54 46 9z 3u 21 2a 6e 3t".split(" "),function(c,d,b,a,e,g,f,h,l,m){var n=function(a,b){var c=null;return{throttle:function(){var d=arguments;null!==c&&l(c);c=m(function(){a.apply(null,
d);d=c=null},b)}}};return function(l){var m=d.unbindable(),q=a.create({onChange:b([])}),k=n(function(){q.trigger.onChange()},1E3),t=function(){l.runOrOnLoaded(function(a){l.doc().each(function(a){m.set(g.bind(a,"scroll",function(a){k.throttle()}));k.throttle()})})};l.isInline()||t();var u=function(){return l.body().bind(function(a){return l.win().map(function(b){var d=b.innerHeight;b=h.children(a);var e=c.findIndex(b,function(a){if(!f.isElement(a))return!1;a=a.dom().getBoundingClientRect();return a.top<
d&&0<a.bottom});if(-1===e)return[a];var g=c.findIndex(b.slice(e+1),function(a){if(!f.isElement(a))return!1;a=a.dom().getBoundingClientRect();return!(a.top<d&&0<a.bottom)});return b.slice(e,-1<g?e+1+g:b.length)})}).getOr([])};return{sections:function(){return u()},setOn:t,setOff:function(){m.clear()},viewport:function(){return{assess:function(a){if(!f.isElement(a))return e.inView(a);var b=l.win().map(function(a){return a.innerHeight}).getOr(0),c=a.dom().getBoundingClientRect();b=0>c.bottom?e.aboveView:
c.top>b?e.belowView:e.inView;return b(a)}}},destroy:function(){m.clear()},events:q.registry}}});k("5i","b 7v c 7 s 7w 6a 7x 7y 7z 80 81 82 83 6o 84 85 86 87 88 89 8a 8b 8c 8d 8e 8f 53 73 3u 31 o".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,k,t,u,v,w,x,y,B,z,A,C,D,F,E,G,H,I,L){return function(J,K,M){var N=f(J),S=w(M.profile),Q=n(M.filters),P=r(),R=h(Q,P,J.content,K,M.content),O=B(K,Q,R),T=z(R,J.shortcuts),W=J.ui.layout.bounds(J.ui),X=A(R,W,K),V=!1!==J.fullscreen.bundled?p(R,T,J.fullscreen):E.fullscreen(),
aa=v(R,X,K,V,J.platform),ca=C(R,T,X,aa,V,K,J.ui,M.ui),Z=q(R,ca),ba=D(Q,R,Z,T,M.undo),ia=x(R,Z,ba),ga=t(Q,R),fa=m(R,ba,J.editorcontext),Y=F(R),na=y(ca,J.registration),ea=l(K,R,Z,T,X,J.contextmenu),$=u.onNodeChange(R,ga),U=k(M.laundry);ba.events.changed.bind(function(){U.setDirty(!0)});R.events.interaction.bind(function(a){!U.isDirty()&&ba.checkChanged()&&U.setDirty(!0)});var ja=b.detect(),ha=ja.deviceType.isTouch(),W=T.isHelpShortcutEnabled();M=!R.isInline()&&!ha&&J.ui.showHelpHint;J=g.editor(J.ui.editorName,
J.ui.isFullScreen);var ja=G.translate(ja.os.isOSX()?"aria.help.mac":"aria.help.ctrl"),W=W?e.some(ja):e.none(),la=(R.isInline()?d.inline:d.editor)(ca.element(),R.element(),J,W,M),da=e.none();R.runOrOnLoaded(function(a){var b=H.bind(a,"click",function(a){I.closest(a.target(),"a").each(function(b){I.closest(b,'[contenteditable="false"]').each(a.kill)})});da=e.some(b);ha&&(d.label(a,G.translate("aria.label.content")),d.region(ca.viewport()),d.region(ca.tabstrip.element()))});return{region:a.constant(K),
communication:a.constant(N),profile:a.constant(S),filter:a.constant(Q),internalevents:a.constant(P),content:a.constant(R),keyboard:a.constant(Z),shortcuts:a.constant(T),smartview:a.constant(X),undo:a.constant(ba),proximity:a.constant(ia),operations:a.constant(ga),context:a.constant(fa),fullscreen:a.constant(V),platform:a.constant(aa),registration:a.constant(na),contextmenu:a.constant(ea),ui:a.constant(ca),selections:a.constant(O),insertFilteredHtmlAtCursor:function(a){a=Q.filterHtml(Q.input(),a);
R.insertHtmlAtCursor(a)},viewablearea:a.constant(Y),laundry:a.constant(U),state:function(){return{ui:ca.state(),undo:ba.state(),content:R.state(),profile:S.state(),laundry:U.state()}},destroy:function(){da.each(function(a){a.unbind()});c.each([Y,$,ea,na,ca,aa,V,fa,ga,ia,ba,X,T,Z,O,R,Q,S,N],function(a){a.destroy?a.destroy():L.log("Feature missing destroy method: ",a)});la.destroy()}}}});k("o4",["4g"],function(c){return{resolve:c.create("ephox-hermes").resolve}});k("fy","o4 ed 7 54 46 1a 1y 3u l 32".split(" "),
function(c,d,b,a,e,g,f,h,l,m){var n=function(){var n=e.create({upload:a(["files"])}),r=l.fromTag("input");f.add(r,c.resolve("hidden"));f.add(r,c.resolve("file-selector-input"));g.setAll(r,{type:"file",accept:"image/*"});var q=h.bind(r,"change",function(a){a=d.toFiles(a);n.trigger.upload(a)});return{element:b.constant(r),open:function(){m.set(r,"");r.dom().click()},destroy:function(){q.unbind()},events:n.registry}};return{single:n,multiple:function(){var a=n();g.set(a.element(),"multiple","multiple");
return{element:a.element,open:a.open,destroy:a.destroy,events:a.events}}}});k("8g",["fy","ed","54","46"],function(c,d,b,a){return function(){var e=c.single(),g=a.create({upload:b(["assets"])});e.events.upload.bind(function(a){d.multiple(a.files()).get(function(a){g.trigger.upload(a)})});return{element:e.element,open:e.open,destroy:e.destroy,events:g.registry}}});k("8i",["s","bt","8p"],function(c,d,b){return function(a){var e=c.none(),g=function(b){f();b=d(b);b.events.close.bind(function(){e=c.none()});
e=c.some(b);a().displayBanner(b)},f=function(){e.each(a().hideBanner);e=c.none()};return{show:g,showKey:function(a){var c=b.get.apply(void 0,arguments);g(c)},hide:f,reset:function(){e=c.none()}}}});k("8j","b fz 7u 1a 3u l".split(" "),function(c,d,b,a,e,g){var f=function(b,f){return c.map(f,function(c){var f=g.fromTag("img"),l=e.bind(f,"load",function(){l.unbind();b.domChanged()});c=d.cata(c,function(a,b,c,d){return c},function(a,b,c){return b});a.set(f,"src",c);return f})};return{insertMobileAssets:function(a,
c,d,e){var g=f(a,e);return a.undoOperation(function(){var f=b.insertAt(a,c,g);d.uploadAssets(e);return f})},insertAssets:function(a,c,d){var e=f(a,d);a.focus();a.undoOperation(function(){b.insertAtCursor(a,e).each(function(b){a.setSelection(b.element(),b.offset(),b.element(),b.offset())});c.uploadAssets(d)})}}});k("w2",["4g"],function(c){return{resolve:c.create("ephox-gel").resolve}});k("rm","7v w2 6 54 46 1y 2n l 2o 2q 31".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){return function(p,r){var q=b.merge({layerClass:void 0,
zindex:void 0,padding:"0px"},p),k=e.create({exiting:a([])}),t=h.fromTag("div");c.presentation(t);g.add(t,d.resolve("modal"));g.add(t,d.resolve("modal-hidden"));f.setAll(t,{position:"fixed",left:q.padding,top:q.padding,right:q.padding,bottom:q.padding});void 0!==q.background&&f.set(t,"background",q.background);void 0!==q.zindex&&f.set(t,"z-index",q.zindex);void 0!==q.layerClass&&g.add(t,q.layerClass);var u=void 0!==r?r:n.first("body").getOrDie();l.append(u,t);return{element:function(){return t},content:function(a){m.empty(t);
l.append(t,a)},show:function(){g.add(u,d.resolve("modal-active"));g.remove(t,d.resolve("modal-hidden"));g.add(t,d.resolve("modal-show"))},hide:function(){g.remove(u,d.resolve("modal-active"));g.add(t,d.resolve("modal-hidden"));g.remove(t,d.resolve("modal-show"))},destroy:function(){m.remove(t);g.remove(u,d.resolve("modal-active"))},events:k.registry}}});k("w3","7v w2 6 zv 7 54 46 1y 2n 3u l 2o 2q 31 36".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,k){return function(t,u){var v=a.onChange(),w=f.create({exiting:g([])}),
x=b.merge({layerClass:null,zindex:null,padding:"0px",background:"rgba(0, 0, 0, 0.5)"},t),y=n.fromTag("div");c.presentation(y);h.add(y,d.resolve("moodal"));h.add(y,d.resolve("moodal-hidden"));l.setAll(y,{left:x.padding,top:x.padding,right:x.padding,bottom:x.padding});x.background&&l.set(y,"background",x.background);x.zindex&&l.set(y,"z-index",x.zindex);x.layerClass&&h.add(y,x.layerClass);var B=void 0!==u?u:q.first("body").getOrDie();p.append(B,y);var z=n.fromTag("div");c.presentation(z);h.add(z,d.resolve("moodal-flexor"));
p.append(y,z);var A=function(){l.setAll(z,{top:k.scrollY+"px",height:k.innerHeight+"px"})},C=function(){D.unbind();v.destroy();r.remove(y);h.remove(B,d.resolve("modal-active"))},D=m.bind(y,"click",function(){w.trigger.exiting();C()});v.events.ready.bind(function(){A()});return{element:e.constant(y),content:function(a){r.empty(z);p.append(z,a)},show:function(){h.add(B,d.resolve("moodal-active"));h.remove(y,d.resolve("moodal-hidden"));h.add(y,d.resolve("moodal-show"));A()},hide:function(){h.remove(B,
d.resolve("moodal-active"));h.add(y,d.resolve("moodal-hidden"));h.remove(y,d.resolve("moodal-show"))},destroy:C,events:w.registry}}});k("o6","c rm w3 w2 6 46 47 1y 2n 2o 2q 31".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p){return function(r){var q=e.deepMerge({layerClass:void 0,zindex:void 0,modal:{}},r);r=void 0!==r.container?r.container:p.first("body").getOrDie();var k=(c.detect().os.isiOS()?b:d)(q.modal,r),t=k.element(),u=g.create({exiting:f([],k.events.exiting)});void 0!==q.zindex&&l.set(t,"z-index",
q.zindex);void 0!==q.layerClass&&h.add(t,q.layerClass);h.add(t,a.resolve("centered-dialog"));m.append(r,t);return{content:k.content,show:function(){k.show()},hide:function(){k.hide()},destroy:function(){n.remove(t);k.destroy()},events:u.registry}}});k("o7","7v 2z c 4z 73 33 54 46 1a 1y 3u l 2y 2o 3c 2q".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,k,t){var u=b.detect().deviceType.isiOS();return function(){var b=function(a,b){m.add(a,g.resolve(b));return a},w=b(a.div(),"dialog"),x=b(a.div(),"top"),
y=b(a.span(),"dialog-title"),B=b(a.span(),"dialog-close"),z=b(a.div(),"dialog-content"),A=b(a.div(),"dialog-controls");l.set(w,"tabindex",-1);l.set(B,"tabindex",-1);c.button(B,e.translate("button.close"));var C=n.bind(B,"click",function(){D.trigger.close()});k.append(w,[x,z,A]);k.append(x,[y,B]);var D=h.create({close:f([])});return{element:function(){return w},focus:function(){r.focus(w)},setTitle:function(a){t.empty(y);q.append(y,p.fromText(a));u||(c.dialog(w,a),a=d.generate("ephox-aria"),l.set(y,
"id",a),c.labelledBy(w,a))},setContent:function(a){t.empty(z);q.append(z,a);a=d.generate("ephox-aria");l.set(z,"id",a);c.describedBy(w,a)},setControls:function(a){t.empty(A);q.append(A,a);a=d.generate("ephox-aria");l.set(A,"id",a);c.controls(w,a)},close:function(){D.trigger.close()},destroy:function(){t.remove(w);C.unbind()},events:D.registry}}});k("g3","c o6 s o7 3m 33 2m 3u".split(" "),function(c,d,b,a,e,g,f,h){var l=c.detect();return function(c){var n=a(),p=b.none(),r=d({container:c,layerClass:g.resolve("layer-dialog"),
modal:{layerClass:g.resolve("layer-below-dialog")}});r.content(n.element());r.events.exiting.bind(function(){e.unlock([f.body()]);n.close()});var q=function(){r.hide();e.unlock([f.body()])};return{element:n.element,destroy:function(){n.destroy();p.each(function(a){a.unbind()});q();r.destroy()},setTitle:n.setTitle,setContent:n.setContent,setControls:n.setControls,show:function(){r.content(n.element());r.show();n.focus();l.deviceType.isTouch()&&(p=b.some(h.bind(n.element(),"click",function(a){a.stop()})));
e.lock([f.body()])},hide:q,events:n.events}}});k("g4","g2 8h 7 s 31 m".split(" "),function(c,d,b,a,e,g){var f=function(b){b.dom().click();return a.some(b)};return{setup:function(a,b,e){b=c.dialog({execute:function(a){a.dom().click()},ok:b.ok().element(),cancel:b.cancel().element()});a=d.dialog(a.element(),e,b);return{enter:a.enter,exit:a.exit,destroy:a.destroy}},button:function(b){return(g.is(b,".ephox-pastry-button")?a.some(b):e.descendant(b,".ephox-pastry-button")).bind(f)},click:f,radio:function(a,
e,f){e={item:b.constant(e),selected:b.constant(f)};return d.radio(a,e,c.radio({one:function(a,b){b.dom().click()}}))}}});k("8l","7v c g2 g3 g4 73 g5 33 54 46 1y 3u l 3t 36".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,k){return function(t,u,v,w,x,y){var B=f.okCancel("file-upload"),z=w(x),A=null,C=d.detect(),D=m.create({close:l([]),analytics:l(["message"]),escaped:l([]),insertAssets:l(["assets"]),opened:l([])}),F=function(){A.unbind();G.hide();D.trigger.close();D.trigger.analytics("insert_image_closed");
E()},E=function(){z.reset();B.ok().disable()},G=a(v);G.setTitle(g.translate("fileupload.title"));G.setContent(z.element());G.setControls(B.element());G.events.close.bind(F);n.add(G.element(),h.resolve("imageupload-dialog"));var H=y(G.element(),z.keylayouts(),b.dialog({cancel:B.cancel().element(),ok:B.ok().element(),execute:e.click,index:0}));z.events.upload.bind(function(a){D.trigger.insertAssets(a.assets());F()});z.events.dragndrop.bind(function(a){D.trigger.insertAssets(a.assets());F()});z.events.success.bind(function(a){B.ok().enable()});
z.events.lookup.bind(function(a){B.ok().disable()});z.events.setActive.bind(function(a){E()});B.events.ok.bind(function(){z.selected().each(function(a){D.trigger.insertAssets([a]);F()})});B.events.cancel.bind(F);E();return{show:function(){C.deviceType.isiOS()&&(c.hidden(u.element(),!0),q(function(){z.focus();c.hidden(u.element(),!1)},250));G.show();H.enter();D.trigger.analytics("insert_image_opened");D.trigger.opened();var a=r.fromDom(k);A=p.bind(a,"orientationchange",function(){t.foreground()})},
element:G.element,events:D.registry,destroy:function(){H.exit();H.destroy();G.hide();G.destroy();z.destroy();B.destroy()}}}});k("o8","fz o4 7 1a 1y 1s".split(" "),function(c,d,b,a,e,g){return{previewAsset:function(f,g){c.cata(f,b.die("asset should not be a file type"),function(b,c,f){e.add(g,d.resolve("fluid-image"));a.set(g,"src",c)})}}});k("o9","7v 2z c n2 o4 ed 4z 7 9u s 54 46 1a 1y 3u l 2y 2o 3c 32 n3".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,k,t,u,v,w,x,y){var B=b.detect();return function(b){var y=
p.create({success:n(["assets"]),invalidUrl:n(["url"]),empty:n([]),lookup:n([])}),C=[],D=f.div(),F=q.toggler(D,e.resolve("url-indicator-loading")),E=a();E.events.start.bind(function(){F.on()});E.events.fail.bind(function(a){F.off();y.trigger.invalidUrl(a.url());C=[]});E.events.success.bind(function(a){F.off();var b=x.get(L);a.url()===b?g.fromImages([a.image()]).get(function(a){C=a;y.trigger.success(C)}):E.go(b)});var G=f.div();q.add(G,e.resolve("url-selector"));var H=t.fromTag("label");b=t.fromText(b("fileupload.web.url"));
var I=d.generate(e.resolve("input-id"));r.set(H,"for",I);q.add(H,e.resolve("url-input-label"));v.append(H,b);var L=t.fromTag("input");r.setAll(L,{id:I,type:"url",placeholder:"http://www.example.com/image.jpg"});q.add(L,e.resolve("url-input"));B.os.isAndroid()&&r.set(L,"autofocus","true");c.required(L);b=t.fromHtml("<span role=presentation>*</span>");q.add(b,e.resolve("url-input-required"));v.append(H,b);w.append(G,[H,L,D]);var J=l(function(a){""!==a&&E.go(a)},1E3),K=k.bind(L,"input",function(){var a=
x.get(L);""===a.trim()?(y.trigger.empty(),J.throttle("")):(y.trigger.lookup(),J.throttle(a))});return{element:h.constant(G),input:h.constant(L),events:y.registry,reset:function(){F.off();x.set(L,"")},focus:function(){u.focus(L)},selected:function(){return m.from(C[0])},destroy:function(){K.unbind()}}}});k("g8","b 7v 2z o4 o8 o9 4z 7 54 46 1a 1y l 2o 3c 2q n3".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,k,t,u){return function(u){var w=m.create({lookup:l([]),success:l([])}),x=f.span(),y=r.fromHtml('<div role=presentation><span role=presentation class="'+
a.resolve("url-input-required")+'">*</span> '+u("fileupload.weburlhelp")+"</div>"),B=b.generate(a.resolve("help-message"));n.set(y,"id",B);p.add(y,a.resolve("fileupload-weburl-help"));var z=r.fromHtml("<div role=presentation><div role=presentation>"+u("fileupload.invalid1")+"</div><div role=presentation>"+u("fileupload.invalid2")+"</div><div role=presentation>"+u("fileupload.invalid3")+"</div></div>");p.add(z,a.resolve("fileupload-weburl-help"));p.add(z,a.resolve("fileupload-weburl-help-invalid"));
var A=function(a){t.empty(E);q.append(E,a)},C=function(a){var b=r.fromTag("img");q.append(E,b);e.previewAsset(a,b)},D=f.div();p.add(D,a.resolve("web-url-container"));var F=g(u),E=f.div();p.add(E,a.resolve("image-preview-container"));u=b.generate("ephox-hermes-url-state");d.live(E,u,"polite");d.controls(F.input(),u);d.describedBy(F.input(),B);B=f.div();p.add(B,a.resolve("hbox"));k.append(B,[F.element(),E,y]);q.append(D,B);F.events.lookup.bind(function(a){w.trigger.lookup();t.empty(E)});F.events.success.bind(function(a){c.each(a.assets(),
C);w.trigger.success()});F.events.invalidUrl.bind(function(){A(z)});F.events.empty.bind(function(){A(x)});A(x);return{element:h.constant(D),selected:F.selected,input:F.input,events:w.registry,focus:F.focus,reset:function(){A(x);F.reset()},destroy:function(){F.destroy()}}}});k("g6","g8 g2 8h 4z 7 73 54 46 47 2o".split(" "),function(c,d,b,a,e,g,f,h,l,m){return function(n){n=a.div();var p=c(g.translate),r=h.create({upload:f(["assets"]),dragndrop:f(["assets"]),dragover:f([]),dragleave:f([]),drop:f([]),
setActive:f(["item"]),lookup:l([],p.events.lookup),success:l([],p.events.success)}),q=[function(){var a=p.input();return b.input(a,d.input({}))}()];m.append(n,p.element());return{element:e.constant(n),events:r.registry,keylayouts:e.constant(q),reset:function(){p.reset()},focus:p.focus,selected:p.selected,destroy:function(){p.destroy()}}}});k("8k","a5 a6 b 7v g0 8g 8h 6 g1 7 s 8l g6 73 74 54 46 l 3c q".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q,k,t,u,v,w,x){return function(y,B,z,A,C){var D=u.create({insertAsset:t(["asset"]),
open:t([]),done:t([]),abort:t([])}),F=v.fromDom(x);A=e.mainmenu(F,"file-upload-menu",[]);var E=function(b,c){var d=e.item(F,b,q.get(c)+"...");a.menuItem(d,n.some(q.get(c)),n.none());return d},G=E("from-url",q.key("image.from-url")),E=E("from-camera",q.key("image.from-camera")),G=!0===C.allowLocalImages?[G,E]:[G],H=g();H.events.upload.bind(function(a){n.from(a.assets()[0]).each(function(a){L();D.trigger.insertAsset(a)})});var I=function(a){a=a.assets();b.each(a,function(a){D.trigger.insertAsset(a)})},
L=function(){l.target(z.uiContainer(),"mousedown")};w.append(A,G);A={name:"image",textkey:q.key("image.menu-button"),menuTextkey:q.key("image.menu"),icon:n.none,tooltip:k.get,contentFocus:!1,toggle:!1};G=[[{handlers:m.constant({"from-url":function(a){D.trigger.open();var b=p(y,B,z.uiContainer(),r,C,f.dialog);b.events.insertAssets.bind(I);a=function(){y.focus();b.destroy()};b.events.opened.bind(L);b.events.close.bind(a);b.events.escaped.bind(a);b.show()},"from-camera":function(){D.trigger.open();H.open()}}),
destroyer:m.noop,refreshMenu:m.noop,structure:m.constant({}),submenus:m.constant([]),items:m.constant(G),events:D.registry}]];A=c.menu(A,G,q.get,d.menu({focusActive:!0}));G={label:m.constant(!1),hasDialog:!0};return h.merge(A,G)}});k("w4",["kz","s","1a","l"],function(c,d,b,a){return function(e){var g=a.fromTag("button");b.set(g,"type","button");return c(g,d.none(),e)}});k("oa","er ec fy o4 4z w4 dv 7 s 1y l 2y 2o 3c".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,q){return function(k){var t=b.multiple(),
u=e.div();m.add(u,a.resolve("drop-container"));var v=d.register(u,l.some(a.resolve("drop-active")),!1),w=g();w.content(f(k("fileupload.chooseimage")));m.add(w.element(),a.resolve("default-action"));m.add(w.element(),a.resolve("file-selector-trigger"));var x=n.fromTag("p");m.add(x,a.resolve("help-text-drop-icon"));var y=n.fromTag("p");m.add(y,a.resolve("help-text-drop"));c.disable(y);r.append(y,n.fromText(k("fileupload.dropimages")));q.append(u,[x,y,w.element(),t.element()]);return{container:h.constant(u),
dropper:h.constant(v),picker:h.constant(t),button:h.constant(w),focus:function(){p.focus(w.element())},destroy:function(){t.destroy();v.destroy();w.destroy()}}}});k("g7","oa ed 7 54 46 47".split(" "),function(c,d,b,a,e,g){return function(f){var h=c(f);f=h.picker();var l=h.container(),m=h.dropper(),n=h.button(),p=e.create({upload:a(["assets"]),dragndrop:a(["assets"]),dragover:g([],m.events.dragover),dragleave:g([],m.events.dragleave),drop:g([],m.events.drop)}),r=function(a){return function(b){d.multiple(b.files()).get(function(b){a(b)})}};
f.events.upload.bind(r(p.trigger.upload));m.events.dragndropimages.bind(r(p.trigger.dragndrop));n.events.click.bind(f.open);return{element:b.constant(l),button:b.constant(n),input:f.element,focus:h.focus,events:p.registry,destroy:function(){h.destroy()}}}});k("g9","b 4z ob dv l0 7 54 46 2u 1a 1y l 2o 3c".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,k){return function(s,t,u){var v=[],w=l.immutable("view","item","container"),x=h.create({setActive:f(["item"])}),y=d.div();n.add(y,e.resolve("tablayout-wrapper"));
n.add(y,e.resolve("tablayout-wrapper-"+s));void 0!==u&&n.add(y,u);var B=d.div();n.add(B,e.resolve("tablayout-body"));var z=p.fromTag("div");n.add(z,e.resolve("tablayout-menu"));k.append(y,[z,B]);var A=function(c){var d=b(c);d.content(a(c));n.add(d.element(),e.resolve("tablayout-item"));return d},C=[],D=c.map(t,function(a){var b=A(a.heading());m.set(b.element(),"data-ephox-pastry-tablayout-tab",a.heading());r.append(z,b.element());var c=p.fromTag("div");n.add(c,e.resolve("tablayout-content"));m.set(c,
"data-ephox-pastry-tablayout-view",a.heading());r.append(B,c);C.push(c);var d=w(a,b,c);v.push(d);b.events.click.bind(function(){F(d)});return b}),F=function(a){c.each(v,function(b){var c=b.view(),d=b.item(),f=b.container();b===a?(n.add(f,e.resolve("tablayout-active")),d.select(),c.renderer().render(f),x.trigger.setActive(d)):(n.remove(f,e.resolve("tablayout-active")),d.deselect())})};F(v[0]);return{element:function(){return y},tabs:g.constant(D),body:g.constant(B),menu:g.constant(z),tabContent:g.constant(C),
destroy:function(){c.each(D,function(a){a.destroy()})},events:x.registry}}});k("ga",["2o","2q"],function(c,d){return function(b){return{render:function(a){d.empty(a);c.append(a,b)}}}});k("gb",["2u"],function(c){return c.immutable("heading","renderer")});k("gc",["7"],function(c){return{left:c.constant("left"),top:c.constant("top")}});k("8m","b 7v 2z c g7 g8 g2 8h 6 4z g9 ga gb gc 7 g4 73 33 46 47 1a 1y 2o".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,k,s,t,u,v,w,x,y,B,z){return function(A){var C=
m.div(),D=e(u.translate),F=g(u.translate),E=function(a,b){var c=u.translate(a),d=p(b);return r(c,d)},G=E("fileupload.tabweburl",F.element());A=(A.allowLocalImages?[E("fileupload.tablocal",D.element())]:[]).concat(G);var H=n(k.top(),A,"file-upload");d.hidden(D.input(),!0);E=function(){var b=D.button();B.add(b.element(),v.resolve("dialog-button-default"));var c=a.detect().browser.isFirefox(),d={execute:t.button},c=c?l.merge(d,{process:s.noop}):d,c=f.button(c);return h.button(b.element(),c)}();d.tabList(H.menu());
var G=function(){var a=F.input();return h.input(a,f.input({}))}(),I=h.flow(H.menu(),{item:s.constant(".ephox-pastry-statebutton")},f.flow({trigger:t.button,executeOnArrow:!0})),E=[I].concat(E).concat(G),L=H.tabs();c.each(H.tabContent(),function(a){d.tabPanel(a)});c.each(A,function(a,b){var c=L[b];d.tabButton(c.element(),a.heading());B.add(c.element(),v.resolve("tab-button"));c.events.click.bind(function(){I.clickFocus(c.element())})});c.each(H.tabContent(),function(a,c){var e=L[c],f=b.generate("ephox-aria");
y.set(e.element(),"id",f);d.labelledBy(a,f)});A=w.create({upload:x(["assets"],D.events.upload),dragndrop:x(["assets"],D.events.dragndrop),dragover:x([],D.events.dragover),dragleave:x([],D.events.dragleave),drop:x([],D.events.drop),lookup:x([],F.events.lookup),success:x([],F.events.success),setActive:x(["item"],H.events.setActive)});H.events.setActive.bind(function(a){a=y.get(a.item().element(),"data-ephox-pastry-tablayout-tab");a===u.translate("fileupload.tablocal")?D.focus():a===u.translate("fileupload.tabweburl")&&
F.focus()});z.append(C,H.element());return{element:s.constant(C),events:A.registry,focus:F.focus,keylayouts:s.constant(E),reset:function(){F.reset()},selected:F.selected,destroy:function(){H.destroy();D.destroy();F.destroy()}}}});k("8n",["a","b","fz","7"],function(c,d,b,a){var e=["image"],g=function(a,b,g,m){return d.exists(e,function(a){return c.isString(b.type)&&-1<b.type.indexOf(a)})};return{validate:function(c){c=d.foldl(c,function(c,d){return!1===b.cata(d,g,a.constant(!0))?{assets:c.assets,failure:!0}:
{assets:c.assets.concat([d]),failure:c.failure}},{assets:[],failure:!1});return{assets:a.constant(c.assets),failure:a.constant(c.failure)}}}});k("gd",["ed"],function(c){return{multiple:function(d){return c.multiple(d)},single:function(d){return c.single(d)},singleWithUrl:function(d,b){return c.singleWithUrl(d,b)}}});k("w5",[],function(){function c(c,b,a){c.width=b;c.height=a;return c}return{create:function(d,b){return c(document.createElement("canvas"),d,b)},resize:c,get2dContext:function(c){return c.getContext("2d")},
get3dContext:function(c){var b=null;try{b=c.getContext("webgl")||c.getContext("experimental-webgl")}catch(a){}b||(b=null);return b}}});k("w6",[],function(){return{getWidth:function(c){return c.naturalWidth||c.width},getHeight:function(c){return c.naturalHeight||c.height}}});k("w7",[],function(){function c(a,b){return function(){a.apply(b,arguments)}}function d(b){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof b)throw new TypeError("not a function");
this._value=this._state=null;this._deferreds=[];h(b,c(a,this),c(e,this))}function b(a){var b=this;null===this._state?this._deferreds.push(a):l(function(){var c=b._state?a.onFulfilled:a.onRejected;if(null===c)(b._state?a.resolve:a.reject)(b._value);else{var d;try{d=c(b._value)}catch(e){a.reject(e);return}a.resolve(d)}})}function a(b){try{if(b===this)throw new TypeError("A promise cannot be resolved with itself.");if(b&&("object"===typeof b||"function"===typeof b)){var d=b.then;if("function"===typeof d){h(c(d,
b),c(a,this),c(e,this));return}}this._state=!0;this._value=b;g.call(this)}catch(f){e.call(this,f)}}function e(a){this._state=!1;this._value=a;g.call(this)}function g(){for(var a=0,c=this._deferreds.length;a<c;a++)b.call(this,this._deferreds[a]);this._deferreds=null}function f(a,b,c,d){this.onFulfilled="function"===typeof a?a:null;this.onRejected="function"===typeof b?b:null;this.resolve=c;this.reject=d}function h(a,b,c){var d=!1;try{a(function(a){d||(d=!0,b(a))},function(a){d||(d=!0,c(a))})}catch(e){d||
(d=!0,c(e))}}if(window.Promise)return window.Promise;var l=d.immediateFn||"function"===typeof setImmediate&&setImmediate||function(a){setTimeout(a,1)},m=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)};d.prototype["catch"]=function(a){return this.then(null,a)};d.prototype.then=function(a,c){var e=this;return new d(function(d,g){b.call(e,new f(a,c,d,g))})};d.all=function(){var a=Array.prototype.slice.call(1===arguments.length&&m(arguments[0])?arguments[0]:arguments);
return new d(function(b,c){function d(f,g){try{if(g&&("object"===typeof g||"function"===typeof g)){var h=g.then;if("function"===typeof h){h.call(g,function(a){d(f,a)},c);return}}a[f]=g;0===--e&&b(a)}catch(l){c(l)}}if(0===a.length)return b([]);for(var e=a.length,f=0;f<a.length;f++)d(f,a[f])})};d.resolve=function(a){return a&&"object"===typeof a&&a.constructor===d?a:new d(function(b){b(a)})};d.reject=function(a){return new d(function(b,c){c(a)})};d.race=function(a){return new d(function(b,c){for(var d=
0,e=a.length;d<e;d++)a[d].then(b,c)})};return d});k("w8",[],function(){return{guessMimeType:function(c){var d=document.createElement("a");d.href=c;c=d.pathname.split(".");(c=c[c.length-1])&&(c=c.toLowerCase());return{jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png"}[c]}}});k("p7",["w7","w5","w8","w6"],function(c,d,b,a){function e(a){return new c(function(b){function c(){a.removeEventListener("load",c);b(a)}a.complete?b(a):a.addEventListener("load",c)})}function g(b){return e(b).then(function(b){var c;
c=d.create(a.getWidth(b),a.getHeight(b));d.get2dContext(c).drawImage(b,0,0);return c})}function f(a){return new c(function(b){var c=new XMLHttpRequest;c.open("GET",a,!0);c.responseType="blob";c.onload=function(){200==this.status&&b(this.response)};c.send()})}function h(a){return new c(function(b){var c,d,e,f,g;a=a.split(",");(c=/data:([^;]+)/.exec(a[0]))&&(f=c[1]);c=atob(a[1]);if(window.WebKitBlobBuilder){g=new WebKitBlobBuilder;d=new ArrayBuffer(c.length);for(e=0;e<d.length;e++)d[e]=c.charCodeAt(e);
g.append(d);b(g.getBlob(f))}else{d=new Uint8Array(c.length);for(e=0;e<d.length;e++)d[e]=c.charCodeAt(e);b(new Blob([d],{type:f}))}})}function l(a){return new c(function(b){var c=new FileReader;c.onloadend=function(){b(c.result)};c.readAsDataURL(a)})}return{blobToImage:function(a){return new c(function(b){function c(){d.removeEventListener("load",c);b(d)}var d=new Image;d.addEventListener("load",c);d.src=URL.createObjectURL(a);d.complete&&c()})},imageToBlob:function(a){return e(a).then(function(a){var c=
a.src;return 0===c.indexOf("blob:")?f(c):0===c.indexOf("data:")?h(c):g(a).then(function(a){return h(a.toDataURL(b.guessMimeType(c)))})})},blobToDataUri:l,blobToBase64:function(a){return l(a).then(function(a){return a.split(",")[1]})},imageToCanvas:g,canvasToBlob:function(a,b){return h(a.toDataURL(b))},revokeImageUrl:function(a){URL.revokeObjectURL(a.src)},uriToBlob:function(a){return 0===a.indexOf("blob:")?f(a):0===a.indexOf("data:")?h(a):null}}});k("w9",[],function(){function c(a,b,c){a=parseFloat(a);
a>c?a=c:a<b&&(a=b);return a}function d(a,b){var c,d,l,m,n=[],p=Array(10);for(c=0;5>c;c++){for(d=0;5>d;d++)n[d]=b[d+5*c];for(d=0;5>d;d++){for(l=m=0;5>l;l++)m+=a[d+5*l]*n[l];p[d+5*c]=m}}return p}function b(a,b){b=c(b,0,1);return a.map(function(a,d){a=0===d%6?1-(1-a)*b:a*b;return c(a,0,1)})}var a=[0,0.01,0.02,0.04,0.05,0.06,0.07,0.08,0.1,0.11,0.12,0.14,0.15,0.16,0.17,0.18,0.2,0.21,0.22,0.24,0.25,0.27,0.28,0.3,0.32,0.34,0.36,0.38,0.4,0.42,0.44,0.46,0.48,0.5,0.53,0.56,0.59,0.62,0.65,0.68,0.71,0.74,0.77,
0.8,0.83,0.86,0.89,0.92,0.95,0.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10];return{identity:function(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]},adjust:b,multiply:d,adjustContrast:function(b,g){var f;g=c(g,-1,1);g*=100;0>g?f=127+g/100*127:(f=g%1,f=0===f?a[g]:a[Math.floor(g)]*(1-f)+a[Math.floor(g)+1]*f,f=127*f+127);return d(b,
[f/127,0,0,0,0.5*(127-f),0,f/127,0,0,0.5*(127-f),0,0,f/127,0,0.5*(127-f),0,0,0,1,0,0,0,0,0,1])},adjustBrightness:function(a,b){b=c(255*b,-255,255);return d(a,[1,0,0,0,b,0,1,0,0,b,0,0,1,0,b,0,0,0,1,0,0,0,0,0,1])},adjustSaturation:function(a,b){var f;b=c(b,-1,1);f=1+(0<b?3*b:b);return d(a,[0.3086*(1-f)+f,0.6094*(1-f),0.082*(1-f),0,0,0.3086*(1-f),0.6094*(1-f)+f,0.082*(1-f),0,0,0.3086*(1-f),0.6094*(1-f),0.082*(1-f)+f,0,0,0,0,0,1,0,0,0,0,0,1])},adjustHue:function(a,b){var f,h;b=c(b,-180,180)/180*Math.PI;
f=Math.cos(b);h=Math.sin(b);return d(a,[0.213+0.787*f+-0.213*h,0.715+-0.715*f+-0.715*h,0.072+-0.072*f+0.928*h,0,0,0.213+-0.213*f+0.143*h,0.715+f*(1-0.715)+0.14*h,0.072+-0.072*f+-0.283*h,0,0,0.213+-0.213*f+-0.787*h,0.715+-0.715*f+0.715*h,0.072+0.928*f+0.072*h,0,0,0,0,0,1,0,0,0,0,0,1])},adjustColors:function(a,b,f,h){b=c(b,0,2);f=c(f,0,2);h=c(h,0,2);return d(a,[b,0,0,0,0,0,f,0,0,0,0,0,h,0,0,0,0,0,1,0,0,0,0,0,1])},adjustSepia:function(a,g){g=c(g,0,1);return d(a,b([0.393,0.769,0.189,0,0,0.349,0.686,0.168,
0,0,0.272,0.534,0.131,0,0,0,0,0,1,0,0,0,0,0,1],g))},adjustGrayscale:function(a,g){g=c(g,0,1);return d(a,b([0.33,0.34,0.33,0,0,0.33,0.34,0.33,0,0,0.33,0.34,0.33,0,0,0,0,0,1,0,0,0,0,0,1],g))}}});k("oc",["w5","w6","p7","w9"],function(c,d,b,a){function e(a,e){return b.blobToImage(a).then(function(a){var f=c.create(d.getWidth(a),d.getHeight(a)),g=c.get2dContext(f);g.drawImage(a,0,0);m(a);a=g.getImageData(0,0,f.width,f.height);var h=a.data,l,n,k,x,y,B=e[0],z=e[1],A=e[2],C=e[3],D=e[4],F=e[5],E=e[6],G=e[7],
H=e[8],I=e[9],L=e[10],J=e[11],K=e[12],M=e[13],N=e[14],S=e[15],Q=e[16],P=e[17],R=e[18],O=e[19];for(y=0;y<h.length;y+=4)l=h[y],n=h[y+1],k=h[y+2],x=h[y+3],h[y]=l*B+n*z+k*A+x*C+D,h[y+1]=l*F+n*E+k*G+x*H+I,h[y+2]=l*L+n*J+k*K+x*M+N,h[y+3]=l*S+n*Q+k*P+x*R+O;g.putImageData(a,0,0);return b.canvasToBlob(f)})}function g(a,e){return b.blobToImage(a).then(function(a){var f=c.create(d.getWidth(a),d.getHeight(a)),g=c.get2dContext(f),h;g.drawImage(a,0,0);m(a);a=g.getImageData(0,0,f.width,f.height);h=g.getImageData(0,
0,f.width,f.height);h=function(a,b,c){function d(a,b,c){a>c?a=c:a<b&&(a=b);return a}var e,f,g,h,l,m,n,p,r,k,q,s,t,K;g=Math.round(Math.sqrt(c.length));h=Math.floor(g/2);e=a.data;f=b.data;t=a.width;K=a.height;for(l=0;l<K;l++)for(a=0;a<t;a++){for(k=m=n=p=0;k<g;k++)for(r=0;r<g;r++)q=d(a+r-h,0,t-1),s=d(l+k-h,0,K-1),q=4*(s*t+q),s=c[k*g+r],m+=e[q]*s,n+=e[q+1]*s,p+=e[q+2]*s;q=4*(l*t+a);f[q]=d(m,0,255);f[q+1]=d(n,0,255);f[q+2]=d(p,0,255)}return b}(a,h,e);g.putImageData(h,0,0);return b.canvasToBlob(f)})}function f(a){return function(e,
f){return b.blobToImage(e).then(function(e){var g=c.create(d.getWidth(e),d.getHeight(e)),h=c.get2dContext(g),l,p=Array(256);for(l=0;l<p.length;l++)p[l]=a(l,f);h.drawImage(e,0,0);m(e);e=h.getImageData(0,0,g.width,g.height);l=e.data;var k;for(k=0;k<l.length;k+=4)l[k]=p[l[k]],l[k+1]=p[l[k+1]],l[k+2]=p[l[k+2]];h.putImageData(e,0,0);return b.canvasToBlob(g)})}}function h(b){return function(c,d){return e(c,b(a.identity(),d))}}function l(a){return function(b){return g(b,a)}}var m=b.revokeImageUrl;return{invert:function(a){return function(b){return e(b,
a)}}([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0]),brightness:h(a.adjustBrightness),hue:h(a.adjustHue),saturate:h(a.adjustSaturation),contrast:h(a.adjustContrast),grayscale:h(a.adjustGrayscale),sepia:h(a.adjustSepia),colorize:function(b,c,d,f){return e(b,a.adjustColors(a.identity(),c,d,f))},sharpen:l([0,-1,0,-1,5,-1,0,-1,0]),emboss:l([-2,-1,0,-1,1,1,0,1,2]),gamma:f(function(a,b){return 255*Math.pow(a/255,1-b)}),exposure:f(function(a,b){return 255*(1-Math.exp(-(a/255)*b))}),colorFilter:e,convoluteFilter:g}});
k("wa",["w7","p7","w5","w6"],function(c,d,b,a){function e(b,c,d){var m=a.getWidth(b),n=a.getHeight(b),m=c/m,p=d/n,n=!1;if(0.5>m||2<m)m=0.5>m?0.5:2,n=!0;if(0.5>p||2<p)p=0.5>p?0.5:2,n=!0;b=g(b,m,p);return n?b.then(function(a){return e(a,c,d)}):b}function g(d,e,g){return new c(function(c){var n=a.getWidth(d),p=a.getHeight(d),r=Math.floor(n*e),k=Math.floor(p*g),s=b.create(r,k);b.get2dContext(s).drawImage(d,0,0,n,p,0,0,r,k);c(s)})}return{scale:e}});k("od",["p7","w5","w6","wa"],function(c,d,b,a){var e=
c.revokeImageUrl,g=function(a){return function(b){e(a);return b}};return{rotate:function(a,g){return c.blobToImage(a).then(function(l){var m=d.create(b.getWidth(l),b.getHeight(l)),n=d.get2dContext(m),p=0,r=0;g=0>g?360+g:g;90!=g&&270!=g||d.resize(m,m.height,m.width);if(90==g||180==g)p=m.width;if(270==g||180==g)r=m.height;n.translate(p,r);n.rotate(g*Math.PI/180);n.drawImage(l,0,0);e(l);return c.canvasToBlob(m,a.type)})},flip:function(a,g){return c.blobToImage(a).then(function(a){var f=d.create(b.getWidth(a),
b.getHeight(a)),n=d.get2dContext(f);"v"==g?(n.scale(1,-1),n.drawImage(a,0,-f.height)):(n.scale(-1,1),n.drawImage(a,-f.width,0));e(a);return c.canvasToBlob(f)})},crop:function(a,b,g,m,n){return c.blobToImage(a).then(function(a){var f=d.create(m,n);d.get2dContext(f).drawImage(a,-b,-g);e(a);return c.canvasToBlob(f)})},resize:function(b,d,e){return c.blobToImage(b).then(function(m){var n=g(m);return a.scale(m,d,e).then(function(a){return c.canvasToBlob(a,b.type)}).then(n,n)})}}});k("gg",["oc","od"],function(c,
d){return{invert:function(b){return c.invert(b)},sharpen:function(b){return c.sharpen(b)},emboss:function(b){return c.emboss(b)},brightness:function(b,a){return c.brightness(b,a)},hue:function(b,a){return c.hue(b,a)},saturate:function(b,a){return c.saturate(b,a)},contrast:function(b,a){return c.contrast(b,a)},grayscale:function(b,a){return c.grayscale(b,a)},sepia:function(b,a){return c.sepia(b,a)},colorize:function(b,a,d,g){return c.colorize(b,a,d,g)},gamma:function(b,a){return c.gamma(b,a)},exposure:function(b,
a){return c.exposure(b,a)},flip:function(b,a){return d.flip(b,a)},crop:function(b,a,c,g,f){return d.crop(b,a,c,g,f)},resize:function(b,a,c){return d.resize(b,a,c)},rotate:function(b,a){return d.rotate(b,a)}}});k("9c",["gf","gg"],function(c,d){var b=function(a){return function(b){return d.rotate(b,a)}},a=function(a){return function(b){return d.flip(b,a)}},e=function(a){return function(b){return d.resize(b,a.width(),a.height())}},g=c.pToFR(d.sharpen),f=c.pToFR(b(-90)),b=c.pToFR(b(90)),h=c.pToFR(a("v")),
a=c.pToFR(a("h"));return{rotateLeft:f,rotateRight:b,flipVertical:h,flipHorizontal:a,sharpen:g,crop:function(a,b,e,f){return c.pToFR(function(c){return d.crop(c,a,b,e,f)})},resizeTo:function(a){return c.pToFR(e(a))}}});k("gh",["gf"],function(c){return{mapIfSet:function(d,b){return c.map(d,function(a){return a.map(b)})},applyIfSet:function(d){return function(b){return c.bind(d,function(a){return a.fold(function(){return c.pure(b)},function(a){return a(b)})})}}}});k("9v",["b"],function(c){return{partition:function(d){var b=
[],a=[];c.each(d,function(c){c.fold(function(a){b.push(a)},function(b){a.push(b)})});return{errors:b,values:a}}}});k("oe",["2u"],function(c){return c.immutable("width","height")});k("wb",["4n","on"],function(c,d){var b=c.generate([{special:["size"]},{regular:["value","size","unit"]}]);return{identify:function(a){a=a.match(/(\d*\.?\d*)(.*)/);return""!==a[1]?b.regular(a[0],d(a[1]),a[2]):b.special(a[0])}}});k("of","s oe wb 2u 1a 2n 6d 2r dg".split(" "),function(c,d,b,a,e,g,f,h,l){var m=function(a,d){return g.getRaw(a,
d).orThunk(function(){return e.has(a,d)?c.some(e.get(a,d)):c.none()}).bind(function(a){return b.identify(a).fold(function(a){return c.none()},function(a,b,d){switch(d){case "":case "px":return c.some(l(b,10));default:return c.none()}})})},n=function(a,b,d){b=b(a);return 0<b?c.some(b):m(a,d)};return{get:function(a){return n(a,h.get,"width").bind(function(b){return n(a,f.get,"height").map(function(a){return d(b,a)})})},measure:n}});k("og",[],function(){var c=function(a,b){var c=b/a;return 1>c?c:1},
d=function(a,b){var d=c(a.height,b.height);return 1===d?a:{width:a.width*d,height:b.height}},b=function(a,b){var d=c(a.width,b.width);return 1===d?a:{width:b.width,height:a.height*d}};return{max:function(a,c){var g=0<c.height?c.height:0,f=0<c.width?c.width:0;if(!(a.height>g||a.width>f)||g===f&&0===g)return a;var g={width:f,height:g},f=a.width>a.height,h=0<g.height,l=(h?a.height/g.height:0)>(0<g.width?a.width/g.width:0);return(g.width===g.height&&f||!h||!l?b:d)(a,g)}}});k("gi","ge s oe gf of eo og".split(" "),
function(c,d,b,a,e,g,f){var h=function(b){var d=c.createObjectURL(b);return a.map(g.load(d),function(a){a=l(a);c.revokeObjectURL(d);return a})},l=function(a){return b(a.dom().naturalWidth,a.dom().naturalHeight)},m=function(a){var b=l(a);return e.get(a).filter(function(a){return a.width()!==b.width()||a.height()!==b.height()})};return{restrain:function(c){var e=c.width(),g=c.height(),l=function(a){var c=f.max({width:a.width(),height:a.height()},{width:e,height:g});return a.height()>g||a.width()>e?
d.some(b(c.width,c.height)):d.none()};return function(b){b=h(b);return a.map(b,l)}},changedBounds:function(b){return a.map(g.loadIfNeeded(b),m)}}});k("8o","fz gd ge 9c gf gh 9v gi o".split(" "),function(c,d,b,a,e,g,f,h,l){var m=function(b){b=g.mapIfSet(b,a.resizeTo);return g.applyIfSet(b)},n=function(a,b,c){return e.fromChain([m(a),c])(b)};return{instance:function(a){var f=h.restrain(a);return function(a){return c.cata(a,function(c,g,h,l){c=f(g);return n(c,g,function(c){if(c===g)return e.pure(a);
b.revokeObjectURL(h);return e.fromFuture(d.single(c))})},function(){return e.pure(a)})}},processResults:function(a){return function(b){b=f.partition(b);0<b.errors.length&&(a("imageedit.generic"),l.error("Image resample errors: ",b.errors));return b.values}},resampleAction:n}});k("5j","8g 8h 7 8i 8j 8k 8l 8m 8n 73 8o 8p 6t 54 46".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,k,s){return function(t,u,v,w,x){var y=t.content(),B=t.smartview(),z=t.ui().tabstrip,A=a(t.ui),C=n.processResults(A.showKey),
D=function(a){t.undo().save();a=l.validate(a);(a.failure()?b.curry(A.showKey,"fileupload.invalidimages"):A.hide)();v.assets(a.assets()).map(C).get(function(a){e.insertAssets(y,u,a)})},F=function(a){D(a.assets())};w.events.insertAssets.bind(function(a){x.allowLocalImages?D(a.assets()):p.getOrLog("errors.dragdrop.images.disallowed")});var E=y.cursor();w=s.create({analytics:k(["message"])});return{ui:r.ui({"fileupload.general":b.constant({value:"image",textkey:m.key("insert.image"),icon:!0,updateGeneral:b.identity,
action:function(){var a=f(y,z,B.uiContainer(),h,x,d.dialog);a.events.insertAssets.bind(F);a.events.close.bind(function(){y.focus();a.destroy()});a.events.escaped.bind(function(){y.focus();a.destroy()});t.content().hideInlineSelection();a.show()},hasDialog:!0}),"fileupload.menu":function(){var a=g(y,z,B,t.ui(),x);a.events.insertAsset.bind(function(a){E.get().bind(function(b){e.insertMobileAssets(y,b,u,[a.asset()])})});a.events.open.bind(function(a){y.getSelection().each(E.save)});return a},"camera.general":function(){var a=
c();a.events.upload.bind(function(a){E.get().bind(function(b){e.insertMobileAssets(y,b,u,a.assets())})});return{value:"image",textkey:m.key("image.from-camera"),icon:!0,updateGeneral:b.identity,action:function(){y.getSelection().each(E.save);y.toReading();a.open()},hasDialog:!0}}},b.identity),events:w.registry,destroy:function(){}}}});k("8q",["7","33","ca"],function(c,d,b){var a=d.resolve("find-match");d=d.resolve("find-mark");var e="."+a+", ."+d;return{configure:function(a){a.addSelector(a.output(),
e,b.unwrap);a.addSelector(a.history(),e,b.unwrap);a.addSelector(a.internal(),e,b.unwrap)},matchClass:c.constant(a),markClass:c.constant(d),findIdAttr:c.constant("data-ephox-find-id"),shiftKeyState:function(a){return{isShift:c.constant(a)}}}});k("wc",[],function(){var c=function(c){return{fold:c}};return{created:function(d){return c(function(b,a){return a(d)})},preserved:function(d){return c(function(b,a){return b(d)})}}});k("108",["2u"],function(c){return c.immutable("id","match","current")});k("136",
["4g"],function(c){return{resolve:c.create("data.ephox.cram").resolve}});k("137",["4g"],function(c){return{resolve:c.create("ephox-cram").resolve}});k("109","136 137 7 s 1a 1y 4e 31 2a".split(" "),function(c,d,b,a,e,g,f,h,l){var m=c.resolve("highlight-id"),n=d.resolve("highlight-wrap"),p=function(a,b){return h.closest(a,"."+b)},r=function(b){return a.from(e.get(b,m))};return{marker:p,idMarker:function(a){return p(a,n)},id:r,set:function(a,b){e.set(a,m,b);g.add(a,b)},all:function(a){return r(a).fold(b.constant([a]),
function(b){var c=l.owner(a);return f.descendants(c,"."+b)})}}});k("oi",["2u"],function(c){return c.immutable("word","pattern")});k("15g",["b","7","uf","h4"],function(c,d,b,a){return{separate:function(e,g,f){var h=c.bind(f,function(a){return[a.start(),a.finish()]}),l=a.splits(g,h,function(a,c){return b.subdivide(e,a.element(),c)});return c.map(f,function(b){var f=a.sublist(l,b.start(),b.finish()),f=c.map(f,function(a){return a.element()}),g=c.map(f,e.property().getText).join("");return{elements:d.constant(f),
word:b.word,exact:d.constant(g)}})}}});k("14p","b s oi eg yy 11v 15g 6j h4 h5".split(" "),function(c,d,b,a,e,g,f,h,l,m){var n=function(b,c){return l.generate(c,function(c,e){var f=e+b.property().getText(c).length;return d.from(a.range(c,e,f))})},p=function(a,b,d,h){b=e.group(a,b,h);return c.bind(b,function(b){b=g.justText(b);var e=c.map(b,a.property().getText).join(""),e=m.findmany(e,d);b=n(a,b);return f.separate(a,b,e)})};return{safeWords:function(a,d,e,f){e=c.map(e,function(a){var c=h.safeword(a);
return b(a,c)});return p(a,d,e,f)},safeToken:function(a,c,d,e){d=b(d,h.safetoken(d));return p(a,c,[d],e)},run:p}});k("138",["14p"],function(c){return{safeWords:function(d,b,a,e){return c.safeWords(d,b,a,e)},safeToken:function(d,b,a,e){return c.safeToken(d,b,a,e)},run:function(d,b,a,e){return c.run(d,b,a,e)}}});k("10a",["dy","138"],function(c,d){var b=c();return{safeWords:function(a,c,g){return d.safeWords(b,a,c,g)},safeToken:function(a,c,g){return d.safeToken(b,a,c,g)},run:function(a,c,g){return d.run(b,
a,c,g)}}});k("wd","b 108 109 2z 7 s 10a".split(" "),function(c,d,b,a,e,g,f){var h=function(f,h){var n=c.bind(f.elements(),function(a){return b.marker(a,h).fold(e.constant([]),function(a){return[a]})}),p=a.generate("ephox-cram");return d(p,f,g.from(n[0]))};return{matchWords:function(a,b,c){return f.safeWords(a,b,c)},matchToken:function(a,b,c){return f.safeToken(a,b,c)},matchPattern:function(a,b,c){return f.run(a,[b],c)},annotates:function(a,b){return c.map(a,function(a){return h(a,b)})}}});k("oh",
["b","wc","wd","7","h3"],function(c,d,b,a,e){var g=function(f,g,l,m){g=b.annotates(m,l.label());return c.bind(g,function(b){return b.current().fold(function(){var g=b.match();if(f.ignore(g))return[];g=e.wrapper(g.elements(),l.nu)||[];c.each(g,a.curry(l.tag,b));return[d.created(g)]},function(a){return[d.preserved(a)]})})};return{highlight:function(a,c,d,e){d=b.matchToken(c,d,a.optimise);return g(a,c,e,d)},highlightPattern:function(a,c,d,e){d=b.matchPattern(c,d,a.optimise);return g(a,c,e,d)}}});k("gj",
"b oh 7 s oi 6j 8q ep 1a 1y l 2o 21 2q 4e 9q 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,r,k,s,t,u){var v=function(a,b){return r.isElement(b)&&h.isBlock(b)?0>t.get(b).toLowerCase().indexOf(a):!1},w=function(a){return{ignore:b.constant(!1),optimise:b.curry(v,a.toLowerCase())}},x=b.constant("."+f.matchClass()),y={label:f.matchClass,tag:function(a,b){m.add(b,f.matchClass());l.set(b,f.findIdAttr(),a.id())},nu:function(){var a=n.fromTag("span");return{element:b.constant(a),wrap:b.curry(p.append,a)}}},
B=function(a){c.each(a,function(a){m.add(a,f.markClass())})},z=function(a){c.each(a,function(a){m.remove(a,f.markClass())})},A=function(b,d){var e=c.groupBy(s.descendants(b,d),function(a){return l.get(a,f.findIdAttr())});return 0===e.length?a.none():a.some(e)},C=function(a,c){var d=g.custom(g.sanitise(a),b.constant(0),b.constant(0),c);return e(a,d)},D=function(a,b,d){return A(a,x()).map(function(e){var g=c.filter(e,function(a){return m.has(a[0],f.markClass())}),h=c.findIndex(e,function(a){return c.contains(g,
a)});return{pos:d(e,c.flatten(g),h,b(h,e.length)),all:A(a,x())}})},F=function(a,b,c,d){z(b);B(a[d]);return d},E=function(a,b){return a===b-1?0:a+1},G=function(a,b){return 0===a?b-1:a-1},H=function(a,b){return D(a,E,function(a,d,e,f){F(a,d,e,f);p.before(d[0],n.fromText(b));c.each(d,k.remove);return 0===f?f:e})};return{search:function(b,c,e){if(0===c.length)return a.none();var f=w(c),g=u.children(b);c=!0===e?C(c,a.none()):C(c,a.some("gi"));d.highlightPattern(f,g,c,y);return A(b,x()).map(function(b){B(b[0]);
return{all:a.some(b),pos:0}})},clear:function(b){b=s.descendants(b,x());c.each(b,k.unwrap);return a.none()},next:function(a){return D(a,E,F)},prev:function(a){return D(a,G,F)},replace:H,replaceAll:function(b,c){for(;H(b,c).isSome(););return a.none()}}});k("gk",["7","s","gj","2a"],function(c,d,b,a){return function(e,g,f){var h=function(){g.counter.update(0,0)},l=function(b){b.all.fold(h,function(c){g.counter.update(b.pos+1,c.length);var d=c[b.pos];c=d[0];d=d[d.length-1];e.setSelection(c,0,d,a.children(d).length);
f.element(c)})},m=function(){f.cursor();h()},n=function(a,c,e){b.clear(a);b.search(a,c,e).fold(m,l);return d.some(c)},p=function(a,c){var d=(!0===c?b.prev:b.next)(a);d.fold(m,l);return d},r=function(a){e.body().each(function(c){b.replace(c,a).fold(m,l);e.domChanged();e.undoChanged()})},k=d.none(),s=function(){k=d.none()};g.events.search.bind(function(a){e.body().each(function(b){n(b,a.term(),a.matchcase())})});g.events.next.bind(function(){e.body().each(function(a){p(a,!1)})});g.events.prev.bind(function(){e.body().each(function(a){p(a,
!0)})});g.events.replace.bind(function(a){r(a.value())});g.events.replaceAll.bind(function(a){e.body().each(function(c){b.replaceAll(c,a.value()).fold(m,l);e.undoChanged()})});g.events.interactive.bind(function(a){e.body().each(function(b){k=n(b,a.term(),a.matchcase())})});g.events.encase.bind(function(a){e.body().each(function(b){k.each(function(c){n(b,c,a.matchcase())})})});g.events.clear.bind(function(a){e.body().each(function(a){b.clear(a);s()})});return{zeroCount:h,updateMatch:l,enterSearchAction:function(a,
b){e.body().each(function(d){var e=g.getCase();k=k.filter(function(b){return a===b}).fold(function(){return n(d,a,e)},function(f){return p(d,b.isShift()).fold(function(){return n(d,a,e)},c.constant(k))})});(0===a.length?g.counter.hide:g.counter.show)()},enterReplaceAction:r,clearLastSearch:s}}});k("gl",["c","7","cb"],function(c,d,b){var a=c.detect().deviceType.isiOS();return function(c){var g=c.content();c=function(a){g.elementIntoView(a)};var f=function(){g.cursorIntoView()};c={element:a?c:d.curry(b.elementIntoView,
g),cursor:a?f:d.curry(b.cursorIntoView,g)};return{get:d.constant(c)}}});k("ok","7v a7 4z gp dv l1 7 73 33 54 46 47 1a 2m 1y 4b 2n 3u l 2y 2o 3c i4 2q al".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,k,q,s,t,u,v,w,x,y,B,z,A,C){var D=function(a,b,d){a=a();var e=a.element();t.add(e,b);c.button(e,d);k.set(e,"tabindex","-1");a.events.click.bind(function(){x.focus(e)});return a},F=function(b,c){var d=D(a,b,c);k.set(d.element(),"title",c);return d},E=function(b,c){var d=l.resolve("inline-main-button"),d=
b.concat([d]),d=D(a,d,c);d.content(e(c));return d},G=function(a,b,c){var d=l.resolve("inline-main-button-toggle");a=a.concat([d]);c=D(g,a,c);k.set(c.element(),"title",b);return c},H=function(a,b,d){var e=w.fromTag("input");t.add(e,a);k.set(e,"placeholder",b);c.label(e,d);return{element:f.constant(e),destroy:f.curry(A.remove,e)}};return{counter:function(a){var c=b.div(),e=b.span();s.add(c,l.resolve("search-widget-counter"));s.add(e,l.resolve("search-widget-counter-text"));y.append(c,e);return{element:f.constant(c),
update:function(a,b){var c=h.translate("units.amount-of-total",a,b);A.empty(e);y.append(e,w.fromText(c));C.isVisible(e)&&d.speak(q.body(),c)},hide:function(){u.set(c,"display","none")},show:function(){u.remove(c,"display")},destroy:function(){A.remove(e);A.remove(c)}}},dummyCounter:function(a){a=b.div();s.add(a,l.resolve("search-widget-counter"));return{element:f.constant(a),update:f.noop,hide:f.noop,show:f.noop,destroy:f.curry(A.remove,a)}},searchField:function(){var a=b.span(),c=F([l.resolve("stepper-button"),
l.resolve("search-widget-previous")],h.translate("search.previous")),d=F([l.resolve("stepper-button"),l.resolve("search-widget-next")],h.translate("search.next")),e=G([l.resolve("search-widget-more")],h.translate("aria.label.more"),h.translate("aria.label.more"));s.add(a,l.resolve("search-widget-searchField"));var g=H([l.resolve("search-widget-input"),l.resolve("search-widget-input-search")].concat(z.isSmallTouch()?[l.resolve("search-widget-small-touch")]:[]),h.translate("search.search"),h.translate("search.field.search")),
k=n.create({next:p([],d.events.click),previous:p([],c.events.click),more:p([],e.events.click),input:m(["raw"])}),r=v.bind(g.element(),"input",k.trigger.input);B.append(a,[g.element(),c.element(),d.element(),e.element()]);return{events:k.registry,element:f.constant(a),input:g.element,focus:function(){x.focus(g.element())},previous:c.element,next:d.element,moreToggle:e,destroy:function(){r.unbind();g.destroy();c.destroy();d.destroy();e.destroy()}}},replaceDrawer:function(){var a=H([l.resolve("search-widget-input"),
l.resolve("search-widget-input-replace")],h.translate("search.replace"),h.translate("search.field.replace")),c=G([l.resolve("search-widget-matchcase")],h.translate("search.matchcase"),h.translate("search.matchcase")),d=E([l.resolve("search-widget-replace")],h.translate("search.replace")),e=E([l.resolve("search-widget-replace-all")],h.translate("search.replace-all")),g=b.div(),m=b.div();s.add(g,l.resolve("search-widget-replace-drawer"));s.add(m,l.resolve("search-widget-replace-drawer-tools"));B.append(m,
[c.element(),d.element(),e.element()]);B.append(g,[a.element(),m]);return{element:f.constant(g),replace:d,replaceAll:e,input:a,matchcase:c,destroy:function(){c.destroy();d.destroy();e.destroy();A.remove(m);A.remove(g)}}},button:F,input:H}});k("gm","oj 4z 7 9u ok 33 54 46 47 1y 2n 3u 6d 3c i4 2q 32".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,k,q,s,t,u){return function(){var v=d.div();m.add(v,g.resolve("search-widget"));var w=e.searchField(),x=(s.isSmallTouch()?e.dummyCounter:e.counter)(w.input()),
y=e.replaceDrawer(),B=y.element(),z=h.create({next:l([],w.events.next),prev:l([],w.events.previous),replace:f(["value"]),replaceAll:f(["value"]),search:f(["term","matchcase","isShift"]),interactive:f(["term","matchcase"]),encase:f(["matchcase"]),clear:f([])}),A=c(B);w.moreToggle.events.click.bind(function(){(A.visible()?A.hide:A.show)()});w.events.input.bind(function(){var a=u.get(w.input()),b=k.get(w.element());n.set(x.element(),"height",b+"px");3<=a.length?D.throttle(a):(z.trigger.clear(),x.hide(),
x.update(0,0))});y.replace.events.click.bind(function(){var a=u.get(y.input.element());z.trigger.replace(a)});y.replaceAll.events.click.bind(function(){var a=u.get(y.input.element());z.trigger.replaceAll(a)});y.matchcase.events.click.bind(function(){z.trigger.encase(C())});var C=function(){return y.matchcase.selected()},D=a(function(a){x.show();z.trigger.interactive(a,C())},500),F=p.bind(B,"transitionend",function(a){"opacity"===a.raw().propertyName&&m.remove(B,"ephox-chameleon-toolbar-more-open")});
q.append(v,[x.element(),w.element(),y.element()]);return{element:b.constant(v),search:w,focus:function(){w.focus()},drawer:y,counter:x,getCase:C,destroy:function(){F.unbind();w.destroy();y.destroy();x.destroy();A.destroy();t.remove(v)},events:z.registry}}});k("8r","g2 8h 7 gj g4 gk 8q gl gm 54 46 32".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p){return function(k){var q=k.content(),s=l();k=h(k);var t=g(q,s,k.get()),u=function(a){var b=a.endContainer();a=a.endOffset();q.setSelection(b,a,b,a)};k=c.button({execute:e.button});
k=[d.input(s.search.input(),c.input({execute:function(a,b){t.enterSearchAction(a,b)}})),d.button(s.search.previous(),k),d.button(s.search.next(),k),d.button(s.search.moreToggle.element(),k),d.input(s.drawer.input.element(),c.input({execute:function(a,b){t.enterReplaceAction(a)}})),d.button(s.drawer.matchcase.element(),k),d.button(s.drawer.replace.element(),k),d.button(s.drawer.replaceAll.element(),k)];var v=n.create({done:m([])});return{element:s.element,anchorName:b.constant("search-widget-anchor"),
textkey:b.constant("action.search"),dialogTextkey:b.constant("search.menu"),destroy:function(){s.destroy()},keylayouts:b.constant(k),openWidget:function(){t.enterSearchAction(p.get(s.search.input()),f.shiftKeyState(!1))},closeWidget:function(){q.body().each(function(b){q.getSelection().each(u);a.clear(b)});t.clearLastSearch()},events:v.registry}}});k("gn",["4n"],function(c){return{text:c.generate([{text:["field","input"]}]).text,cata:function(c,b){return c.fold(b)}}});k("8s","7 gj gk 8q gl gn gm 54 46 2y 2o 32 3t".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,p,k){return function(q,s){var t=q.content(),u=f(),v=e(q),w=b(t,u,v.get()),v=l.create({toEditor:h([])}),x=g.text(u.search.element(),u.search.input());return{element:u.element,addEscape:function(a){n.append(u.search.element(),a.element())},open:function(){w.enterSearchAction(p.get(u.search.input()),a.shiftKeyState(!1));k(u.focus,250)},close:function(){t.body().each(function(a){d.clear(a).fold(w.zeroCount,w.updateMatch)});w.clearLastSearch()},execute:function(b){if(m.hasFocus(u.search.input())){b=
a.shiftKeyState(!0===b.raw().shiftKey);var c=p.get(u.search.input());w.enterSearchAction(c,b)}else b=p.get(u.drawer.input.element()),w.enterReplaceAction(b)},type:c.constant(x),events:v.registry,destroy:function(){u.destroy()}}}});k("8t","75 b 7v go gp gq 7 r s gr gn 73 a1 33 54 46 4m 52 1a 1y 3u l 2y 2o 4i 4e 3t".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,k,q,s,t,u,v,w,x,y,B,z,A,C,D,F){var E=v.ensureWith("element addEscape open close execute type events destroy".split(" "),m.isFunctionOrEvents(["toEditor"]));
return function(m,v){E(v);var F=m.content(),L=m.ui().tabstrip.element();x.add(v.element(),q.resolve("slick-widget"));var J=n.cata(v.type(),function(b,c){x.add(b,q.resolve("slick-widget-field"));x.add(c,q.resolve("slick-widget-input"));var e=y.bind(v.element(),"keydown",function(a){var b={original:f.constant(a)};if(k.isEnter(b))v.execute(a),a.kill();else if(k.isTab(b)){var b=D.descendants(v.element(),"input,textarea"),c=d.findIndex(b,z.hasFocus);-1<c&&(c=(c+1)%b.length,0<=c&&c<b.length&&z.focus(b[c]));
a.kill()}else k.isEscape(b)&&(P(),a.kill())}),g=y.bind(c,"blur",function(b){l.from(b.raw().relatedTarget).each(function(b){!0===C.ancestor(B.fromDom(b),function(a){return x.has(a,"ephox-polish-mobile-toolbar-hide")}).isSome()&&a.refreshInput(c)})});return{destroy:function(){e.unbind();g.unbind()}}}),K=e("shizniz"),M=p.translate("toolbar.backbutton"),N=g([c.resolve("icon")]);K.content(N);w.set(K.element(),"title",M);b.toolbarButton(K.element(),M,!1,!1);v.addEscape(K);var S=u(!1);A.prepend(L,v.element());
var Q=t.create({done:s([]),abort:s([]),open:s([]),close:s([])}),P=function(){O();F.toEditing()};v.events.toEditor.bind(P);var R=h.cached(function(a){return D.children(L,"."+c.resolve("toolbar"))}),O=function(){v.close();S.set(!1);d.each(R(),function(a){x.remove(a,q.resolve("mobile-toolbar-hide"))});x.remove(v.element(),q.resolve("mobile-toolbar-show"));x.add(v.element(),q.resolve("mobile-toolbar-hide"));Q.trigger.close()};F.events.mousedown.bind(O);O();K.events.click.bind(function(){P();Q.trigger.abort()});
return{element:v.element,destroy:function(){F.events.mousedown.unbind(O);J.destroy();v.destroy()},events:Q.registry,open:function(){var a=y.bind(L,"transitionend",function(){v.open();Q.trigger.open();a.unbind()});S.set(!0);d.each(R(),function(a){x.remove(a,q.resolve("mobile-toolbar-show"));x.add(a,q.resolve("mobile-toolbar-hide"))});x.remove(v.element(),q.resolve("mobile-toolbar-hide"));x.add(v.element(),q.resolve("mobile-toolbar-show"))},close:O,isOpen:function(){return S.get()}}}});k("5k","c r 8q 8r 8s 72 8t 73 33 6t 74 54 46 1y".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,p,k,q){var s=l.resolve("toolbar-dialog"),t=function(b){var c=a(b);return g(b,c,"search",s)},u=function(a){var b=e(a);return f(a,b,s)},v=function(a){return(c.detect().deviceType.isTouch()?u:t)(a)};return function(a){var c=a.filter();b.configure(c);var e=k.create({analytics:p(["message"])}),f=d.cached(function(){var b=v(a);b.events.open.bind(function(){e.trigger.analytics("search_tool_open")});b.events.abort.bind(b.close);return b}),c=function(){var a=f();(a.isOpen()?
a.close:a.open)()};a.shortcuts().events.search.bind(c);return{ui:m.ui({"find.general":{toggle:!1,hasPopup:!1,value:"search",textkey:h.key("action.search"),action:c,updateGeneral:function(a){q.add(a.element(),l.resolve("search"))},icon:!0,tooltip:n.get}}),events:e.registry,destroy:function(){f().destroy()}}}});k("8u","7 dr 7c 7n dl dt 1a".split(" "),function(c,d,b,a,e,g,f){var h=function(b){return a.isAnnotation(b)||f.has(b,e.overrideSpan())},l=function(a,e,f,g,l,m){var k=function(b){a(b,l,h)};b.cata(g.get(),
c.noop,d.multiple(e,f,k,m),d.single(e,f,k,m))},m=function(a,b,c,d,e){l(a,b,c,d,e,b.toEditing)};return{face:c.curry(m,g.face),background:c.curry(m,g.background),foreground:c.curry(m,g.foreground),size:c.curry(m,g.size),partialSize:c.curry(function(a,b,d,e,f){l(a,b,d,e,f,c.noop)},g.size)}});k("8w",["2u"],function(c){return{color:c.immutable("hex","classes","name"),face:c.immutable("textkey","value","icon"),size:c.immutable("name","size")}});k("8v",["7","r","s","8w","73"],function(c,d,b,a,e){var g=a.color,
f=a.face,h=a.size;a=d.cached(function(){return[g("#FFF",["color-highlight-dark","color-option-white"],e.key("color.white")),g("#000",["color-highlight-light"],e.key("color.black")),g("#444",["color-highlight-light"],e.key("color.gray")),g("#777",["color-highlight-light"],e.key("color.metal")),g("#CCC",["color-highlight-light"],e.key("color.smoke")),g("#FC1D00",["color-highlight-light"],e.key("color.red")),g("#C81500",["color-highlight-light"],e.key("color.darkred")),g("#FF8C00",["color-highlight-dark"],
e.key("color.darkorange")),g("#FEBE00",["color-highlight-dark"],e.key("color.orange")),g("#FFFC00",["color-highlight-dark"],e.key("color.yellow")),g("#22AE50",["color-highlight-dark"],e.key("color.green")),g("#006400",["color-highlight-dark"],e.key("color.darkgreen")),g("#3CB371",["color-highlight-dark"],e.key("color.mediumseagreen")),g("#8FCD4E",["color-highlight-dark"],e.key("color.lightgreen")),g("#00FF00 ",["color-highlight-dark"],e.key("color.lime")),g("#0000CD",["color-highlight-dark"],e.key("color.mediumblue")),
g("#002360",["color-highlight-light"],e.key("color.navy")),g("#0173C1",["color-highlight-light"],e.key("color.blue")),g("#14B2F2",["color-highlight-dark"],e.key("color.lightblue")),g("#ee82ee",["color-highlight-light"],e.key("color.violet"))]});d=d.cached(function(){return[f(e.key("font.arial"),"Arial",b.none()),f(e.key("font.comicsans"),"Comic Sans MS",b.none()),f(e.key("font.consolas"),"Consolas",b.none()),f(e.key("font.courier"),"Courier",b.none()),f(e.key("font.georgia"),"Georgia",b.none()),f(e.key("font.impact"),
"Impact",b.none()),f(e.key("font.tahoma"),"Tahoma",b.none()),f(e.key("font.timesnr"),"Times New Roman",b.none()),f(e.key("font.trebuchet"),"Trebuchet MS",b.none()),f(e.key("font.verdana"),"Verdana",b.none())]});h=[h("font.small","10px"),h("font.medium","13px"),h("font.large","18px"),h("font.huge","32px")];return{colors:a,faces:d,sizes:c.constant(h)}});k("i3",["7v","gp","73","1a","4b"],function(c,d,b,a,e){return function(g,f){var h=d();e.add(h.element(),g);c.button(h.element(),b.translate(f));a.set(h.element(),
"title",b.translate(f));return h}});k("gw",["7"],function(c){return{configuration:c.constant({i18nNamespace:"font",cssNamespace:"font",property:"font-size",tag:"span",specials:["xx-small x-small small medium large x-large xx-large".split(" ")]})}});k("69",["a"],function(c){return{isEmpty:function(d){return null===d||void 0===d||""===d||c.isArray(d)&&0===d.length}}});k("om","7 s p 69 wb 2n 1k 1s on".split(" "),function(c,d,b,a,e,g,f,h,l){var m=function(a){var b=f.pNum(a)?"px":"";return a+b},n=function(a,
c,e){return(g.isValidValue(a,c,e)?d.some(e):d.none()).fold(function(){return b.error("Invalid value: "+e)},function(a){return a===e?b.value(e):b.error("Invalid value: "+e)})},p=function(a){return e.identify(a).fold(function(a){return a},function(a,b,c){return h.round(10*b)/10+c})};return{identify:e.identify,validate:function(d,e,f){return(a.isEmpty(d)?b.error("can not use empty value for font size."):b.value(d)).map(m).map(p).bind(c.curry(n,e,f))},sanitise:function(a){return p(a)}}});k("ol","a b 7 s om 1s on".split(" "),
function(c,d,b,a,e,g,f){var h={px:1,em:0.1,"%":10,pt:1,rem:"0.1"},l=function(b,c,e){c=d.find(c,function(a){return d.contains(a,e)});return a.from(c).bind(function(c){var f=d.indexOf(c,e);return-1<f?a.from(c[b(f,c)]):a.none()}).getOr(e)};f=function(a,b,d,f){return e.identify(f).fold(function(b){return l(a,d,b)},function(a,d,e){a=void 0!==h[e]?h[e]:1;var f=b*(void 0!==h[e]?h[e]:1);return(c.isNumber(d)&&0<=d?g.max(a,d+f):a)+e})};return{decrease:b.curry(f,function(a,b){return g.max(0,a-1)},-1),increase:b.curry(f,
function(a,b){return g.min(b.length-1,a+1)},1)}});k("gs","7v a7 4z 7 8u i3 gn gw 73 ol om 33 54 46 2u 2m 1y l 2y 2o 3c 32 3t".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,k,q,s,t,u,v,w,x,y,B,z){var A=s.immutableBag(["i18nNamespace","cssNamespace","property","tag","specials"],[]);return function(s,z){var F=A(h.configuration()),E=F.i18nNamespace(),G=F.cssNamespace(),H=b.div();u.add(H,p.resolve("fontsize-widget"));var I=b.span();u.add(I,p.resolve("fontsize-widget-field"));var L=b.div();u.add(L,p.resolve("fontsize-widget-exit"));
var J=v.fromTag("input");u.add(J,p.resolve("fontsize-widget-input"));c.label(J,l.translate(E+".stepper.input"));var K=function(a){u.remove(J,p.resolve("slick-widget-invalid-input"));c.invalid(J,!1);B.set(J,a);e.partialSize(s.content(),s.undo(),s.selections(),a);d.speak(t.body(),a)},M=function(){u.add(J,p.resolve("slick-widget-invalid-input"));c.invalid(J,!0);d.speak(t.body(),l.translate("aria.input.invalid"));w.focus(J)},N=function(a){return function(){var b=B.get(J),b=a(F.specials(),b);n.validate(b,
F.tag(),F.property()).fold(M,K)}},S=N(m.decrease),N=N(m.increase),Q=function(a,b){return g([p.resolve(G+a),p.resolve("stepper-button")],E+b)},P=Q("-stepper-decrease",".stepper.decrease"),Q=Q("-stepper-increase",".stepper.increase");P.events.click.bind(S);Q.events.click.bind(N);y.append(I,[P.element(),J,Q.element()]);x.append(H,I);x.append(H,L);var I=f.text(I,J),R=q.create({toEditor:k([]),size:k(["value"])}),O=function(){B.set(J,"")},T=function(a){a=n.sanitise(a);n.validate(a,F.tag(),F.property()).fold(M,
function(a){u.remove(J,p.resolve("slick-widget-invalid-input"));c.invalid(J,!1)});B.set(J,a)};return{element:a.constant(H),addEscape:function(a){x.append(L,a.element())},open:function(){w.focus(J)},close:a.noop,execute:function(){var a=B.get(J);n.validate(a,F.tag(),F.property()).fold(M,function(a){K(a);R.trigger.toEditor()})},destroy:a.noop,type:a.constant(I),represent:function(a){a.fold(O,T,T)},events:R.registry}}});k("gt","s 7c 69 7a 2u 2n 21 4i 2a on".split(" "),function(c,d,b,a,e,g,f,h,l,m){var n=
e.immutable("size"),p=function(b){b=d.toSelection(b.get()).fold(a.off,function(b){b=s(b.startContainer());return a.on(b)});return n(b)},k=function(a){return a.body().bind(function(a){a=g.get(a,"font-size");return c.from(a)})},q=function(a){var c=a.dom();if(!c.style)return!1;c=c.style.fontSize;return"body"!==f.name(a)&&!b.isEmpty(c)},s=function(a){var b=f.isText(a)?l.parent(a).getOrDie():a;return(q(b)?c.some(b):h.ancestor(b,q)).fold(function(){return g.get(b,"font-size")},function(a){return a.dom().style.fontSize})};
return{getState:function(a,b){return{readState:p(a),fallbackSize:k(b).getOr("12px")}}}});k("8x","7 s gs 8t 73 gt 4m 3t".split(" "),function(c,d,b,a,e,g,f,h){return function(h,m){var n=h.content(),p=f(d.none()),k=function(){var c=b(h,m),e=a(h,c),c={represent:c.represent,refreshValue:c.refreshValue,open:e.open,close:e.close,isOpen:e.isOpen};p.set(d.some(c));return c},q={toggle:!1,value:"size",textkey:e.key("font.size"),action:function(){var a=p.get().getOrThunk(k);if(a.isOpen())a.close();else{var b=
g.getState(h.selections(),n);a.open();a.represent(b.readState.size())}},updateGeneral:c.noop,icon:!0,shortcut:!1,hasPopup:!1,hasDialog:!1};return{general:c.constant(q)}}});k("oq","7v 7 73 33 54 46 1a 1y 3u l 2y 2q".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p){return function(k){var q=k.hex(),s=m.fromTag("span");h.add(s,a.resolve("palette-detail-action"));f.set(s,"title",b.get(k.name()));c.option(s,b.get(k.name()),!1,!1);var t=g.create({selected:e(["value"])}),u=l.bind(s,"click",function(){n.focus(s);
t.trigger.selected(q)});return{element:function(){return s},value:d.constant(q),destroy:function(){u.unbind();p.remove(s)},events:t.registry}}});k("or","b 7v er 4z 7 73 33 3e 54 46 1y 2n l 2o 2q".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,k,q,s){return function(){var t=[],u=a.div(),v=k.fromTag("span");d.listBox(v);n.add(v,f.resolve("palette-detail-actions"));n.add(v,f.resolve("palette-color-options"));d.label(v,g.translate("aria.font.palette"));q.append(u,v);var w=h.create(),x=m.create({selected:l(["value"])});
return{element:function(){return u},add:function(a){t.push(a.destroy);q.append(v,a.element());w.bind(a.events.selected,function(a){x.trigger.selected(a.value())})},remove:function(a){s.remove(a.element());w.unbind(a.events.selected)},show:function(){n.add(u,f.resolve("palette-detail-active"));b.showPanel(u);p.remove(u,"display")},hide:function(){n.remove(u,f.resolve("palette-detail-active"));b.hidePanel(u);p.set(u,"display","none")},destroy:function(){c.each(t,e.apply);s.remove(u);t=[]},events:x.registry}}});
k("iy","b g2 8h 6 7 s 8v oq or 33 1y 4b 2n 6d 3l 4e 1s".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,k,q,s,t,u){var v=function(a){a.dom().click();return g.some(a)},w=function(a,b){var d=t.descendants(a,b);if(0<q.get(a)&&0<d.length){var f=s.absolute(d[0]).top(),h=c.findIndex(d.slice(1),function(a){return s.absolute(a).top()!==f});return-1<h?g.some({rows:e.constant(u.ceil(d.length/(h+1))),columns:e.constant(h+1)}):g.none()}return g.none()};return{create:function(a){var b=void 0!==a?a:f.colors();a=l();
b=c.map(b,function(a){var b=h(a);p.add(b.element(),c.map(a.classes(),m.resolve));n.add(b.element(),m.resolve("palette-color-option"));k.set(b.element(),"background-color",a.hex());return b});c.each(b,a.add);return a},makeLayout:function(c,f,g){g=d.grid(a.deepMerge({trigger:v},g));var h=b.grid(c,{cell:e.constant(f)},4,5,g);return{layout:e.constant(h),refresh:function(){h.clear();w(c,f).each(function(a){h.resize(a.rows(),a.columns())})}}}}});k("oo",["iy","6m","1s"],function(c,d,b){var a=function(a){return d.closest(a,
".ephox-polish-palette-detail-active")};return function(b,d){var f=c.makeLayout(d,".ephox-polish-palette-detail-action.ephox-polish-palette-color-option",{isValid:a}),h=f.layout();return{isFocused:h.isFocused,enterGrid:h.enter,grid:h,refresh:f.refresh,destroy:h.destroy,clear:h.clear}}});k("op","7v c dv l1 7 s 73 33 1y l 2o 2q".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p){var k=d.detect().deviceType.isTouch;return function(){var d=m.fromTag("div");k()?c.presentation(d):c.menuItem(d,g.none(),g.none());
l.add(d,h.resolve("color-widget"));var s=m.fromTag("div");l.add(s,h.resolve("color-widget-controls"));c.tabList(s);var t=m.fromTag("div");l.add(t,h.resolve("color-widget-palettes"));c.toolbarGroup(t);var u=a("text-color");l.add(u.element(),h.resolve("tab-button"));u.content(b(f.translate("font.color")));c.tabButton(u.element(),f.translate("aria.font.color"));var v=a("highlight-color");l.add(v.element(),h.resolve("tab-button"));v.content(b(f.translate("font.highlight")));c.tabButton(v.element(),f.translate("aria.font.highlight"));
n.append(s,u.element());n.append(s,v.element());n.append(d,s);n.append(d,t);return{element:e.constant(d),colorToggle:e.constant(u),highlightToggle:e.constant(v),content:e.constant(t),controls:e.constant(s),destroy:function(){u.destroy();v.destroy();p.remove(t);p.remove(s)}}}});k("gu","7v er g2 8h 7 8v oo op iy 54 46 47 2o 31 1s".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,k,q,s){return function(){var s=l.create(g.colors()),u=l.create(g.colors()),v=n.create({color:p(["value"],s.events.selected),highlight:p(["value"],
u.events.selected),abort:m([])}),w=h(),x=w.colorToggle(),y=w.highlightToggle();c.linkTabToPanel(x.element(),s.element());c.linkTabToPanel(y.element(),u.element());k.append(w.content(),s.element());k.append(w.content(),u.element());var B=f(w,s.element()),z=f(w,u.element()),A=a.flow(w.controls(),{item:e.constant(".ephox-pastry-statebutton")},b.flow({trigger:function(a,b){return q.descendant(a,".ephox-pastry-button").map(function(a){a.dom().click();return a})},executeOnArrow:!0})),C=a.multiple(w.element(),
[A,B.grid,z.grid]);C.events.exit.bind(function(a){v.trigger.abort()});var D=function(){C.exit()},F=function(){u.hide();x.select();y.deselect();d.tabSelected(x.element(),[y.element()]);s.show()};x.events.click.bind(function(){A.clickFocus(x.element());F()});y.events.click.bind(function(){A.clickFocus(y.element());s.hide();x.deselect();d.tabSelected(y.element(),[x.element()]);u.show()});return{element:w.element,destroy:function(){D();s.destroy();C.destroy();u.destroy();w.destroy()},open:function(){C.clear();
C.refresh();x.click();F();C.enter()},close:D,events:v.registry}}});k("8y","7 50 8u gu 73 54 46 47".split(" "),function(c,d,b,a,e,g,f,h){return{widget:function(l){var m=l.content(),n=l.undo(),p=l.selections(),k=a(),q=f.create({color:h(["value"],k.events.color),highlight:h(["value"],k.events.highlight),done:g([]),abort:h([],k.events.abort)});k.events.color.bind(function(a){b.foreground(m,n,p,a.value());q.trigger.done();m.toEditing()});k.events.highlight.bind(function(a){b.background(m,n,p,a.value());
q.trigger.done();m.toEditing()});return{element:k.element,name:c.constant("color"),textkey:c.constant(e.key("font.coloroption")),menuTextkey:c.constant(e.key("aria.color.menu")),open:k.open,close:k.close,updateWidget:function(a){d.isHighContrast(l.smartview())?a.disable():k.open()},ability:c.noop,destroy:k.destroy,events:q.registry,label:c.constant(!1)}}}});k("we",["7","s"],function(c,d){return function(){var b=d.none(),a=function(a){b.bind(function(b){b[a]()})};return{enter:c.curry(a,"enter"),exit:c.curry(a,
"exit"),destroy:c.curry(a,"destroy"),set:function(a){b=d.some(a)}}}});k("os","7v a7 g2 8h ke a8 4z gp gq 7 s we 73 33 54 46 1a 1y 1b 3u l 2y 2o 3c 2q 2a 32 1s".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,k,q,s,t,u,v,w,x,y,B,z,A,C,D,F,E){return function(E,H){var I=H.i18nNamespace(),L=H.cssNamespace(),J=t.create({plus:s([]),minus:s([]),validate:s([]),abort:s([])}),K=h(),M=h(),N=f.div(),S=f.div(),Q=y.fromTag("input");c.label(Q,k.translate(I+".stepper.input"));c.toolbarButton(K.element(),k.translate(I+
".stepper.increase"),!1,!1);c.toolbarButton(M.element(),k.translate(I+".stepper.decrease"),!1,!1);u.set(Q,"tabindex","-1");u.set(K.element(),"tabindex","-1");u.set(M.element(),"tabindex","-1");v.add(S,q.resolve(L+"-stepper-input"));v.add(N,q.resolve(L+"-stepper-options"));v.add(K.element(),q.resolve("stepper-button"));K.content(l([q.resolve(L+"-stepper-increase")]));v.add(M.element(),q.resolve("stepper-button"));M.content(l([q.resolve(L+"-stepper-decrease")]));z.append(S,Q);A.append(N,[K.element(),
M.element()]);A.append(E,[S,N]);K.events.click.bind(function(){B.focus(K.element());J.trigger.plus()});M.events.click.bind(function(){B.focus(M.element());J.trigger.minus()});var P=function(){Q.dom().setSelectionRange(0,F.get(Q).length)},R=x.capture(E,"click",function(a){w.eq(a.target(),S)&&O.enter()}),O=p(),T=v.toggler(Q,q.resolve("invalid-"+L+"-size"));return{destroy:function(){K.destroy();M.destroy();O.exit();O.destroy();R.unbind();C.remove(Q)},highlight:function(){T.on();u.set(Q,"title",k.translate("aria.stepper.input.invalid"));
d.shout(Q,k.translate("aria.stepper.input.invalid"))},dehighlight:function(){T.off();u.remove(Q,"title")},input:m.constant(Q),focus:function(){B.focus(Q);P()},enter:O.enter,exit:O.exit,initLayout:function(){var c=a.single(Q,[e.basic(g.ENTER()[0],function(){J.trigger.validate();return n.some(!0)})],n.none());c.events.enter.bind(P);var d=b.button({execute:function(a){a.dom().click();B.focus(a);return n.some(a)}}),c=a.multiple(E,[c,a.button(K.element(),d),a.button(M.element(),d)]);c.events.exit.bind(function(){D.parent(S).each(B.focus);
J.trigger.abort()});O.set(c)},events:J.registry}}});k("gx","4z 7 os ol om 33 54 46 47 2u 1y 1b 3u 2q 32".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,k,q,s){var t=m.immutableBag(["i18nNamespace","cssNamespace","property","tag","specials"],[]);return function(m){var v=t(m),w=c.div(),x=b(w,v);n.add(w,g.resolve(v.cssNamespace()+"-size-widget"));var y=function(){return s.get(x.input())},B=function(a){var b=y();a=a(b);a=e.sanitise(a);s.set(x.input(),a);z.trigger.action(a);x.dehighlight()};x.events.validate.bind(function(a){a=
y();e.validate(a,v.tag(),v.property()).fold(function(){x.highlight()},function(a){s.set(x.input(),a);z.trigger.action(a);x.dehighlight();z.trigger.close()})});x.events.plus.bind(function(b){B(d.curry(a.increase,v.specials()))});x.events.minus.bind(function(b){B(d.curry(a.decrease,v.specials()))});var z=h.create({close:f([]),action:f(["value"]),abort:l([],x.events.abort)}),A=k.bind(w,"click",function(a){(p.eq(a.target(),w)||p.eq(a.target(),x.input()))&&x.enter()});return{element:d.constant(w),input:x.input,
getCurrentValue:y,focus:x.focus,enter:x.enter,initLayout:x.initLayout,destroy:function(){A.unbind();x.destroy();q.remove(w)},updateInlineWidget:function(a,b){var c=function(a){e.validate(a,v.tag(),v.property()).each(function(a){s.set(x.input(),a);x.dehighlight()})};a.size().fold(function(){c(b);n.add(w,g.resolve("default-"+v.cssNamespace()+"-size"))},d.noop,function(a){c(a);n.remove(w,g.resolve("default-"+v.cssNamespace()+"-size"))})},open:d.noop,close:d.noop,events:z.registry}}});k("8z","7v 7 8u gv gw gx 73 gt 54 46 47 2y".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,p){return{widget:function(c,k){var s=a.cata(k,d.constant(d.noop),d.constant(function(a){a.initLayout()})),t=c.content(),u=c.undo(),v=g(e.configuration());s(v);var w=m.create({done:l([]),abort:n([],v.events.abort)});v.events.close.bind(function(a){w.trigger.done()});v.events.action.bind(function(a){var d=p.active();t.focus();b.size(t,u,c.selections(),a.value());d.each(p.focus)});return{element:v.element,item:v.item,name:d.constant("size"),textkey:d.constant(f.key("font.size")),
open:v.open,close:v.close,updateInlineWidget:function(){var a=h.getState(c.selections(),t);v.updateInlineWidget(a.readState,a.fallbackSize)},ability:d.noop,destroy:v.destroy,events:w.registry}}}});k("gz","g3 73 g5 33 54 46 1y 3u l 36".split(" "),function(c,d,b,a,e,g,f,h,l,m){return function(n,p,k,q){var s=k();k=b.okCancel("font-size");var t=c(p),u=null,v=g.create({close:e([]),open:e([]),analytics:e(["message"]),ok:e(["value"])});p=function(){u.unbind();t.hide();v.trigger.close()};t.setTitle(d.translate("font.size"));
t.setContent(s.element());t.setControls(k.element());t.events.close.bind(p);k.events.ok.bind(function(){v.trigger.ok(s.getCurrentValue())});k.events.cancel.bind(p);f.add(t.element(),a.resolve("widget-dialog"));return{show:function(){t.show();var a=l.fromDom(m);u=h.bind(a,"orientationchange",function(){n.foreground()});v.trigger.open()},element:t.element,contents:s,events:v.registry,destroy:function(){t.hide();t.destroy();s.destroy()}}}});k("90","gy 7 8u gz gw gx 73 gt 54 46 47 1a 3u 3t".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,p,k,q){return{widget:function(q,t){var u=q.content(),v=q.smartview().uiContainer(),w=q.ui().tabstrip.element,x=q.undo(),y=g(e.configuration()),B=y.input(),z=c(w());p.set(B,"disabled","true");var A=k.bind(B,"touchstart",function(c){c.kill();z.closeMenus();var f=a(u,v,d.curry(g,e.configuration()));f.show();c=f.contents;var l=h.getState(q.selections(),u),m=function(){f.destroy();u.cursorIntoView()};c.updateInlineWidget(l.readState,l.fallbackSize);c.events.close.bind(m);
c.events.action.bind(function(a){b.size(u,x,q.selections(),a.value())});f.events.close.bind(f.destroy);f.events.ok.bind(function(a){b.size(u,x,q.selections(),a.value());m()})}),C=m.create({done:l([]),abort:n([],y.events.abort)});y.events.close.bind(function(a){C.trigger.done()});y.events.action.bind(function(a){b.size(u,x,q.selections(),a.value())});return{element:y.element,item:y.item,name:d.constant("size"),textkey:d.constant(f.key("font.size")),open:y.open,close:y.close,updateInlineWidget:function(){var a=
h.getState(q.selections(),u);y.updateInlineWidget(a.readState,a.fallbackSize)},ability:d.noop,destroy:function(){A.unbind();y.destroy()},events:C.registry}}}});k("91",["7c","69","7a","h0"],function(c,d,b,a){return{face:function(e){return c.toSelection(e.get()).map(function(c){c=a.value(c.startContainer(),"font-family");return d.isEmpty(c)?b.off():b.on(c)}).getOrThunk(b.unchanged)}}});k("5l","b c 7 s 8u 77 7j 8v 8w 8x 8y 8z 90 73 91 6t 7a 54 46".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,k,q,s,t,
u,v,w){return function(x,y){var B=x.content(),z=x.undo(),A=function(a){return c.map(a.split(/,\s?/g),function(a){return a.trim().replace(/^[\'\"](.*)[\'\"]$/,"$1")}).join(",")},C=(0===y.faces.length?a.none():a.some(y.faces)).fold(h.faces,function(b){return c.map(b,function(b){return l.face(q.raw(b.text),A(b.value),a.none())})}),D=d.detect().deviceType.isiOS(),F=w.create({analytics:v(["message","properties"])}),E=a.some(f.face),G=function(b){var d=A(b);b=c.find(C,function(a){return a.value()===d});
var e=l.face(q.raw(d),d,a.none());return void 0!==b&&null!==b?b:e},D=D?k:p,H=m(x,y);return{ui:t.ui({"fontface.dropdown":b.constant({name:"fontface",textkey:q.key("font.face"),menuTextkey:q.key("font.menu"),updateDropdown:function(c){var d=s.face(x.selections()).map(G);c.populate([{label:a.none,items:b.constant(C)}]);g.updateMenu(c,d,u.on(),C,E)},action:function(a){e.face(B,z,x.selections(),a)},values:C,render:E,describe:function(a){return q.translate("font.describe",q.get(a.textkey()))},hasPopup:!0}),
"fontcolor.widget":b.curry(n.widget,x),"fontsize.widget":b.curry(D.widget,x),"fontsize.general":H.general},b.identity),events:F.registry,destroy:b.noop}}});k("ot","b 7v 2z g9 33 1a 1y 2y 31".split(" "),function(c,d,b,a,e,g,f,h,l){return function(h,n,p){var k=a(h,n,p);d.tabList(k.menu());c.map(k.tabs(),function(a){var c='.ephox-pastry-tablayout-content[data-ephox-pastry-tablayout-view="'+a.name()+'"]';g.set(a.element(),"tabindex","-1");f.add(a.element(),e.resolve("tab-button"));l.descendant(k.body(),
c).each(function(c){var e=b.generate("ephox-aria");g.set(a.element(),"id",e);d.tabButton(a.element(),a.name());d.tabPanel(c);d.linkTabToPanel(a.element(),c);d.labelledBy(c,e)})});return{element:k.element,tabs:k.tabs,body:k.body,menu:k.menu,destroy:k.destroy,events:k.events}}});k("wf","b 1o 7 1j 2n 31".split(" "),function(c,d,b,a,e,g){return function(f){var h=2===d.keys(f.integration).length,l=a.aboutTags(h,f.integration);return{content:function(a){return c.foldl(l,function(a,b){return a.replace(b.str(),
b.replace())},a)},dom:h?function(a){g.descendant(a,".ephox-polish-help-integration").each(function(a){e.set(a,"display","block")})}:b.noop}}});k("wg","7v 7 s 33 1y 3u l 2o 2q 31 o 36".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p){var k=function(a){var b=a.baseUrl;!0===a.source&&(b+="/licenses");return b+"/textbox-licenses.html"};return function(q,s,t){var u=b.none(),v=b.none(),w=k(t),x=function(a,c){var d=s.content(c.trim());u=b.some(d);y(a,d)},y=function(b,d){var g=f.fromHtml(d.trim());s.dom(g);l.empty(b);
e.remove(b,a.resolve("tablayout-loading"));B(g);var m=f.fromTag("div");c.document(m);h.append(m,g);h.append(b,m)},B=function(a){A();v=m.descendant(a,".ephox-license-link").map(function(a){return g.bind(a,"click",function(a){p.open(w,"","height=700,width=620,resizable=yes,scrollbars=yes")})})},z=function(a){q.get(function(b){b.fold(function(b){a("&nbsp;");n.error("Unable to download help article",b)},a)})},A=function(){v.each(function(a){a.unbind()})};return{render:function(b){u.fold(function(){e.add(b,
a.resolve("tablayout-loading"));z(d.curry(x,b))},function(a){y(b,a)})},destroy:function(){A()}}}});k("10b",["3s","mp"],function(c,d){return function(b){return c.nu(function(a){var c=d();c.onload=function(b){a(b.target.result)};c.readAsText(b)})}});k("10c",["2i"],function(c){return function(){return new (c.getOrDie("XMLHttpRequest"))}});k("wi","a 1o 6 10b 3s 10c s p v o".split(" "),function(c,d,b,a,e,g,f,h,l,m){var n={"*":"*/*",text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"};
return{ajax:function(p,k,q,s){var t=b.merge({url:p,contentType:"application/json",processData:!1,type:"GET"},s),u=g();u.open(t.type.toUpperCase(),t.url,!0);"blob"===t.responseType&&(u.responseType=t.responseType);c.isString(t.contentType)&&u.setRequestHeader("Content-Type",t.contentType);var v=t.dataType;s=c.isString(v)&&"*"!==v?n[v]+", "+n["*"]+"; q=0.01":n["*"];u.setRequestHeader("Accept",s);void 0!==t.xhrFields&&!0===t.xhrFields.withCredentials&&(u.withCredentials=!0);c.isObject(t.headers)&&d.each(t.headers,
function(a,b){c.isString(b)||c.isString(a)?u.setRequestHeader(b,a):m.error("Request header data was not a string: ",b," -> ",a)});var w=function(){var b;b="blob"===t.responseType?f.from(u.response).map(a).getOr(e.pure("no response content")):e.pure(u.responseText);b.get(function(a){0===u.status?q("Unknown HTTP error (possible cross-domain request)",u.status,a):q('Could not load url "'+p+'": '+u.statusText,u.status,a)})},x=function(){var a;if("json"===v)try{a=h.value(JSON.parse(u.response))}catch(b){a=
h.error({status:u.status,statusText:"Response was not JSON",responseText:u.responseText})}else a=h.value(u.response);a.fold(w,function(a){k(a)})};u.onerror=w;u.onload=function(){0===u.status?l.startsWith(t.url,"file:")?x():w():100>u.status||400<=u.status?w():x()};void 0===t.data?u.send():u.send(t.data)}}});k("p6",["6","wi","vv"],function(c,d,b){return{get:function(a,b,g,f){d.ajax(a,b,g,c.merge({dataType:"text",type:"GET"},f))},post:function(a,e,g,f,h){d.ajax(a,g,f,c.merge({dataType:"text",data:b.stringify(e),
type:"POST"},h))}}});k("ha",["p6","2l","p"],function(c,d,b){return{get:function(a,e){return d.nu(function(d){c.get(a,function(a){d(b.value(a))},function(a,c,e){d(b.error({message:a,status:c,text:e}))},e)})}}});k("wh","a 1o 4l ha 7 p 1f 1j o".split(" "),function(c,d,b,a,e,g,f,h,l){var m=function(a,b){return a.map(function(a){return a.bind(function(a){var e=a[b];return void 0===e?g.error("Cannot find method "+b+" in help article list: "+d.keys(a)):c.isFunction(e)?g.value(e()):g.error("Key "+b+" in help article list was not a function")})})},
n=function(a){a=b.addScript(a,e.identity);a.get(function(a){a.each(function(a){h.weakMatch(a.version,"Help articles").each(function(a){l.warn(a)})})});return{about:m(a,"about"),accessibility:m(a,"accessibility"),a11ycheck:m(a,"a11ycheck"),markdown:m(a,"markdown"),shortcuts:m(a,"shortcuts")}};return function(b){!0===b.source?(b=b.baseUrl+"/help/"+f.get()+"/",b={about:a.get(b+"about.html"),accessibility:a.get(b+"accessibility.html"),a11ycheck:a.get(b+"a11ycheck.html"),markdown:a.get(b+"markdown.html"),
shortcuts:a.get(b+"shortcuts.html")}):b=n(b.baseUrl+"/help_"+f.get()+".js?"+h.resourceParam());return b}});k("ou","c gb 7 s k wf wg wh 73".split(" "),function(c,d,b,a,e,g,f,h,l){var m=function(b,c){return b?a.some(c):a.none()};return function(a){var p={content:b.identity,dom:b.noop},k=c.detect(),q=h(a),k=!k.deviceType.isTouch();a=[m(k,d(l.translate("help.dialog.shortcuts"),f(q.shortcuts,p,a))),m(k,d(l.translate("help.dialog.accessibility"),f(q.accessibility,p,a))),m(!0,d(l.translate("help.dialog.markdown"),
f(q.markdown,p,a))),m(k,d(l.translate("help.dialog.a11ycheck"),f(q.a11ycheck,p,a))),m(!0,d(l.translate("help.dialog.about"),f(q.about,g(a),a)))];return e.cat(a)}});k("h1","b g2 8h gc 7 g3 g4 ot ou 73 3m 33 54 46 1a 1y 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,k,q,s,t,u){var v=function(a){var c={item:e.constant(".ephox-pastry-statebutton.ephox-pastry-tablayout-item")},g=d.flow({trigger:f.button,executeOnArrow:!0});return b.flow(a.menu(),c,g)},w=function(a){var c={stops:e.constant(["a"])},g=d.page({trigger:f.click,
first:".ephox-pastry-tablayout-active"});return b.page(a.body(),c,g)};return function(d,e){var f=q.create({close:k([])}),z=g(d),A=l(e),C=h(a.left(),A,"help");s.set(C.body(),"tabindex","-1");t.add(z.element(),p.resolve("help-modal"));var D=u.children(C.element());c.each(D,n.register);z.setTitle(m.translate("cog.help"));z.setContent(C.element());var F=v(C),D=w(C),E=b.multiple(z.element(),[F,D]);C.events.setActive.bind(function(a){F.clickFocus(a.item().element())});var G=function(){z.hide()};z.events.close.bind(function(){E.exit();
G()});E.events.exit.bind(function(){G();f.trigger.close()});return{element:z.element,open:function(){z.show();E.enter()},destroy:function(){C.destroy();z.destroy();E.destroy();c.each(A,function(a){a.renderer().destroy()})},hide:G,events:f.registry}}});k("92",["h1","54","46","q"],function(c,d,b,a){return function(a,g){var f=c(a,g),h=function(){l.trigger.analytics("help_screen_hide");l.trigger.close();m()},l=b.create({close:d([]),analytics:d(["message"])});f.events.close.bind(h);var m=function(){f.events.close.unbind(h);
f.destroy()};return{show:function(){l.trigger.analytics("help_screen_show");f.open()},destroy:m,events:l.registry}}});k("5m","7 71 92 73 6t 74 54 46 3t".split(" "),function(c,d,b,a,e,g,f,h,l){return function(l,n){var p=l.content(),k=l.smartview(),q=l.shortcuts(),s=h.create({analytics:f(["message"])}),t=d.destroyable(),u=function(){var a=b(k.uiContainer(),n);t.set(a);a.events.close.bind(function(){p.toEditing();t.clear()});a.events.analytics.bind(function(a){s.trigger.analytics(a.message())});p.toReading();
l.content().hideInlineSelection();a.show()};q.events.help.bind(u);return{ui:e.ui({"help.general":{toggle:!1,value:"help",textkey:a.key("cog.help"),action:u,updateGeneral:c.noop,icon:!0,hasPopup:!1,hasDialog:!0,tooltip:g.get}}),events:s.registry,destroy:function(){t.clear()}}}});k("94",["2u"],function(c){return c.immutable("prefix","suffix","style")});k("95","b s 93 4b 2n l 2o 3c 21 2q ak 2a v".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,k){return{rehighlight:function(q,s,t){var u=p.children(t),v=
c.bind(u,function(a){return l.isText(a)?n.get(a):""}).join("");d.from(c.find(s,function(a){return k.startsWith(v,a.prefix())&&k.endsWith(v,a.suffix())})).fold(function(){q.preserve(function(){m.unwrap(t)})},function(c){var d=g.fromTag("span");a.add(d,[b.highlightClass()]);e.setAll(d,c.style());q.preserve(function(){f.before(t,d);h.append(d,u);m.remove(t)})})},unhighlight:function(c,d){var e=p.children(d),l=g.fromTag("span");a.add(l,[b.placeholderClass()]);c.preserve(function(){f.before(d,l);m.unwrap(d);
h.append(l,e)})}}});k("96","b 7 h2 h3 6j h4 h5 93 h6 f0 ca 4b 2n l 21 6h ak".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,k,q,s,t,u){var v=function(a,b){var g=c.bind(b,function(a){var b=e.sanitise(a.prefix()),c=e.sanitise(a.suffix()),b=e.unsafetoken(b+"[^"+c+"]*"+c);return{pattern:d.constant(b),style:a.style}});return f.findmany(a,g)},w=m("."+h.highlightClass(),n.unwrap);return{run:function(d,e){d.body().each(function(d){l.filterDom(d,[w]);d=t.descendants(d,s.isText);c.each(d,function(d){var f=u.get(d),
f=v(f,e),l=c.bind(f,function(a){return[a.start(),a.finish()]}),m=b.subdivide(d,l);c.each(f,function(b){var d=g.sublist(m,b.start(),b.finish()),d=c.map(d,function(a){return a.element()});a.wrapper(d,function(){var c=q.fromTag("span");p.add(c,[h.highlightClass()]);k.setAll(c,b.style());return a.nu(c)})})})})}}});k("5n","b 93 94 95 96 3i 4b 2n l 2f 2o 31".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p){return function(k,q,s){var t=k.filter(),u=k.content(),v=k.operations();d.configure(t);var w=void 0===
s.external?[]:c.map(s.external,function(a){return b(a.prefix,a.suffix,a.style)});c.each(w,function(a){var b=g(a.prefix(),a.suffix(),function(b){var c=l.fromTag("span");f.add(c,[d.highlightClass()]);h.setAll(c,a.style());var e=l.fromTag("div");n.append(c,l.fromText(a.prefix()+b+a.suffix()));n.append(e,c);return m.get(e)});q.customMacros().add(b)});u.events.nodeChanged.bind(function(b){u.getSelection().each(function(c){b.prev().each(function(b){p.ancestor(b,"."+d.placeholderClass()).each(function(b){a.rehighlight(v,
w,b)})});p.ancestor(c.startContainer(),"."+d.highlightClass()).each(function(b){a.unhighlight(v,b)})})});return{run:function(){e.run(u,w)},destroy:function(){}}}});k("5o","97 7 7u 73 6t l".split(" "),function(c,d,b,a,e,g){return function(f){var h=f.content();return{ui:e.ui({"horizontalrule.general":{toggle:!1,value:"horizontalrule",textkey:a.key("insert.horizontalrule"),action:function(){b.insertAtCursor(h,[g.fromTag("hr")]).each(function(a){a=c.after(a.element());h.setRelativeSelection(a,a);h.toEditing()})},
updateGeneral:d.noop,icon:!0,shortcut:!1,hasPopup:!1}}),destroy:d.noop}}});k("p3","b a7 6 7 p 73 33 2u 1y 2n l 4e 32 dg".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,k,q){var s=f.resolve("input-invalid-field"),t=function(a){return q(a,10).toString()===a&&0<=q(a,10)},u=function(a,b,c){var d=k.get(a);if(""===d)return e.value("");var f=n.fromTag("img");c=t(d)?d+c.getOr(""):d;m.set(f,b,c);c=m.getRaw(f,b);m.remove(f,b);return c.fold(function(){return e.error(a)},e.value)},v=function(a){l.remove(a,s)};return{highlight:function(a){d.shout(a,
g.translate("aria.input.invalid"));l.add(a,s)},dehighlight:v,clearHighlights:function(a){a=p.descendants(a,"."+s);c.each(a,v)},validate:function(d){return c.foldr(d,function(c,d){return c.bind(function(c){return u(d.input(),d.property(),d.defaultUnit()).map(function(e){k.set(d.input(),e);var f={};f[d.property()]=a.constant(e);return b.deepMerge(f,c)})})},e.value({}))},validateField:u,rule:h.immutable("input","property","defaultUnit")}});k("p4","b 7v er 2z c 4z gp 7 g4 73 33 1a 1y l 2y 2o 3c 31 2a".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,p,k,q,s,t,u,v,w){e.detect().browser.isFirefox();return function(e){var y=n.resolve("dialog-float-selected"),B=q.fromTag("fieldset");p.set(B,"role","radiogroup");e=q.fromHtml("<legend>"+m.translate(e)+"</legend>");var z=a.generate("ephox-aria");p.set(e,"id",z);p.set(B,"aria-labelledby",z);var A=g.div();k.add(A,n.resolve("dialog-float-options"));u.append(B,[e,A]);var C=function(){c.each(D,function(a){k.remove(a.element(),y);b.checked(a.element(),!1)})},D=c.map(["none",
"center","left","right"],function(a){var c=f(),e=m.translate("align."+a);p.setAll(c.element(),{tabindex:"-1","data-float-value":a,title:e,"aria-label":e,role:"radio"});a=g.div();var e=g.div(),h=g.div(),l=g.div();d.hidden(a,!0);k.add(e,n.resolve("dialog-float-icon-inner-left"));k.add(h,n.resolve("dialog-float-icon-inner-center"));k.add(l,n.resolve("dialog-float-icon-inner-right"));u.append(a,[e,h,l]);c.events.click.bind(function(){C();k.add(c.element(),y);b.checked(c.element(),!0);s.focus(c.element())});
k.add(c.element(),n.resolve("dialog-float-container"));k.add(a,n.resolve("dialog-float-icon"));t.append(c.element(),a);return c});u.append(A,c.map(D,function(a){return a.element()}));var F=l.radio(B,"."+n.resolve("dialog-float-container"),"."+n.resolve("dialog-float-selected"));return{element:function(){return B},get:function(){return v.child(A,"."+y).map(function(a){return p.get(a,"data-float-value")})},select:function(a){C();a.each(function(a){v.child(A,'span[data-float-value="'+a+'"]').or(w.firstChild(A)).each(function(a){k.add(a,
y);b.checked(a,!0)})});F.refresh()},keylayout:h.constant(F),destroy:function(){c.each(D,function(a){a.destroy()})}}}});k("p5",["s","wb","2u","1s"],function(c,d,b,a){var e=b.immutable("size","unit"),g=function(a){return d.identify(a).fold(c.none,function(a,b,d){return c.some(e(b,d))})};return{fromHeight:function(b,c){return g(c).map(function(c){return a.ceil(b*c.size())+c.unit()})},fromWidth:function(b,c){return g(c).map(function(c){return a.ceil(1/b*c.size())+c.unit()})},calculate:function(a,b){return g(a).fold(c.none,
function(a){return g(b).fold(c.none,function(b){return c.some((a.size()+0)/(b.size()+0))})})}}});k("h7","7v er 2z g2 8h 4z gq l1 7 s g4 l2 p3 p4 99 73 p5 33 1a 1y 1b 3u l 2y 3c 32 1v dg".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,k,q,s,t,u,v,w,x,y,B,z,A,C,D,F,E){return function(){var E=g.div(),H=g.div(),I=g.div(),L=g.div();x.add(I,v.resolve("image-url-controls"));x.add(L,v.resolve("image-size-controls"));var J=q("image.dialog.fields.align"),K=p.input("image-url","image.dialog.fields.url"),M=p.input("image-alt",
"image.dialog.fields.alt"),N=p.input("image-width","image.dialog.fields.width"),S=p.input("image-height","image.dialog.fields.height"),Q=z.fromTag("input");w.set(Q,"type","hidden");var P=h("lock");x.add(P.element(),v.resolve("dialog-button"));var R=f([v.resolve("icon"),v.resolve("image-lock-button")]);w.set(P.element(),"title",t.translate("image.dialog.fields.constrain.on"));c.toolbarButton(P.element(),t.translate("image.dialog.fields.constrain.label"),!1,!0);d.press(P.element());P.select();P.content(R);
P.events.click.bind(function(){A.focus(P.element());var a=P.selected()?"on":"off";w.set(P.element(),"title",t.translate("image.dialog.fields.constrain."+a));(P.selected()?d.press:d.release)(P.element())});R=g.div();x.add(R,v.resolve("form-group"));x.add(R,v.resolve("form-group-lock"));var O=z.fromHtml("<label>"+t.translate("image.dialog.fields.constrain.label")+"</label>"),T="constrain"+b.generate("");w.set(P.element(),"id",T);w.set(O,"for",T);var W=function(a){a.isLocal()?(w.set(K.input(),"disabled",
"disabled"),D.set(K.input(),t.translate("image.dialog.fields.urllocal"))):(w.remove(K.input(),"disabled"),D.set(K.input(),a.url()))},X=function(a,b,c){var d=F(D.get(Q),10);a=D.get(a);D.set(b,c(d,a).getOrThunk(function(){return D.get(b)}));k.dehighlight(b)},T=function(a){k.validateField(a.target(),"width",m.some("px")).fold(function(){k.highlight(a.target())},function(b){k.dehighlight(a.target());b=a.target();P.selected()&&(y.eq(b,N.input())?X(N.input(),S.input(),u.fromWidth):y.eq(b,S.input())&&X(S.input(),
N.input(),u.fromHeight))})},V=function(a){if(w.has(a.target(),"placeholder")){var b=w.get(a.target(),"placeholder");""===D.get(a.target())&&D.set(a.target(),b)}},aa=B.bind(N.input(),"input",T),ca=B.bind(S.input(),"input",T),Z=B.bind(N.input(),"focus",V),ba=B.bind(S.input(),"focus",V);C.append(R,[O,P.element()]);C.append(H,[J.element()]);C.append(I,[K.element(),M.element()]);C.append(L,[N.element(),S.element(),R]);C.append(E,[I,L,H]);H=[e.input(K.input(),a.input({})),e.input(M.input(),a.input({})),
e.input(N.input(),a.input({})),e.input(S.input(),a.input({})),e.button(P.element(),a.button({execute:n.button})),J.keylayout()];return{element:l.constant(E),destroy:function(){P.destroy();aa.unbind();ca.unbind();Z.unbind();ba.unbind();J.destroy()},dehighlight:l.curry(k.clearHighlights,E),highlight:k.highlight,keylayouts:l.constant(H),set:function(a){W(a);D.set(M.input(),a.alt());D.set(N.input(),a.width());D.set(S.input(),a.height());var b=a.computedWidth().bind(function(b){return a.computedHeight().bind(function(a){return u.calculate(b,
a)})}).getOr(1);a.computedWidth().each(l.curry(w.set,N.input(),"placeholder"));a.computedHeight().each(l.curry(w.set,S.input(),"placeholder"));D.set(Q,b);J.select(a.align())},get:function(){return k.validate([k.rule(N.input(),"width",m.some("px")),k.rule(S.input(),"height",m.some("px"))]).map(function(a){return s.properties({url:D.get(K.input()),alt:D.get(M.input()),width:a.width(),height:a.height(),isLocal:w.has(K.input(),"disabled"),align:J.get()})})}}}});k("98","s g3 g4 99 h7 73 g5 33 54 46 4m 1y".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,p){return function(k){var q=m.create({ok:l(["image","properties"]),close:l([])}),s=n(c.none()),t=d(k),u=f.okCancel("image-properties"),v=e();t.setContent(v.element());p.add(t.element(),h.resolve("dialog-narrow"));k=function(){var a=v.get();v.dehighlight();a.fold(function(a){v.highlight(a)},function(a){s.get().each(function(b){q.trigger.ok(b,a)})})};u.events.ok.bind(k);u.events.cancel.bind(function(){t.hide();q.trigger.close()});t.setTitle(g.translate("image.dialog.title"));
t.setControls(u.element());t.events.close.bind(function(){q.trigger.close()});var w=b.setup(t,u,v.keylayouts());return{element:t.element,open:function(){t.show();w.enter()},hide:function(){w.exit();t.hide()},destroy:function(){t.destroy();w.destroy();u.destroy();v.destroy()},represent:function(b){var d=a.divine(b);s.set(c.some(b));v.set(d)},execute:k,events:q.registry}}});k("9a","b 7 s 73 54 46 2u 1a 21".split(" "),function(c,d,b,a,e,g,f,h,l){var m=f.immutable("value","text","attrs"),n=function(a){return"img"===
l.name(a)};return{image:function(){var c=b.none(),f=g.create({properties:e(["image"]),contextmenu:e(["image"])});return{situation:function(b){b=c.map(function(b){return[m("imagemenu-properties",a.translate("image.context.properties"),{})]}).getOr([]);return{primary:d.constant(b),secondary:d.constant([]),submenus:d.constant([])}},handle:function(a){c.each(function(a){f.trigger.properties(a)})},assign:function(a){c=a.filter(n);c.each(f.trigger.contextmenu)},events:f.registry}},imageEdit:function(e,
f,g){var l=b.none(),k=function(b){return c.map(b,function(b){return m(b.spec.value,a.get(b.spec.textkey),{})})};return{situation:function(a){a=l.map(k).getOr([]);return{primary:d.constant(a),secondary:d.constant([]),submenus:d.constant([])}},handle:function(a){l.each(function(b){var d=h.get(a,"data-ephox-gopher-item-value");b=c.find(b,function(a){return a.spec.value===d});void 0!==b&&b.spec.action()})},assign:function(a){l=e()?b.some(f):a.filter(n).map(d.constant(g))}}}}});k("9b",["54","46","47"],
function(c,d,b){return{generate:function(a,e,g){a=function(){h();f.trigger.close()};var f=d.create({ok:b(g,e.events.ok),close:c([])});e.events.close.bind(a);var h=function(){e.destroy()};return{open:function(){e.open()},hide:a,destroy:h,represent:e.represent,events:f.registry}}}});k("5p","7 98 99 9a 9b 54 46 47".split(" "),function(c,d,b,a,e,g,f,h){return function(l,m){var n=a.image(l.content()),p=f.create({changed:g(["image"]),contextmenu:h(["image"],n.events.contextmenu)}),k=function(a){var c=l.content(),
f=d(l.smartview().uiContainer()),g=e.generate(l.keyboard(),f,["image","properties"]);g.events.ok.bind(function(a){b.apply(a.image(),a.properties());p.trigger.changed(a.image());g.destroy();c.uiChanged();c.focus()});g.events.close.bind(function(a){g.destroy();c.focus()});g.represent(a);g.open()};n.events.properties.bind(function(a){k(a.image())});return{destroy:c.noop,situation:n.situation,handle:n.handle,assign:n.assign,events:p.registry,fireChanged:function(a){p.trigger.changed(a)}}}});k("9d","b 1o 7 gf 4n 1a 2n".split(" "),
function(c,d,b,a,e,g,f){var h=e.generate([{html:["key","value"]},{css:["key","value"]}]),l=function(a,b){return c.flatten(d.mapToArray(a,function(a,c){var d=[];if(g.has(b,c)){var e=g.get(b,c);d.push(h.html(a,e))}f.getRaw(b,c).each(function(b){d.push(h.css(a,b))});return d}))},m=function(a){f.remove(a,"width");f.remove(a,"height");g.remove(a,"width");g.remove(a,"height")};e=b.curry(l,{width:"width",height:"height"});l=b.curry(l,{width:"height",height:"width"});b=b.constant([]);return{keepCrop:b,keepFlip:e,
keepRotate:l,keepResample:b,updater:function(b,d){var e=b(d);return a.effect(function(){m(d);c.each(e,function(a){a.fold(function(a,b){g.set(d,a,b)},function(a,b){f.set(d,a,b)})})})}}});k("h9",["6"],function(c){var d={strictMode:!1,key:"source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@\/]*)(?::([^:@\/]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,
loose:/^(?:(?![^:@\/]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*)(?::([^:@\/]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},b=function(a,b){for(var c=b.parser[b.strictMode?"strict":"loose"].exec(a),d={},h=14;h--;)d[b.key[h]]=c[h]||"";d[b.q.name]={};d[b.key[12]].replace(b.q.parser,function(a,c,g){c&&(d[b.q.name][c]=g)});return d};return{parse:function(a,e){var g=c.merge(d,e);return b(a,g)}}});k("h8",["v","h9","w"],
function(c,d,b){var a=function(a){return""!==a.trim()&&!c.contains(a,"://")};return{local:function(a){return c.startsWith(a,"data:")||c.startsWith(a,"blob:")||c.startsWith(a,"file:")},relative:a,sameDomain:function(b,c){if(""===b.trim()||""===c.trim())return!1;if(a(b))return!0;var f=d.parse(c),h=d.parse(b);return f.host===h.host&&f.port===h.port}}});k("9e",["h8","8p","2u","h9"],function(c,d,b,a){var e=b.immutable("bannerMessage","consoleMessage"),g=function(a){return void 0!==a.message&&void 0!==
a.status&&void 0!==a.text};return{diagnoseImageEdit:function(b,h){var l=18===b.code||"SecurityError"===b.name?"imageedit.needsproxy":g(b)&&0===b.status?"imageedit.proxyerror":"imageedit.generic",m;m=a.parse(h);m=""===m.host||c.relative(h)?h:""===m.port?m.host:m.host+":"+m.port;l=d.get(l,[m]);m=g(b)?b.message+". Response code "+b.status+". Error details: "+b.text:b;return e(l,m)}}});k("hb",["p7"],function(c){return{blobToImage:function(d){return c.blobToImage(d)},imageToBlob:function(d){return c.imageToBlob(d)},
blobToDataUri:function(d){return c.blobToDataUri(d)},blobToBase64:function(d){return c.blobToBase64(d)}}});k("9f","1 6 ha s gf h8 1a hb w".split(" "),function(c,d,b,a,e,g,f,h,l){return function(m){var n={responseType:"blob"},p=function(a,c){var e=d.merge(c||{},m.headers(),n);return b.get(a,e)},k=function(a){return!(g.local(a)||g.sameDomain(a,l(c.location)))};return{getImage:function(b){var c=f.get(b,"src");return(k(c)?m.proxy(c):a.none()).fold(function(){return e.fromPromise(h.imageToBlob(b.dom()))},
p)}}}});k("9g",["7","73","74"],function(c,d,b){return{make:function(a,e,g){return{type:"general",spec:{value:a,textkey:d.key(e),action:g,updateGeneral:c.noop,icon:!0,hasPopup:!1,toggle:!1,tooltip:b.get}}}}});k("6g",["4g","7"],function(c,d){var b=d.constant(4);return{resolve:c.create("ephox-clipper").resolve,CORNER_SIZE:b}});k("p8","6g 3s 7 1a 1y 2n 3u l 3c 1s dg".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){var p=function(a,c){var d={left:"0px",top:"0px",width:a.width()+"px",height:a.height()+"px"},
e={left:g.get(c,"left"),top:g.get(c,"top"),width:g.get(c,"width"),height:g.get(c,"height")};return{outside:b.constant(d),inside:b.constant(e)}};return{snap:function(b,k){var s=p(b,k),t=h.fromTag("div");e.add(t,c.resolve("dynamic-box"));g.setAll(t,s.outside());var u=h.fromTag("div");e.add(u,c.resolve("opaque-box"));g.setAll(u,s.outside());var v=function(a,b){return 2<m.abs(n(a,10)-n(b,10))},w=function(a){return d.nu(function(b){b(a)})},x=function(a,b){return d.nu(function(c){var d=f.bind(a,"transitionend",
function(){d.unbind();c(a)});g.setAll(a,b.inside())})};return{prepare:function(b,d,f){var h=a.get(d,"src"),m=g.get(d,"width");d=g.get(d,"height");g.setAll(k,{"background-image":"url("+h+")","background-size":m+" "+d,"background-position-x":-f.left()+"px","background-position-y":-f.top()+"px"});e.add(k,c.resolve("snapshot"));e.add(t,c.resolve("dynamic-box-animate"));l.append(b,[t,u]);g.reflow(b)},showcase:function(){var a=s.outside(),b=s.inside();return v(a.left,b.left)||v(a.top,b.top)||v(a.right,
b.right)||v(a.bottom,b.bottom)?x(t,s):w(t)}}}}});k("hc",["p8","3s","7"],function(c,d,b){return{slide:function(){return{animate:function(a,d,g,f){g=c.snap(g.box(),g.shade());g.prepare(a,d,{left:f.cropX,top:f.cropY,width:f.cropWidth,height:f.cropHeight});return g.showcase().map(b.constant(f))}}},none:function(){return{animate:function(a,b,c,f){return d.pure(f)}}}}});k("p9",["2u"],function(c){return c.immutableBag("displayWidth displayHeight cropX cropY cropWidth cropHeight".split(" "),[])});k("wj",
["3u","3t"],function(c,d){return{bind:function(b,a){return c.bind(b,"mousedown",function(b){b.kill();var g=b.target(),f=!1,h=c.bind(g,"mouseup",function(){f=!0;h.unbind()});d(function(){f||(h.unbind(),a(g))},250)})}}});k("pb",["2u"],function(c){var d=c.immutableBag(["top","left","width","height"],[]),b=c.immutableBag(["top","left"],[]);c=c.immutableBag(["top","left"],[]);return{boxModel:d,delta:b,cornersMovements:c}});k("wk",["pb","1s"],function(c,d){var b=function(a,b){var c=d.min(a.top()+a.height(),
d.max(0,a.top()+b.top())),e=c-a.top(),e=a.height()-e;return{top:c,height:e}},a=function(a,b,c){a=d.min(a.width(),d.max(b.left(),b.left()+b.width()+c.left()))-b.left()-b.width();return{width:b.width()+a}},e=function(a,b,c){return d.min(a.height(),d.max(b.top(),b.top()+c.top()+b.height()))-b.top()},g=function(a,b){var c=d.min(a.width()+a.left(),d.max(0,a.left()+b.left())),e=c-a.left(),e=a.width()-e;return{left:c,width:e}};return{nw:function(a,d,e){a=b(d,e);d=g(d,e);return c.boxModel({left:d.left,width:d.width,
top:a.top,height:a.height})},n:function(a,d,e){a=b(d,e);return c.boxModel({left:d.left(),width:d.width(),top:a.top,height:a.height})},ne:function(d,e,g){var m=b(e,g);d=a(d,e,g);return c.boxModel({left:e.left(),width:d.width,top:m.top,height:m.height})},e:function(b,d,e){b=a(b,d,e);return c.boxModel({left:d.left(),width:b.width,top:d.top(),height:d.height()})},se:function(b,d,g){var m=a(b,d,g);b=e(b,d,g);return c.boxModel({left:d.left(),width:m.width,top:d.top(),height:b})},s:function(a,b,d){a=e(a,
b,d);return c.boxModel({left:b.left(),width:b.width(),top:b.top(),height:a})},sw:function(a,b,d){a=e(a,b,d);d=g(b,d);return c.boxModel({left:d.left,width:d.width,top:b.top(),height:a})},w:function(a,b,d){a=g(b,d);return c.boxModel({left:a.left,width:a.width,top:b.top(),height:b.height()})},translate:function(a,b,e){var g=d.min(d.max(0,b.top()+e.top()),d.max(0,a.height()-b.height()));a=d.min(d.max(0,b.left()+e.left()),d.max(0,a.width()-b.width()));return c.boxModel({top:g,left:a,width:b.width(),height:b.height()})}}});
k("wl",["ke","a8","s","3k"],function(c,d,b,a){return{navigation:function(e,g){var f=function(c,d,e){return function(){g(c,a(d,e));return b.some(!0)}};return[c.rule(c.and([c.isShift,c.inSet(d.LEFT())]),f(e,-1,0)),c.rule(c.and([c.isShift,c.inSet(d.RIGHT())]),f(e,1,0)),c.rule(c.and([c.isShift,c.inSet(d.UP())]),f(e,0,-1)),c.rule(c.and([c.isShift,c.inSet(d.DOWN())]),f(e,0,1)),c.basic(d.LEFT()[0],f(e,-10,0)),c.basic(d.RIGHT()[0],f(e,10,0)),c.basic(d.UP()[0],f(e,0,-10)),c.basic(d.DOWN()[0],f(e,0,10))]}}});
k("10d",["6g","pb","1o","6","7"],function(c,d,b,a,e){var g=function(a,b,c){var g=b.top(),n=b.left()+b.width()/2-c.middle(),p=g+b.height()/2-c.middle(),k=b.left()+b.width()-c.right();a=b.left()-c.left();c=g+b.height()-c.bottom();b=d.cornersMovements({top:g,left:n});var n=d.cornersMovements({top:c,left:n}),q=d.cornersMovements({top:p,left:k}),p=d.cornersMovements({top:p,left:a}),s=d.cornersMovements({top:g,left:a}),g=d.cornersMovements({top:g,left:k}),k=d.cornersMovements({top:c,left:k});a=d.cornersMovements({top:c,
left:a});return{n:e.constant(b),s:e.constant(n),e:e.constant(q),w:e.constant(p),nw:e.constant(s),ne:e.constant(g),se:e.constant(k),sw:e.constant(a)}};return{calculate:function(a,b){var d={middle:e.constant(2*c.CORNER_SIZE()+1),right:e.constant(c.CORNER_SIZE()),left:e.constant(0),bottom:e.constant(c.CORNER_SIZE())};return g(a,b,d)},limitBounds:function(c,d){var g={};if(20>d.width()){var m=20-d.width();g.width=d.width()+m;g.left=d.left()===c.left()?c.left():d.left()-m}20>d.height()&&(m=20-d.height(),
g.height=d.height()+m,g.top=d.top()===c.top()?c.top():d.top()-m);return a.merge(d,b.map(g,e.constant))},doCalculate:g}});k("wo",["10d","6g","pb","1a","2n"],function(c,d,b,a,e){var g=function(c){return b.boxModel({left:parseInt(a.get(c,"data-"+d.resolve("image-left")),10),top:parseInt(a.get(c,"data-"+d.resolve("image-top")),10),width:parseInt(a.get(c,"data-"+d.resolve("image-width")),10),height:parseInt(a.get(c,"data-"+d.resolve("image-height")),10)})},f=function(b,c){a.set(b,"data-"+d.resolve("image-left"),
c.left());a.set(b,"data-"+d.resolve("image-top"),c.top());a.set(b,"data-"+d.resolve("image-width"),c.width());a.set(b,"data-"+d.resolve("image-height"),c.height())};return{readPosition:g,writePosition:f,updatePosition:function(a,b){var d=g(a),e=b(d),d=c.limitBounds(d,e);f(a,d);return d},drawAtOrigin:function(a){var b=g(a);e.setAll(a,{left:b.left()+"px",top:b.top()+"px",width:b.width()+"px",height:b.height()+"px"})}}});k("wm",["pb","wo","s"],function(c,d,b){return function(a,e,g){var f=b.none();return{setTarget:function(a){f=
b.some(a)},clearTarget:function(){f=b.none()},mutate:function(b,l){f.each(function(f){var n=c.delta({top:l,left:b}),p=d.updatePosition(g,function(b){return f(a,b,n)});d.drawAtOrigin(g,a);e.update(p)})}}}});k("49",["6g","7"],function(c,d){var b=c.resolve("magic-box");return{magicBox:d.constant(b)}});k("ws",["1a"],function(c){return{grab:function(d,b){c.set(d,"aria-grabbed",b)},effect:function(d,b){c.set(d,"aria-dropeffect",b)}}});k("wt","7v ci 2z 2u 1a 1y l 2o".split(" "),function(c,d,b,a,e,g,f,h){var l=
a.immutable("help","ids"),m=function(a){e.set(a,"role","gridcell")};return{base:function(a,b){e.setAll(a,{role:"grid","aria-label":b})},row:function(a){e.set(a,"role","row")},cell:function(a,b){m(a);e.set(a,"aria-label",b)},gridcell:m,createHelp:function(a,m,k){var q=f.fromTag("div");c.presentation(q);g.add(q,d.resolve("aria-help"));for(var s=[],t=0;t<m;t++){var u=b.generate("ephox-aria"),v=f.fromTag("span");c.presentation(v);e.set(v,"id",u);g.add(v,d.resolve("aria-help"));h.append(v,f.fromText(k.col(t+
1)));h.append(q,v);s[t]=u}t=[];for(u=0;u<a;u++){var v=b.generate("ephox-aria"),w=f.fromTag("span");c.presentation(w);e.set(w,"id",v);g.add(w,d.resolve("aria-help"));h.append(w,f.fromText(k.row(u+1)));h.append(q,w);t[u]=[];for(w=0;w<m;w++)t[u][w]=s[w]+" "+v}return l(q,t)}}});k("10e","10d wl 6g b ws wt 8h 2l 7 s 54 46 1a 4b 2n l 6d 2o 2r 3t w".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,k,q,s,t,u,v,w,x,y){var B=function(a,c,d){var f=t.fromTag("div");s.set(f,"position","absolute");var h=t.fromTag("div");
v.append(f,h);d.each(function(a){g.cell(f,a);e.grab(f,!1)});q.add(f,[b.resolve("corner-wrapper"),b.resolve("corner-wrapper-"+c)]);q.add(h,[b.resolve("corner-element"),b.resolve("corner-"+a)]);k.set(f,"data-"+b.resolve("direction"),c);return f},z=function(a,b){s.setAll(a,{top:b.top()+"px",left:b.left()+"px"})},A=function(b,c,d){var e=c()<d()?0:1;a.each(b,function(a){s.set(a,"opacity",y(e))})};return function(a){var b=p.create({reposition:n(["direction","delta"])}),e=B("top","n",m.none()),g=B("bottom",
"s",m.none()),k=B("right","e",m.none()),r=B("left","w",m.none()),q=B("top-left","nw",m.some(a("image.crop.handle.nw"))),t=B("top-right","ne",m.some(a("image.crop.handle.ne"))),v=B("bottom-right","se",m.some(a("image.crop.handle.se"))),y=B("bottom-left","sw",m.some(a("image.crop.handle.sw"))),M=h.nu(function(a){x(function(){s.reflow(e);var b=w.get(e),c=u.get(e);a(l.constant(3*b+2*c))},0)}),N=b.trigger.reposition;a=[e,g,k,r,t,q,v,y];N=[f.single(q,d.navigation("nw",N),m.none()),f.single(t,d.navigation("ne",
N),m.none()),f.single(v,d.navigation("se",N),m.none()),f.single(y,d.navigation("sw",N),m.none())];return{elements:l.constant(a),keylayouts:l.constant(N),events:b.registry,refresh:function(a,b){var d=c.calculate(a,b);z(e,d.n());z(g,d.s());z(k,d.e());z(r,d.w());z(q,d.nw());z(y,d.sw());z(v,d.se());z(t,d.ne());M.get(function(a){A([e,g],b.width,a);A([k,r],b.height,a)})}}}});k("139",["pb","7"],function(c,d){return{derive:function(b,a){return{leftRim:function(){var d=a.left(),g=b.height();return c.boxModel({top:0,
left:0,width:d,height:g})},topRim:function(){var d=a.left(),g=b.width()-a.left(),f=a.top();return c.boxModel({top:0,left:d,width:g,height:f})},rightRim:function(){return c.boxModel({top:a.top(),left:a.left()+a.width(),width:b.width()-a.width()-a.left(),height:b.height()-a.top()})},bottomRim:function(){return c.boxModel({top:a.top()+a.height(),left:a.left(),width:a.width(),height:b.height()-a.height()-a.top()})},shadeBox:d.constant(a)}}}});k("10f","139 6g 7 4b 2n l".split(" "),function(c,d,b,a,e,g){var f=
function(b){var c=g.fromTag("div");a.add(c,[d.resolve("panel-"+b),d.resolve("side-panel")]);return c},h=function(a,b){e.setAll(a,{top:b.top()+"px",left:b.left()+"px",width:b.width()+"px",height:b.height()+"px"})};return function(){var a=f("left"),d=f("top"),e=f("right"),g=f("bottom");return{elements:b.constant([a,d,e,g]),refresh:function(b,f){var k=c.derive(b,f);h(a,k.leftRim());h(d,k.topRim());h(e,k.rightRim());h(g,k.bottomRim())}}}});k("wn","49 wk 6g 10e 10f b ws wt 7 s 54 46 47 1a 1y 2n l 2o 3c 2q 31".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,p,k,q,s,t,u,v,w,x,y){return function(B,z,A,C){var D=u.fromTag("div");s.add(D,c.magicBox());h.base(D,C("image.crop.begin"));f.effect(D,"execute");var F=u.fromTag("div");q.set(F,"role","row");var E=e(),G=a(C),H=function(a){t.setAll(D,{top:a.top()+"px",left:a.left()+"px"})};C=function(a){var b=B();H(b);E.refresh(b,a);G.refresh(b,a);I.trigger.updated(a)};w.append(F,g.flatten([E.elements(),[z],G.elements()]));v.append(D,F);var I=p.create({updated:n(["newBounds"]),reposition:k(["direction",
"delta"],G.events.reposition)});C(A);z=G.keylayouts();return{element:l.constant(D),bitsbox:l.constant(F),keylayouts:l.constant(z),move:H,update:C,destroy:function(){x.remove(D)},events:I.registry,tryMovement:function(a){return y.closest(a,"."+b.resolve("corner-wrapper")).bind(function(a){a=q.get(a,"data-"+b.resolve("direction"));return void 0!==d[a]?m.some(d[a]):m.none()})}}}});k("pa","wj wk wl wm 6g pb wn wo b ib ws wt 8h 7 s 54 46 47 1a 4b 3u l 2y 2o 31 2a 1s".split(" "),function(c,d,b,a,e,g,f,
h,l,m,n,p,k,q,s,t,u,v,w,x,y,B,z,A,C,D,F){var E=function(a){var b=a.width();a=a.height();var c=F.floor(0.125*a),d=F.floor(0.125*b);return g.boxModel({top:c,left:d,width:b-2*d,height:a-2*c})};return function(g,F,I,L){var J=B.fromTag("div");x.add(J,[e.resolve("panel-central"),e.resolve("side-panel")]);w.set(J,"tabindex","-1");p.cell(J,L("image.crop.handle.shade"));n.grab(J,!1);var K=E(g());h.writePosition(J,K);h.drawAtOrigin(J);var M=f(g,J,K,L);A.append(F,M.element());var N=a(g(),M,J),S=m.transform(N),
Q=y.bind(J,"dblclick",function(){V.trigger.apply()}),P=c.bind(M.element(),function(a){M.tryMovement(a).orThunk(function(){return C.closest(a,"."+e.resolve("panel-central")).map(function(){return d.translate})}).each(R)}),R=function(a){S.off();N.clearTarget();N.setTarget(a);S.on();S.go(I)},O=function(a,b){var c=h.updatePosition(J,function(c){return d[a](g(),c,b)});h.drawAtOrigin(J);M.update(c)};L=l.flatten([M.keylayouts(),[k.single(J,b.navigation("translate",O),s.none())]]);var T=function(){var a=
g();return y.bind(D.defaultView(F),"resize",function(){var b=g();if(b.height()!==a.height()||b.width()!==a.width())V.trigger.cancel();else if(b.top()!==a.top()||b.left()!==a.left())M.move(b),a=b})}(),K=function(a){return function(){z.active(D.owner(F)).each(function(b){n.grab(b,a)})}},W=K("true"),X=K("false");l.each(L,function(a){a.events.enter.bind(W);a.events.exit.bind(X)});M.events.reposition.bind(function(a){O(a.direction(),a.delta())});var V=u.create({updated:v(["newBounds"],M.events.updated),
apply:t([]),cancel:t([])});return{element:M.element,keylayouts:q.constant(L),destroy:function(){S.destroy();T.unbind();P.unbind();Q.unbind();M.destroy()},boxes:function(){return{box:g,magic:M.element,shade:q.constant(J)}},get:function(){return h.readPosition(J)},events:V.registry}}});k("hd","p9 pa pb 7 6d 3l 2r".split(" "),function(c,d,b,a,e,g,f){var h=function(a){var c=g.absolute(a),d=c.top(),h=e.get(a),c=c.left();a=f.get(a);return b.boxModel({top:d,left:c,width:a,height:h})};return function(b,g,
n,p,k){var q=a.curry(h,b),s=d(q,g,n,k);return{element:s.element,keylayouts:s.keylayouts,crop:function(){var a;a=s.get();var d=f.get(b),g=e.get(b);a=c({cropX:a.left(),cropY:a.top(),cropWidth:a.width(),cropHeight:a.height(),displayWidth:d,displayHeight:g});return p.animate(s.boxes().magic(),b,s.boxes(),a)},destroy:function(){s.destroy()},events:s.events}}});k("9h","hc hd a7 c 97 g2 8h 7 9u 9c 71 73 gi 8o 79 3e 54 46 2m 3u 2a 3t".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,k,q,s,t,u,v,w,x,y,B){var z=
a.detect(),A=function(a,b){s.detect(a).fold(function(){a.setRelativeSelection(e.before(b),e.before(b))},function(b){var c=z.browser.isIE()||z.browser.isSpartan()?e.on:e.after;a.setRelativeSelection(c(b.container()),c(b.container()))})};return function(a){var e=a.content(),z=v.create({ok:u(["cropAction","image","cleanup"]),cancel:u(["image"])}),E=n.value(),G=n.value(),H=function(a){var h=e.body().getOrDie();b.speak(w.body(),p.translate("image.crop.announce"));var s=y.documentElement(a),u=d(a,s,s,c.slide(),
p.translate),v=l(function(a,c){b.speak(w.body(),p.translate("aria.image.crop.size",a,c))},500);u.events.updated.bind(function(a){a=a.newBounds();v.throttle(a.width(),a.height())});var C=function(){E.clear();T.exit();T.destroy();W.unbindAll();O.clear()},H=function(){C();G.clear();u.destroy()},Q=function(){H();z.trigger.cancel(a)},P=function(){C();u.crop().get(function(c){O.clear();b.speak(w.body(),p.translate("image.crop.apply"));var d=m.crop(c.cropX(),c.cropY(),c.cropWidth(),c.cropHeight()),e=k.changedBounds(a);
z.trigger.ok(function(a){return q.resampleAction(e,a,d)},a,function(a){Q();return a})})};E.set(P);G.set(H);A(e,a);var R=function(){b.speak(w.body(),p.translate("image.crop.cancel"));Q()},O=n.unbindable();B(function(){O.set(x.bind(h,"focus",function(a){R()}))});var T=f.inlineDialog(s,u.keylayouts(),g.inlineDialog({ok:P,cancel:R}));T.enter();var W=t.create();W.bind(e.events.domChanged,Q);W.bind(e.events.nodeChanged,function(a){w.inBody(a.node())&&Q()});W.bind(u.events.apply,P);W.bind(u.events.cancel,
Q)};return{apply:function(){E.on(h.apply)},open:function(){a.content().getSelection().bind(s.selectionContains).each(function(a){H(a)})},destroy:function(){G.on(h.apply)},isActive:E.isSet,events:z.registry}}});k("he",["3s","p","3u","6e","3t"],function(c,d,b,a,e){return{waitFor:function(g,f,h){return c.nu(function(c){var m=b.bind(g,f,function(b){a(n);m.unbind();c(d.value(b))}),n=e(function(){m.unbind();c(d.error("Event "+f+" did not fire within "+h+"ms"))},h)})}}});k("9i",["fz","gd","he","gf","1a"],
function(c,d,b,a,e){var g=a.fToFR(d.single);return{run:function(b,c,d){return a.fromChain([b.getImage,c,g,d])},applyEdit:function(d){return function(g){var l=c.cata(g,function(a,b,c,d){return c},function(a,b,c){return b});e.set(d,"src",l);l=b.waitFor(d,"load",1E3);return a.map(l,function(){return g})}}}});k("hf",["s","oe"],function(c,d){var b=function(a){return 20<=a},a=function(a){return c.from(a).filter(b)};return{ensureMin:a,parse:function(b,g){var f=a(b).getOr(0),h=a(g).getOr(0);return 0===f&&
0===h?c.none():c.some(d(f,h))}}});k("9j","fz 3s 7 gf eo hf 8o 1a".split(" "),function(c,d,b,a,e,g,f,h){var l=function(a){return function(d){var f=d.image(),g=d.asset(),l=function(a){a.fold(function(){h.remove(f,"src")},function(a){c.cata(a,function(a,b,c,d){h.set(f,"src",c)},b.noop)})};return e.loadIfNeeded(f).bind(function(){return a(g).map(function(a){l(a);return a})})}},m=b.constant(a.pure),n=b.constant(function(b){return a.pure(b.asset())});return function(a){a=g.parse(a.preferredWidth,a.preferredHeight);
var b=a.fold(m,f.instance),c=a.fold(n,function(){return l(b)});return{assets:function(a){return d.mapM(a,b)},correlated:function(a){return d.mapM(a,c)}}}});k("9k",["7","s","73"],function(c,d,b){return{edit:function(a,e,g,f){return{items:f,updatePalette:function(f){if(g())f.hide(d.none())&&a();else{var l=c.curry(f.show,d.some(b.translate("image.context.palette.show")));f=c.curry(f.hide,d.some(b.translate("image.context.palette.hide")));(e().isSome()?l:f)()&&a()}}}},crop:function(a,b,c){return{items:c,
updatePalette:function(c){(b()?c.show:c.hide)(d.none())&&a()}}}}});k("5q","7 8i 9c 9d 9e 9f 9g 9a 9h 9i 9j 9k 79 6t 1a o".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,k,q,s,t){return function(u,v,w,x){var y=g(u.communication()),B=d(u.ui),z=function(a){return function(b){b.fold(function(b){b=e.diagnoseImageEdit(b,s.get(a,"src"));B.show(b.bannerMessage());t.error("Image edit operation failed: ",b.consoleMessage())},function(a){w.uploadAssets([a]);u.content().focus();u.undo().save()});v.fireChanged(a);
return b}},A=function(a,b){u.undo().save();var c=m.applyEdit(a);return m.run(y,b,c)(a)},C=l(u);C.events.cancel.bind(function(a){v.fireChanged(a.image())});C.events.ok.bind(function(b){var c=b.image(),d=b.cropAction();b=b.cleanup();var e=a.updater(a.keepCrop,c);A(c,d).map(e).map(b).get(z(c))});var D=function(){return u.content().getSelection().bind(k.selectionContains)},F=function(b,d){return function(){D().each(function(e){var f=c.identity,g=a.updater(d,e);A(e,b).map(g).map(f).get(z(e))})}},E=[f.make("crop-begin",
"image.crop.begin",C.open),f.make("rotate-left","image.toolbar.rotateleft",F(b.rotateLeft,a.keepRotate)),f.make("rotate-right","image.toolbar.rotateright",F(b.rotateRight,a.keepRotate)),f.make("flip-horizontal","image.toolbar.fliphorizontal",F(b.flipHorizontal,a.keepFlip)),f.make("flip-vertical","image.toolbar.flipvertical",F(b.flipVertical,a.keepFlip))],G=[f.make("crop-apply","image.crop.apply",C.apply)],F=q.ui({"edit.palette":c.curry(p.edit,u.ui().refresh,D,C.isActive,E),"crop.palette":c.curry(p.crop,
u.ui().refresh,C.isActive,G)},c.identity),E=h.imageEdit(C.isActive,G,E);x=n(x);return{destroy:function(){C.destroy()},ui:F,insertResample:c.constant(x),situation:E.situation,handle:E.handle,assign:E.assign,name:c.constant("imageEdit")}}});k("hn",["1s"],function(c){return{generate:function(d){return d+"-"+c.floor(99999*c.random()).toString()}}});k("hl",["7","73","1s"],function(c,d,b){var a=function(){return d.translate("link.anchor.top")},e=function(){return d.translate("link.anchor.bottom")},g=function(){var b=
{};b[a().toLowerCase()]="top";b[e().toLowerCase()]="bottom";return b};return{bookmarkDataAttr:c.constant("data-textbox-bookmark"),bookmarkAnchorDataAttr:c.constant("data-textbox-bookmark-anchor"),topAnchorUrl:a,bottomAnchorUrl:e,top:c.constant("top"),bottom:c.constant("bottom"),reservedUrls:g,isReservedUrl:function(a){return g().hasOwnProperty(a.toLowerCase())},getReservedUrl:function(b){var c={};c.top=a();c.bottom=e();return c[b.toLowerCase()]}}});k("9n","b 7 hn hl 33 2u ca 1a l 2o 2q 4e".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,p){var k=e.resolve("link-eph-cursor"),q=function(a){c.each(a,n.remove)},s=function(b,c){u("textbox-bookmark-top",b,m.prepend,c,a.top())},t=function(b,c){u("textbox-bookmark-bottom",b,m.append,c,a.bottom())},u=function(d,e,f,g,m){var k=b.generate(d);c.each(e,function(a){h.set(a,"href","#"+k)});d=p.children(g,"["+a.bookmarkDataAttr()+'="'+m+'"]');c.each(d,n.remove);0<e.length&&(e=l.fromTag("span"),h.setAll(e,{id:k,style:"visibility: hidden;"}),h.set(e,a.bookmarkDataAttr(),
m),f(g,e))};return{configure:function(b){b.add(b.internal(),k,f.remove);b.add(b.output(),k,f.remove);b.addSelector(b.input(),"["+a.bookmarkDataAttr()+"]",q);b.addSelector(b.output(),"["+a.bookmarkAnchorDataAttr()+'="'+a.top()+'"]',s);b.addSelector(b.output(),"["+a.bookmarkAnchorDataAttr()+'="'+a.bottom()+'"]',t)},properties:g.immutableBag(["url","text","title","target","action"],[]),insertCursor:d.constant(k)}});k("pc",["7","v"],function(c,d){var b=function(a){a=d.removeTrailing(a,".");var b=d.startsWith(a,
"www.")?"http://"+a:a;return{text:c.constant(a),href:c.constant(b)}};return{preprocess:b,auto:function(a){return b(a).href()}}});k("hg","b 97 7 s 7u dd 9n pc d7 79 l 2o 9q".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,k){var q=function(a,b){a.setRelativeSelection(d.after(b),d.after(b))},s=function(a,b,c,d){return m.detect(a).fold(function(){return a.getSelection().fold(function(){return[]},function(a){return(a.collapsed()?c:d)(a)})},function(a){return b(a.container())})},t=function(a,b,c){a=n.fromTag("a");
u(a,b);p.wrap(c,a);return[a]},u=function(a,b){b.url().each(function(b){b=h.auto(b);g.attr(a,"href",b)});b.text().each(function(b){k.set(a,b)});b.title().each(function(b){g.attr(a,"title",b)});b.target().each(function(b){g.attr(a,"target",b)});b.action().each(function(b){b(a)})},v=function(a){var b=l.findDescendants(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset(),"a");return 0<b.length?b:l.findAncestors(a.startContainer(),a.endContainer(),"a")},w=function(a,d){return s(a,b.curry(t,
a,d),function(b){var c=n.fromTag("a");u(c,d);e.insertAtCursor(a,[c]);d.action().each(function(a){a(c)});q(a,c);return[c]},function(b){a.execCommand("CreateLink",!1,h.auto(d.url().getOr("")));b=a.getSelection().map(v).getOr([]);c.each(b,function(b){u(b,d);d.action().each(function(a){a(b)});q(a,b)});return b})};return{hyperlink:function(c,d){var e=d.text().fold(b.constant(d),function(b){return f.properties({url:d.url(),text:a.some(0<b.trim().length?b:d.url().getOr("")),title:d.title(),target:d.target(),
action:d.action()})});c.focus();return e.url().fold(b.constant([]),function(a){return 0<a.trim().length?w(c,e):[]})},setProperties:u}});k("hh",["d6"],function(c){var d=function(a,b){var d=c.getEnd(b);a.setSelection(b,d,b,d)},b=function(a,b){a.setSelection(b,0,b,0)};return{selectEnd:d,moveToEnd:function(a){a.getSelection().each(function(b){d(a,b.endContainer());a.focus()})},selectStart:b,moveToStart:function(a){a.getSelection().each(function(c){b(a,c.endContainer());a.focus()})}}});k("9l",["hg","hh",
"9p","2q","2a"],function(c,d,b,a,e){var g=function(a,c){return a.getSelection().bind(function(a){return b.sharedLink(a.startContainer(),a.endContainer()).map(function(a){c(a);return a})})};return{insert:c.hyperlink,update:function(a,b){return g(a,function(d){c.setProperties(d,b);a.focus()})},unlink:function(b){g(b,function(c){b.setSelection(c,0,c,e.children(c).length);var g=e.lastChild(c);a.unwrap(c);g.each(function(a){d.selectEnd(b,a)});b.focus()})}}});k("a2","7s 7 s hi ev 33 ew hj 1y 21 2a".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n){var p=function(a){return a.getSelection().bind(function(b){return a.win().bind(function(a){return c.rectangleAt(a,b.startContainer(),b.startOffset(),b.endContainer(),b.endOffset()).map(function(a){return{bounds:d.constant(a),element:d.constant(b.startContainer())}})})})},k=function(c,e,f){p(e).fold(function(){a.insertAtCursor(c,e,f)},function(a){var g=a.bounds();a=a.element();(m.isText(a)?n.parent(a):b.some(a)).each(function(a){a=c.directionAt(a);var b=e.translateScreen(g.left,
g.top);f({left:b.left,top:b.top,height:d.constant(g.height),width:d.constant(g.width),direction:d.constant(a)})})})},q=function(a,b,c,d,f,g,h){var l=f.direction();a=e.makeshift(a,b,f.left(),f.top(),f.width(),f.height(),l,g,h);b.show(c,a);c.setComponents([d.element()])};return{show:function(a,b,c,d,e){k(a,b,function(a){q(b,c,d,e,a,f(0,0))})},showExpandable:function(a,b,c,d,e){k(a,b,function(a){l.add(d.panel(),g.resolve("expandable-popup"));var m=f(22,14),n={maxHeightFunction:h.expandable()};q(b,c,
d,e,a,m,n)})}}});k("hk","7v g2 8h 4z gp dv 7 g4 73 33 46 47 1y 3c".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,k,q){var s=function(a,b,d){a=e(a);b=l.translate(b);a.content(g(b));k.add(a.element(),m.resolve(d));c.button(a.element(),b);return a},t=function(b){var c=a.div();k.add(c,m.resolve("main-controls"));q.append(c,b);return c},u=function(a,c,e){var f=s("remove","link.dialog.remove","link-remove"),g=s("cancel","button.cancel","link-cancel"),l=s(a,c,e);a=n.create({remove:p([],f.events.click),cancel:p([],
g.events.click),execute:p([],l.events.click)});c=[b.button(f.element(),d.button({execute:h.click})),b.button(g.element(),d.button({execute:h.click})),b.button(l.element(),d.button({execute:h.click}))];return{remove:f,cancel:g,execute:l,keylayouts:c,events:a.registry,destroy:function(){f.destroy();g.destroy();l.destroy()}}};return{insert:function(){var a=u("insert","link.dialog.insert","link-insert"),b=t([a.cancel.element(),a.execute.element()]);a.remove.disable();return{dialogTitle:f.constant(l.key("link.dialog.aria.insert")),
elements:f.constant([a.remove.element(),b]),events:f.constant(a.events),keylayouts:f.constant(a.keylayouts),execute:a.execute,destroy:a.destroy}},update:function(){var a=u("update","link.dialog.update","link-update"),b=t([a.cancel.element(),a.execute.element()]);return{dialogTitle:f.constant(l.key("link.dialog.aria.update")),elements:f.constant([a.remove.element(),b]),events:f.constant(a.events),keylayouts:f.constant(a.keylayouts),execute:a.execute,destroy:a.destroy}}}});k("9w",["b","7","33","ca"],
function(c,d,b,a){var e=b.resolve("link-validation-highlight"),g=b.resolve("link-validation-invalid");b=b.resolve("link-validation-unknown");var f=d.constant([e,g,b]);return{configure:function(b){c.each(f(),function(c){b.add(b.output(),c,a.removeClass(c));b.add(b.internal(),c,a.removeClass(c))})},allClasses:f,invalidLink:d.constant(g),unknownLink:d.constant(b),validationHighlight:d.constant(e)}});k("hm","7 s 73 9w 6s 54 46 2u 1a 1y 31".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){return{enabled:function(e){var k=
d.none(),q=h.immutable("value","text","attrs"),s=f.create({properties:g(["link"]),follow:g(["link"]),ignore:g(["link"]),remove:g(["link"])}),t={"linkmenu-properties":s.trigger.properties,"linkmenu-follow":s.trigger.follow,"linkmenu-ignore":s.trigger.ignore,"linkmenu-remove":s.trigger.remove};return{situation:function(d){d=k.map(function(c){var d=[q("linkmenu-properties",b.translate("link.context.edit"),{}),q("linkmenu-follow",b.translate("link.context.follow"),{}),q("linkmenu-remove",b.translate("link.context.remove"),
{})];c=m.has(c,a.validationHighlight())?[q("linkmenu-ignore",b.translate("link.context.ignore"),{})]:[];return d.concat(c)}).getOr([]);return{primary:c.constant(d),secondary:c.constant([]),submenus:c.constant([])}},handle:function(a){k.each(function(b){var c=l.get(a,"data-ephox-gopher-item-value"),c=t[c];void 0!==c&&c(b)})},assign:function(a){k=a.bind(function(a){return n.closest(a,"a[href]",e.isRoot)})},events:s.registry}},disabled:function(){var a=e.noSituation(),b=f.create({properties:g(["link"])});
return{situation:a,handle:c.noop,assign:c.noop,events:b.registry}}}});k("ho","b a8 s hl 9p 33 1a 1y 3u l 6d 3l 29 31 36".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,k,q,s){return function(t,u){var v=g.resolve("cursor-pointer"),w=u.os.isOSX(),x=b.none(),y=function(a){return t.isInline()?p.absolute(a).top():0},B=function(b){var c=f.get(b,"href");if("top"===f.get(b,a.bookmarkAnchorDataAttr()))t.win().each(function(a){t.body().each(function(b){a.scrollTo(0,y(b))})});else if("bottom"===f.get(b,a.bookmarkAnchorDataAttr()))t.win().each(function(a){t.body().each(function(b){b=
y(b)+n.get(b)-a.innerHeight;a.scrollTo(0,b)})});else if(/^#/.test(c)){var d=c.substr(1);t.body().each(function(a){e.anchorTarget(a,d).each(function(a){t.win().each(function(b){k.setToElement(b,a)})})})}else s.open(c)},z=function(a,b){var e=w?d.META():d.CTRL();c.contains(e,a)&&b()},A=m.fromDom(s),C=b.none();t.events.ready.bind(function(a){a=a.api().body();var c=l.bind(a,"click",function(a){var b=a.target();(w?a.raw().metaKey:a.raw().ctrlKey)&&q.closest(b,"a[href]").bind(function(b){a.prevent();B(b)})});
C=b.some(c);x=b.some(h.toggler(a,v))});var D=function(){x.each(function(a){a.on()})},F=function(){x.each(function(a){a.off()})},E=function(a){z(a.original().raw().which,F)};t.events.keyup.bind(E);var G=l.bind(A,"keyup",function(a){z(a.raw().which,F)}),H=function(a){z(a.original().raw().which,D)};t.events.keydown.bind(H);var I=l.bind(A,"keydown",function(a){z(a.raw().which,D)});return{follow:B,destroy:function(){C.each(function(a){a.unbind()});t.events.keyup.unbind(E);t.events.keydown.unbind(H);G.unbind();
I.unbind()}}}});k("pf","7v g2 8h 4z 7 g4 73 33 1y 4b 2n 3u l 6d 2o 3c 2q".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,p,k,q,s,t,u){var v=h.resolve("inline-popup-expanded");return function(w,x,y,B){var z=k.fromTag("div");c.dialog(z,f.get(B));m.add(z,[h.resolve("expandable-inline-popup")]);B=a.div();l.add(B,h.resolve("inline-popup-content"));var A=a.div();m.add(A,[h.resolve("inline-popup-content-expand"),v]);var C=a.div();l.add(C,h.resolve("inline-popup-controls"));var D=a.div();l.add(D,h.resolve("inline-popup-expand-button-wrapper"));
var F=k.fromTag("span");m.add(F,[h.resolve("inline-popup-expand-button"),h.resolve("icon")]);c.button(F,f.translate("aria.label.more"));s.append(D,F);t.append(z,[B,A,D,C]);t.append(B,w);t.append(A,x);t.append(C,y);l.add(z,v);var E="0px",G=function(){l.add(A,h.resolve("expand-close"));l.remove(z,v);n.setAll(A,{opacity:"0",height:"0px",visibility:"hidden"})},H=p.bind(A,"transitionend",function(a){m.remove(A,[h.resolve("expand-close"),h.resolve("expand-open")])}),I=p.bind(F,"click",function(a){l.has(z,
v)?G():(l.add(z,v),l.add(A,h.resolve("expand-open")),n.setAll(A,{opacity:"1",height:E,visibility:"visible"}))});w=[b.button(F,d.button({execute:g.click}))];return{element:e.constant(z),keylayouts:e.constant(w),destroy:function(){u.remove(z);I.unbind();H.unbind()},show:function(){E=q.getOuter(A)+"px";G();n.reflow(z);l.add(z,h.resolve("enable-transition"))}}}});k("10j",[],function(){return{setValue:function(c,d,b){c=c.dom();c.value=d;c.text=b}}});k("pj",["b","s"],function(c,d){var b=function(a,b){a.dom().add(b.dom())};
return{getValue:function(a){var b=a.dom();a=b.selectedIndex;b=b.options[a];return void 0===b||-1===a?d.none():d.from(b.value)},add:b,addAll:function(a,d){c.each(d,function(c){b(a,c)})},setSelected:function(a,b){a.dom().selectedIndex=b}}});k("wu","b l2 73 l 10j pj".split(" "),function(c,d,b,a,e,g){var f=[{value:"",i18nKey:"link.properties.target.none"},{value:"_blank",i18nKey:"link.properties.target.blank"},{value:"_top",i18nKey:"link.properties.target.top"},{value:"_self",i18nKey:"link.properties.target.self"},
{value:"_parent",i18nKey:"link.properties.target.parent"}];return{target:function(h){var l=d.common("select","target-container","link.properties.target.label"),m=c.map(f,function(c){var d=a.fromTag("option");e.setValue(d,c.value,b.translate(c.i18nKey));return d});g.addAll(l.field(),m);var n=h.target().getOr("");h=c.findIndex(f,function(a){return a.value===n});g.setSelected(l.field(),0<h?h:0);return{element:l.element,input:l.field}}}});k("pg","g2 8h 7 g4 l2 73 wu 33 1a 1y 32".split(" "),function(c,
d,b,a,e,g,f,h,l,m,n){return function(p){var k=e.input("href-url-value","link.properties.url.label");l.setAll(k.input(),{placeholder:g.translate("link.properties.url.placeholder"),autocomplete:"off",autocorrect:"off"});p.url().each(function(a){n.set(k.input(),a)});var q=e.input("text-to-display","link.properties.text.label");m.add(q.element(),h.resolve("text-to-display"));l.setAll(q.input(),{placeholder:g.translate("link.properties.text.placeholder"),autocomplete:"off",autocorrect:"off"});p.text().each(function(a){n.set(q.input(),
a);l.set(q.input(),"disabled","disabled")});var s=e.input("title-text","link.properties.title.label");m.add(s.element(),h.resolve("title-container"));l.setAll(s.input(),{placeholder:g.translate("link.properties.title.placeholder"),autocomplete:"off",autocorrect:"off"});p.title().each(function(a){n.set(s.input(),a)});var t=f.target(p);return{url:b.constant(k),text:b.constant(q),title:b.constant(s),target:b.constant(t),keylayouts:function(){return[d.input(k.input(),c.input({})),d.input(q.input(),c.input({})),
d.input(s.input(),c.input({})),d.button(t.input(),c.button({execute:a.click,process:b.noop}))]}}}});k("ph",["a","b","nn","1s"],function(c,d,b,a){return function(a){var g=c.isNumber(a)?a:1E4,f=b.access("local.linkCache");a=f.read();var h=function(a){return 0>g-a.length?a.slice(0,g):a}(c.isArray(a)?a:[]),l=function(){return h.slice(0)};return{add:function(a){if("#"!==a.charAt(0)){h.length>=g&&h.pop();var b=d.indexOf(h,a);-1<b&&h.splice(b,1);h.unshift(a)}},state:l,destroy:function(){f.write(l())}}}});
k("wv",["b","1o"],function(c,d){return{stringArray:function(b){var a={};c.each(b,function(b){a[b]={}});return d.keys(a)}}});k("ww",["s"],function(c){return{url:function(d){return c.some(d.url())},title:function(c){return c.title()},innerText:function(d){d=d.innerText();return 0<d.length?c.some(d):c.none()}}});k("10k",["4g"],function(c){return{resolve:c.create("ephox-tarot").resolve}});k("10l","4z 7 s 1y l 2o 3c 10k 1s".split(" "),function(c,d,b,a,e,g,f,h,l){var m=function(a,b,c,d,f){var h=e.fromText(a.substr(0,
b));b=e.fromText(a.substr(b,c));a=e.fromText(a.substr(d));f=e.fromTag(f);g.append(f,b);return[h,f,a]},n=function(e,g,h,l){var m=c.tag(g);f.append(m,h);l.each(function(b){a.add(m,b)});return{item:d.constant(e),marked:d.constant(b.some(m))}},p=function(a,c,d,e){var f=a.text,g=a.marker.start(),p=a.marker.length(),k=0;0<e-(g+p)||0===g||(p>e?k=g-10:(e=l.floor((e-p)/2),k=g-e));e=f.substr(k);g-=k;c=m(e,g,p,g+p,c);f=e.length===f.length?b.none():b.some(h.resolve("anchor-before"));return n(a.item(),d,c,f)},
k=function(b,d){var e=c.span();a.add(e,d);f.append(e,b);return e},q=function(a,b,c){var d=[];b=k(b,h.resolve("content-innertext"));0<a.length&&(a=k([e.fromText(a)],h.resolve("anchor-before")),d.push(a));d.push(b);0<c.length&&(c=k([e.fromText(c)],h.resolve("anchor-after")),d.push(c));return d};return{contentMarker:function(a,c,d,e){var f=a.item().before(),g=a.item().after(),h=a.text;if(0===f.length&&0===g.length&&h.length>e)return p(a,c,d,e);e=a.marker.start();var l=a.marker.length();c=m(h,e,l,e+l,
c);f=q(f,c,g);return n(a.item(),d,f,b.none())},contentUnderlined:q,attrMarker:p}});k("wx","4z s 1a 1y l 2o 3c 10k 10l".split(" "),function(c,d,b,a,e,g,f,h,l){var m=function(a,b,d){a=c.tag(b);g.append(a,e.fromText(d));return a};return{anchors:function(e,g){var l=g.item(),k=l.url(),s=c.div();a.add(s,h.resolve("item-line"));var t=l.title().getOr(k);b.set(s,"title",t);l=g.marked().fold(function(){return m(e,"div",t)},function(a){return a});a.add(l,h.resolve("item-main-label"));k=d.from(k).map(function(b){return b!==
t?(b=m(e,"div",b),a.add(b,h.resolve("item-secondary-label")),[b]):[]}).getOr([]);k=[l].concat(k);f.append(s,k);return s},standard:function(d,m){var k=m.item(),q=c.div();a.add(q,h.resolve("item-line"));var s=[k.before(),k.innerText(),k.after()].join("");b.set(q,"title",s);s=m.marked().fold(function(){var a=l.contentUnderlined(k.before(),[e.fromText(k.innerText())],k.after()),b=c.div();f.append(b,a);return b},function(a){return a});a.add(s,h.resolve("item-main-label"));k.indent()&&a.add(s,h.resolve("indent"));
g.append(q,s);return q},error:function(a,b){var d=c.span(),f=e.fromText(b);g.append(d,f);return d}}});k("10m",["n8","ew","n9","nb"],function(c,d,b,a){return function(e,g){return{position:function(f){f=f.isRtl()?b.allRtl():b.all();var h=d(0,0),l=c.element(e);a.fixed(l,g,h,f,{})}}}});k("10n","b 7 s k 2u ww 10l".split(" "),function(c,d,b,a,e,g,f){var h=e.immutable("matchFunction","start","length"),l=function(a,b,c){for(var d=0,e=[],f=function(a){e.push(a);d++},g=0,h=a.length;g<h&&d<b;g++)c(a[g]).each(f);
return e};return{unmarked:function(a,e){var f=e.getOr(1E3),f=a.length>f?a.slice(0,f):a;return c.map(f,function(a){return{item:d.constant(a),marked:b.none}})},match:function(c,e,f,g){var k=f.toLowerCase();f=g.getOr(1E3);return l(c,f,function(c){return a.findMap(e,function(a){return a(c).bind(function(e){var f=e.toLowerCase().indexOf(k);if(-1<f){var g=k.length;return b.some({item:d.constant(c),marked:b.none,text:e,marker:h(a,f,g)})}return b.none()})})})},mark:function(a,b,d,e){return c.map(a,function(a){return(a.marker.matchFunction()===
g.innerText?f.contentMarker:f.attrMarker)(a,b,d,e)})}}});k("10o","7 1a l 2o 2q 10k".split(" "),function(c,d,b,a,e,g){var f="data"+g.resolve("section-id");return{create:function(g,l){var m=b.fromTag("ol");d.set(m,f,l.id());var n=function(){e.empty(m)};return{element:c.constant(m),clear:n,add:function(c){var d=b.fromTag("li");a.append(d,c);a.append(m,d);return d},spec:c.constant(l),destroy:function(){n()}}},dataIdAttribute:c.constant(f)}});k("wy","a b 7v a7 2z c w1 4z 7 s 54 46 52 2u 1a 2m 1y 3u l 2o 2q 6m 31 m 2a 10m 10n 10k 10o q".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,k,r,q,s,t,u,v,w,x,y,B,z,A,C,D,F,E,G,H){var I=g.detect().browser.isSafari(),L=function(a,b){I&&c.isFunction(a.dom().scrollIntoViewIfNeeded)?a.dom().scrollIntoViewIfNeeded(!1):a.dom().scrollIntoView(b)};g=q.immutableBag(["container","sections","translate"],["doc"]);q=q.immutableBag("id highlight contentLimit items render extractors".split(" "),["itemLimit"]);var J="data"+E.resolve("item-id");return{init:function(c,g){var q=g.doc().getOr(w.fromDom(H)),I=g.translate(),Q=
{},P=f(),R=h.div();u.add(R,E.resolve("predictive-menu"));b.hidden(R,!0);var O=D(c,R),T=function(){d.each(P.state(),function(a){W(a,[])})},W=function(a,b){y.remove(a.element());a.clear();var c={};0<b.length&&(d.each(b,function(b){var d=a.spec().render()(q,b),d=a.add(d),f=e.generate("");s.set(d,J,f);c[f]={gui:l.constant(d),item:l.constant(b.item())}}),x.append(R,a.element()));Q[a.spec().id()]=c},X=function(b){u.add(b,E.resolve("selected"));ba().bind(Y).each(function(b){a.speak(t.body(),b.item().url())})},
V=function(a){X(a);var b=R.dom().getBoundingClientRect(),c=a.dom().getBoundingClientRect();c.top<b.top?L(a,!0):c.bottom>b.bottom&&L(a,!1)},aa=function(a){u.remove(a,E.resolve("selected"))},ca=function(){z.descendant(R,"li").each(V)},Z=function(){A.one("ol:last-child li:last-child",R).each(V)},ba=function(){return z.descendant(R,"li."+E.resolve("selected"))},ia=function(){return ba().bind(Y).map(function(b){b=b.item();a.speak(t.body(),I("link.dialog.autocomplete.accept",b.url()));return b})},ga=function(a){0===
C.children(a).length?C.nextSibling(a).fold(ca,ga):C.firstChild(a).fold(Z,V)},fa=function(a){0===C.children(a).length?C.prevSibling(a).fold(Z,fa):C.lastChild(a).fold(ca,V)},Y=function(a){a=z.closest(a,"["+J+"]");var b=a.bind(function(a){return z.closest(a,"["+G.dataIdAttribute()+"]")}),c=a.map(function(a){return s.get(a,J)});return b.map(function(a){return s.get(a,G.dataIdAttribute())}).bind(function(a){return m.from(Q[a])}).bind(function(a){return c.bind(function(b){return m.from(a[b])})})},na=v.capture(R,
"mouseover",function(a){a=a.target();B.closest(a,"li."+E.resolve("selected"))||Y(a).fold(l.noop,function(a){ba().each(function(a){aa(a)});X(a.gui())})}),ea=v.capture(R,"click",function(a){ia().each($.trigger.click)}),$=k.create({click:n(["item"])}),U=r.ensure(["url","indent"]);d.each(g.sections(),function(a){d.each(a.items(),U);a=G.create(q,a);P.push(a)});T();return{element:l.constant(R),events:$.registry,reset:T,resetFull:function(){d.each(P.state(),function(a){a.clear();var b=a.spec().items(),c=
a.spec().itemLimit(),b=F.unmarked(b,c);W(a,b)})},filter:function(a){0<a.length?(Q={},d.each(P.state(),function(b){var c=b.spec(),d=F.match(c.items(),c.extractors(),a,c.itemLimit()),c=F.mark(d,c.highlight(),"div",c.contentLimit());W(b,c)})):T()},show:function(b){x.append(g.container(),R);O.position(b);a.speak(t.body(),I("link.dialog.autocomplete.open"))},isShowing:function(){return C.parent(R).isSome()},hide:function(){y.remove(R);ba().each(aa);a.speak(t.body(),I("link.dialog.autocomplete.close"))},
getSelectedData:ia,moveup:function(){ba().fold(Z,function(a){aa(a);C.prevSibling(a).fold(function(){C.parent(a).bind(C.prevSibling).fold(Z,fa)},V)})},movedown:function(){ba().fold(ca,function(a){aa(a);C.nextSibling(a).fold(function(){C.parent(a).bind(C.nextSibling).fold(ca,ga)},V)})},destroy:function(){na.unbind();ea.unbind();d.each(P,function(a){a.destroy()});y.remove(R)}}},config:g,section:q}});k("pi","b c wv a8 7 r s k hn 73 hl 9p 33 4m 2u 1a 4b 1b 2n 3u 2y 21 9q 32 2r ww wx wy v".split(" "),function(c,
d,b,a,e,g,f,h,l,m,n,k,r,q,s,t,u,v,w,x,y,B,z,A,C,D,F,E,G){var H=d.detect().browser.isSafari(),I=s.immutable("url","indent","action","before","innerText","after"),L=s.immutable("url","indent","title","action"),J=s.immutable("url","action"),K=s.immutable("url","indent","action");return function(d,s,S,Q){var P=function(){var a=s.body().map(k.all).getOr([]),a=c.bind(a,function(a){var b=t.get(a,"href");return G.startsWith(b,"#")||t.has(a,n.bookmarkAnchorDataAttr())?[]:[b]}),a=Q.state().concat(a),a=b.stringArray(a);
return c.map(a,function(a){var b=f.none();return L(a,e.constant(!1),b,e.noop)})},R=function(a,b,c){a=a.replace(/[^0-9a-zA-Z$-_.+*(),]/g,"");var d=0<a.length?a:l.generate("textbox-heading");return f.some(K("#"+d,c,function(){t.set(b,"id",d)}))},O=function(a){var b="h1"!==B.name(a),c=z.get(a);return t.has(a,"id")||t.has(a,"name")?(a=t.has(a,"id")?t.get(a,"id"):t.get(a,"name"),f.some(K("#"+a,b,e.noop))):0===c.trim().length?f.none():R(c,a,b)},T=function(a){t.remove(a,n.bookmarkAnchorDataAttr())},W=function(a){var b=
n.reservedUrls()[a.toLowerCase()];return function(a){t.set(a,n.bookmarkAnchorDataAttr(),b)}},X=function(){var a=s.body().map(k.findLinkTargets).getOr([]),b=1E3<a.length,a=c.map(a,function(a){return O(a).map(function(c){var d=(b?k.linkTargetFastText:k.linkTargetText)(50,a);return I(c.url(),c.indent(),c.action(),d.before(),d.innerText(),d.after())})}),a=h.cat(a),d=function(a){return"\u2014 "+a+" \u2014"},e=W(n.topAnchorUrl()),e=I(n.topAnchorUrl(),!1,e,"",d(n.topAnchorUrl()),""),f=W(n.bottomAnchorUrl()),
d=I(n.bottomAnchorUrl(),!1,f,"",d(n.bottomAnchorUrl()),"");return[e].concat(a).concat([d])};return{predict:function(b,e){var h=g.cached(function(){var a=P(),c=X(),a=E.config({container:S,translate:m.translate,sections:[E.section({id:"recent",highlight:"strong",contentLimit:50,items:a,itemLimit:10,render:F.anchors,extractors:[D.title,D.url]}),E.section({id:"anchors",highlight:"strong",contentLimit:50,items:c,render:F.standard,extractors:[D.innerText,D.url]})]}),d=E.init(b,a);u.add(d.element(),[r.resolve("layer-menus"),
r.resolve("tarot-inline")]);d.events.click.bind(function(a){d.hide();k(b,a.item())});a=C.get(b);w.setAll(d.element(),{"min-width":a+"px","box-sizing":"border-box"});return d}),l=q(f.none()),k=function(a,b){var c=b.url();A.set(a,c);H&&a.dom().click();l.set(f.some(b))},p=e.container(b);p.swallowKeys([a.UP(),a.DOWN()]);p.events.up.bind(function(a){a.stopper()();a=h();s(a);a.moveup()});p.events.down.bind(function(a){a.stopper()();a=h();s(a);a.movedown()});p.events.escape.bind(function(a){var b=h();b.isShowing()&&
(b.hide(),a.stopper()())});p.events.enter.bind(function(a){h().getSelectedData().each(function(c){a.stopper()();var d=h();d.hide();d.reset();k(b,c)})});p.on();var s=function(a){if(!a.isShowing()){var c=A.get(b);""===c?a.resetFull():a.filter(c);a.isShowing()||a.show(d.uiDirection())}},t=[x.bind(b,"input",function(a){a=h();l.set(f.none());var c=A.get(b);0<c.length?(a.filter(c),a.isShowing()||a.show(d.uiDirection())):(a.reset(),a.hide())}),x.bind(b,"focus",function(a){h()}),x.bind(b,"blur",function(a){var c=
h().hide;y.active().fold(c,function(a){v.eq(a,b)||c()})}),x.bind(S,"click",function(a){h().hide()})];return{destroy:function(){h().destroy();p.destroy();c.each(t,function(a){a.unbind()})},getSelectedValue:function(){return l.get().fold(function(){var a=A.get(b),c=n.isReservedUrl(a)?W(a):T;return J(a,c)},function(a){return J(a.url(),a.action())})}}}}}});k("hp","a5 b l5 g2 8h 7 s pf pg hl 9n ph pi 33 aj 54 46 47 1a 1y 2n 32 pj".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,k,r,q,s,t,u,v,w,x,y,B,z){return function(A,
C,D,F,E,G,H){var I=k(1337),L=l(G),J=H();G=[L.url().element()];H=[L.text().element(),L.title().element(),L.target().element()];var K=h(G,H,J.elements(),J.dialogTitle());x.add(K.element(),q.resolve("inline-link-dialog"));var M=c.popup(F.uiContainer,F.bounds,A,[],s.editorContainer()).initMenu(K.element());x.add(M.element(),q.resolve("bubble-box"));var N=r(A,D,K.element(),I).predict(L.url().input(),C),S={before:function(){y.set(M.panel(),"visibility","hidden");M.open()},after:function(){y.remove(M.panel(),
"visibility");y.remove(M.panel(),"display")}},Q=u.create({remove:v([],J.events().remove),cancel:t([]),execute:v([],J.events().execute)}),P=function(a){var b=a.command();a=a.data();w.has(a,m.bookmarkAnchorDataAttr())||"insertLink"!==b&&"updateLink"!==b||(b=w.get(a,"href"),I.add(b))};E.events.internal.bind(P);C=function(){Q.trigger.cancel()};J.events().cancel.bind(C);M.events.close.bind(C);C=d.flatten([L.keylayouts(),K.keylayouts(),J.keylayouts()]);var R=e.inlineDialog(K.element(),C,a.inlineDialog({ok:J.execute.click,
cancel:g.noop}));R.events.exit.bind(function(){M.close();Q.trigger.cancel()});return{showPopup:function(a){S.before();b.preserve(function(){a.showExpandable(A,D,F,M,K);S.after();K.show();R.enter()},K.element())},hide:function(){M.closed()||R.exit()},getValues:function(){var a=N.getSelectedValue(),b=B.get(L.text().input()),c=B.get(L.title().input());return n.properties({url:""===a.url()?f.none():f.some(a.url()),text:"disabled"===w.get(L.text().input(),"disabled")?f.none():f.some(b),title:f.some(c),
target:z.getValue(L.target().input()),action:f.some(a.action())})},destroy:function(){I.destroy();E.events.internal.unbind(P);N.destroy();R.destroy();J.destroy();M.destroy();K.destroy()},events:Q.registry}}});k("9m","c 7 s 71 a2 hk hl hm 9n ho hp 54 46 1a 9q 3t".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,k,r,q,s,t){return function(u,v){var w=u.filter(),x=u.content(),y=u.smartview(),B=h.enabled(x),z=u.internalevents(),A=c.detect();l.configure(w);var C=m(x,A),w=function(){x.getSelection().each(function(a){x.setSelection(a.startContainer(),
a.startOffset(),a.endContainer(),a.endOffset())})},D=A.browser.isIE()?w:d.noop,F=r.create({insert:k(["properties"]),update:k(["properties"]),unlink:k([])}),E=a.destroyable(),G=function(a,b){var c=n(u.region(),u.keyboard(),x,y,z,a,b);c.events.remove.bind(function(a){F.trigger.unlink();H()});c.events.cancel.bind(function(a){H();x.focus();D()});E.set(c);x.events.mousedown.bind(H);return c},H=function(){E.clear();x.events.mousedown.unbind(H)},I=function(a){var b=G(a,g.update);b.events.execute.bind(function(a){F.trigger.update(b.getValues());
H()});b.showPopup(e)};B.events.properties.bind(function(a){a=a.link();var c=q.has(a,f.bookmarkAnchorDataAttr())?f.getReservedUrl(q.get(a,f.bookmarkAnchorDataAttr())):q.get(a,"href");a=l.properties({url:b.from(c),text:b.from(s.get(a)),title:b.from(q.get(a,"title")),target:b.from(q.get(a,"target")),action:b.none()});I(a)});B.events.follow.bind(function(a){x.focus();t(function(){C.follow(a.link())},0)});B.events.ignore.bind(function(a){v.ignore(a.link())});B.events.remove.bind(function(){F.trigger.unlink()});
return{showContext:I,showInsert:function(a){var b=G(a,g.insert);b.events.execute.bind(function(a){F.trigger.insert(b.getValues());H()});b.showPopup(e)},situation:B.situation,handle:B.handle,assign:B.assign,events:F.registry,destroy:function(){H();C.destroy()}}}});k("hq","b 7v 4z 7 s i3 gn 73 9n 33 54 46 4m 1a 1y l 2y 2o 3c 2q 32 al".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,k,r,q,s,t,u,v,w,x,y,B){return function(z){var A=r(e.none());z=b.div();s.add(z,m.resolve("link-widget"));var C=b.span();s.add(C,
m.resolve("link-widget-field"));var D=t.fromTag("input");s.add(D,m.resolve("link-widget-input"));d.label(D,h.translate("link.properties.url.placeholder"));v.append(C,D);q.set(D,"type","url");q.set(D,"placeholder",h.translate("link.dialog.tooltip"));var F=f.text(C,D),E=g([m.resolve("link-widget-insert")],"insert.link"),G=g([m.resolve("link-widget-update")],"link.dialog.update"),H=g([m.resolve("link-widget-remove")],"link.dialog.remove");v.append(z,C);var I=k.create({insert:n(["properties"]),update:n(["properties"]),
unlink:n([]),toEditor:n([])}),L=function(a,b){return l.properties({url:e.some(a),text:e.from(b),title:e.none(),target:e.none(),action:e.none()})},J=function(){var a=y.get(D),b=A.get().fold(function(){return L(a,a)},function(b){return b.text().fold(function(){return L(a,a)},function(b){return L(a,b)})});I.trigger.insert(b);A.set(e.none());I.trigger.toEditor()},K=function(){var a=y.get(D);I.trigger.update(L(a));A.set(e.none());I.trigger.toEditor()};E.events.click.bind(J);G.events.click.bind(K);H.events.click.bind(function(){I.trigger.unlink();
I.trigger.toEditor()});return{element:a.constant(z),addEscape:function(a){v.append(C,a.element())},type:a.constant(F),execute:function(){B.isVisible(E.element())?J():B.isVisible(G.element())&&K()},open:function(){u.focus(D)},close:a.noop,destroy:a.noop,represent:function(a){c.each([E.element(),G.element(),H.element()],x.remove);a.url().fold(function(){y.set(D,"http://");v.after(D,E.element())},function(a){w.after(D,[G.element(),H.element()]);y.set(D,a)});A.set(e.some(a))},events:I.registry}}});k("9o",
["8t","hm","hq","54","46"],function(c,d,b,a,e){return function(g){var f=b(g),h=c(g,f);g=d.disabled();var l=e.create({insert:a(["properties"]),update:a(["properties"]),unlink:a([])});f.events.insert.bind(function(a){l.trigger.insert(a.properties())});f.events.update.bind(function(a){l.trigger.update(a.properties())});f.events.unlink.bind(function(a){l.trigger.unlink()});return{showContext:function(a){f.represent(a);h.open()},showInsert:function(a){f.represent(a);h.open()},situation:g.situation,handle:g.handle,
assign:g.assign,events:l.registry,destroy:function(){h.close();h.destroy()}}}});k("5r","c 7 s 9l 73 9m 9n 9o 9p 6t 54 46 1a 9q".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,k,r,q){return function(s,t){var u=s.content(),v=s.undo(),w=s.shortcuts(),x=c.detect().deviceType.isTouch()?h(s):g(s,t),y=k.create({analytics:n(["message"])});x.events.insert.bind(function(b){v.transaction(function(){var c=a.insert(u,b.properties());s.internalevents().input(c)});u.domChanged();u.cursorIntoView();y.trigger.analytics("link_inserted")});
x.events.update.bind(function(b){v.transaction(function(){var c=b.properties();a.update(u,c)});u.domChanged();u.cursorIntoView()});x.events.unlink.bind(function(b){v.save();a.unlink(u);u.domChanged();u.cursorIntoView()});var B=function(){u.getSelection().each(function(a){l.sharedLink(a.startContainer(),a.endContainer()).fold(function(){u.selectWord();x.showInsert(f.properties({url:b.none(),text:u.getSelectedText(),title:b.none(),target:b.none(),action:b.none()}))},function(a){x.showContext(f.properties({url:b.from(r.get(a,
"href")),text:b.from(q.get(a)),title:b.from(r.get(a,"title")),target:b.from(r.get(a,"target")),action:b.none()}))})})},z=m.ui({"link.general":{toggle:!1,value:"link",textkey:e.key("insert.link"),action:B,updateGeneral:d.noop,icon:!0,shortcut:!0,hasPopup:!1,hasDialog:!0}});w.events.link.bind(B);return{ui:z,situation:x.situation,handle:x.handle,assign:x.assign,events:y.registry,destroy:function(){x.destroy()}}}});k("pk",["b","6","p"],function(c,d,b){return{consolidateObj:function(a,e){return c.foldl(a,
function(a,c){return a.fold(function(a){return c.fold(function(c){return b.error(a.concat(c))},function(c){return b.error(a)})},function(a){return c.fold(function(a){return b.error(a)},function(c){return b.value(d.deepMerge(a,c))})})},b.value(e))},consolidateArr:function(a){return c.foldl(a,function(a,c){return a.fold(function(a){return c.fold(function(c){return b.error(a.concat(c))},function(c){return b.error(a)})},function(a){return c.fold(function(a){return b.error(a)},function(c){return b.value(a.concat([c]))})})},
b.value([]))}}});k("pl",["b"],function(c){return{narrow:function(d,b){var a={};c.each(b,function(b){void 0!==d[b]&&d.hasOwnProperty(b)&&(a[b]=d[b])});return a},indexOnKey:function(d,b){var a={};c.each(d,function(c){a[c[b]]=c});return a}}});k("pm",["s"],function(c){var d=function(b){return function(a){return a.hasOwnProperty(b)?c.from(a[b]):c.none()}};return{readOpt:d,readOr:function(b,a){return function(c){return d(b)(c).getOr(a)}},readOptFrom:function(b,a){return d(a)(b)},hasKey:function(b,a){return b.hasOwnProperty(a)&&
void 0!==b[a]&&null!==b[a]}}});k("pn",["b"],function(c){return{wrap:function(c,b){var a={};a[c]=b;return a},wrapAll:function(d){var b={};c.each(d,function(a){b[a.key]=a.value});return b}}});k("hr",["pk","pl","pm","pn"],function(c,d,b,a){return{narrow:function(a,b){return d.narrow(a,b)},readOpt:function(a){return b.readOpt(a)},readOr:function(a,c){return b.readOr(a,c)},readOptFrom:function(a,c){return b.readOptFrom(a,c)},wrap:function(b,c){return a.wrap(b,c)},wrapAll:function(b){return a.wrapAll(b)},
indexOnKey:function(a,b){return d.indexOnKey(a,b)},hasKey:function(a,c){return b.hasKey(a,c)},consolidate:function(a,b){return c.consolidateObj(a,b)}}});k("9s",["4n"],function(c){var d=c.generate([{invalid:["invalidUrl"]},{unknown:["unknownUrl"]},{valid:["validUrl"]}]);return{cata:function(b,a,c,d){return b.fold(a,c,d)},derive:function(b,a){return"VALID"===a?d.valid(b):"INVALID"===a?d.invalid(b):d.unknown(b)}}});k("9t",["3s","7","p"],function(c,d,b){var a=d.compose(c.pure,b.value);c=d.compose(c.pure,
b.error);return{pure:a,failed:c,bindSync:function(a,b){return a.map(function(a){return a.bind(b)})},bindAsync:function(a,b){return a.bind(function(a){return a.bind(b)})},mapSync:function(a,b){return a.map(function(a){return a.map(b)})},handle:function(a,b,c){return a.get(function(a){return a.fold(b,c)})}}});k("hv",["20"],function(c){return{now:function(){return(new c).getTime()}}});k("hs",["a","1o","hv","s","2u"],function(c,d,b,a,e){return function(g,f){var h=void 0!==f?f:36E5,l=e.immutable("result",
"timestamp"),m={},n=function(a,b,c){m[a]=l(b,c)},k=function(a){var c=b.now();d.map(a,function(a,b){c-a.timestamp<h&&n(b,a.result,a.timestamp)})};c.isObject(g)&&k(g);return{set:n,get:function(b,c){return a.from(m[c]).filter(function(a){return b-a.timestamp()<h}).map(function(a){return a.result()})},dump:function(){return d.map(m,function(a){return{result:a.result(),timestamp:a.timestamp()}})}}}});k("x0",["p"],function(c){return{nu:function(d,b){return c.error([{path:d,err:b}])},toString:function(c){return"Failed path: ("+
c.path.join(" > ")+")\n"+c.err}}});k("pr",["7","4n"],function(c,d){var b=d.generate([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]);return{strict:b.strict,asOption:b.asOption,defaulted:function(a){return b.defaultedThunk(c.constant(a))},defaultedThunk:b.defaultedThunk,asDefaultedOption:function(a){return b.asDefaultedOptionThunk(c.constant(a))},asDefaultedOptionThunk:b.asDefaultedOptionThunk,mergeWith:function(a){return b.mergeWithThunk(c.constant(a))},
mergeWithThunk:b.mergeWithThunk}});k("x1","pr pk pm pn x0 b 1o 6 vv 7 s p 4n".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,k,r){var q=r.generate([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),s=function(a,c,d){return b.readOptFrom(c,d).fold(function(){return e.nu(a,'Could not find valid *strict* value for "'+d+'" in '+l.stringify(c,null,2))},k.value)},t=function(a,c,d){return k.value(b.readOr(c,d)(a))},u=function(a,c,d){a=b.readOptFrom(a,c).map(function(a){return!0===a?d:
a});return k.value(a)},v=function(c,d,e,f){return e.fold(function(e,g,l,m){var q=function(b){return m.extract(c.concat([e]),f,b).map(function(b){return a.wrap(g,f(b))})},r=function(b){return b.fold(function(){var b=a.wrap(g,f(n.none()));return k.value(b)},function(b){return m.extract(c.concat([e]),f,b).map(function(b){return a.wrap(g,f(n.some(b)))})})};return function(){return l.fold(function(){return s(c,d,e).bind(q)},function(a){a=a();return t(d,e,a).bind(q)},function(){return k.value(b.readOptFrom(d,
e)).bind(r)},function(a){a=a();return u(d,e,a).bind(r)},function(a){var b=a();return t(d,e,{}).map(function(a){return h.deepMerge(b,a)}).bind(q)})}()},function(b,c){var e=c(d);return k.value(a.wrap(b,f(e)))})},w=function(a,b,c,e){c=g.map(c,function(c){return v(a,b,c,e)});return d.consolidateObj(c,{})},x=function(a){return{extract:function(b,c,d){return a(d).fold(function(a){return e.nu(b,a)},k.value)},toString:function(){return"val"}}},y=function(a){return{extract:function(b,c,d){return w(b,d,a,c)},
toString:function(){return"obj{\n"+g.map(a,function(a){return a.fold(function(a,b,c,d){return a+" -> "+d.toString()},function(a,b){return"state("+a+")"})}).join("\n")+"}"}}},B=function(a){return{extract:function(b,c,e){e=g.map(e,function(d,e){return a.extract(b.concat(["["+e+"]"]),c,d)});return d.consolidateArr(e)},toString:function(){return"array("+a.toString()+")"}}};r=x(k.value);var z=m.compose(B,y);return{anyValue:m.constant(r),value:x,obj:y,arr:B,setOf:function(a,b){var d=function(b,c){return B(x(a)).extract(b,
m.identity,c)};return{extract:function(a,e,h){var l=f.keys(h);return d(a,l).bind(function(d){d=g.map(d,function(a){return q.field(a,a,c.strict(),b)});return y(d).extract(a,e,h)})},toString:function(){return"setOf("+b.toString()+")"}}},arrOfObj:z,state:q.state,field:q.field,output:function(a,b){return q.state(a,m.constant(b))},snapshot:function(a){return q.state(a,m.identity)}}});k("wz","hr x0 x1 1o vv p".split(" "),function(c,d,b,a,e,g){var f=function(a,f,g,n,k){return c.readOptFrom(n,k).fold(function(){return d.nu(a,
'The chosen schema: "'+k+'" did not exist in branches: '+e.stringify(n,null,2))},function(c){return b.obj(c).extract(a.concat(["branch: "+k]),f,g)})};return{choose:function(b,e){return{extract:function(a,g,k){return c.readOptFrom(k,b).fold(function(){return d.nu(a,'Choice schema did not contain choice key: "'+b+'"')},function(b){return f(a,g,k,e,b)})},toString:function(){return"chooseOn("+b+"). Possible values: "+a.keys(e)}}}}});k("po","wz x0 x1 b vv 7 p n".split(" "),function(c,d,b,a,e,g,f,h){var l=
b.value(f.value),m=b.arr,n=b.obj,k=b.setOf,r=function(a,b,c,d){return b.extract([a],c,d).fold(function(a){return f.error({input:d,errors:a})},f.value)},q=function(a,b,c){return r(a,b,g.constant,c)},s=function(a,b,c){return r(a,b,g.identity,c)},t=function(a){return a.fold(function(a){throw new h(u(a));},g.identity)},u=function(b){return"Errors: \n"+a.map(b.errors,d.toString).join("\n\n")+"\n\nInput object: "+e.stringify(b.input,null,2)};return{anyValue:g.constant(l),arrOfObj:function(a){return b.arrOfObj(a)},
arrOf:m,arrOfVal:function(){return b.arr(l)},valueOf:function(a){return b.value(a)},setOf:k,objOf:n,asStruct:q,asRaw:s,asStructOrDie:function(a,b,c){return t(q(a,b,c))},asRawOrDie:function(a,b,c){return t(s(a,b,c))},getOrDie:t,formatError:u,choose:function(a,b){return c.choose(a,b)}}});k("pp",["6","wi","vv"],function(c,d,b){var a=function(a){return function(c,d,e){var m;try{m=void 0===e||""===e?e:b.parse(e)}catch(n){m={contents:e}}a(c,d,m)}},e=function(b,e,h,l,m){d.ajax(b,h,a(l),c.merge({dataType:"json",
type:e},m))};return{get:function(b,c,d,l){e(b,"GET",c,a(d),l)},post:function(a,d,h,l,m){e(a,"POST",h,l,c.merge({data:b.stringify(d)},m))},ajax:e}});k("ht","po a 1o pp 3s p v w".split(" "),function(c,d,b,a,e,g,f,h){return{get:function(l,m,n,k){var r={headers:k};return{execute:function(k){k=c.asRawOrDie(l+".ajax.service.get",m,k);k=b.map(k,function(a){return d.isBoolean(a)?h(a):a});var p=f.supplant(n,k);return e.nu(function(b){a.get(p,function(a){b(g.value(a))},function(a){b(g.error(a))},r)})}}},post:function(b,
d,f,h){var k={headers:h};return{execute:function(h){var p=c.asRawOrDie(b+".ajax.service.post",d,h);return e.nu(function(b){a.post(f,p,function(a){b(g.value(a))},function(a){b(g.error(a))},k)})}}}}});k("pq",["hr","b","6"],function(c,d,b){return{partition:function(a,e,g,f,h){return!0===h?{known:{},unknown:g}:d.foldl(g,function(d,g){var h=f(g);return a(e,h).fold(function(){return{known:d.known,unknown:d.unknown.concat([g])}},function(a){a=c.wrap(h,a);return{known:b.merge(d.known,a),unknown:d.unknown}})},
{known:{},unknown:[]})}}});k("hu",["1o","6","9t","pq","s"],function(c,d,b,a,e){var g=function(a,e,g,m,n,k,r){a=a(m,r);return b.mapSync(a,function(a){a=n(a);c.each(a,function(a,b){e.set(b,a,k)});return d.deepMerge(g,a)})};return{single:function(a,c,d,g,n){return(!0===n?e.none():c.get(g,d)).fold(function(){return a(d,n).map(function(a){return a.map(function(a){c.set(d,a,g);return a})})},function(a){return b.pure(a)})},multiple:function(c,d,e,m,n,k,r){e=a.partition(d.get,k,e,n,r);return 0===e.unknown.length?
b.pure(e.known):g(c,d,e.known,e.unknown,m,k,r)}}});k("ps",["pr","x1"],function(c,d){return{strict:function(b){return d.field(b,b,c.strict(),d.anyValue())},option:function(b){return d.field(b,b,c.asOption(),d.anyValue())},strictArrayOfObj:function(b,a){return d.field(b,b,c.strict(),d.arrOfObj(a))},strictArrayOf:function(b,a){return d.field(b,b,c.strict(),a)},defaulted:function(b,a){return d.field(b,b,c.defaulted(a),d.anyValue())},field:function(b,a,c,g){return d.field(b,a,c,g)},state:function(b,a){return d.state(b,
a)}}});k("hw",["pr","ps","po","7"],function(c,d,b,a){var e=[d.strict("url"),d.defaulted("fresh",!1)],g=b.objOf(e);c=b.objOf([d.field("urls","urls",c.strict(),b.arrOfObj(e))]);return{one:a.constant(g),many:a.constant(c)}});da("hx",encodeURIComponent);k("9r","hr 1o 9s 9t hs ht hu hv hw hx".split(" "),function(c,d,b,a,e,g,f,h,l,m){return function(n,k,r){var q=e(r),s=g.get("ephox.link.service.one",l.one(),n+"/1/check?url=${url}&fresh=${fresh}",k),t=g.post("ephox.link.service.many",l.many(),n+"/1/check",
k),u=function(a){return{url:a.url,result:b.derive(a.url,a.result)}};return{checkOne:function(b,c){var d=h.now(),d=f.single(function(a,c){return s.execute({url:m(b),fresh:c})},q,b,d,void 0!==c?c:!1);return a.mapSync(d,u)},checkMany:function(b,e){var g=h.now(),g=f.multiple(function(a,b){return t.execute({urls:a})},q,b,function(a){return c.indexOnKey(a.results,"url")},function(a){return a.url},g,void 0!==e?e:!1);return a.mapSync(g,function(a){return d.map(a,u)})},dumpCache:q.dump}}});k("pt",[],function(){return{recompose:function(c){var d=
"";""!==c.protocol&&(d+=c.protocol,d+=":");""!==c.authority&&(d=d+"//"+c.authority);d+=c.path;""!==c.query&&(d+="?",d+=c.query);""!==c.anchor&&(d+="#",d+=c.anchor);return d}}});k("x2",["v"],function(c){return{remove:function(d){for(var b="";""!==d;)if(c.startsWith(d,"../"))d=c.removeLeading(d,"../");else if(c.startsWith(d,"./"))d=c.removeLeading(d,"./");else if(c.startsWith(d,"/./"))d="/"+c.removeLeading(d,"/./");else if("/."===d)d="/";else if(c.startsWith(d,"/../"))d="/"+c.removeLeading(d,"/../"),
b=c.removeTrailing(b,b.substring(b.lastIndexOf("/")));else if("/.."===d)d="/",b=c.removeTrailing(b,b.substring(b.lastIndexOf("/")));else if("."===d||".."===d)d="";else{var a=d.match(/(^\/?.*?)(\/|$)/)[1];d=c.removeLeading(d,a);b+=a}return b}}});k("x3",["v"],function(c){return{merge:function(d,b,a){if(""!==a&&""===d)return"/"+b;a=d.substring(d.lastIndexOf("/")+1);return c.removeTrailing(d,a)+b}}});k("pu",["v","h9","x2","x3"],function(c,d,b,a){return{transform:function(e,g){var f={strictMode:!0},h=
d.parse(e,f),f=d.parse(g,f),l={};""!==f.protocol?(l.protocol=f.protocol,l.authority=f.authority,l.path=b.remove(f.path),l.query=f.query):(""!==f.authority?(l.authority=f.authority,l.path=b.remove(f.path),l.query=f.query):(""===f.path?(l.path=h.path,l.query=""!==f.query?f.query:h.query):(c.startsWith(f.path,"/")?l.path=b.remove(f.path):(l.path=a.merge(h.path,f.path,e.authority),l.path=b.remove(l.path)),l.query=f.query),l.authority=h.authority),l.protocol=h.protocol);l.anchor=f.anchor;return l}}});
k("hy",["pt","pu"],function(c,d){return{resolve:function(b,a){var e=d.transform(b,a);return c.recompose(e)}}});k("9x","b s p hl 2u 1a 2a v h9 hy 36".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){var k=e.immutable("href","resolved");return function(e){var q=e.slice(0),s=function(e){var r=g.get(e,"href");if(h.startsWith(r,"#")||g.has(e,a.bookmarkAnchorDataAttr()))e=b.error(e);else{var s;s=f.owner(e).dom().baseURI;s=d.from(s).getOr(n.location);s=m.resolve(s,r);if(c.contains(q,s))e=b.error(e);else{var w=
l.parse(s).protocol;e="https"===w||"http"===w?b.value(k(r,s)):b.error(e)}}return e};return{extract:s,ignore:function(a){s(a).each(function(a){q.push(a.resolved())})},state:function(){return q.slice(0)}}}});k("9y",["b"],function(c){return{generate:function(d){var b={};c.each(d,function(a){var d=a.resolved();a=a.href();b.hasOwnProperty(d)?c.contains(b[d],a)||b[d].push(a):b[d]=[a]});return b}}});k("5s","b 1o 9r 9s 9t 7 9u s k 9v 9w 9x 9y 9p 9z 1y 4b o".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,k,r,q,
s,t,u,v){return function(w,x,y){var B=w.content(),z=w.filter(),A=w.communication(),C=w.undo(),D=w.viewablearea(),F=D.viewport(),E=k(x.ignore),G=n.validationHighlight(),H=n.invalidLink(),I=n.unknownLink();n.configure(z);var L=b(y.url,A.mediatorHeaders(),x.cache),J=function(a){a=c.map(a,function(a){return s.cata(F.assess(a),h.none,g.compose(h.some,E.extract),h.none)});a=l.cat(a);a=m.partition(a);c.each(a.errors,Q);var b=r.generate(a.values);a=d.keys(b);a=c.map(a,function(a){return{url:a}});a=L.checkMany(a);
M(a,function(a){d.each(a,function(a){var d=b[a.url];void 0===d?v.warn("Link validator response from server was unknown: ",a.url,a.result):c.each(d,function(b){R(a.result,b)})})})};w=function(){var a=D.sections(),a=q.many(a);J(a)};var K=f(w,500).throttle;D.events.onChange.bind(K);B.events.domChanged.bind(K);var M=function(a,b){e.handle(a,function(a){v.error("Link Validation server failure: ",a)},function(a){b(a)})},N=function(a){return B.body().map(function(b){return q.hrefUrl(b,a)})},S=function(a,
b){N(a).each(function(a){c.each(a,function(a){t.has(a,n.validationHighlight())||u.add(a,[G,b])})})},Q=function(a){t.has(a,n.validationHighlight())&&u.remove(a,n.allClasses())},P=function(a){N(a).each(function(a){c.each(a,Q)})},R=function(b,c){a.cata(b,function(a){S(c,H)},function(a){S(c,I)},function(a){P(c)})};C.events.undo.bind(w);C.events.redo.bind(w);return{destroy:g.noop,refresh:K,ignore:function(a){C.save();E.ignore(a);K();B.focus();B.domChanged();B.cursorIntoView()},state:function(){return{ignore:E.state(),
cache:L.dumpCache()}}}}});k("10p",["s","i7"],function(c,d){return{top:{rules:[{current:d.backtrack,next:d.sidestep,fallback:c.none()},{current:d.sidestep,next:d.sidestep,fallback:c.some(d.backtrack)},{current:d.advance,next:d.sidestep,fallback:c.some(d.sidestep)}],inclusion:function(b,a,c){return!b.property().parent(c).exists(function(c){return b.eq(c,a.item())})}},all:{rules:void 0,inclusion:function(b,a,c){return b.property().isText(a.item())}}}});k("x4",["b","7","i7","10p"],function(c,d,b,a){var e=
b.walkers(),g=function(a,c,d,f){return b.walk(a,c,d,e.left(),f.rules).map(function(b){return a.property().isEmptyTag(b.item())||a.property().isBoundary(b.item())?[]:(f.inclusion(a,b,c)?[b.item()]:[]).concat(g(a,b.item(),b.mode(),f))}).getOr([])},f=function(a,d,e){a=g(d,e,b.sidestep,a);return c.reverse(a).concat([e])};return{top:d.curry(f,a.top),all:d.curry(f,a.all)}});k("pv",["dy","x4"],function(c,d){var b=c();return{top:function(a){return d.top(b,a)},all:function(a){return d.all(b,a)}}});k("x5",
["b","7","s","eg","h4"],function(c,d,b,a,e){var g=function(f,g){var m=e.generate(g,function(c,d){return f.property().isText(c)?b.some(a.range(c,d,d+f.property().getText(c).length)):b.none()}),n=c.foldr(m,function(a,b){return f.property().getText(b.element())+a},"");return{list:d.constant(m),text:d.constant(n)}},f=function(a,b,c,f){var g=e.find(b.list(),function(b){return a.eq(b.element(),c)}).map(function(a){return a.start()+f});return{list:b.list,text:b.text,cursor:d.constant(g)}};return{from:function(a,
b,c,d){b=g(a,b);return f(a,b,c,d)}}});k("pw",["dy","x5"],function(c,d){var b=c();return{from:function(a,c,g){return d.from(b,a,c,g)}}});k("hz",["7","s","pv","pw","21"],function(c,d,b,a,e){return{get:function(g,f){var h=b.all(g),l=a.from(h,g,f),h=l.cursor().orThunk(function(){return e.isText(g)?d.none():d.some(l.text().length)});return{list:l.list,text:l.text,cursor:c.constant(h)}}}});k("px",["4p","7","s","l","68"],function(c,d,b,a,e){return function(g,f,h){return{patterns:function(){return[new e("(\\W)(\\w+)(\\W*)$",
"gi"),new e("(^)(\\w+)(\\W*)$","gi")]},useCursor:d.constant(!0),generate:function(e,f){var g=a.fromText(f.text());return c.species({elements:d.constant([g]),cursor:b.none,dictation:d.constant(b.some(function(){return h(f.text())})),notify:b.none})},derive:function(a){var b=a.index+a[1].length,c=b+a[2].length;return f(a[2]).map(function(a){return{startIndex:d.constant(b),finishIndex:d.constant(c),text:d.constant(a)}})},label:g}}});k("py","4p 7 s 6j l 68".split(" "),function(c,d,b,a,e,g){return function(f,
h){var l=a.sanitise(f);return{patterns:function(){return[new g("("+l+")","gi")]},useCursor:d.constant(!0),generate:function(a,f){var g=e.fromTag("span",a.dom());g.dom().innerHTML=h;return c.species({elements:d.constant([g]),cursor:b.none,dictation:b.none,notify:b.none})},derive:function(a){var c=a.index;a=c+a[0].length;return b.some({startIndex:d.constant(c),finishIndex:d.constant(a)})}}}});k("pz","4p 7 s eg 6j 2n l 2o 3c 68".split(" "),function(c,d,b,a,e,g,f,h,l,m){return function(n,k,r){var q=e.sanitise(k);
return{patterns:function(){return[new m("^("+q+"\\s)(.+)","gi")]},useCursor:d.constant(!1),generate:function(e,m){var k=f.fromTag(n,e.dom());g.set(k,"list-style-type",r);var p=f.fromTag("li",e.dom()),q=f.fromTag("li",e.dom());h.append(q,f.fromTag("br",e.dom()));l.append(k,[p,q]);l.append(p,m.clones());return c.species({elements:d.constant([k]),cursor:d.constant(b.some(a.point(q,0))),dictation:b.none,notify:b.none})},derive:function(a){var c=a[1];return b.some({startIndex:d.constant(a.index),finishIndex:d.constant(a.index+
c.length)})}}}});k("q0","4p 7 s 6j l 3c 68".split(" "),function(c,d,b,a,e,g,f){var h=function(a,h){return{patterns:function(){return[new f("^("+a+")(.+)","gi")]},useCursor:d.constant(!1),generate:function(a,f){var l=e.fromTag(h,a.dom());g.append(l,f.clones());return c.species({elements:d.constant([l]),cursor:b.none,dictation:b.none,notify:b.none})},derive:function(a){var c=a[1];return b.some({startIndex:d.constant(a.index),finishIndex:d.constant(a.index+c.length)})}}};return{normal:function(b,c){var d=
a.sanitise(b);return h(d,c)},spaced:function(b,c){var d=a.sanitise(b)+"\\s";return h(d,c)}}});k("q1","4p 7 s 6j l 2o 68".split(" "),function(c,d,b,a,e,g,f){return function(h,l,m,n){var k=a.sanitise(l),r=a.sanitise(m);return{patterns:function(){return[new f(k+"([^\\s].*?[^\\s])"+r,"gi"),new f(k+"([^\\s])"+r,"gi")]},useCursor:d.constant(!0),generate:function(a,f){var h=e.fromTag(n,a.dom()),l=e.fromText(f.text());g.append(h,l);return c.species({elements:d.constant([h]),cursor:b.none,dictation:b.none,
notify:b.none})},derive:function(a){return b.some({startIndex:d.constant(a.index),finishIndex:d.constant(a.index+a[0].length),text:d.constant(a[1])})}}}});k("q2","4p 7 s 6j l 68".split(" "),function(c,d,b,a,e,g){return function(f,h){var l=a.sanitise(f);return{patterns:function(){return[new g("("+l+")","gi")]},useCursor:d.constant(!0),generate:function(a,f){return c.species({elements:d.constant([e.fromTag(h,a.dom())]),cursor:b.none,dictation:b.none,notify:b.none})},derive:function(a){return b.some({startIndex:d.constant(a.index),
finishIndex:d.constant(a.index+a[0].length)})}}}});k("q3","4p 7 s l v 68".split(" "),function(c,d,b,a,e,g){var f=function(e,f){return c.species({elements:d.constant([a.fromText(f.text())]),cursor:b.none,dictation:b.none,notify:b.none})},h=function(){return{patterns:function(){return[/([^.?!][.?!]\s+)([a-z][^\s]*)/g,/^()([a-z][^\s]*)/g]},useCursor:d.constant(!0),generate:f,derive:function(a){var c=a.index,f=c+a[0].length;a=a[1]+e.capitalize(a[2]);return b.some({startIndex:d.constant(c),finishIndex:d.constant(f),
text:d.constant(a)})}}}(),l=function(){return{patterns:function(){return[new g("([A-Z][A-Z]+)([a-z]+)","g")]},useCursor:d.constant(!1),generate:f,derive:function(a){var c=a[2],c=e.capitalize(a[1].toLowerCase())+c.toLowerCase(),f=a.index;a=f+a[0].length;return b.some({startIndex:d.constant(f),finishIndex:d.constant(a),text:d.constant(c)})}}}();return{capitalise:d.constant(h),normalise:d.constant(l)}});k("q4","4p 7 s bw pc 1a l 2o".split(" "),function(c,d,b,a,e,g,f,h){return{patterns:function(){return[a.link()]},
useCursor:d.constant(!0),generate:function(a,e){var n=f.fromTag("a");g.set(n,"href",e.href());h.append(n,f.fromText(e.text()));return c.species({elements:d.constant([n]),cursor:b.none,dictation:b.none,notify:d.curry(b.some,[n])})},derive:function(a){var c=e.preprocess(a[0]),f=c.text(),c=c.href();return-1<f.indexOf("@")?b.none():b.some({startIndex:d.constant(a.index),finishIndex:d.constant(a.index+f.length),text:d.constant(f),href:d.constant(c)})}}});k("i0","b px py pz q0 q1 q2 7 r 73 q3 q4 6m 2a 3t".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,k,r,q,s){var t=h.constant(function(a,b){return b});return function(s,v,w){var x=w.whitelist.fold(t,function(a){return function(b,d){return c.contains(a,b)?d:[]}}),y=function(a){return{derive:a.derive,generate:a.generate,patterns:a.patterns,useCursor:a.useCursor,allowed:h.constant(!0)}},B=function(a,b){return{derive:a.derive,generate:a.generate,patterns:a.patterns,useCursor:a.useCursor,allowed:function(a){return!1===r.closest(a,b)}}};w=x("headings",[y(e.spaced("######",
"h6")),y(e.spaced("#####","h5")),y(e.spaced("####","h4")),y(e.spaced("###","h3")),y(e.spaced("##","h2")),y(e.spaced("#","h1"))]);var z=x("lists",[y(a("ul","*","disc")),y(a("ol","1.","decimal")),y(a("ol","a.","lower-alpha")),y(a("ol","i.","lower-roman")),y(a("ol","1)","decimal")),y(a("ol","a)","lower-alpha")),y(a("ol","i)","lower-roman"))]),A=x("semantics",[y(g("bold","**","**","strong")),y(g("bold","__","__","strong")),y(g("italic","*","*","em")),y(g("italic","_","_","em"))]),C=x("entities",[y(b("(c)",
"&copy;")),y(b("-","&mdash;"))]),D=x("capitalisation",[y(n.normalise()),y(n.capitalise())]),F=function(a){return m.translate("aria.autocorrect.announce",a)};s=s.hasAutocorrect()?x("autocorrect",[y(d("autocorrect",s.lookup,F))]):[];var F=x("hr",[y(f("---","hr"))]),E=l.cached(function(a){a.runOrOnLoaded(function(b){var c=l.cached(function(){q.owner(b).dom().execCommand("AutoUrlDetect",!1,!1)});a.events.focus.bind(function(){c()})});return x("link",[B(k,"a")])});return{headings:h.constant(w),semantics:h.constant(A),
entities:h.constant(C),cases:h.constant(D),lists:h.constant(z),dynCustoms:function(){var a=v.get();return c.map(a,y)},link:E,hr:h.constant(F),corrections:h.constant(s)}}});k("x6",["2u"],function(c){return c.immutable("startContainer","startOffset","endContainer","endOffset")});k("x7","b 1b 21 f4 ak 1s".split(" "),function(c,d,b,a,e,g){return{cloneAfter:function(f,h,l){var m=h;return c.map(f,function(c){var f=a.deep(c);b.isText(c)&&d.eq(l.endContainer(),c)&&e.get(c).length>l.endOffset()&&e.set(f,e.get(f).substring(0,
l.endOffset()));if(b.isText(f)&&0<m){var h=e.get(f);c=g.min(h.length,m);h=h.substring(c);e.set(f,h);m-=c}return f})}}});k("x8",["s","k"],function(c,d){return{matcher:function(b,a,e){var g=function(a){return e.fold(function(){return a&&1<a.length},function(b){return a&&0<a.length&&a.index+a[0].length===b})};return d.findMap(b,function(b){a:{if(!b.global)throw"Macro matching only works with global regexes: "+b;for(var d=b.exec(a);d;){if(g(d)){b=c.some(d);break a}d=b.exec(a)}b=c.none()}return b})}}});
k("q5","4p x6 x7 x8 6 7 s pv".split(" "),function(c,d,b,a,e,g,f,h){var l=function(a,d,f,h){d=b.cloneAfter(d,h.finishIndex(),f);var l=e.merge(h,{clones:g.constant(d)});return{build:function(b){b=a.generate(b,l);return c.applicator({elements:b.elements,cursor:b.cursor,range:g.constant(f),dictation:b.dictation,notify:b.notify})}}};return{detect:function(b,c,e,g){var k=c.patterns(),s=b.cursor().filter(c.useCursor);return a.matcher(k,b.text(),s).bind(c.derive).bind(function(a){var b=h.top(e);if(0<b.length){var m=
d(b[0],0,e,g);return f.some(l(c,b,m,a))}return f.none()})}}});k("q6","4p x6 x8 7 s h4".split(" "),function(c,d,b,a,e,g){var f=function(b,c,d){c=g.get(b,c);var e=g.get(b,d);return c.bind(function(b){return e.map(function(c){return{start:a.constant(b),finish:a.constant(c)}})})},h=function(a,b){return b(a.start().element())&&b(a.finish().element())?e.some(a):e.none()};return{detect:function(e,g,n,k){n=g.patterns();k=e.cursor().filter(g.useCursor);return b.matcher(n,e.text(),k).bind(g.derive).bind(function(b){return f(e.list(),
b.startIndex(),b.finishIndex()).bind(function(e){return h(e,g.allowed).map(function(e){var f=b.startIndex()-e.start().start(),h=b.finishIndex()-e.finish().start(),l=d(e.start().element(),f,e.finish().element(),h);return{build:function(d){d=g.generate(d,b);return c.applicator({elements:d.elements,cursor:d.cursor,range:a.constant(l),dictation:d.dictation,notify:d.notify})}}})})})}}});k("i1","ee b q5 q6 a7 7 7u f9 2m".split(" "),function(c,d,b,a,e,g,f,h,l){var m=function(a,b,g){return b.doc().bind(function(m){m=
a.build(m);var n=m.elements();d.map(n,c.doNotMerge);var k=h.handle(m.range());f.insertAt(b,k,n);d.map(n,c.clear);m.dictation().each(function(a){e.shout(l.body(),a())});m.notify().each(function(){g.input(n)});return m.cursor()})},n=function(a,b,c,d,e){return a.detect(b,c,d,e).map(function(a){return{execute:g.curry(m,a)}})};return{block:g.curry(n,b),inline:g.curry(n,a)}});k("a0","b hz 7 s k f8 i0 i1".split(" "),function(c,d,b,a,e,g,f,h){return function(l,m,n,k,r,q,s,t){var u=a.none(),v=a.none(),w=f(r,
q,t),x=c.flatten([w.link(m),w.hr(),w.semantics(),w.entities()]),y=function(){return c.flatten([x,l.autocorrect().get()?w.corrections():[],l.capitalisation().get()?w.cases():[],w.dynCustoms()])},B=w.headings().concat(w.lists()),z=function(a,b,f,h){var l=g.descend(b,f),m=d.get(l.element(),l.offset());f=c.filter(h,function(a){return a.allowed(b)});return e.findMap(f,function(b){return a(m,b,l.element(),l.offset())})},A=function(a,b){m.undoOperation(function(){a(function(){return b.execute(m,s)}).each(function(a){m.setSelection(a.element(),
a.offset(),a.element(),a.offset())});m.domChanged()})};return{spaceDown:function(){m.getSelection().map(function(a){a.collapsed()&&(u=z(h.inline,a.startContainer(),a.startOffset(),y()))})},spaceUp:function(){var c=b.curry(A,k.run);u.each(c);u=a.none()},enterDown:function(){m.getSelection().map(function(a){a.collapsed()&&(v=z(h.block,a.startContainer(),a.startOffset(),B.concat()));v=v.orThunk(function(){return z(h.inline,a.startContainer(),a.startOffset(),y())})})},enterUp:function(){var c=b.curry(A,
b.apply);v.each(c);v=a.none()}}}});k("5t","7 73 6q a0 a1 6t 74 54 46".split(" "),function(c,d,b,a,e,g,f,h,l){return function(m,n,k,r){var q=m.profile(),s=m.content(),t=m.undo(),u=m.context(),v=m.operations(),w=m.internalevents(),x=l.create({analytics:h(["message"])}),y=b(k.customs),B=a(q,s,t,v,n,y,w,r);s.events.keydown.bind(function(a){e.isSpace(a)&&B.spaceDown()});s.events.keyup.bind(function(a){e.isSpace(a)&&B.spaceUp()});u.events.preLinebreak.bind(function(a){B.enterDown()});u.events.postLinebreak.bind(function(a){B.enterUp()});
var z=function(a){return function(){var b=a.get();a.setAndCache(!b)}},A=function(a){return function(b){(!0===a.get()?b.select:b.deselect)()}};n=function(a,b,c){return{toggle:!0,value:a,textkey:d.key(b),action:z(c),updateGeneral:A(c),icon:!1,tooltip:f.get}};return{ui:g.ui({"capitalisation.general":n("capitalisation","cog.capitalisation",m.profile().capitalisation()),"autocorrect.general":n("autocorrect","cog.autocorrect",m.profile().autocorrect())}),destroy:c.noop,events:x.registry,customMacros:c.constant(y),
state:function(){return{customs:y.state()}}}}});k("i2","7v a7 c g2 8h 4z gp dv 7 g4 l2 73 g5 33 54 46 1a 1y l 2y 2o 3c 2q 32".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,k,r,q,s,t,u,v,w,x,y,B,z,A){var C=b.detect().deviceType.isTouch();return function(){var b=t.create({insert:s(["embed"])}),F=w.fromTag("span"),E=n.textarea("media-embed","media.embed"),G=k.translate("media.placeholder"),H=d.describe(E.textarea(),G);y.append(E.element(),H);H=g.span();c.hidden(H,!0);v.add(H,q.resolve("media-icon"));u.set(H,
"alt",k.translate("media.insert"));var I=f(),L=k.translate("media.insert");I.content(h(L));v.add(I.element(),[q.resolve("media-insert")]);r.makeDefault(I.element());c.button(I.element(),L);u.set(E.textarea(),"placeholder",G);B.append(F,[H,E.element(),I.element()]);var J=function(){var a=A.get(E.textarea());b.trigger.insert(a);C&&x.blur(E.textarea())},G=[e.input(E.textarea(),a.input({})),e.button(I.element(),a.button({execute:m.click}))];I.events.click.bind(function(){J()});return{element:l.constant(F),
execute:J,empty:function(){A.set(E.textarea(),"")},keylayouts:l.constant(G),events:b.registry,destroy:function(){I.destroy();z.remove(F)}}}});k("a3","a5 7v g2 8h 7 73 i2 33 aj 46 47 4b".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,k){return function(r){var q=r.region(),s=r.content(),t=r.smartview(),u=f(),v=a.inlineDialog(u.element(),u.keylayouts(),b.inlineDialog({ok:u.execute,cancel:e.noop}));d.dialog(u.element(),g.translate("insert.media"));var w=c.popup(t.uiContainer,t.bounds,q,[],l.editorContainer()).initMenu(u.element());
k.add(u.element(),[h.resolve("media-embed-dialog"),h.resolve("inline-dialog")]);v.events.exit.bind(function(){x()});var x=function(){w.closed()||(w.close(),u.empty(),s.focus(),v.exit());y()};r=m.create({insert:n(["embed"],u.events.insert)});var y=function(){v.destroy();u.destroy();w.destroy()};return{element:u.element,showPopup:function(a){w.open();a.show(q,s,t,w,u);v.enter()},isClosed:w.closed,events:r.registry,closePopup:x,destroy:y}}});k("a4","4z 7 i3 gn 73 33 54 46 1a 1y l 2y 2o i4 32".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,k,r,q,s){return function(t){t=c.div();m.add(t,g.resolve("media-widget"));var u=c.span();m.add(u,g.resolve("media-widget-field"));var v=n.fromTag(q.isLarge()?"textarea":"input");m.add(v,g.resolve("media-widget-input"));var w=e.translate("media.placeholder");l.set(v,"placeholder",w);l.set(v,"title",w);r.append(u,v);w=b([g.resolve("media-widget-insert")],"insert.media");r.append(u,w.element());r.append(t,u);var x=a.text(u,v),y=h.create({insert:f(["embed"]),toEditor:f([])}),
B=function(){var a=s.get(v);y.trigger.insert(a);y.trigger.toEditor()};w.events.click.bind(function(){B()});return{element:d.constant(t),addEscape:function(a){r.append(u,a.element())},open:function(){s.set(v,"");k.focus(v)},close:d.noop,execute:function(){B()},destroy:d.noop,type:d.constant(x),events:y.registry}}});k("5u","c 7 71 a2 8t 73 a3 a4 6t".split(" "),function(c,d,b,a,e,g,f,h,l){return function(m){var n=m.content(),k=function(){var c=b.destroyable(),d=function(){c.clear();n.events.mousedown.unbind(d)};
return{open:function(){var b=f(m);b.events.insert.bind(function(a){a=a.embed();m.insertFilteredHtmlAtCursor(a);n.cursorIntoView();d()});b.showPopup(a);n.events.mousedown.bind(d);c.set(b)},destroy:function(){d()}}},r=function(){var a=h(m);a.events.insert.bind(function(a){a=a.embed();m.insertFilteredHtmlAtCursor(a);n.cursorIntoView()});return e(m,a)},q=(c.detect().deviceType.isTouch()?r:k)();return{ui:l.ui({"media.general":{toggle:!1,value:"media",textkey:g.key("insert.media"),action:q.open,updateGeneral:d.noop,
icon:!0,shortcut:!1,hasPopup:!1,hasDialog:!0}}),destroy:function(){q.destroy()}}}});k("a9","7 33 1y l 2o 2q 6e 3t".split(" "),function(c,d,b,a,e,g,f,h){return function(l,m){var n=a.fromTag("div");b.add(n,d.resolve("mentions-business-card"));var k=l.initMenu(n),r=null,q=function(a,b,c){g.empty(n);e.append(n,c);k.open();a(b,k)};return{showFull:function(a){return function(b,c){f(r);r=h(function(){q(a,b,c)},500)}}(m.showUnder),showMini:c.curry(q,m.showAtSide),hide:function(){f(r);k.close()},destroy:function(){f(r);
k.destroy()}}}});k("aa","a 1p s p 2u l o".split(" "),function(c,d,b,a,e,g,f){var h=e.immutable("rawData","extra"),l=function(b,d,e){if(c.isArray(d)&&c.isArray(e))return a.value(h(d,e));f.error(b+" callback parameters were not both arrays",d,e);return a.error(b+" callback parameters were not both arrays")},m=function(b,c){if(d.isPrototypeOf(c))return a.value(g.fromDom(c));f.error(b+" was not a DOM element",c);return a.error(b+" was not a DOM element")};return function(a){var c=b.none();return{fetch:function(b,
c){a.fetch(b,function(a,b){var d=l("fetch()",a,b);c(d)})},fetchExtra:function(b,c,d){a.menuExtra(b,c,function(a,b){var c=l("menuExtra()",a,b);d(c)})},menuHover:function(d,e){c=b.some(d.userid);a.menuHover(d,function(a){a=m("menuHover() callback",a);c.is(d.userid)&&e(a)})},hover:function(b,c){a.hover(b.dom(),function(a){a=m("hover() callback",a);c(a)})},menuComplete:function(b){b=a.menuComplete(b);return m("menuComplete result",b)},hoverSelector:function(){return a.hoverSelector},isTrigger:function(a){return 64===
a}}}});k("ab",["b","ca"],function(c,d){return{configure:function(b){var a=[b.internal(),b.history(),b.output()];c.each(a,function(a){b.addSelector(a,"span.ephox-polish-incomplete-mention",d.unwrap)})}}});k("q7","b g0 6 7 s 33 4n 4m 1a l 2f 3c 2q 31 al q".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,k,r,q,s,t){var u=g.resolve("no-results"),v=g.resolve("loading-results"),w=f.generate([{none:["item"]},{extra:["value","item"]},{fetched:["userId","name","rawname","info","item"]}]);return function(f){var y=
d.mainmenu(m.fromDom(t),g.resolve("mentions-list"),[]),B=h({}),z=function(a){return a.userid},A=function(a){return a.name},C=function(a,b){q.child(a,".ephox-gopher-item-text").each(function(a){n.set(a,b)})},D=function(a){return c.map(a,function(a){var b=d.item(m.fromDom(t),a.userid,a.name);C(b,a.name);return b})},F=function(a){return c.foldr(a,function(a,c){var d={};d[c.userid]=c;return b.merge(a,d)},{})},E=function(a,b){var e=D(a),f=c.map(b,function(a){return d.item(m.fromDom(t),a.key,a.value)});
return e.concat(f)},G=function(a){var b=l.get(a,"data-ephox-gopher-item-value"),d=B.get();return void 0!==d[b]?w.fetched(d[b].userid,d[b].name,d[b].rawname,d[b],a):c.contains([v,u],b)?w.none(a):w.extra(b,a)};return{element:a.constant(y),selected:function(){return q.descendant(y,".ephox-gopher-item-selected")},setData:function(a,c){var d=F(a);B.set(b.merge(B.get(),d));d=0===a.length?[{userid:u,name:f.get("mentions.lookahead.noresults")}]:a;d=E(d,c);r.empty(y);k.append(y,d)},getInfo:G,getUserId:function(b){return G(b).fold(e.none,
e.none,a.compose(e.some,z))},setLoading:function(){var a=[{userid:v,name:f.get("mentions.lookahead.searching")}],a=E(a,[]);r.empty(y);k.append(y,a)},getName:function(b){return G(b).fold(e.none,e.none,a.compose(e.some,A))},refind:function(a){a=l.get(a,"data-ephox-gopher-item-value");return void 0!==a&&null!==a?q.descendant(y,'[data-ephox-gopher-item-value="'+a+'"]'):e.none()},isOpen:function(){return s.isVisible(y)}}}});k("i5","a7 7 s q7 54 46 4n 4m 2m 9q v 6e o q 3t".split(" "),function(c,d,b,a,e,
g,f,h,l,m,n,k,r,q,s){var t=f.generate([{nothing:[]},{refetch:["term"]},{open:["term"]}]);return function(f,k,p){var q=function(a){c.speak(l.body(),a)},r=a(p);f.setView(r.element());var s=h(""),z=function(a){C(a.rawData(),a.extra());f.reposition(b.none())},A=function(a){var b=r.selected();a();return b.bind(r.refind)},C=function(a,b){q(p.get("mentions.lookahead.open"));f.updateItems(A,function(){r.setData(a,b)})},D=function(a){return r.isOpen()&&2<=a.length?t.refetch(a):2<=a.length?t.open(a):t.nothing()},
F=function(a){a.fold(G,z)},E=g.create({accept:e(["information"]),menuHover:e(["element","info"]),none:e([])}),G=function(){f.cancel()};return{setData:C,isOpen:function(){return r.isOpen()},lookup:function(a,b){var c=n.startsWith(a,"@")?a.substring(1):a;s.set(c);var e=d.noop;D(c).fold(e,function(a){k.fetch(a,F)},function(a){r.setLoading();f.open(b);k.fetch(a,F)})},close:function(){f.close()},onClick:function(a){r.getInfo(a).fold(function(){E.trigger.none()},function(a,b){k.fetchExtra(a,s.get(),F)},
function(a,b,d,e,f){c.speak(l.body(),p.get("mentions.lookahead.selected",d));E.trigger.accept(e)})},onHover:function(a){q(m.get(a));r.getInfo(a).fold(d.noop,d.noop,function(a,b,c,d,e){E.trigger.menuHover(e,d)})},events:E.registry}}});k("i6","7 s 33 54 46 4m 1y l 2o 2q al".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){return function(k,r,q,s){var t=h.fromTag("div");f.add(t,b.resolve("mentions-lookahead-container"));var u=q.initMenu(t),v=g(d.none()),w=e.create({close:a([])}),x=function(){return n.isVisible(t)};
q=function(){v.set(d.none());u.close()};u.events.close.bind(function(){r.close();w.trigger.close()});k.events.mousedown.bind(q);return{element:c.constant(t),destroy:function(){v.set(d.none());u.destroy()},setView:function(a){m.empty(t);l.append(t,a)},updateItems:function(a,b){a(b).fold(function(){r.setActiveMenu(t)},function(a){r.select(a)})},reposition:function(a){a.isSome()&&v.set(a);x()&&v.get().each(function(a){s.showUnder(a,u)})},open:function(a){k.body().each(function(b){u.open();s.showUnder(a,
u);v.set(d.some(a));r.open([r.sandbox()],b)})},isOpen:x,cancel:function(){v.set(d.none());w.trigger.close()},close:q,events:w.registry}}});k("ac",["s","i5","i6","46","47"],function(c,d,b,a,e){return function(g,f,h,l,m,n){var k=b(g,f,h,l),r=d(k,m,n);g=a.create({menuHover:e(["element","info"],r.events.menuHover),accept:e(["information"],r.events.accept),close:e([],k.events.close)});r.events.none.bind(k.close);return{onHover:r.onHover,onClick:r.onClick,close:function(){r.isOpen()&&r.close();k.isOpen()&&
k.cancel()},isOpen:k.isOpen,lookup:function(a,b){k.reposition(c.some(b));r.lookup(a,b)},destroy:function(){k.destroy()},events:g.registry}}});k("ae","d6 7 s eg i7 6j i8 68".split(" "),function(c,d,b,a,e,g,f,h){var l=function(){return new h(g.wordbreak(),"i")},m=function(a,c,d){return f.repeatLeft(a,d,function(a,b,c,d,e){return f.previousChar(d,e).fold(function(){return b.kontinue()},function(a){return b.finish(a.ch())})}).fold(b.none,b.none,b.some)},n=function(b,c,d,e){return 0<=e&&"@"===d.charAt(e)?
b.finish(a.point(c,e)):b.abort()},k=function(b,c,d,e){return b.finish(a.point(c,e))},r=function(d){return b.some(a.point(d,c.getEnd(d)))};return{isValidMention:function(a,b){return m(a,e.sidestep,b).fold(d.constant(!0),function(a){return null===a.match(/[0-9a-zA-Z]/)})},scan:function(a,c){return f.expandLeft(a,c,{regex:l,attempt:n}).fold(b.none,b.none,b.some).bind(function(d){return f.expandRight(a,c,{regex:l,attempt:k}).fold(b.none,r,b.some).map(function(a){return{start:d.element,soffset:d.offset,
finish:a.element,foffset:a.offset}})})}}});k("ad","b s ae 33 4n 21 6h 31 ak".split(" "),function(c,d,b,a,e,g,f,h,l){var m=e.generate([{none:[]},{bare:["text","start","soffset","finish","foffset"]},{incomplete:["text","element"]},{complete:["text","element"]}]),n=a.resolve("incomplete-mention"),k=function(a,c){return b.scan(a,c).map(function(a){return m.bare("",a.start(),a.soffset(),a.finish(),a.foffset())})},r=function(a){if(g.isText(a))return l.get(a);a=f.descendants(a,g.isText);return c.map(a,l.get).join("")},
q=function(a,b){return a.collapsed()?h.closest(a.startContainer(),b.hoverSelector()).fold(function(){return h.closest(a.startContainer(),"."+n).fold(function(){return k(a.startContainer(),a.startOffset())},function(a){return d.some(m.incomplete(r(a),a))})},function(a){return d.some(m.complete(r(a),a))}).getOrThunk(m.none):m.none()};return{detect:function(a,b){return a.getSelection().map(function(a){return q(a,b)}).getOrThunk(m.none)},detectOn:q,withinIncomplete:function(a){return h.closest(a,"."+
n)}}});k("af","ad 33 1y 1b l 2o 2q".split(" "),function(c,d,b,a,e,g,f){var h=function(a){b.remove(a,d.resolve("incomplete-mention"));f.unwrap(a)};return{cancel:h,create:function(){var a=e.fromTag("span");b.add(a,d.resolve("incomplete-mention"));var c=e.fromText("@");g.append(a,c);return a},validatePrevious:function(b,d){c.withinIncomplete(b).filter(function(b){return c.withinIncomplete(d).forall(function(c){return!a.eq(b,c)})}).each(h)}}});k("ag","b s 33 54 46 4m 2m 3u l 6m 31 6e 3t".split(" "),function(c,
d,b,a,e,g,f,h,l,m,n,k,r){var q="."+b.resolve("mentions-business-card");return function(b,t){var u=g([]),v=null,w=null,x=e.create({contentHover:a(["target"]),stopHover:a([]),menuHover:a(["info"])});b.runOrOnLoaded(function(a){u.set([h.bind(a,"mouseover",function(a){A(a)}),h.bind(f.body(),"mouseover",function(a){n.closest(a.target(),q).each(B)}),h.bind(a,"mouseout",function(a){C(a)}),h.bind(f.body(),"mouseout",function(a){D(a)})])});var y=function(a){k(v);k(w);v=r(function(){x.trigger.contentHover(a)},
300)},B=function(){k(w)},z=function(){k(v);w=r(function(){x.trigger.stopHover()},300)},A=function(a){n.closest(a.target(),t).each(function(a){y(a);x.trigger.contentHover(a)})},C=function(a){if(!m.closest(a.target(),t))return!1;d.from(a.raw().relatedTarget||a.raw().toElement).map(l.fromDom).filter(function(a){return m.closest(a,t)}).isNone()&&z()},D=function(a){if(!m.closest(a.target(),q))return!1;d.from(a.raw().relatedTarget||a.raw().toElement).map(l.fromDom).filter(function(a){return m.closest(a,
q)}).isNone()&&z()};return{destroy:function(){c.each(u.get(),function(a){a.unbind()})},events:x.registry}}});k("ah",["a","bw","73","9"],function(c,d,b,a){var e=function(a,b){return 1<arguments.length||/\{(\d+)\}/.test(a)?d.tokens.call(void 0,a,b):a};return function(d){return{get:function(f){var h=d[f];return c.isString(h)?e(h,a.prototype.slice.call(arguments,1)):b.translate.apply(void 0,arguments)}}}});k("i9",["7","ev","ew"],function(c,d,b){return function(a){return{show:function(e,g,f,h,l){g=b(0,
0);e=e.directionAt(a);e=d.mainmenu(f,c.constant(a),g,e);f.show(h,e);h.setComponents([a,l.element()])},showWith:function(b,g,f,h,l){b=b.directionAt(a);b=d.submenu(f,c.constant(a),b);f.show(h,b);h.setComponents([a,l.element()])}}}});k("ai",["7","i9","w"],function(c,d,b){return function(a,b,g,f){return{showAtSide:function(f,l){d(f).showWith(a,b,g,l,{element:c.constant(l.element())})},showUnder:function(f,l){d(f).show(a,b,g,l,{element:c.constant(l.element())})}}}});k("5v","5b a5 a6 b a7 97 a8 7 7u a9 aa ab ac ad ae af ag ah ai aj 2m 2n l 2y 2o 21 6h 2q ak al w".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n,k,r,q,s,t,u,v,w,x,y,B,z,A,C,D,F,E,G,H,I){return function(L,J){var K=v(J.aria),M=L.content(),N=L.smartview(),S=L.region(),Q=L.operations(),P=n(J),R=d.menuSystem(N.uiContainer,h.constant("mentions"),b.menu({focusActive:!1}));B.set(R.sandbox(),"z-index",I(void 0!==J.zIndex?J.zIndex:1E6));var O=d.popup(R.sandbox,N.bounds,S,[],x.editorContainer()),N=w(S,M,N,R.sandbox()),T=r(M,R,O,N,P,K),W=m(O,N);k.configure(L.filter());var X=u(M,P.hoverSelector());T.events.menuHover.bind(function(a){P.menuHover(a.info(),
function(b){b.fold(h.noop,function(b){H.isVisible(a.element())&&W.showMini(a.element(),b)})})});X.events.contentHover.bind(function(a){P.hover(a.target(),function(b){b.fold(h.noop,function(b){T.close();W.showFull(a.target(),b)})})});X.events.stopHover.bind(function(a){W.hide()});R.events.itemHover.bind(function(a){a=a.item();T.onHover(a);M.backupSelection();A.focus(a);M.focus()});R.events.itemAction.bind(function(a){T.onClick(a.item())});M.events.nodeChanged.bind(function(a){M.getSelection().each(function(b){b.collapsed()&&
(q.detectOn(b,P).fold(T.close,T.close,h.noop,T.close),a.prev().each(function(a){t.validatePrevious(a,b.startContainer())}))})});M.events.keyup.bind(function(b){M.getSelection().each(function(c){c.collapsed()&&(a.contains(V,b.original().raw().which)||q.withinIncomplete(c.startContainer()).each(function(b){var c=F.descendants(b,D.isText),c=a.map(c,G.get).join("");T.lookup(c,b);W.hide()}))})});M.events.keypress.bind(function(a){var b=a.original();P.isTrigger(b.raw().which)&&M.getSelection().each(function(a){s.isValidMention(a.startContainer(),
a.startOffset())&&(a=function(){var a=t.create();l.insertAtCursor(M,[a]).each(function(a){M.setSelection(a.element(),a.offset(),a.element(),a.offset())});b.kill();e.speak(y.body(),K.get("mentions.initiated"))},q.detect(M,P).fold(a,a,h.noop,h.noop))})});var V=a.flatten([f.ENTER(),f.DOWN(),f.UP()]);L.context().events.preLinebreak.bind(function(a){aa(function(b,c){T.isOpen()?a.handler().handle():ba()},h.noop)});M.events.keydown.bind(function(b){var c=b.original().raw().which;a.contains(f.ESCAPE(),c)?
aa(function(){ba();b.original().kill()},h.noop):a.contains(V,c)&&T.isOpen()&&(R.simulateKey(b.original()),b.original().kill())});var aa=function(a,b){q.detect(M,P).fold(b,b,a,b)},ca=function(a){aa(function(b,d){P.menuComplete(a).each(function(a){C.after(d,a);E.remove(d);var b=z.fromText(c.zeroWidth());C.after(a,b);M.setRelativeSelection(g.after(b),g.after(b));Z()})},Z)},Z=function(){W.hide();T.close()},ba=function(){aa(function(a,b){e.speak(y.body(),K.get("mentions.lookahead.cancelled"));Q.atomic(function(){t.cancel(b)});
Z()},Z)};T.events.close.bind(ba);T.events.accept.bind(function(a){ca(a.information())});return{destroy:function(){T.destroy();W.destroy();X.destroy();R.destroy()}}}});k("am",["b","s","73","2u"],function(c,d,b,a){var e=a.immutable("textkey","value","icon");return function(a){var f=function(a){var c;c={zh:"zh_cn",pt:"pt_br"};c=void 0===c[a]?a:c[a];c=b.has("parlance."+c)?b.key("parlance."+c):b.raw(c);return e(c,a,d.none())},h=c.map(a.languages,f);return{build:function(b){return b.filter(function(b){return!c.contains(a.languages,
b)}).fold(function(){return h},function(a){return h.concat([f(a)])})}}}});k("5w","7 s 7b 7c am 73 6t 7a 7e an 3t".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){return function(k,r,q){var s=k.content(),t=k.undo(),u=e(q),v=function(){return s.on(function(a){return m.language(a).fold(h.off,h.on)}).getOrThunk(h.unchanged)};return{ui:f.ui({"parlance.dropdown":c.constant({name:"parlance",textkey:g.key("parlance.set"),menuTextkey:g.key("parlance.menu"),updateDropdown:function(a){var b=v(),e=b.fold(d.none,d.none,
d.some),e=u.build(e);a.populate([{label:d.none,items:c.constant(e)}]);b.fold(a.deactivate,c.noop,a.activate);b.fold(a.untick,c.noop,a.tick)},action:function(d){var e=function(a){return l.language(s.isRoot,a,d)};r.lock(function(){a.cata(k.selections().get(),c.noop,b.multiple(s,t,e),b.single(s,t,e));s.getSelection().each(function(a){r.check(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset())})});n(function(){s.uiChanged()},0)},values:u.build(d.none()),render:d.none(),toggle:!1,describe:function(){return g.key("parlance.set")}})},
c.identity),destroy:c.noop}}});k("q8",["7v","7","73","l"],function(c,d,b,a){return function(){var e=a.fromTag("textarea");c.label(e,b.translate("plaincode.dialog.editor"));c.textarea(e);return{element:d.constant(e)}}});k("ia","8h ke a8 s g3 g4 q8 73 g5 33 54 46 1y 32".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,k,r,q){return function(s){var t=k.create({execute:n(["html"]),close:n([])}),u=e(s);r.add(u.element(),m.resolve("plaincode-modal"));u.setTitle(h.translate("plaincode.dialog.title"));var v=function(){w();
t.trigger.close()},w=function(){u.hide()},x=f();u.setContent(x.element());s=l.okCancel("plaincode");s.events.ok.bind(function(){t.trigger.execute(q.get(x.element()));v()});s.events.cancel.bind(function(){v()});u.events.close.bind(function(){y.exit();v()});u.setControls(s.element());var y=g.setup(u,s,[c.single(x.element(),[d.rule(d.is(b.ENTER()[0]),function(b){b.raw().stopPropagation();return a.none()})],a.none())]);return{element:u.element,open:function(){u.show();y.enter()},setHtml:function(a){q.set(x.element(),
a)},destroy:function(){u.destroy();y.destroy()},hide:w,events:t.registry}}});k("ao",["ia","54","46"],function(c,d,b){return function(a){var e=c(a),g=function(){f.trigger.close();e.events.close.unbind(g);e.events.execute.unbind(h);e.destroy()},f=b.create({execute:d(["html"]),close:d([])}),h=function(a){f.trigger.execute(a.html())};e.events.close.bind(g);e.events.execute.bind(h);return{show:function(){e.open()},setHtml:e.setHtml,events:f.registry}}});k("5x",["7","ao"],function(c,d){return function(b,
a){var e=b.content(),g=b.shortcuts(),f=b.smartview(),h=a.setContent,l=a.getContent;g.events.plaincode.bind(function(){m()});var m=function(){var a=d(f.uiContainer());a.events.close.bind(function(){e.toEditing()});a.events.execute.bind(function(a){h(a.html())});e.toReading();a.setHtml(l());a.show()};return{destroy:c.noop}}});k("aq",["7","33"],function(c,d){var b=d.resolve("resizable"),a=d.resolve("no-resize");return{style:c.constant(b),noStyle:c.constant(a)}});k("ar",["b","7","33","ca","4b"],function(c,
d,b,a,e){var g=b.resolve("resize-eph-block"),f=b.resolve("resize-eph-container"),h=b.resolve("resize-eph-resizer"),l=b.resolve("resize-eph-target"),m=b.resolve("element-resize-selected"),n=function(a){e.remove(a,[g,f,h,l,m])};return{configure:function(b){var d=[b.internal(),b.history(),b.output(),b.paste()];c.each(d,function(c){b.add(c,g,a.remove);b.add(c,f,a.unwrap);b.add(c,h,a.remove)});d=function(a){c.each(a,n)};b.add(b.output(),l,d);b.add(b.history(),l,d)},clean:n,resizeBlock:d.constant(g),resizeContainer:d.constant(f),
resizer:d.constant(h),resizeTarget:d.constant(l),resizeSelected:d.constant(m)}});k("ic","s 54 46 2n 6d 2r v 1s".split(" "),function(c,d,b,a,e,g,f,h){return function(){var l=b.create({grow:d(["x","y"])}),m=1,n=1,k=c.none(),r=function(b){return a.getRaw(b,"width").bind(function(a){return f.endsWith(a,"px")?c.some(parseInt(a,10)):c.none()}).getOrThunk(function(){return g.get(b)})};return{setTarget:function(a){k=c.some(a);n=g.get(a)/(e.get(a)+0)},setMultiplier:function(a){m=a},clearTarget:function(){k=
c.none()},mutate:function(a,b){k.each(function(c){var d=r(c)+m*a,f=1===d?1:h.floor(d/n);5<=d&&5<=f&&(g.set(c,d),e.set(c,f));l.trigger.grow(a,b)})},events:l.registry}}});k("id","b ar 33 54 46 1a 1y 4b 2n 3u l 6d 2o 3c 2q 2a 2r q dg".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,k,r,q,s,t,u,v,w){return function(x){var y=x.doc().getOr(n.fromDom(v)),B=n.fromTag("span",y.dom());g.set(B,"contenteditable","false");l.set(B,"position","relative");h.add(B,[b.resolve("element-resize-container"),d.resizeContainer()]);
var z="data-"+b.resolve("resize-direction"),A=function(a,c){var e=n.fromTag("span",y.dom());h.add(e,[b.resolve(a),d.resizer()]);g.set(e,z,c);return e};x=A("element-se-resize","1");var C=A("element-ne-resize","1"),D=A("element-sw-resize","-1"),A=A("element-nw-resize","-1"),F=[x,C,D,A],E=n.fromTag("span",y.dom());q.append(B,[E].concat(F));h.add(E,[b.resolve("element-resize-border"),d.resizeContainer()]);var G=function(a){l.getRaw(a,"display").filter(function(a){return"block"===a}).fold(function(){l.remove(B,
"display");l.remove(E,"margin");l.remove(E,"display")},function(b){l.set(B,"display","block");l.set(E,"display","block");l.getRaw(a,"margin").each(function(a){l.set(E,"margin",a)})})},H=function(){t.firstChild(E).each(function(a){r.before(B,a);s.remove(B);d.clean(a)})},I=e.create({click:a(["multiplier"])}),L=m.bind(B,"mousedown",function(a){f.has(a.target(),d.resizer())&&(a.prevent(),a=g.get(a.target(),z),a=void 0!==a?w(a,10):1,I.trigger.click(a))});return{connect:function(){},destroy:function(){L.unbind();
H()},components:function(){return[B]},show:function(a){c.each([B,E].concat(F),s.empty);q.append(B,[E].concat(F));var b=l.getRaw(a,"float");G(a);H();var e=u.getOuter(a),f=k.getOuter(a);r.before(a,B);r.append(E,a);l.setAll(E,{width:e-2+"px",height:f-2+"px"});h.add(a,[d.resizeSelected(),d.resizeTarget()]);b.fold(function(){l.remove(B,"float")},function(a){l.set(B,"float",a)})},hide:H,isOver:function(a){return f.has(a,d.resizeSelected())},cleanup:function(){H()},events:I.registry}}});k("as","ib s ar ic id 33 54 46 1y q 36".split(" "),
function(c,d,b,a,e,g,f,h,l,m,n){return function(m){var n=e(m),k=d.none(),s=a();s.events.grow.bind(function(){n.hide()});var t=c.transform(s,{layerClass:g.resolve("layer-below-dialog")});t.events.stop.bind(function(){k.each(function(a){n.show(a);v.trigger.stop(a)})});l.add(t.element(),b.resizeBlock());var u=function(){t.off();s.clearTarget();k=d.none();n.hide()},v=h.create({stop:f(["target"])});return{connect:function(){n.connect();n.events.click.bind(function(a){m.body().each(function(b){s.setMultiplier(a.multiplier());
t.go(b)})})},components:function(){return k.fold(function(){return n.components()},function(a){return[a].concat(n.components())})},open:function(a){u();s.setTarget(a);k=d.some(a);t.on();n.show(a)},close:u,isOver:n.isOver,events:v.registry,cleanup:function(){n.cleanup()},destroy:function(){n.destroy();t.destroy()}}}});k("5y","ap 97 7 a1 79 aq ar as 1y 21 3t".split(" "),function(c,d,b,a,e,g,f,h,l,m,n){return function(n,k){var q=n.filter(),s=n.content(),t=n.undo();f.configure(q);var u=h(s),v=c(u.close,
u.components),w=function(a){e.detect(s).each(function(b){t.save();e.remove(s,u,b.image());s.domChanged();t.save();a.original().kill()})},x=function(a){e.detect(s).each(function(b){s.setRelativeSelection(d.before(b.container()),d.before(b.container()));a.original().kill()})},y=function(a){e.detect(s).each(function(b){s.setRelativeSelection(d.after(b.container()),d.after(b.container()));a.original().kill()})};s.events.nodeChanged.bind(function(){e.detect(s).fold(function(){u.close()},b.noop)});s.events.keydown.bind(function(b){a.isDel(b)||
a.isBackspace(b)?w(b):a.isLeftOrUp(b)?x(b):a.isRightOrDown(b)&&y(b)});var B=function(a){return("img"===m.name(a)||l.has(a,g.style()))&&!l.has(a,g.noStyle())},z=function(a){B(a)&&(u.open(a),e.select(s,a))};s.events.mouseup.bind(function(a){a=a.original().target();z(a)});k.events.changed.bind(function(a){a=a.image();z(a)});s.events.mousedown.bind(function(a){var b=a.original().target();B(b)&&u.isOver(b)&&a.original().raw().preventDefault();v.mousedown(a.original())});s.events.loaded.bind(function(){u.connect()});
u.events.stop.bind(function(a){e.select(s,a.target())});return{cleanup:function(){u.cleanup()},destroy:function(){u.destroy()}}}});k("ih","b 1o 2u qb qc 1a 2n l 2o 2q 4e m".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,k){var r=b.immutable("minRow","minCol","maxRow","maxCol"),q=function(a,b){var c=a.grid().columns(),e=a.grid().rows(),f=c,g=0,h=0;d.each(a.access(),function(a){if(b(a)){var c=a.row(),d=c+a.rowspan()-1,l=a.column();a=l+a.colspan()-1;c<e?e=c:d>g&&(g=d);l<f?f=l:a>h&&(h=a)}});return r(e,f,g,
h)},s=function(a,b,c,d){for(var f=b.grid().columns(),g=b.grid().rows(),m=0;m<g;m++)for(var n=!1,k=0;k<f;k++)if(!(m<c.minRow()||m>c.maxRow()||k<c.minCol()||k>c.maxCol()))if(e.getAt(b,m,k).filter(d).isNone()){var p=n,q=a[m].element(),r=h.fromTag("td");l.append(r,h.fromTag("br"));(p?l.append:l.prepend)(q,r)}else n=!0},t=function(a,b){var d=c.filter(n.descendants(a,"tr"),function(a){return 0===a.dom().childElementCount});c.each(d,m.remove);b.minCol()!==b.maxCol()&&b.minRow()!==b.maxRow()||c.each(n.descendants(a,
"th,td"),function(a){g.remove(a,"rowspan");g.remove(a,"colspan")});g.remove(a,"width");g.remove(a,"height");f.remove(a,"width");f.remove(a,"height")};return{extract:function(b,d){var f="."+d,g=function(a){return k.is(a.element(),f)},h=a.fromTable(b),l=e.generate(h),r=q(l,g),A=n.descendants(b,"th:not("+f+"),td:not("+f+")");c.each(A,m.remove);s(h,l,r,g);t(b,r);return b}}});k("at","b ie 7 7c ei es if ig ih b8 l 2o 2q f4".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,k,r,q){var s=function(a){c.each(a,function(a){r.empty(a);
k.append(a,n.fromTag("br"))})},t=function(a){return m.table(a[0]).map(q.deep).map(function(a){return[l.extract(a,d.selectedClass())]})},u=function(a,d){var l=b.curry(d.filterDom,d.output()),m=h.register({doc:a.doc,win:a.win,body:a.body,getSelection:a.getSelection,setSelection:a.setSelection});return function(d,h,n){c.each(h,l);var k=b.curry(e.toText,h);h=b.curry(e.toHtml,h);var k=f.buildClipboardContents(k,h),p=g.fromSafe(a);p.begin();m.setClipboard(d,k,function(){p.end();n.apply(void 0,arguments)})}},
v=function(c,d,e){var f=function(c,f){a.cata(d.get(),b.noop,function(a){t(a).each(function(d){e(c,d,b.curry(f,a))})},b.noop)};c.events.cut.bind(function(a){f(a.original(),s)});c.events.copy.bind(function(a){f(a.original(),b.noop)})};return function(a,c){var d=a.content(),e=a.filter(),f=a.selections();d.events.ready.bind(function(a){a=a.api();var b=u(a,e);v(a,f,b)});return{destroy:b.noop}}});k("qd",["4g"],function(c){return{resolve:c.create("ephox-cement").resolve}});k("ii",["qd","7"],function(c,d){var b=
c.resolve("smartpaste-eph-bin");return{binStyle:d.constant(b)}});k("qe",["7","s","2o","2q"],function(c,d,b,a){return function(e,g){var f=function(b,e,f){b(f,e);return d.some({element:c.constant(e),cleanup:function(){a.remove(e)},splits:c.constant([])})},h=function(a){return{none:d.none,start:c.curry(f,b.before,a),end:c.curry(f,b.after,a),middle:function(c,d,e){return f(b.after,a,d)}}},l=function(a){var d=function(a){return function(c,d){b.appendAt(c,d,a)}};return{prepend:c.curry(f,b.prepend,a),before:c.curry(f,
b.before,a),after:c.curry(f,b.after,a),insertAt:function(b,c){return f(d(c),a,b)},append:c.curry(f,b.append,a)}};return{before:{text:h(e),element:{hasPrevious:l(e).insertAt,first:l(e).prepend,empty:l(e).before,otherwise:l(e).append}},after:{text:h(g),element:{hasNext:l(g).insertAt,rightEdge:l(g).append,empty:l(g).after,otherwise:l(g).append}},general:{insertBefore:l(e).before,insertAfter:l(g).after}}}});k("ij","b 97 ip cb 7u qe es qf 2m l 2q 6m".split(" "),function(c,d,b,a,e,g,f,h,l,m,n,k){return function(r){var q=
f.fromUnsafe(r),s=m.fromTag("span"),t=m.fromTag("span");c.each([s,t],r.markAsEphemeral);var u=g(s,t);return{backup:function(){r.getSelection().each(function(a){a.collapsed()?(e.insertAtCursor(r,[s]),n.unwrap(t),q.begin()):h.both(u,a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset())})},insert:function(f,g,h){r.setRelativeSelection(d.after(s),l.inBody(t)?d.before(t):d.after(s));e.insertAtCursorWith(r,f,g,h).each(function(a){k.ancestor(a.element(),"table")?r.setSelection(a.element(),0,
a.element(),0):r.setRelativeSelection(d.after(a.element()),d.after(a.element()))});q.end();r.getSelection().each(function(c){c=b.toLeaf(c.startContainer(),c.startOffset());a.cursorIntoView(r,c.element())});c.each([s,t],n.unwrap)},cancel:function(){c.each([s,t],n.unwrap)}}}});k("qi","b fm 7 s 7c 1a dg".split(" "),function(c,d,b,a,e,g,f){return{mergable:function(c,f){return e.cata(f.get(),a.none,function(e,f){return 0===e.length?a.none():d.retrieveBox(c).bind(function(c){return 1<e.length?a.some({bounds:b.constant(c),
cells:b.constant(e)}):a.none()})},a.none)},unmergable:function(d,l){var m=function(a){return g.has(a,"rowspan")&&1<f(g.get(a,"rowspan"),10)||g.has(a,"colspan")&&1<f(g.get(a,"colspan"),10)},k=e.cata(l.get(),b.constant([]),b.identity,b.constant([d]));return 0<k.length&&c.forall(k,m)?a.some(k):a.none()}}});k("j6",["7","s","qi","2u"],function(c,d,b,a){var e=function(a){return{element:c.constant(a),mergable:d.none,unmergable:d.none}};a=a.immutable("element","clipboard","generators");return{noMenu:e,forMenu:function(a,
d,e){return{element:c.constant(e),mergable:c.constant(b.mergable(d,a)),unmergable:c.constant(b.unmergable(e,a))}},caption:function(a){return e(a)},paste:a}});k("ik","qg b 7 s j3 qh j6 b8 j8 21 9q".split(" "),function(c,d,b,a,e,g,f,h,l,m,k){var p=function(a){return"table"===m.name(a)||0===k.get(a).trim().length},r=function(b){var c=d.filter(b,function(a){return"table"===m.name(a)});return 1!==c.length?a.none():d.forall(b,p)?a.from(c[0]):a.none()};return{rules:function(a,d,m){var k=b.noop,n=function(c,
n){return h.table(c).bind(function(h){var p=a.doc().getOrDie(),p=g.paste(p),p=f.paste(c,n,p),r=b.constant(m);return e.execute(d,l.pasteCells,k,r)(a,h,p).map(function(a){return a.startContainer()})})},p=function(a){return r(a).map(function(a){return{single:b.constant(a)}})};return{collapsed:b.constant(c(function(a,b,c){return h.cell(b)},p,function(a,b){return n(a.element(),b.single())},"custom arcade table insert collapsed")),ranged:b.constant(c(function(a,c,d){return h.cell(c.element()).map(function(a){return{left:b.constant(a),
right:b.constant(a)}})},p,function(a,b){return n(a.left(),b.single())},"custom arcade table insert ranged"))}},extractTable:r}});k("13b",["b","2u","o"],function(c,d,b){var a="officeStyles htmlStyles isWord proxyBin isInternal backgroundAssets".split(" "),e=d.immutableBag([],a);return{nu:e,merge:function(b,d){var h={};c.each(a,function(a){d[a]().or(b[a]()).each(function(b){h[a]=b})});return e(h)}}});k("10r",["s","4n"],function(c,d){var b=d.generate([{error:["message"]},{paste:["elements","assets",
"correlated"]},{cancel:[]},{incomplete:["elements","assets","correlated","message"]}]),a=function(a,b,c,d,l){return a.fold(b,c,d,l)};return{error:b.error,paste:b.paste,cancel:b.cancel,incomplete:b.incomplete,cata:a,carry:function(d,g){return a(d,c.none,c.none,c.none,function(d,e,l,m){return a(g,c.none,function(a,d,e){return c.some(b.incomplete(a,d,e,m))},c.none,c.none)}).getOr(g)}}});k("13a",["13b","10r","3q","2u"],function(c,d,b,a){var e=a.immutableBag(["response","bundle"],[]),g=function(a){return f(function(b){var c=
e(a);b(c)})},f=function(a){return b(f,function(b){a(b)})};return{call:function(a,b){a(e(b))},sync:f,pure:g,pass:function(a){return g({response:a.response(),bundle:a.bundle()})},done:e,error:function(a){return g({response:d.error(a),bundle:c.nu({})})},initial:function(){return g({response:d.paste([],[],[]),bundle:c.nu({})})},cancel:function(){return g({response:d.cancel(),bundle:c.nu({})})}}});k("10q","13a 13b 10r b 7 k 2u".split(" "),function(c,d,b,a,e,g,f){var h=f.immutable("steps","input","label",
"capture"),l=function(a,b){return g.findMap(a,function(a){return a.getAvailable(b).map(function(b){return h(a.steps(),b,a.label(),a.capture())})})},m=function(a,f){var g=e.curry(c.pass,a),h=function(){return f().map(function(e){var f=d.merge(a.bundle(),e.bundle());e=b.carry(a.response(),e.response());return c.done({response:e,bundle:f})})};return b.cata(a.response(),g,h,g,h)};return{choose:function(a,b,c){return l(a,c).getOrThunk(function(){var a=b.getAvailable(c);return h(b.steps(),a,b.label(),b.capture())})},
run:function(b,d){return a.foldl(b,function(a,b){return a.bind(function(a){return m(a,function(){return b(d,a)})})},c.initial()).map(function(a){return a.response()})}}});k("10s",["c","7","3t"],function(c,d,b){var a=c.detect();c=function(a,b,c){b.control.block();a.dom().execCommand("paste");c();b.control.unblock()};var e=function(a,c,d){b(d,1)},g=(a=a.browser.isIE()&&10>=a.browser.version.major)?c:e;return{willBlock:d.constant(a),run:function(a,b,c){return g(a,b,c)}}});k("x9","10q 10r b 7 eh 54 46 10s".split(" "),
function(c,d,b,a,e,g,f,h){return function(l,m){var k=f.create({cancel:g([]),error:g(["message"]),insert:g(["elements","assets","correlated"])}),p=e.tap(function(a){h.willBlock()&&(p.control.block(),a.preventDefault());var e=c.choose(l,m,a);e.capture()&&a.preventDefault();a=b.map(e.steps(),function(a){return a(p.control)});c.run(a,e.input()).get(function(a){d.cata(a,function(a){k.trigger.error(a)},function(a,b,c){k.trigger.insert(a,b,c)},function(){k.trigger.cancel()},function(a,b,c,d){k.trigger.insert(a,
b,c);k.trigger.error(d)})})});return{paste:p.instance,isBlocked:p.control.isBlocked,destroy:a.noop,events:k.registry}}});k("10t",["7"],function(c){return{blocking:function(c){return function(b){return function(a,e,g){b.block();return c(a,e,g).map(function(a){b.unblock();return a})}}},normal:function(d){return c.constant(d)}}});k("13c",["2h","gd","3s","ge","s"],function(c,d,b,a,e){return{convert:function(g){var f=c.resolve("window.clipboardData.files"),h=void 0!==g.convertURL?g.convertURL:void 0!==
g.msConvertURL?g.msConvertURL:void 0;return void 0!==f&&void 0!==h&&0<f.length?(f=b.mapM(f,function(b){var c=a.createObjectURL(b);h.apply(g,[b,"specified",c]);return d.singleWithUrl(b,c)}),e.some(f)):e.none()}}});k("10u",["13c","3s","7","s"],function(c,d,b,a){return{background:function(){var b=a.none();return{convert:function(a){b=c.convert(a)},listen:function(a){return b.fold(function(){return d.nu(function(a){a([])})},function(a){return a}).get(a)},clear:function(){b=a.none()}}},ignore:function(){return{convert:a.none,
listen:function(a){a([])},clear:b.noop}}}});k("10v",["s","k","68"],function(c,d,b){var a=function(a,g){var f=new b(g,"i");return d.findMap(a,function(a){return null!==a.match(f)?c.some({type:a,flavor:g}):c.none()})};return{isValidData:function(a){return void 0!==a&&void 0!==a.types&&null!==a.types},getPreferredFlavor:function(b,c){return d.findMap(b,function(b){return a(c,b)})},getFlavor:a}});k("ro",["6","4n"],function(c,d){var b=d.generate([{none:[]},{error:["message "]},{blob:["blob"]}]);return c.merge(b,
{cata:function(a,b,c,d){return a.fold(b,c,d)}})});k("11f",["2i"],function(c){return function(d,b){return new (c.getOrDie("Blob"))(d,b)}});k("11g",["2i"],function(c){return function(d){return new (c.getOrDie("Uint8Array"))(d)}});k("xv","ro 11f 11g ko s p v 9 1s".split(" "),function(c,d,b,a,e,g,f,h,l){var m=function(c,e){for(var f=a.atob(c),g=f.length,m=l.ceil(g/1024),k=new h(m),u=0;u<m;++u){for(var v=1024*u,w=l.min(v+1024,g),x=new h(w-v),y=0;v<w;++y,++v)x[y]=f[v].charCodeAt(0);k[u]=b(x)}return d(k,
{type:e})};return{convert:function(a){if(f.startsWith(a,"data:image/")&&11<a.indexOf(";base64,")){var b=a.indexOf(";"),d=a.substr(5,b-5);a=a.substr(b+8);try{return c.blob(m(a,d))}catch(e){return c.error(e)}}else return c.none()}}});k("rn",["xv"],function(c){return{toBlob:function(d){return c.convert(d)}}});k("13d","10r b fz 7 2u 1a l 21 4e o".split(" "),function(c,d,b,a,e,g,f,h,l,m){var k=e.immutable("asset","image");return{createImages:function(a){var e=[],h=[],l=[];d.each(a,function(a){return b.cata(a,
function(b,c,d,m){b=f.fromTag("img");g.set(b,"src",d);e.push(b);h.push(a);l.push(k(a,b))},function(a,b,c){m.error("Internal error: Paste operation produced an image URL instead of a Data URI: ",b)})});return c.paste(e,h,l)},findImages:function(c,e){var f=[],m=d.bind(c,function(a){return"img"===h.name(a)?[a]:l.descendants(a,"img")});d.each(e,function(c){b.cata(c,function(a,b,e,h){d.each(m,function(a){g.get(a,"src")===e&&f.push(k(c,a))})},a.noop)});return f},updateSources:function(c,e){var f=[];d.each(c,
function(c,d){b.cata(c,function(a,b,h,l){a=e[d];g.set(a,"src",h);f.push(k(c,a))},a.noop)});return f}}});k("10w","rn ro 13a 13d 10r b gd s 2u 1a l 21 2q 3c 4e".split(" "),function(c,d,b,a,e,g,f,h,l,m,k,p,r,q,s){var t=l.immutable("blob","image"),u=function(a,b){var e=c.toBlob(b);return d.cata(e,h.none,h.none,function(b){return h.some(t(b,a))})},v=function(a){var b=k.fromTag("div");q.append(b,a);return s.descendants(b,"img[src]")},w=function(a){return 0===a.indexOf("data:")&&-1<a.indexOf("base64")||
0===a.indexOf("blob:")},x=function(a){a=m.get(a,"src");return w(a)},y=function(a){return g.bind(v(a),function(a){var b=m.get(a,"src");return w(b)?u(a,b).toArray():[]})},B=function(a){a=g.filter(a,function(a){return"img"!==p.name(a)||!x(a)});return e.incomplete(a,[],[],"errors.local.images.disallowed")};return function(c){return function(d,h){return b.sync(function(d){var l=function(){b.call(d,{response:h.response(),bundle:h.bundle()})},m=function(c){var l=y(c),m=g.map(l,function(a){return a.blob()});
f.multiple(m).get(function(f){var m=g.map(l,function(a){return a.image()}),m=a.updateSources(f,m);b.call(d,{response:e.paste(c,f,m),bundle:h.bundle()})})},k=function(a,e,f,k){!1===c.allowLocalImages?(e=g.filter(v(a),x),g.each(e,r.remove),b.call(d,{response:0<e.length?B(a):h.response(),bundle:h.bundle()})):0===e.length?m(a):l()};e.cata(h.response(),l,k,l,k)})}}});k("13e",["13a","10r","3s","o"],function(c,d,b,a){var e=function(a){return a.officeStyles().getOr(!0)},g=function(a){return a.htmlStyles().getOr(!1)},
f=function(a){return a.isWord().getOr(!1)};return{proxyBin:function(b){return{handle:function(e,f){return b.proxyBin().fold(function(){a.error(e);return c.pure({response:d.cancel(),bundle:{}})},f)}}},backgroundAssets:function(a){return b.nu(function(b){a.backgroundAssets().fold(function(){b([])},function(a){a.listen(b)})})},merging:function(a){var b=f(a);return b&&e(a)||!b&&g(a)},mergeOffice:e,mergeNormal:g,isWord:f,isInternal:function(a){return a.isInternal().getOr(!1)}}});k("13f","qd 6 7 s 1y l 48 2o 3c".split(" "),
function(c,d,b,a,e,g,f,h,l){return function(m,k){var p=k.translations,r=function(b,c,e){e(a.some(d.merge(c,{officeStyles:b,htmlStyles:b})))},q=function(b,d){var k=g.fromTag("div");e.add(k,c.resolve("styles-dialog-content"));var n=g.fromTag("p"),q=f.fromHtml(p("cement.dialog.paste.instructions"));l.append(n,q);h.append(k,n);var n={text:p("cement.dialog.paste.clean"),tabindex:0,className:c.resolve("clean-styles"),click:function(){x.destroy();r(!1,b,d)}},q={text:p("cement.dialog.paste.merge"),tabindex:1,
className:c.resolve("merge-styles"),click:function(){x.destroy();r(!0,b,d)}},x=m(!0);x.setTitle(p("cement.dialog.paste.title"));x.setContent(k);x.setButtons([n,q]);x.show();x.events.close.bind(function(){d(a.none());x.destroy()})};return{get:function(a,b){var c=k[a?"officeStyles":"htmlStyles"];"clean"===c?r(!1,k,b):"merge"===c?r(!0,k,b):q(k,b)},destroy:b.noop}}});k("10x",["13a","13b","13e","13f","10r"],function(c,d,b,a,e){var g=function(f,g){var l=a(f,g);return function(a,f){var g=f.bundle(),h=f.response();
return c.sync(function(a){l.get(b.isWord(g),function(b){b=b.fold(function(){return{response:e.cancel(),bundle:f.bundle()}},function(a){return{response:h,bundle:d.nu({officeStyles:a.officeStyles,htmlStyles:a.htmlStyles})}});c.call(a,b)})})}};return{fixed:function(a,b){return function(e,g){return c.pure({response:g.response(),bundle:d.nu({officeStyles:a,htmlStyles:b})})}},fromConfig:g,fromConfigIfExternal:function(a,e){return function(l,m){return b.isInternal(m.bundle())?c.pure({response:m.response(),
bundle:d.nu({officeStyles:!0,htmlStyles:!0})}):g(a,e)(l,m)}}}});k("15x",["c","7","l","q"],function(c,d,b,a){var e=function(a){for(var c=[];null!==a.nextNode();)c.push(b.fromDom(a.currentNode));return c},g=function(a){try{return e(a)}catch(b){return[]}};c=c.detect().browser;var f=c.isIE()||c.isSpartan()?g:e,h=d.constant(d.constant(!0));return{find:function(b,c){var d=c.fold(h,function(a){return function(b){return a(b.nodeValue)}});d.acceptNode=d;d=a.createTreeWalker(b.dom(),NodeFilter.SHOW_COMMENT,
d,!1);return f(d)}}});k("15h",["s","15x","v","q"],function(c,d,b,a){return{find:function(a){return d.find(a,c.some(function(a){return b.startsWith(a,"[if gte vml 1]")}))}}});k("13o","s 1a 1y 2n l 21 4i f4 4e v".split(" "),function(c,d,b,a,e,g,f,h,l,m){var k=function(a,b){var c=g.value(a),d=e.fromTag("div"),h=c.indexOf("]>");d.dom().innerHTML=c.substr(h+2);return f.descendant(d,function(a){return g.name(a)===b})},p=function(a){return g.isComment(a)?k(a,"v:shape"):c.none()},r=function(a){return l.descendants(a,
".rtf-data-image")};return{local:function(a){if("img"===g.name(a)){var e=d.get(a,"src");if(void 0!==e&&null!==e&&m.startsWith(e,"file://"))return a=h.shallow(a),e=e.split(/[\/\\]/),d.set(a,"data-image-id",e[e.length-1]),d.remove(a,"src"),d.set(a,"data-image-type","local"),b.add(a,"rtf-data-image"),c.some(a)}return c.none()},vshape:function(c){return p(c).map(function(c){var f=d.get(c,"o:spid"),f=void 0===f?d.get(c,"id"):f,g=e.fromTag("img");b.add(g,"rtf-data-image");d.set(g,"data-image-id",f.substr(7));
d.set(g,"data-image-type","code");a.setAll(g,{width:a.get(c,"width"),height:a.get(c,"height")});return g})},find:r,exists:function(a){return 0<r(a).length},scour:p}});k("14q","15h b 13o s k 2u 1a 48 4e o".split(" "),function(c,d,b,a,e,g,f,h,l,m){var k=g.immutable("img","vshape"),p=function(b,c){var e=f.get(b,"v:shapes"),g=a.from(d.find(c,function(a){return f.get(a,"id")===e}));g.isNone()&&m.log("WARNING: unable to find data for image",b.dom());return g.map(function(a){var c=f.clone(b);c._rawElement=
b.dom();var d=f.clone(a);d._rawElement=a.dom();return k(c,d)})};return{extract:function(a){var f=h.fromHtml(a);a=d.bind(f,function(a){return l.descendants(a,"img")});var f=d.bind(f,c.find),g=e.cat(d.map(f,b.scour));a=d.map(a,function(a){return p(a,g)});return e.cat(a)}}});k("15i","a b 7 s 1a 1y".split(" "),function(c,d,b,a,e,g){var f=function(a,b){var d=b.style;e.has(a,"width")&&e.has(a,"height")&&c.isString(d)&&(d=d.match(/rotation:([^;]*)/),null===d||"90"!==d[1]&&"-90"!==d[1]||e.setAll(a,{width:e.get(a,
"height"),height:e.get(a,"width")}))},h=function(a,b,c){return c.img()[a]===b},l=function(c,f,g){var l=e.get(f,g),l=b.curry(h,g,l);c=d.find(c,l);return a.from(c).map(function(a){e.remove(f,g);return a})};return{rotateImage:f,insertRtfCorrelation:function(a,b,c){d.each(b,function(b){l(a,b,c).each(function(a){a=a.vshape();var c=a["o:spid"],c=void 0===c?a.id:c;f(b,a);g.add(b,"rtf-data-image");e.set(b,"data-image-id",c.substr(7));e.set(b,"data-image-type","code")})})}}});k("15y",["2o"],function(c){return{setCss:function(d,
b,a){d.dom().styleSheet?d.dom().styleSheet.cssText=b:c.append(d,a)}}});k("16f",[],function(){return{escape:function(c){return c.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}}});k("15z",["1o","16f","68"],function(c,d,b){var a=function(a,c,f){c=new b("url\\(\\s*['\"]?"+d.escape(c)+"(.*?)['\"]?\\s*\\)","g");return a.replace(c,'url("'+f+'$1")')};return{replace:a,replaceMany:function(b,d){var f=b;c.each(d,function(b,c){f=a(f,c,b)});return f}}});k("15j","1a l 2o 31 15y 15z 9".split(" "),function(c,d,b,a,
e,g,f){return{stylesheets:function(a){a=a.dom().styleSheets;return f.prototype.slice.call(a)},inject:function(f,l,m){var k=d.fromTag("style",m.dom());c.set(k,"type","text/css");f=void 0===l?f:g.replaceMany(f,l);e.setCss(k,f,d.fromText(f,m.dom()));m=a.descendant(m,"head").getOrDie();b.append(m,k)}}});k("160",["b","2u"],function(c,d){var b=d.immutable("selector","style","raw"),a=function(a){return c.map(a.cssRules,function(a){var c=a.selectorText,d=a.style.cssText;if(void 0===d)throw"WARNING: Browser does not support cssText property";
return b(c,d,a.style)})};return{extract:a,extractAll:function(b){return c.bind(b,a)}}});k("15k",["160"],function(c){return{extract:function(d){return c.extract(d)},extractAll:function(d){return c.extractAll(d)}}});(function(c,d,b){c("15l",[],function(){var a=function(){var a;a=function(a){var b=a,c,d={a:0,b:0,c:0},e=[];c=function(c,h){var k,q,s,t,u,v;if(c.test(b))for(k=b.match(c),q=0,s=k.length;q<s;q+=1)d[h]+=1,t=k[q],u=b.indexOf(t),v=t.length,e.push({selector:a.substr(u,v),type:h,index:u,length:v}),
b=b.replace(t,Array(v+1).join(" "))};(function(){var a=function(a){var c,d,e;if(a.test(b))for(a=b.match(a),c=0,d=a.length;c<d;c+=1)e=a[c],b=b.replace(e,Array(e.length+1).join("A"))};a(/\\[0-9A-Fa-f]{6}\s?/g);a(/\\[0-9A-Fa-f]{1,5}\s/g);a(/\\./g)})();(function(){var a=/:not\(([^\)]*)\)/g;a.test(b)&&(b=b.replace(a,"     $1 "))})();(function(){var a=RegExp("{[^]*","gm"),c,d,e;if(a.test(b))for(a=b.match(a),c=0,d=a.length;c<d;c+=1)e=a[c],b=b.replace(e,Array(e.length+1).join(" "))})();c(/(\[[^\]]+\])/g,
"b");c(/(#[^\s\+>~\.\[:]+)/g,"a");c(/(\.[^\s\+>~\.\[:]+)/g,"b");c(/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,"c");c(/(:[\w-]+\([^\)]*\))/gi,"b");c(/(:[^\s\+>~\.\[:]+)/g,"b");b=b.replace(/[\*\s\+>~]/g," ");b=b.replace(/[#\.]/g," ");c(/([^\s\+>~\.\[:]+)/g,"c");e.sort(function(a,b){return a.index-b.index});return{selector:a,specificity:"0,"+d.a.toString()+","+d.b.toString()+","+d.c.toString(),specificityArray:[0,d.a,d.b,d.c],parts:e}};return{calculate:function(b){var c,d,l,m=[];
b=b.split(",");d=0;for(l=b.length;d<l;d+=1)c=b[d],0<c.length&&m.push(a(c));return m},compare:function(b,c){var d,l,m;if("string"===typeof b){if(-1!==b.indexOf(","))throw"Invalid CSS selector";d=a(b).specificityArray}else if(Array.isArray(b)){if(4!==b.filter(function(a){return"number"===typeof a}).length)throw"Invalid specificity array";d=b}else throw"Invalid CSS selector or specificity array";if("string"===typeof c){if(-1!==c.indexOf(","))throw"Invalid CSS selector";l=a(c).specificityArray}else if(Array.isArray(c)){if(4!==
c.filter(function(a){return"number"===typeof a}).length)throw"Invalid specificity array";l=c}else throw"Invalid CSS selector or specificity array";for(m=0;4>m;m+=1){if(d[m]<l[m])return-1;if(d[m]>l[m])return 1}return 0}}}();"undefined"!==typeof exports&&(exports.calculate=a.calculate,exports.compare=a.compare);return a})})(ma.define,ma.require,ma.demand);k("14r","15i b 7 2u 1a mx 2n 2q 4e 2a 15j 15k 15l".split(" "),function(c,d,b,a,e,g,f,h,l,m,k,p,r){var q=a.immutable("selector","raw"),s=b.noop,t=
function(a,b){var c={};d.each(a,function(e){if(void 0!==a[e]){var f=b.dom().style;d.contains(f,e)||(c[e]=a[e])}});return c},u=function(a,b){var c=d.bind(b,function(b){var c=l.descendants(a,b.selector());d.each(c,function(a){var c=t(b.raw(),a);f.setAll(a,c)});return c});d.each(c,function(a){e.remove(a,"class")})},v=function(a,b){var c=k.stylesheets(a),c=p.extractAll(c),e=function(a){return-1!==a.selector().indexOf(",")},f=d.flatten(d.map(d.filter(c,e),function(a){var b=a.selector().split(",");return d.map(b,
function(b){b=b.trim();return q(b,a.raw())})})),c=d.filter(c,function(a){return!e(a)}).concat(f);c.sort(function(a,b){return r.compare(a.selector(),b.selector())}).reverse();u(b,c)},w=function(a){a=m.children(a);d.each(a,function(a){g.getOption(a).each(function(b){"StartFragment"!==b&&"EndFragment"!==b||h.remove(a)})})};return{doMergeInlineStyles:u,process:function(a,b,d,e,f){var g=l.descendants(b,"img");w(b);c.insertRtfCorrelation(d,g,e);(f.mergeInline()?v:s)(a,b)}}});k("14s","7 13w 2n 3u l 2o 2q 3t".split(" "),
function(c,d,b,a,e,g,f,h){return function(l){return{play:function(m,k,p){var r=e.fromTag("div"),q=e.fromTag("iframe");b.setAll(r,{display:"none"});var s=a.bind(q,"load",function(){s.unbind();d.write(q,m);var a=q.dom().contentWindow.document;if(void 0===a)throw"sandbox iframe load event did not fire correctly";var b=e.fromDom(a),a=a.body;if(void 0===a)throw"sandbox iframe does not have a body";a=e.fromDom(a);b=k(b,a);f.remove(r);h(c.curry(p,b),0)});g.append(r,q);g.append(l,r)}}}});k("13g","13a 13b 14q 14r 10r 7 14s l 48 2f q".split(" "),
function(c,d,b,a,e,g,f,h,l,m,k){var p=function(a){var b=1;return a.replace(/(<img[^>]*)src=".*?"/g,function(a,c,d){return c+'data-textbox-image="'+b++ +'"'})},r=function(b,c){var d=f(h.fromDom(k.body));return function(e,f){d.play(e,function(d,e){a.process(d,e,b,"data-textbox-image",{mergeInline:g.constant(c)});return m.get(e)},f)}},q=function(a,f,g){return c.sync(function(h){var m=b.extract(a);r(m,f)(g,function(a){a=l.fromHtml(a);c.call(h,{response:e.paste(a,[],[]),bundle:d.nu({})})})})},s=function(a){var b=
a.indexOf("</html>");return-1<b?a.substr(0,b+7):a};return{handle:function(a,b,d){a=s(a.data());var f=p(a);return d.cleanDocument(f,b).fold(function(){return c.pure({response:e.error("errors.paste.word.notready"),bundle:{}})},function(a){return void 0===a||null===a||0===a.length?c.pure(e.paste([],[],[]),{}):q(f,b,a)})}}});k("13h",["13a","13b","13d","b","gd"],function(c,d,b,a,e){return{handle:function(g){g=a.filter(g,function(a){return"file"===a.kind&&/image/.test(a.type)});var f=a.map(g,function(a){return a.getAsFile()});
return c.sync(function(a){e.multiple(f).get(function(e){e=b.createImages(e);c.call(a,{response:e,bundle:d.nu({})})})})}}});k("161",[],function(){return{validStyles:function(){return/^(mso-.*|tab-stops|tab-interval|language|text-underline|text-effect|text-line-through|font-color|horiz-align|list-image-[0-9]+|separator-image|table-border-color-(dark|light)|vert-align|vnd\..*)$/},specialInline:function(){return/^(font|em|strong|samp|acronym|cite|code|dfn|kbd|tt|b|i|u|s|sub|sup|ins|del|var|span)$/}}});
k("168",[],function(){var c=function(c){return{fold:c,matches:function(b){return c(function(a){return 0===b.toLowerCase().indexOf(a.toLowerCase())},function(a){return a.test(b.toLowerCase())},function(a){return 0<=b.toLowerCase().indexOf(a.toLowerCase())},function(a){return b.toLowerCase()===a.toLowerCase()},function(){return!0},function(a){return!a.matches(b)})}}};return{starts:function(d){return c(function(b,a,c,g,f,h){return b(d)})},pattern:function(d){return c(function(b,a,c,g,f,h){return a(d)})},
contains:function(d){return c(function(b,a,c,g,f,h){return c(d)})},exact:function(d){return c(function(b,a,c,g,f,h){return g(d)})},all:function(){return c(function(c,b,a,e,g,f){return g()})},not:function(d){return c(function(b,a,c,g,f,h){return h(d)})},cata:function(c,b,a,e,g,f,h){return c.fold(b,a,e,g,f,h)}}});k("162",["7","21","168"],function(c,d,b){return{keyval:function(a,d,g,f){var h=f.name,l=void 0!==f.condition?f.condition:c.constant(!0);f=void 0!==f.value?f.value:b.all();return h.matches(g)&&
f.matches(d)&&l(a)},name:function(a,b){var g=d.name(a),f=b.name,h=void 0!==b.condition?b.condition:c.constant(!0);return f.matches(g)&&h(a)}}});k("16g",["b","1o","7","1a"],function(c,d,b,a){var e=function(b,e,h){c.each(e,function(c){a.remove(b,c)});d.each(h,function(c,d){a.set(b,d,c)})};return{filter:function(a,b){var d={};c.each(a.dom().attributes,function(a){b(a.value,a.name)||(d[a.name]=a.value)});return d},clobber:function(a,b,h){h=c.map(a.dom().attributes,function(a){return a.name});d.size(b)!==
h.length&&e(a,h,b)},scan:b.constant({})}});k("16h",["b","1o","1a","2n","v"],function(c,d,b,a,e){var g=function(a){var b={};a=void 0!==a&&null!==a?a.split(";"):[];c.each(a,function(a){a=a.split(":");2===a.length&&(b[e.trim(a[0])]=e.trim(a[1]))});return b},f=function(a){var b=d.keys(a);return c.map(b,function(b){return b+": "+a[b]}).join("; ")};return{filter:function(a,b){var d=a.dom().style,e={};c.each(void 0===d?[]:d,function(c){var d;d=a.dom().style.getPropertyValue(c);b(d,c)||(e[c]=d)});return e},
clobber:function(c,e,g){b.set(c,"style","");var k=d.size(e),p=d.size(g);0===k&&0===p?b.remove(c,"style"):0===k?b.set(c,"style",f(g)):(d.each(e,function(b,d){a.set(c,d,b)}),e=b.get(c,"style"),g=0<p?f(g)+"; ":"",b.set(c,"style",g+e))},scan:function(a,b,d){a=a.dom().getAttribute("style");var e=g(a),f={};c.each(b,function(a){var b=e[a];void 0===b||d(b,a)||(f[a]=b)});return f}}});k("163",["16g","16h","7","l"],function(c,d,b,a){var e=["mso-list"],g=function(a,b){var c=d.scan(a,e,b),f=d.filter(a,b);d.clobber(a,
f,c)},f=function(a,b){var d=c.filter(a,b);c.clobber(a,d,{})};return{style:g,attribute:f,styleDom:function(b,c){g(a.fromDom(b),c)},attributeDom:function(b,c){f(a.fromDom(b),c)},validateStyles:function(a){var c=d.filter(a,b.constant(!1));d.clobber(a,c,{})}}});k("15n","b 6 162 163 7 1a 1y 4b 2q 4e".split(" "),function(c,d,b,a,e,g,f,h,l,m){var k=function(a,d,e){a(e,function(a,f){return c.exists(d,function(c){return b.keyval(e,a,f,c)})})};return{remover:function(p,r){var q=d.merge({styles:[],attributes:[],
classes:[],tags:[]},r),s=m.descendants(p,"*");c.each(s,function(b){k(a.style,q.styles,b);k(a.attribute,q.attributes,b);c.each(q.classes,function(a){var d=g.has(b,"class")?h.get(b):[];c.each(d,function(c){a.name.matches(c)&&f.remove(b,c)})})});s=m.descendants(p,"*");c.each(s,function(a){c.exists(q.tags,e.curry(b.name,a))&&l.remove(a)})},unwrapper:function(a,f){var g=d.merge({tags:[]},f),h=m.descendants(a,"*");c.each(h,function(a){c.exists(g.tags,e.curry(b.name,a))&&l.unwrap(a)})},transformer:function(a,
f){var g=d.merge({tags:[]},f),h=m.descendants(a,"*");c.each(h,function(a){var d=c.find(g.tags,e.curry(b.name,a));void 0!==d&&null!==d&&d.mutate(a)})},validator:function(b){b=m.descendants(b,"*");c.each(b,function(b){a.validateStyles(b)})}}});k("16b",["1o","2n","l"],function(c,d,b){var a=function(a,c,e){var l,m,k,p=b.fromDom(a);switch(a.nodeType){case 1:c?l="endElement":(l="startElement",d.setAll(p,e||{}));m="HTML"!==a.scopeName&&a.scopeName&&a.tagName&&0>=a.tagName.indexOf(":")?(a.scopeName+":"+a.tagName).toUpperCase():
a.tagName;break;case 3:l="text";k=a.nodeValue;break;case 8:l="comment";k=a.nodeValue;break;default:console.log("WARNING: Unsupported node type encountered: "+a.nodeType)}return{getNode:function(){return a},tag:function(){return m},type:function(){return l},text:function(){return k}}},e=function(b,c){return a(c.createElement(b),!0)};return{START_ELEMENT_TYPE:"startElement",END_ELEMENT_TYPE:"endElement",TEXT_TYPE:"text",COMMENT_TYPE:"comment",FINISHED:e("HTML",window.document),token:a,createStartElement:function(b,
d,e,l){var m=l.createElement(b);c.each(d,function(a,b){m.setAttribute(b,a)});return a(m,!1,e)},createEndElement:e,createComment:function(b,c){return a(c.createComment(b),!1)},createText:function(b,c){return a(c.createTextNode(b))}}});k("164",["16b"],function(c){return{create:function(d){var b=d.createDocumentFragment(),a=b;return{dom:a,receive:function(e){var g=function(a){a=a.getNode().cloneNode(!1);b.appendChild(a);b=a},f=function(a,c){var e=d.createTextNode(a.text());b.appendChild(e)};switch(e.type()){case c.START_ELEMENT_TYPE:g(e);
break;case c.TEXT_TYPE:f(e);break;case c.END_ELEMENT_TYPE:b=b.parentNode;null===b&&(b=a);break;case c.COMMENT_TYPE:break;default:throw{message:"Unsupported token type: "+e.type()};}},label:"SERIALISER"}}}});k("165",["16b"],function(c){return{tokenise:function(d,b){var a;b=b||window.document;a=b.createElement("div");b.body.appendChild(a);a.style.position="absolute";a.style.left="-10000px";a.innerHTML=d;nextNode=a.firstChild||c.FINISHED;var e=[];endNode=!1;return{hasNext:function(){return void 0!==
nextNode},next:function(){var d=nextNode,f=endNode;!endNode&&nextNode.firstChild?(e.push(nextNode),nextNode=nextNode.firstChild):endNode||1!==nextNode.nodeType?nextNode.nextSibling?(nextNode=nextNode.nextSibling,endNode=!1):(nextNode=e.pop(),endNode=!0):endNode=!0;d===c.FINISHED||nextNode||(b.body.removeChild(a),nextNode=c.FINISHED);d=d===c.FINISHED?d:d?c.token(d,f):void 0;return d}}}}});k("15o",["164","165"],function(c,d){var b=function(a,b,c){var d=c;for(c=b.length-1;0<=c;c--)d=b[c](d,{},a);return d};
return{build:b,run:function(a,e,g){var f=c.create(a);e=d.tokenise(e,a);for(a=b(a,g,f);e.hasNext();)g=e.next(),a.receive(g);return f.dom}}});k("14x","b 15n 15o l 2f 2q 2a".split(" "),function(c,d,b,a,e,g,f){return{removal:function(a){return function(b){d.remover(b,a)}},unwrapper:function(a){return function(b){d.unwrapper(b,a)}},transformer:function(a){return function(b){d.transformer(b,a)}},validate:function(){return function(a){d.validator(a)}},pipeline:function(a){return function(c){var d=e.get(c),
k=f.owner(c),d=b.run(k.dom(),d,a);g.empty(c);c.dom().appendChild(d)}},isWordContent:function(a,b){return 0<=a.indexOf("<o:p>")||b.browser.isSpartan()&&0<=a.indexOf('v:shapes="')||b.browser.isSpartan()&&0<=a.indexOf("mso-")||0<=a.indexOf("mso-list")||0<=a.indexOf("p.MsoNormal, li.MsoNormal, div.MsoNormal")||0<=a.indexOf("MsoListParagraphCxSpFirst")||0<=a.indexOf("<w:WordDocument>")},go:function(b,d,f){var g=a.fromTag("div",b.dom());g.dom().innerHTML=d;c.each(f,function(a){a(g)});return e.get(g)}}});
k("15q",["b","16b"],function(c,d){return function(b,a,e){return function(e,f,h){var l=function(a){e.receive(a)},m=function(a,b){return d.token(b,a.type()===d.END_ELEMENT_TYPE,{})},k={emit:l,emitTokens:function(a){c.each(a,l)},receive:function(a){b(k,a,m)},document:window.document};a(k);return k}}});k("16q","16h 16b 7 1a 2n l".split(" "),function(c,d,b,a,e,g){return{getAttribute:function(b,c){var d=g.fromDom(b.getNode());return a.get(d,c)},getStyle:function(a,b){var c=g.fromDom(a.getNode());return e.get(c,
b)},isWhitespace:function(a){return a.type()===d.TEXT_TYPE&&/^[\s\u00A0]*$/.test(a.text())},getMsoList:function(a){a=g.fromDom(a.getNode());return c.scan(a,["mso-list"],b.constant(!1))["mso-list"]}}});k("16v",["b","s"],function(c,d){var b=function(a,b,c){return a===b||a&&b&&a.tag===b.tag&&a.type===b.type&&(c||a.variant===b.variant)};return{guessFrom:function(a,e){var g=c.find(a,function(a){return"UL"===a.tag||e&&b(a,e,!0)});return void 0!==g?d.some(g):0<a.length?d.some(a[0]):d.none()},eqListType:b}});
k("16l",[],function(){var c=function(b,a){if(void 0===b||void 0===a)throw console.trace(),"brick";b.nextFilter.set(a)},d=function(b,a,c){a.nextFilter.get()(b,a,c)};return{next:c,go:d,jump:function(b){return function(a,e,g){c(e,b);d(a,e,g)}},isNext:function(b,a){return b.nextFilter.get()===a},setNext:function(b){return function(a,d,g){c(d,b)}}}});k("16p","b 16q 16v 16l 7 2u 1a l".split(" "),function(c,d,b,a,e,g,f,h){var l=g.immutable("level","token","type"),m=function(a,e,f,g){a=f.getCurrentListType();
f=f.getCurrentLevel()==g.level()?a:null;return b.guessFrom(g.emblems(),f).filter(function(a){if(a="OL"===a.tag)a=!c.contains(["P"],e.tag())||/^MsoHeading/.test(d.getAttribute(e,"class"));return!a})};return{predicate:function(a,b){return f.has(h.fromDom(b.getNode()),"data-list-level")},action:function(b){return function(c,d,g){c=h.fromDom(g.getNode());var k=parseInt(f.get(c,"data-list-level"),10),t=f.get(c,"data-list-emblems"),t=JSON.parse(t);f.remove(c,"data-list-level");f.remove(c,"data-list-emblems");
c={level:e.constant(k),emblems:e.constant(t)};c.level();d.originalToken.set(g);m(d.listType.get(),g,d.emitter,c).each(d.listType.set);g=l(c.level(),d.originalToken.get(),d.listType.get());d.emitter.openItem(g.level(),g.token(),g.type());a.next(d,b.inside())}}}});k("16r",["7"],function(c){return function(d,b,a){return{pred:d,action:b,label:c.constant(a)}}});k("16s",["b","7","s"],function(c,d,b){var a=function(a,b){return function(a,c,d){return b(a,c,d)}};return function(e,g,f){var h=a(e+" :: FALLBACK --- ",
f);f=function(f,m,k){b.from(c.find(g,function(a){return a.pred(m,k)})).fold(d.constant(h),function(b){var c=b.label();return void 0===c?b.action:a(e+" :: "+c,b.action)})(f,m,k)};f.toString=function(){return"Handlers for "+e};return f}});k("16i","16p 16b 16q 16r 16s 16l".split(" "),function(c,d,b,a,e,g){return{inside:function(b){return e("Inside.List.Item",[a(function(a,b){return b.type()===d.END_ELEMENT_TYPE&&a.originalToken.get()&&b.tag()===a.originalToken.get().tag()},function(a,c,d){g.next(c,b.outside())},
"Closing open tag")],function(a,b,c){a.emit(c)})},outside:function(f){return e("Outside.List.Item",[a(c.predicate,c.action(f),"Data List ****"),a(function(a,c){return c.type()===d.TEXT_TYPE&&b.isWhitespace(c)},function(a,b,c){a.emit(c)},"Whitespace")],function(a,b,c){b.emitter.closeAllLists();a.emit(c);g.next(b,f.outside())})}}});k("16w",["2u"],function(c){var d=c.immutable("state","result"),b=c.immutable("state","value");return{state:c.immutable("level","type","types","items"),value:b,result:d}});
k("16y",["16w","s"],function(c,d){return{start:function(b,a){var e=b.items().slice(0),g=void 0!==a&&"P"!==a?d.some(a):d.none();g.fold(function(){e.push("P")},function(a){e.push(a)});var f=c.state(b.level(),b.type(),b.types(),e);return c.value(f,g)},finish:function(b){var a=b.items().slice(0);if(0<a.length&&"P"!==a[a.length-1]){var e=a[a.length-1];a[a.length-1]="P";b=c.state(b.level(),b.type(),b.types(),a);return c.value(b,d.some(e))}return c.value(b,d.none())}}});k("16z",["16w"],function(c){var d=
function(b,a,d){for(var g=[];a(b);){var f=d(b);b=f.state();g=g.concat(f.result())}return c.result(b,g)};return{moveRight:function(b,a,c){return d(b,function(b){return b.level()<a},c)},moveLeft:function(b,a,c){return d(b,function(b){return b.level()>a},c)},moveUntil:d}});k("171",["16q"],function(c){return{from:function(d){var b={"list-style-type":"none"};d?(d=c.getStyle(d,"margin-left"),d=void 0!==d&&"0px"!==d?{"margin-left":d}:{}):d=b;return d}}});k("170","163 16b 16v 16w 16y 171 7".split(" "),function(c,
d,b,a,e,g,f){var h=function(b,c,e){var g=c.start&&1<c.start?{start:c.start}:{},h=b.level()+1,l=b.types().concat([c]);e=[f.curry(d.createStartElement,c.tag,g,e)];b=a.state(h,c,l,b.items());return a.result(b,e)},l=function(b){var c=b.types().slice(0),e=[f.curry(d.createEndElement,c.pop().tag)],g=b.level()-1;b=a.state(g,c[c.length-1],c,b.items());return a.result(b,e)},m=function(b,c){var d=l(b),e=h(d.state(),c,c.type?{"list-style-type":c.type}:{});return a.result(e.state(),d.result().concat(e.result()))};
return{open:h,openItem:function(h,l,k){var q=g.from(l);h=h.type()&&!b.eqListType(h.type(),k)?m(h,k):a.result(h,[]);q=[f.curry(d.createStartElement,"LI",{},q)];k=e.start(h.state(),l&&l.tag());var s=k.value().map(function(a){c.styleDom(l.getNode(),f.constant(!0));return[f.constant(l)]}).getOr([]);return a.result(k.state(),h.result().concat(q).concat(s))},close:l,closeItem:function(b){var c=f.curry(d.createEndElement,"LI");b=e.finish(b);var g=b.value().fold(function(){return[c]},function(a){return[f.curry(d.createEndElement,
a),c]});return a.result(b.state(),g)}}});k("16x","b 16b 16w 16y 16z 170 7 s".split(" "),function(c,d,b,a,e,g,f,h){var l=function(a){if(0===a.length)throw"Compose must have at least one element in the list";var d=a[a.length-1];a=c.bind(a,function(a){return a.result()});return b.result(d.state(),a)},m=function(a){a=g.closeItem(a);var b=g.close(a.state());return l([a,b])},k=function(a,b,c,d){return e.moveRight(a,c,function(a){var e=a.level()===c-1&&b.type?{"list-style-type":b.type}:{};a=g.open(a,b,e);
e=g.openItem(a.state(),a.state().level()==c?d:void 0,b);return l([a,e])})},p=function(a,b){return e.moveLeft(a,b,m)},r=function(c,e,g,l){var m=1<g?a.finish(c):b.value(c,h.none());c=m.value().map(function(a){return[f.curry(d.createEndElement,a)]}).getOr([]);m.state().level();e=k(m.state(),e,g,l);return b.result(e.state(),c.concat(e.result()))};return{openItem:function(a,c,d,e){a=a.level()>c?p(a,c):b.result(a,[]);a.state().level()===c?(c=a.state(),c=0<c.level()?g.closeItem(c):b.result(c,[]),d=g.openItem(c.state(),
d,e),d=l([c,d])):d=r(a.state(),e,c,d);return l([a,d])},closeAllLists:p}});k("16t",["b","16w","16x"],function(c,d,b){var a=["disc","circle","square"];return function(e,g){var f=d.state(0,void 0,[],[]),h=function(a){c.each(a.result(),function(a){a=a(g);e.emit(a)})};return{closeAllLists:function(){var a=b.closeAllLists(f,0);f=a.state();h(a)},openItem:function(c,d,e){e&&("UL"===e.tag&&a[c-1]===e.type&&(e={tag:"UL"}),c=b.openItem(f,c,d,e),f=c.state(),h(c))},getCurrentListType:function(){return f.type()},
getCurrentLevel:function(){return f.level()}}}});k("16j",["16t","7","4m"],function(c,d,b){var a={getCurrentListType:function(){return e().getCurrentListType()},getCurrentLevel:function(){return e().getCurrentLevel()},closeAllLists:function(){return e().closeAllLists.apply(void 0,arguments)},openItem:function(){return e().openItem.apply(void 0,arguments)}},e=function(){return{getCurrentListType:d.constant({}),getCurrentLevel:d.constant(1),closeAllLists:d.identity,openItem:d.identity}};return function(g){var f=
b(g),h=b(null),l=b(null);return{reset:function(a){f.set(g);h.set(null);l.set(null);_emitter=c(a,a.document);e=d.constant(_emitter)},nextFilter:f,originalToken:h,listType:l,emitter:a}}});k("16k",["16b"],function(c){return function(){var d=!1,b="";return{check:function(a){return d&&a.type()===c.TEXT_TYPE?(b+=a.text(),!0):a.type()===c.START_ELEMENT_TYPE&&"STYLE"===a.tag()?d=!0:a.type()===c.END_ELEMENT_TYPE&&"STYLE"===a.tag()?(d=!1,!0):!1}}}});k("166","15q 16i 16j 16k 16l q".split(" "),function(c,d,b,
a,e,g){g={inside:function(){return h},outside:function(){return l}};var f=a(),h=d.inside(g),l=d.outside(g),m=b(l);return c(function(a,b,c){f.check(b)||e.go(a,m,b)},m.reset,"list.filters")});k("16u",["b","6","1u","dg"],function(c,d,b,a){var e=[{regex:/^\(?[dc][\.\)]$/,type:{tag:"OL",type:"lower-alpha"}},{regex:/^\(?[DC][\.\)]$/,type:{tag:"OL",type:"upper-alpha"}},{regex:/^\(?M*(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})[\.\)]$/,type:{tag:"OL",type:"upper-roman"}},{regex:/^\(?m*(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})[\.\)]$/,
type:{tag:"OL",type:"lower-roman"}},{regex:/^\(?[0-9]+[\.\)]$/,type:{tag:"OL"}},{regex:/^([0-9]+\.)*[0-9]+\.?$/,type:{tag:"OL",variant:"outline"}},{regex:/^\(?[a-z]+[\.\)]$/,type:{tag:"OL",type:"lower-alpha"}},{regex:/^\(?[A-Z]+[\.\)]$/,type:{tag:"OL",type:"upper-alpha"}}],g={"\u2022":{tag:"UL",type:"disc"},"\u00b7":{tag:"UL",type:"disc"},"\u00a7":{tag:"UL",type:"square"}},f={o:{tag:"UL",type:"circle"},"-":{tag:"UL",type:"disc"},"\u25cf":{tag:"UL",type:"disc"},"\ufffd":{tag:"UL",type:"circle"}},h=
function(a,b){return void 0!==a.variant?a.variant:"("===b.charAt(0)?"()":")"===b.charAt(b.length-1)?")":"."},l=function(c){var d=c.split(".");0===d.length?d=c:(c=d[d.length-1],d=0===c.length&&1<d.length?d[d.length-2]:c);d=a(d,10);return b(d)?{}:{start:d}};return{extract:function(a,b){var k=f[a]?[f[a]]:[],r=b&&g[a]?[g[a]]:b?[{tag:"UL",variant:a}]:[],q=c.bind(e,function(b){return b.regex.test(a)?[d.merge(b.type,l(a),{variant:h(b.type,a)})]:[]}),k=k.concat(r).concat(q);return c.map(k,function(b){return void 0!==
b.variant?b:d.merge(b,{variant:a})})}}});k("16m","b 16u 16h 7 s 2n 2f 21 4i 9q 2a 1s 1u dg".split(" "),function(c,d,b,a,e,g,f,h,l,m,k,p,r,q){var s=function(c){return b.scan(c,["mso-list"],a.constant(!1))["mso-list"]},t=function(a){return h.isElement(a)&&g.getRaw(a,"font-family").exists(function(a){return c.contains(["wingdings","symbol"],a.toLowerCase())})};return{getMsoList:s,extractLevel:function(a){a=s(a);return(a=/ level([0-9]+)/.exec(a))&&a[1]?e.some(q(a[1],10)):e.none()},extractEmblem:function(a,
b){var c=m.get(a).trim(),c=d.extract(c,b);return 0<c.length?e.some(c):e.none()},extractSymSpan:function(a){return l.child(a,t)},extractMsoIgnore:function(c){return l.descendant(c,function(c){return!!(h.isElement(c)?b.scan(c,["mso-list"],a.constant(!1)):[])["mso-list"]})},extractCommentSpan:function(a){return l.child(a,h.isComment).bind(k.nextSibling).filter(function(a){return"span"===h.name(a)})},isSymbol:t,deduceLevel:function(a){return g.getRaw(a,"margin-left").bind(function(a){a=q(a,10);return r(a)?
e.none():e.some(p.max(1,p.ceil(a/18)))})}}});da("16n",JSON);k("167","b 16m s 1a 15x 21 2q 2a 16n dg".split(" "),function(c,d,b,a,e,g,f,h,l,m){var k=function(d,g,h,m){a.set(d,"data-list-level",g);g=l.stringify(h);a.set(d,"data-list-emblems",g);g=e.find(d,b.none());c.each(g,f.remove);c.each(m,f.remove);a.remove(d,"style");a.remove(d,"class")},p=function(a){return d.extractLevel(a).bind(function(b){return d.extractSymSpan(a).bind(function(c){return d.extractEmblem(c,!0).map(function(d){return{mutate:function(){k(a,
b,d,[c])}}})})})},r=function(a){return d.extractLevel(a).bind(function(b){return d.extractCommentSpan(a).bind(function(c){return d.extractEmblem(c,d.isSymbol(c)).map(function(d){return{mutate:function(){k(a,b,d,[c])}}})})})},q=function(a){return d.extractLevel(a).bind(function(b){return d.extractCommentSpan(a).bind(function(c){return d.extractEmblem(c,d.isSymbol(c)).map(function(d){return{mutate:function(){k(a,b,d,[c])}}})})})},s=function(a){return"p"!==g.name(a)?b.none():d.extractLevel(a).bind(function(b){return d.extractMsoIgnore(a).bind(function(c){return d.extractEmblem(c,
!1).map(function(d){return{mutate:function(){k(a,b,d,[h.parent(c).getOr(c)])}}})})})},t=function(a){return"p"!==g.name(a)?b.none():d.extractMsoIgnore(a).bind(function(b){var c=h.parent(b).getOr(b),e=d.isSymbol(c);return d.extractEmblem(b,e).bind(function(b){return d.deduceLevel(a).map(function(d){return{mutate:function(){k(a,d,b,[c])}}})})})};return{find:function(a){return p(a).orThunk(function(){return r(a)}).orThunk(function(){return q(a)}).orThunk(function(){return s(a)}).orThunk(function(){return t(a)})}}});
k("15p",["14x","166","167","168"],function(c,d,b,a){c=c.transformer({tags:[{name:a.pattern(/^(p|h\d+)$/),mutate:function(a){b.find(a).each(function(a){a.mutate()})}}]});return{filter:d,preprocess:c}});k("169",["b","1a","2f","21","37"],function(c,d,b,a,e){var g=function(b){var c=b.dom().attributes,c=void 0!==c&&null!==c&&0<c.length;return"span"===a.name(b)?c:!0},f=function(a){return void 0===a.dom().attributes||null===a.dom().attributes?!0:0===a.dom().attributes.length||1===a.dom().attributes.length&&
"style"===a.dom().attributes[0].name};return{isNotImage:function(b){return"img"!==a.name(b)},hasContent:function(b){return f(b)?g(b)&&e.descendant(b,function(b){var d=!f(b),e=!c.contains("font em strong samp acronym cite code dfn kbd tt b i u s sub sup ins del var span".split(" "),a.name(b));return a.isText(b)||d||e}):!0},isList:function(b){return"ol"===a.name(b)||"ul"===a.name(b)},isLocal:function(a){a=d.get(a,"src");return/^file:/.test(a)},hasNoAttributes:f,isEmpty:function(a){return 0===b.get(a).length}}});
k("16a","b 1o s 1a 2n l 2f 2o 3c 21 2q ak 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m,k,p,r){var q=function(a,b){var d=g.fromTag(a);h.before(b,d);var e=b.dom().attributes;c.each(e,function(a){d.dom().setAttribute(a.name,a.value)});e=r.children(b);l.append(d,e);k.remove(b);return d},s=function(a){return r.prevSibling(a).bind(function(a){return m.isText(a)&&0===p.get(a).trim().length?s(a):"li"===m.name(a)?b.some(a):b.none()})};return{changeTag:q,addBrTag:function(a){0===f.get(a).length&&h.append(a,
g.fromTag("br"))},properlyNest:function(a){r.parent(a).each(function(b){b=m.name(b);c.contains(["ol","ul"],b)&&s(a).fold(function(){var b=g.fromTag("li");e.set(b,"list-style-type","none");h.wrap(a,b)},function(b){h.append(b,a)})})},fontToSpan:function(b){var c=q("span",b),f={"font-size":{1:"8pt",2:"10pt",3:"12pt",4:"14pt",5:"18pt",6:"24pt",7:"36pt"}};d.each({face:"font-family",size:"font-size",color:"font-color"},function(b,d){if(a.has(c,d)){var g=a.get(c,d);e.set(c,b,void 0!==f[b]&&void 0!==f[b][g]?
f[b][g]:g);a.remove(c,d)}})}}});k("15m","161 14x 15p 169 16a 7 1y 2n 2a 21 168".split(" "),function(c,d,b,a,e,g,f,h,l,m,k){var p=d.unwrapper({tags:[{name:k.pattern(/^([OVWXP]|U[0-9]+|ST[0-9]+):/i)}]});b=[d.pipeline([b.filter])];var r=d.removal({attributes:[{name:k.pattern(/^v:/)},{name:k.exact("href"),value:k.contains("#_toc")},{name:k.exact("href"),value:k.contains("#_mso")},{name:k.pattern(/^xmlns(:|$)/)},{name:k.exact("type"),condition:a.isList}]}),q=d.removal({attributes:[{name:k.exact("id")},
{name:k.exact("name")}]}),s=d.removal({tags:[{name:k.exact("script")},{name:k.exact("meta")},{name:k.exact("link")},{name:k.exact("style"),condition:a.isEmpty}],attributes:[{name:k.starts("on")},{name:k.exact('"')},{name:k.exact("lang")},{name:k.exact("language")}],styles:[{name:k.all(),value:k.pattern(/OLE_LINK/i)}]}),t=d.removal({styles:[{name:k.not(k.pattern(/width|height|list-style-type/)),condition:function(a){return!f.has(a,"ephox-limbo-transform")}},{name:k.pattern(/width|height/),condition:a.isNotImage}]}),
u=d.removal({classes:[{name:k.not(k.exact("rtf-data-image"))}]}),v=d.removal({styles:[{name:k.pattern(c.validStyles())}]}),w=d.removal({classes:[{name:k.pattern(/mso/i)}]}),x=d.unwrapper({tags:[{name:k.exact("img"),condition:a.isLocal},{name:k.exact("a"),condition:a.hasNoAttributes}]}),y=d.unwrapper({tags:[{name:k.exact("a"),condition:a.hasNoAttributes}]}),B=d.removal({attributes:[{name:k.exact("style"),value:k.exact(""),debug:!0}]}),z=d.removal({attributes:[{name:k.exact("class"),value:k.exact(""),
debug:!0}]});c=d.unwrapper({tags:[{name:k.pattern(c.specialInline()),condition:g.not(a.hasContent)}]});a=d.unwrapper({tags:[{name:k.exact("p"),condition:function(a){return function(b){return l.parent(b).exists(function(b){return m.name(b)===a&&1===l.children(b).length})}}("li")}]});var A=d.transformer({tags:[{name:k.exact("p"),mutate:e.addBrTag}]}),C=d.transformer({tags:[{name:k.pattern(/ol|ul/),mutate:e.properlyNest}]}),D=d.transformer({tags:[{name:k.exact("b"),mutate:g.curry(e.changeTag,"strong")},
{name:k.exact("i"),mutate:g.curry(e.changeTag,"em")},{name:k.exact("u"),mutate:function(a){a=e.changeTag("span",a);f.add(a,"ephox-limbo-transform");h.set(a,"text-decoration","underline")}},{name:k.exact("s"),mutate:g.curry(e.changeTag,"strike")},{name:k.exact("font"),mutate:e.fontToSpan,debug:!0}]}),F=d.removal({classes:[{name:k.exact("ephox-limbo-transform")}]});d=d.removal({attributes:[{name:k.exact("href"),value:k.starts("file:///"),debug:!0}]});return{unwrapWordTags:p,removeWordAttributes:r,parseLists:b,
removeExcess:s,cleanStyles:t,cleanClasses:u,mergeStyles:v,mergeClasses:w,removeLocalImages:x,removeVacantLinks:y,removeEmptyStyle:B,removeEmptyClass:z,pruneInlineTags:c,unwrapSingleParagraphsInlists:a,addPlaceholders:A,nestedListFixes:C,inlineTagFixes:D,cleanupFlags:F,removeLocalLinks:d,removeAnchors:q,none:g.noop}});k("14v","b 13o 15m 14x 15p 15q 7 l".split(" "),function(c,d,b,a,e,g,f,h){var l=function(a){return a.browser.isIE()&&11<=a.browser.version.major},m=function(a){return g(function(b,c,d){var e=
a(h.fromDom(c.getNode())).fold(function(){return c},function(a){return d(c,a.dom())});b.emit(e)},f.noop,"image filters")},k=function(a,c){return l(c)&&a?[b.unwrapSingleParagraphsInlists]:[]},p=function(a,c,d){a=[b.mergeStyles,b.mergeClasses];d=[b.cleanStyles,b.cleanClasses];return c?a:d},r=function(a,b,c){return l(c)||!a?[]:[e.preprocess]},q=function(a,c,d){if(!a)return[b.none];a=[b.unwrapWordTags];d=l(d)?[]:b.parseLists;return a.concat(d).concat([b.removeWordAttributes])};return{derive:function(e,
f,g){var h,w;w=g.browser.isFirefox()||g.browser.isSpartan()?d.local:d.vshape;h=l(g)?b.none:a.pipeline([m(w)]);h=[e?h:b.none];w=[w===d.local?b.none:b.removeLocalImages];return c.flatten([r(e,f,g),h,[b.inlineTagFixes],q(e,f,g),[b.nestedListFixes],[b.removeExcess],e?[b.removeAnchors]:[b.none],w,p(e,f,g),[b.removeLocalLinks,b.removeVacantLinks],[b.removeEmptyStyle],[b.removeEmptyClass],[b.pruneInlineTags],[b.addPlaceholders],k(e,g),[b.cleanupFlags]])}}});k("14w","b s 10a 6j 2u 1a 2n l 2o 3c 21 6m 9q 2a".split(" "),
function(c,d,b,a,e,g,f,h,l,m,k,p,r,q){var s=/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\.\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w\.]+@)[A-Za-z0-9\.\-]+)(:[0-9]+)?((?:\/[\+~%\/\.\w\-_]*)?\??(?:[\-_.~*+=!&;:'%@?^${}()\w,]*)#?(?:[\-_.~*+=!&;:'%@?^${}()\w,\/]*))?)/g.source,t=function(c){var d=e.immutable("word","pattern"),f=a.unsafetoken(s),d=d("__INTERNAL__",f);return b.run(c,[d])},u=function(a){return!p.closest(a,"a")},v=function(a){return d.from(a[0]).filter(u).map(function(b){var c=h.fromTag("a");
l.before(b,c);m.append(c,a);g.set(c,"href",r.get(c));return c})};return{links:function(a){a=t(a);c.each(a,function(a){var b=a.exact(),c;(c=0>b.indexOf("@"))||(b=b.indexOf("://"),c=3<=b&&9>=b);c&&v(a.elements())})},position:function(a){c.each(a,function(a){k.isElement(a)&&f.getRaw(a,"position").isSome()&&f.remove(a,"position")})},list:function(a){var b=c.filter(a,function(a){return"li"===k.name(a)});if(0<b.length){var d=q.prevSiblings(b[0]),e=h.fromTag("ul");l.before(a[0],e);0<d.length&&(a=h.fromTag("li"),
l.append(e,a),m.append(a,d));m.append(e,b)}}}});k("13k","b 14v 14w 14x 2f 2a".split(" "),function(c,d,b,a,e,g){var f=function(a){var d=g.children(a);c.each([b.links,b.position,b.list],function(a){a(d)})};return{go:function(b,c,g,k,p){f(g);g=e.get(g);c=d.derive(p,k,c);return a.go(b,g,c)},preprocess:f}});k("14t","13a 13b 13d 10r c 13k p 48 o".split(" "),function(c,d,b,a,e,g,f,h,l){var m=e.detect(),k=function(a,b,c,d){try{var e=g.go(a,m,b,c,d),k=void 0!==e&&null!==e&&0<e.length?h.fromHtml(e):[];return f.value(k)}catch(n){return l.error(n),
f.error("errors.paste.process.failure")}};return{transfer:function(e,f,g,h,l){return k(e,f,h,g).fold(function(a){return c.error(a)},function(e){return c.sync(function(f){l.get(function(g){var h=b.findImages(e,g);c.call(f,{response:a.paste(e,g,h),bundle:d.nu({})})})})})}}});k("13i","14t b 3s s 2q 2a".split(" "),function(c,d,b,a,e,g){return{internal:function(f,h,l){h=(void 0!==h?h.findClipboardTags(g.children(l)):a.none()).getOr([]);d.each(h,e.remove);h=b.nu(function(a){a([])});return c.transfer(f,
l,!1,!0,h)},external:function(a,b,d,e,g){return c.transfer(a,b,e,d,g)}}});k("14u",["b","l","2f","9q"],function(c,d,b,a){return{encode:function(c){var g=d.fromTag("div");a.set(g,c);return b.get(g)},convert:function(a){a=a.trim().split(/\n{2,}|(?:\r\n){2,}/);a=c.map(a,function(a){return a.split(/\n|\r\n/).join("<br />")});return 1===a.length?a[0]:c.map(a,function(a){return"<p>"+a+"</p>"}).join("")}}});k("13j","13a 14u 13b 10v 10r s k 48 36".split(" "),function(c,d,b,a,e,g,f,h,l){var m=function(a){return 0<
a.length},k=function(b){return a.isValidData(b)?f.findMap(b.types,function(a){return"text/plain"===a?g.some(b.getData(a)):g.none()}):g.none()},p=function(){var a=l.clipboardData;return void 0!==a?g.some(a.getData("text")):g.none()},r=function(a){a=d.encode(a);a=d.convert(a);a=h.fromHtml(a);return e.paste(a,[],[])};return{handle:function(d){return c.sync(function(f){var g=(a.isValidData(d)?k:p)(d).filter(m).fold(e.cancel,r);c.call(f,{response:g,bundle:b.nu({})})})}}});k("10y","13a 13b 13e 13g 13h 13i 13j 10r c 13k 7 l 3c 2a o".split(" "),
function(c,d,b,a,e,g,f,h,l,m,k,p,r,q,s){var t=l.detect();return{plain:function(a,b,c){return f.handle(a)},autolink:function(a,b){var d=function(a,d,e){var f=p.fromTag("div");r.append(f,a);m.preprocess(f);a=q.children(f);return c.pure({response:h.paste(a,d,e),bundle:b.bundle()})},e=k.curry(c.pass,b);return h.cata(b.response(),e,d,e,d)},noImages:function(){return function(a,b){return c.error("errors.local.images.disallowed")}},images:function(){return function(a,b){if(t.browser.isSafari()){var d=t.deviceType.isWebView()?
"webview.imagepaste":"safari.imagepaste";return c.error(d)}return e.handle(a)}},internal:function(a,c){return function(d,e){var f=e.bundle();return b.proxyBin(f).handle("There was no proxy bin setup. Ensure you have run proxyStep first.",function(b){var d=q.owner(a);return g.internal(d,c,b)})}},external:function(a,c){return function(d,e){var f=e.bundle();return b.proxyBin(f).handle("There was no proxy bin setup. Ensure you have run proxyStep first.",function(d){var e=b.merging(f),h=b.isWord(f),l=
b.isInternal(f),m=b.backgroundAssets(f),k=q.owner(a);return l?g.internal(k,c,d):g.external(k,d,e,h,m)})}},gwt:function(c){return function(d,e){var f=b.mergeOffice(e.bundle());return a.handle(d,f,c)}},setBundle:function(a){return function(b,e){var f=d.merge(e.bundle(),d.nu(a));return c.pure({response:e.response(),bundle:f})}},none:function(a,b){return c.cancel()}}});k("13l",["14x","1a","2f","37"],function(c,d,b,a){var e=function(b,c){return a.descendant(b,function(a){return d.has(a,"style")?-1<d.get(a,
"style").indexOf("mso-"):!1})},g=function(a,d){var e=b.get(a);return c.isWordContent(e,d)};return{isWord:function(a,b){var c=a.browser;return(c.isIE()&&11<=c.version.major?e:g)(b,a)}}});k("10z","13a 13b ii c 13l 1y 2a".split(" "),function(c,d,b,a,e,g,f){var h=a.detect();return function(a,m,k,p,r){return function(q,s){var t=r(),u=s.response();return c.sync(function(r){var s=a(k);s.events.after.bind(function(a){a=a.container();m(a);g.add(a,b.binStyle());var l=e.isWord(h,a),k=f.children(a),k=p.findClipboardTags(k,
l).isSome();c.call(r,{response:u,bundle:d.nu({isWord:l,isInternal:k,proxyBin:a,backgroundAssets:t})})});t.convert(q.data());s.run()})}}});k("16c","11f 11g 9 1s w dg".split(" "),function(c,d,b,a,e,g){return{convert:function(e,h){if(0===e.length)throw"Zero length content passed to Hex conversion";for(var l=new b(e.length/2),m=0;m<e.length;m+=2){var k=e.substr(m,2),p=a.floor(m/2);l[p]=g(k,16)}l=d(l);return c([l],{type:h})}}});k("15s",["4n"],function(c){c=c.generate([{unsupported:["id","message"]},{supported:["id",
"contentType","blob"]}]);return{unsupported:c.unsupported,supported:c.supported,cata:function(c,b,a){return c.fold(b,a)}}});k("16d",["7","s"],function(c,d){var b=function(a,b,e,f,g){return-1===a||-1===b?d.none():d.some({start:c.constant(a),end:c.constant(b),bower:e,regex:c.constant(f),idRef:c.constant(g)})},a=function(a,b,c){return function(){return a.substring(b,c)}},e=function(a,b){if(-1===b)return b;var c=0,d=a.length,e,f;do if(e=a.indexOf("{",b),f=a.indexOf("}",b),f>e&&-1!==e?(b=e+1,++c):(e>f||
0>e)&&-1!==f&&(b=f+1,--c),b>d||-1===f)return-1;while(0<c);return b},g=function(c,d,e,f){c=a(c,e,f);return b(e,f,c,/[^a-fA-F0-9]([a-fA-F0-9]+)\}$/,"i")},f=function(c,d,e,f){c=a(c,e,f);return b(e,f,c,/([a-fA-F0-9]{64,})(?:\}.*)/,"s")};return{identify:function(a,b){var m=a.indexOf("{\\pict{",b),k=e(a,m),p=a.indexOf("{\\shp{",b),r=e(a,p),q=c.curry(f,a,b,p,r),s=c.curry(g,a,b,m,k);return-1===m&&-1===p?d.none():-1===m?q():-1===p?s():p<m&&r>k?s():m<p&&k>r?q():m<p?s():p<m?q():d.none()},endBracket:e}});k("15r",
["16c","15s","16d","s","p"],function(c,d,b,a,e){var g=function(a,c){return b.identify(a,c)},f=function(a){return 0<=a.indexOf("\\pngblip")?e.value("image/png"):0<=a.indexOf("\\jpegblip")?e.value("image/jpeg"):e.error("errors.imageimport.unsupported")},h=function(a,b){var c=a.match(b);return c&&c[1]&&0===c[1].length%2?e.value(c[1]):e.error("errors.imageimport.invalid")},l=function(b){b=b.match(/\\shplid(\d+)/);return null!==b?a.some(b[1]):a.none()},m=function(a){var b=a.bower(),e=a.regex();return l(b).map(function(g){var l=
a.idRef()+g;return f(b).fold(function(a){return d.unsupported(l,a)},function(a){return h(b,e).fold(function(a){return d.unsupported(l,a)},function(b){return d.supported(l,a,c.convert(b,a))})})})},k=function(a){for(var b=[],c=function(){return a.length},d=function(a){var c=m(a);b=b.concat(c.toArray());return a.end()},e=0;e<a.length;)e=g(a,e).fold(c,d);return b};return{nextBower:g,extractId:l,extractContentType:f,extractHex:h,images:function(a){a=a.replace(/\r/g,"").replace(/\n/g,"");return k(a)}}});
k("14y",["15r","15s","p"],function(c,d,b){return{images:function(a){return c.images(a)},toId:function(a){return d.cata(a,function(a,b){return a},function(a,b,c){return a})},toBlob:function(a){return d.cata(a,function(a,c){return b.error(c)},function(a,c,d){return b.value(d)})}}});k("14z","14y 13d b gd s 1a 1y o".split(" "),function(c,d,b,a,e,g,f,h){var l={local:function(a,b,c){return e.from(b[c])},code:function(a,d,f){d=b.find(d,function(b){return c.toId(b)===a});return e.from(d)}},m=function(a){var d=
[],e=function(a){return!b.exists(d,function(b){return c.toId(b)===a})};return b.bind(a,function(a){var b=c.toId(a);return e(b)?(d.push(a),[a]):[]})};return{convert:function(k,p,r,q){var s=m(p),t=[],u=!1;k=b.bind(k,function(a,b){var d=g.get(a,"data-image-type"),m=g.get(a,"data-image-id");f.remove(a,"rtf-data-image");g.remove(a,"data-image-type");g.remove(a,"data-image-id");return(void 0!==l[d]?l[d]:e.none)(m,s,b).fold(function(){h.log("WARNING: unable to find data for image ",a.dom());return[]},function(b){return c.toBlob(b).fold(function(b){u=
!0;g.set(a,"alt",q(b));return[]},function(b){t.push(a);return[b]})})});a.multiple(k).get(function(a){var b=d.updateSources(a,t);r(a,b,u)})}}});k("13n","14y 14z 13o 54 46 2a".split(" "),function(c,d,b,a,e,g){return function(f){var h=f.translations,l=e.create({insert:a(["elements","assets","correlated"]),incomplete:a(["elements","assets","correlated","message"])});return{events:l.registry,processRtf:function(a,e,f,k,q){k=c.images(k);var s=b.find(a);d.convert(s,k,function(b,c,d){var h=g.children(a);
b=b.concat(e);c=c.concat(f);d?l.trigger.incomplete(h,b,c,"errors.imageimport.failed"):l.trigger.insert(h,b,c);q()},h)}}}});k("13m","13n b 13o 54 46 2q 2a".split(" "),function(c,d,b,a,e,g,f){return function(h,l){var m=e.create({error:a(["message"]),insert:a(["elements","assets","correlated"]),incomplete:a(["elements","assets","correlated","message"])}),k=c(l);k.events.incomplete.bind(function(a){m.trigger.incomplete(a.elements(),a.assets(),a.correlated(),a.message())});k.events.insert.bind(function(a){m.trigger.insert(a.elements(),
a.assets(),a.correlated())});return{events:m.registry,gordon:function(a,c,e){var s=function(b){k.processRtf(a,c,e,b.rtf(),b.hide())},t=function(h){var l=b.find(a);d.each(l,g.remove);m.trigger.incomplete(f.children(a),c,e,h)},u=function(){var h=b.find(a);d.each(h,g.remove);m.trigger.insert(f.children(a),c,e)},v=function(a){t(a.message())};if(!0===l.allowLocalImages&&!0===l.enableFlashImport){var w=h(l);w.events.response.bind(s);w.events.cancel.bind(u);w.events.failed.bind(v);w.events.error.bind(v);
w.open()}else t("errors.local.images.disallowed")}}}});k("110","13a 13b 13m 13n 10r b 13o 7 s 4m l 3c 2q 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m,k,p,r,q){return function(s,t){var u=b(s,t),v=a(t),w=m(l.none()),x=function(a){w.get().each(function(b){c.call(b,{response:a,bundle:d.nu({})})})};u.events.insert.bind(function(a){x(e.paste(a.elements(),a.assets(),a.correlated()))});u.events.incomplete.bind(function(a){x(e.incomplete(a.elements(),a.assets(),a.correlated(),a.message()))});u.events.error.bind(function(a){a=
a.message();a=e.error(a);x(a)});v.events.insert.bind(function(a){x(e.paste(a.elements(),a.assets(),a.correlated()))});v.events.incomplete.bind(function(a){x(e.incomplete(a.elements(),a.assets(),a.correlated(),a.message()))});return function(a,b){return c.sync(function(d){var m=function(){c.call(d,{response:b.response(),bundle:b.bundle()})},s=function(b,c,s){w.set(l.some(d));var B=k.fromTag("div");p.append(B,b);a.rtf().fold(function(){f.exists(B)?u.gordon(B,c,s):m()},function(a){!0===t.allowLocalImages?
v.processRtf(B,c,s,a,h.noop):(a=f.find(B),g.each(a,r.remove),x(e.incomplete(q.children(B),c,s,"errors.local.images.disallowed")))})};e.cata(b.response(),m,s,m,s)})}}});k("xa","10t 10u 10v 10w 10x 10y 10z 110 c 7 s 2u v 36".split(" "),function(c,d,b,a,e,g,f,h,l,m,k,p,r,q){var s=p.immutable("data","rtf"),t=l.detect(),u=["^image/","file"],v=function(a){var c=a.clipboardData;return b.isValidData(c)?b.getFlavor(c.types,"html").bind(function(b){b=c.getData(b.type);return r.contains(b,"<html")&&(r.contains(b,
'xmlns:o="urn:schemas-microsoft-com:office:office"')||r.contains(b,'xmlns:x="urn:schemas-microsoft-com:office:excel"'))?k.some(s(b,z(a))):k.none()}):k.none()},w=function(a){return s(a,k.none())},x=function(a){if(t.browser.isIE()||t.browser.isFirefox())return k.none();if(b.isValidData(a.clipboardData)){var c=a.clipboardData;return b.getPreferredFlavor(u,c.types).map(function(a){return c.items})}return k.none()},y=function(a,c){var d=b.isValidData(c.clipboardData)?c.clipboardData.types:[];return b.getFlavor(d,
a.clipboardType()).map(function(a){return s(c,k.none())})},B=function(a){return t.browser.isIE()?k.some(q.clipboardData):b.isValidData(a.clipboardData)?k.some(a.clipboardData):k.none()},z=function(a){var c=a.clipboardData;return b.isValidData(c)?b.getFlavor(c.types,"rtf").bind(function(a){a=c.getData(a.type);return 0<a.length?k.some(a):k.none()}):k.none()},A=function(a,b,c,d){return{label:m.constant(a),getAvailable:b,steps:m.constant(c),capture:m.constant(d)}};return{internal:function(a,b,h,l){var k=
m.curry(y,l);return A("Within Textbox.io (tables) pasting",k,[c.normal(f(b,a,h,l,d.ignore)),c.normal(e.fixed(!0,!0)),c.normal(g.internal(h,l))],!1)},pastiche:function(b,l,m,k,n,p,q){return A("Outside of Textbox.io pasting (could be internal but another browser)",w,[c.normal(f(k,m,n,q,d.background)),c.normal(e.fromConfigIfExternal(b,l)),c.normal(g.external(n,q)),c.blocking(h(p,l)),c.normal(a(l))],!1)},gwt:function(a,b,d,f){return A("GWT pasting",v,[c.normal(g.setBundle({isWord:!0})),c.normal(e.fromConfig(b,
d)),c.normal(g.gwt(a)),c.blocking(h(f,d))],!0)},image:function(a){return A("Image pasting",x,[c.normal(!1===a.allowLocalImages?g.noImages(m.noop):g.images())],!0)},text:function(){return A("Plain text pasting",B,[c.normal(g.plain),c.normal(g.autolink)],!0)},none:function(){return A("There is no valid way to paste",k.some,[c.normal(g.none)],!1)}}});k("13p","qd c 1a 1y l 2f 3c".split(" "),function(c,d,b,a,e,g,f){var h=function(a){return e.fromHtml("<p>"+a("cement.dialog.flash.press-escape")+"</p>")};
return{paste:function(b){var g=e.fromTag("div");a.add(g,c.resolve("flashbin-helpcopy"));var k;k=d.detect().os.isOSX()?["\u2318"]:["Ctrl"];var p=e.fromHtml("<p>"+b("cement.dialog.flash.trigger-paste")+"</p>");k=e.fromHtml('<div><span class="ephox-polish-help-kbd">'+k+'</span> + <span class="ephox-polish-help-kbd">V</span></div>');a.add(k,c.resolve("flashbin-helpcopy-kbd"));f.append(g,[p,k,h(b)]);return g},noflash:function(b){var d=e.fromTag("div");a.add(d,c.resolve("flashbin-helpcopy"));var g=e.fromHtml("<p>"+
b("cement.dialog.flash.missing")+"</p>");f.append(d,[g,h(b)]);return d},indicator:function(d){var h=e.fromTag("div");a.add(h,c.resolve("flashbin-loading"));var k=e.fromTag("div");a.add(k,c.resolve("flashbin-loading-spinner"));var p=e.fromTag("p");d=d("loading.wait");g.set(p,d);b.set(p,"aria-label",d);f.append(h,[k,p]);return h}}});da("13q",navigator);k("111","13p qd c 7 1y 2n l 2o 3c 13q".split(" "),function(c,d,b,a,e,g,f,h,l,m){var k=b.detect(),p=function(b,d,e,f){d=c.noflash(f);h.append(b,d);return{reset:a.noop}},
r=function(a,b,d,e){var f=c.paste(e),h=c.indicator(e);l.append(a,[h,f,b.element()]);a=function(){g.set(f,"display","block");g.set(h,"display","none");d()};b.events.spin.bind(function(){g.set(f,"display","none");g.set(h,"display","block");g.remove(h,"height");g.remove(h,"padding");d()});b.events.reset.bind(a);b.events.hide.bind(function(){g.setAll(h,{height:"0",padding:"0"})});return{reset:a}};return function(b,c,g){var h=f.fromTag("div"),l="flashbin-wrapper-"+(k.os.isOSX()?"cmd":"ctrl");e.add(h,d.resolve(l));
var w;try{w=void 0!==(k.browser.isIE()?new ActiveXObject("ShockwaveFlash.ShockwaveFlash"):m.plugins["Shockwave Flash"])}catch(x){w=!1}b=(w?r:p)(h,b,c,g.translations);return{element:a.constant(h),reset:b.reset}}});k("13r","s 54 46 4m 2s 2t".split(" "),function(c,d,b,a,e,g){return{responsive:function(){var f=a(c.none()),h=b.create({crashed:d([]),timeout:d([])});return{start:function(a,b,d,k){var r=b,q=g(function(){d()?e(q):0>=r?(h.trigger.timeout(),e(q)):k()&&(e(q),h.trigger.crashed());r--},a);f.set(c.some(q))},
stop:function(){f.get().each(function(a){e(a)})},events:h.registry}}}});k("13s",["a","b","2s","2t"],function(c,d,b,a){return function(e,g,f){var h=function(a){return d.forall(g,function(b){return c.isFunction(a[b])})},l=!0,m=a(function(){var a=e.dom();c.isFunction(a.PercentLoaded)&&100===a.PercentLoaded()&&h(a)&&(k(),f())},500),k=function(){l&&(b(m),l=!1)};return{stop:k}}});da("13t",unescape);k("112","13r 13s qd b 1o 2z c 4w 7 s 54 46 2m 1y 2n l 2y 2o 2s 6e o 2t 3t 13t 36".split(" "),function(c,d,
b,a,e,g,f,h,l,m,k,p,r,q,s,t,u,v,w,x,y,B,z,A,C){var D=h.install("ephox.flash"),F=f.detect(),E=m.none();return function(f){var h=p.create({response:k(["rtf"]),spin:k([]),cancel:k([]),error:k(["message"]),reset:k([]),hide:k([]),failed:k(["message"])}),m=!1,w=t.fromTag("div");q.add(w,b.resolve("flashbin-target"));var B=c.responsive();B.events.crashed.bind(function(){h.trigger.failed("flash.crashed")});B.events.timeout.bind(function(){h.trigger.failed("flash.crashed")});var K=function(){O.stop();if(!m){m=
!0;try{var a=P.dom();e.each(Q,function(b,c){var d=a[c];if(void 0===d)throw'Flash object does not have the method "'+c+'"';d.call(a,b)});h.trigger.reset();x(W);q.remove(w,b.resolve("flash-activate"));R();T()}catch(c){y.log("Flash dialog - Error during load: ",c)}}},M=D.permanent(K),N=function(){return!r.inBody(P)},S=function(){return!P.dom().SetVariable},Q={setSpinCallback:D.permanent(function(){B.start(1E3,10,N,S);h.trigger.spin()}),setPasteCallback:D.permanent(function(a){B.stop();z(function(){""===
a?h.trigger.error("flash.crashed"):h.trigger.response(A(a))},0)}),setEscapeCallback:D.permanent(h.trigger.cancel),setErrorCallback:D.permanent(function(a){B.stop();h.trigger.error(a)}),setStartPasteCallback:D.permanent(l.noop)},P=function(){var a=f.replace(/^https?:\/\//,"//"),b='    <param name="allowscriptaccess" value="always">    <param name="wmode" value="opaque">    <param name="FlashVars" value="onLoad='+M+'">';if(F.browser.isIE()&&10===F.browser.version.major){var c=g.generate("flash-bin");
return t.fromHtml('<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" id="'+c+'"><param name="movie" value="'+a+'">'+b+"</object>")}return t.fromHtml('<object type="application/x-shockwave-flash" data="'+a+'">'+b+"</object>")}(),R=function(){s.setAll(P,{width:"2px",height:"2px"})};R();var O=d(P,e.keys(Q),K);v.append(w,P);var T=function(){F.browser.isFirefox()&&C.getSelection().removeAllRanges();u.focus(P)},W=null,X=function(){q.add(w,b.resolve("flash-activate"));s.remove(P,"height");s.remove(P,
"width");h.trigger.hide()},V=function(){s.set(w,"display","none");E.each(function(b){a.each(b,function(a){a.unbind()})})};return{focus:T,element:function(){return w},activate:function(){W=z(X,3E3);h.trigger.spin();s.set(w,"display","block");T()},deactivate:V,destroy:function(){V();a.each(e.values(Q),function(a){D.unregister(a)});D.unregister(M);O.stop()},events:h.registry}}});k("xb","111 112 54 46 3u l 36".split(" "),function(c,d,b,a,e,g,f){return function(h,l){var m=l.translations,k=a.create({response:b(["rtf",
"hide"]),cancel:b([]),error:b(["message"]),failed:b(["message"])});return{open:function(){var a=d(l.swf);a.deactivate();var b=g.fromDom(f),q=e.bind(b,"mouseup",a.focus),s=function(){v()},b=function(){v();k.trigger.cancel()};a.events.cancel.bind(b);a.events.response.bind(function(a){k.trigger.response(a.rtf(),s)});a.events.error.bind(function(a){v();k.trigger.error(a.message())});a.events.failed.bind(function(a){v();k.trigger.failed(a.message())});var t=h();t.setTitle(m("cement.dialog.flash.title"));
var u=c(a,t.reflow,l);u.reset();t.setContent(u.element());t.events.close.bind(b);t.show();a.activate();var v=function(){q.unbind();a.destroy();t.destroy()}},events:k.registry}}});k("13u",["7","1b"],function(c,d){return function(b,a,e,g){var f=d.eq(b,e)&&a===g;return{startContainer:c.constant(b),startOffset:c.constant(a),endContainer:c.constant(e),endOffset:c.constant(g),collapsed:c.constant(f)}}});k("113",["13u","l","2o","2q","2a"],function(c,d,b,a,e){return function(g){var f=d.fromTag("br");return{cleanup:function(){a.remove(f)},
toOn:function(a,b){a.dom().focus()},toOff:function(a,d){var m;m=e.owner(d).dom().defaultView;m.focus();b.append(d,f);g.set(m,c(f,0,f,0))}}}});k("114",["7"],function(c){return function(){return{toOn:function(c,b){c.dom().focus()},toOff:function(c,b){b.dom().focus()},cleanup:c.identity}}});k("150","b l 2o 3c 2q 2a".split(" "),function(c,d,b,a,e,g){var f=function(f,l){var m=g.children(f);c.each(m,function(c){if(l(c)){var f=g.children(c),h=d.fromTag("div",g.owner(c).dom());a.append(h,f);b.before(c,h);
e.remove(c)}})};return{consolidate:function(b,c){g.nextSibling(b).filter(c).each(function(c){var d=g.children(c);a.append(b,d);e.remove(c)});f(b,c)}}});k("151",["4g"],function(c){return{resolve:c.create("ephox-sloth").resolve}});k("13v","2z 2u 150 151 1a 1y 4b 2n bl l 2f 2o 2q 31 2a".split(" "),function(c,d,b,a,e,g,f,h,l,m,k,p,r,q,s){var t=a.resolve("bin"),u=t+c.generate(""),v=l.onDirection("-100000px","100000px");return function(a){var c=m.fromTag("div");e.setAll(c,{contenteditable:"true","aria-hidden":"true"});
h.setAll(c,{position:"fixed",top:"0px",width:"100px",height:"100px",overflow:"hidden",opacity:"0"});f.add(c,[t,u]);var l=function(a){return g.has(a,u)};return{attach:function(a){r.empty(c);h.set(c,"left",v(a));p.append(a,c)},focus:function(){q.ancestor(c,"body").each(function(b){a.toOff(b,c)})},contents:function(){b.consolidate(c,l);var a=d.immutable("elements","html","container"),e=s.children(c),f=k.get(c);return a(e,f,c)},container:function(){return c},detach:function(){r.remove(c)}}}});k("115",
"7 eh 54 46 10s 13v 2a".split(" "),function(c,d,b,a,e,g,f){return function(h,l){var m=g(h),k=function(){h.cleanup();var a=m.contents();m.detach();r.trigger.after(a.elements(),a.html(),m.container())},p=d.tap(function(){r.trigger.before();m.attach(l);m.focus();e.run(f.owner(l),p,k)}),r=a.create({before:b([]),after:b(["elements","html","container"])}),q=c.noop;return{instance:c.constant(function(){p.instance()}),destroy:q,events:r.registry}}});k("xc","c 7s 54 46 113 114 115 21".split(" "),function(c,
d,b,a,e,g,f,h){var l=c.detect(),m={set:function(a,b){d.setExact(a,b.startContainer(),b.startOffset(),b.endContainer(),b.endOffset())}},k=function(a){return(l.browser.isIE()&&"body"!==h.name(a)?g:e)(m)};return function(c){var d=a.create({after:b(["container"])}),e=k(c),g=f(e,c);g.events.after.bind(function(a){e.toOn(c,a.container());d.trigger.after(a.container())});return{run:function(){g.instance()()},events:d.registry}}});k("116","c 4w 7 r s 13w 2m 2n 3u l 2o 2p 2q".split(" "),function(c,d,b,a,e,
g,f,h,l,m,k,p,r){var q=d.install("ephox.keurig.init"),s=e.none();c=c.detect();var t=c.browser;return{load:t.isIE()||t.isSpartan()||c.deviceType.isiOS()||c.deviceType.isAndroid()?b.noop:a.cached(function(a){var b=m.fromTag("div");if(void 0===a)throw"baseUrl was undefined";var c=m.fromTag("iframe");h.setAll(b,{display:"none"});var d=l.bind(c,"load",function(){var f=q.ephemeral(function(a){s=e.some(a);t.isSafari()||r.remove(b)});g.write(c,'<script type="text/javascript" src="'+(a+"/wordimport.js")+'">\x3c/script><script type="text/javascript">function gwtInited () {parent.window.'+
f+"(com.ephox.keurig.WordCleaner.cleanDocument);};\x3c/script>");d.unbind()});p.execute(function(){k.append(f.body(),b);k.append(b,c)})}),cleanDocument:function(a,b){return s.map(function(c){return c(a,b)})},ready:function(){return s.isSome()}}});k("xd",["116"],function(c){return function(d){c.ready()||c.load(d);return{cleanDocument:c.cleanDocument}}});k("qw","x9 xa xb xc b 2z xd 7 s".split(" "),function(c,d,b,a,e,g,f,h,l){return function(m,k,p,r){var q=f(r.baseUrl),s=h.curry(b,k),t=void 0!==r.intraFlag?
r.intraFlag:{clipboardType:g.generate("clipboard-type"),findClipboardTags:l.none},q=e.flatten([void 0!==r.intraFlag?[d.internal(p,a,m,t)]:[],[d.gwt(q,k,r,s)],[d.image(r)]]);m=d.pastiche(k,r,p,a,m,s,t);return c(q,m)}});k("qx",["x9","xa"],function(c,d){return function(){return c([d.text()],d.none())}});k("qy","b 7v g2 8h gp dv 7 g3 g4 33 54 46 4m 1a 1y l 3c 2q 3t".split(" "),function(c,d,b,a,e,g,f,h,l,m,k,p,r,q,s,t,u,v,w){return function(x,y){return function(B){var z=p.create({close:k([])}),A=h(x);
A.events.close.bind(function(){z.trigger.close()});s.add(A.element(),m.resolve("external-dialog"));B&&s.add(A.element(),m.resolve("dialog-vertical-controls"));var C=t.fromTag("div"),D=r([]),F=function(a){var b=e();if(void 0===a.text)throw"dialog button did not specify text";b.content(g(a.text));d.button(b.element(),a.text);void 0!==a.tabindex&&q.set(b.element(),"tabindex",a.tabindex);void 0!==a.className&&s.add(b.element(),a.className);void 0!==a.click&&b.events.click.bind(a.click);s.add(b.element(),
m.resolve("dialog-button"));return b};return{element:A.element,events:z.registry,setTitle:A.setTitle,setContent:A.setContent,setButtons:function(a){v.empty(C);a=c.map(a,F);u.append(C,c.map(a,function(a){return a.element()}));D.set(a);A.setControls(C)},reflow:f.noop,show:function(){y.hideInlineSelection();A.show();var d=c.map(D.get(),function(c){return a.button(c.element(),b.button({execute:l.click}))}),e=a.multipleAll(A.element(),d);e.events.exit.bind(function(){z.trigger.close()});w(function(){e.enter()},
0)},destroy:function(){c.each(D.get(),function(a){a.destroy()});D.set([]);A.destroy()}}}}});k("qz",["9"],function(c){return function(d,b,a){var e={"errors.imageimport.unsupported":"errors.images.import.unsupported","errors.imageimport.invalid":"errors.images.import.invalid"};return{baseUrl:a.baseUrl,enableFlashImport:a.enableFlashImport,swf:a.swf,officeStyles:a.officeStyles,htmlStyles:a.htmlStyles,translations:function(a){var b=c.prototype.slice.call(arguments,1);return d.translate.apply(void 0,[void 0!==
e[a]?e[a]:a].concat(b))},allowLocalImages:a.allowLocalImages,intraFlag:b}}});k("il","qw qx qy 73 qz if".split(" "),function(c,d,b,a,e,g){var f=function(d,f,m,k){var p=b(d.uiContainer(),k),r=function(a){f.filterDom(f.paste(),a)},q=e(a,g.intraFlag(),m);return function(a){return c(a,p,r,q)}};return function(a,b,c,e){return!0===c.forceText?d:f(a,b,c,e)}});k("au","ii b 3m c 7 s ij ik az bt 8o if il 8p 54 46 ca 1a 2m 1b l 3c 6m 2a v".split(" "),function(c,d,b,a,e,g,f,h,l,m,k,p,r,q,s,t,u,v,w,x,y,B,z,A,C){return function(e,
w,x,G){var H=a.detect(),I=e.filter(),L=e.content(),J=e.undo(),K=e.smartview(),M=e.region(),N=e.internalevents(),S=r(K,I,G,L),Q=g.none(),P=t.create({analytics:s(["message"])}),R=function(a){O(a.message())},O=function(a){q.getOrLog(a,[]).each(function(a){a=m(a);e.ui().displayBanner(a)});T()},T=function(){b.unblock();L.focus()};I.add(I.history(),c.binStyle(),u.remove);!1===G.allowLocalImages&&I.addSelector(I.paste(),"img[src]",function(a){a=d.filter(a,function(a){a=v.get(a,"src");return C.startsWith(a,
"data")||C.startsWith(a,"blob")});0!==a.length&&(O("errors.local.images.disallowed"),u.remove(a))});if(H.os.isiOS()&&H.browser.isSafari()){var W=H.deviceType.isWebView()?"webview.imagepaste":"safari.imagepaste";I.addSelector(I.paste(),'img[src^="webkit-fake-url"]',function(a){0!==a.length&&(O(W),u.remove(a))})}L.events.ready.bind(function(a){var c=l.get(L,K,a.api().doc()),e=h.rules(L,M,c),m=f(L),q=a.api(),r=S(q.body());Q=g.some(r);q.events.paste.bind(function(a){q.getSelection().filter(function(a){return d.forall(p.ignoreSelectors(),
function(b){return!1===z.ancestor(a.startContainer(),b,L.isRoot)})}).each(function(c){r.isBlocked()||(m.backup(),b.block());r.paste(a.original().raw())})});r.events.cancel.bind(function(){T();m.cancel()});var s=k.processResults(O);r.events.error.bind(R);r.events.insert.bind(function(a){x.correlated(a.correlated()).map(s).get(function(b){T();J.save();var c=y.fromTag("div");B.append(c,a.elements());I.filterDom(I.input(),c);c=A.children(c);m.insert(c,[e.collapsed()],[e.ranged()]);N.input(c);L.domChanged();
P.trigger.analytics("paste_action");w.pasteUpload();w.uploadAssets(b)})})});return{destroy:function(){Q.each(function(a){a.destroy()})},events:P.registry}}});k("5z",["at","au"],function(c,d){return function(b,a,e,g){var f=c(b,g.copy),h=d(b,a,e,g.paste);return{destroy:function(){f.destroy();h.destroy()}}}});k("r0",["b","1o","w"],function(c,d,b){var a=function(a){for(var c=[],d=a.start.charCodeAt(0);d<=a.finish.charCodeAt(0);d++)c.push(b.fromCharCode(d));return c},e=function(a){return{start:a,finish:a}};
return function(){var b={latin:[{start:"A",finish:"Z"},{start:"a",finish:"z"},{start:"\u00c0",finish:"\u00ff"}],punctuation:[{start:"!",finish:"/"},{start:":",finish:"@"},{start:"[",finish:"`"},{start:"{",finish:"~"},{start:"\u00a1",finish:"\u00bf"},{start:"\u2010",finish:"\u2027"},{start:"\u2030",finish:"\u205e"}],currency:[e("$"),{start:"\u00a2",finish:"\u00a5"},{start:"\u20a0",finish:"\u20bd"},e("\u5186"),e("\u5143"),e("\u5713"),e("\u5706")],"extended-latin-a":[{start:"\u0100",finish:"\u017f"}],
"extended-latin-b":[{start:"\u0180",finish:"\u024f"}],arrows:[{start:"\u2190",finish:"\u21ff"},e("\u2794"),{start:"\u2798",finish:"\u27af"},{start:"\u27b1",finish:"\u27be"}],mathematical:[{start:"\u2795",finish:"\u2797"},{start:"\u2200",finish:"\u22ff"}],miscellaneous:[{start:"\u2701",finish:"\u275e"},{start:"\u2761",finish:"\u2793"},e("\u27b0"),e("\u27bf")]},f={};d.each(b,function(b,d,e){f[d]=c.bind(b,a)});return f}});k("r1","4z 7 g5 33 46 47 1y l 3c".split(" "),function(c,d,b,a,e,g,f,h,l){return{controls:function(h){var k=
h+"-";h=c.div();f.add(h,a.resolve(k+"dialog-controls"));var p=b.button(k,"cancel","button.cancel"),r=b.button(k,"insert","specialchar.insert");b.makeNormal(p.element());b.makeDefault(r.element());l.append(h,[p.element(),r.element()]);k=e.create({insert:g([],r.events.click),cancel:g([],p.events.click)});return{element:d.constant(h),ok:d.constant(r),cancel:d.constant(p),destroy:function(){r.destroy();p.destroy()},events:k.registry}}}});k("r2","b 1o wt ga gb 73 33 1a 1y 4b l 2o 3c 1s 36".split(" "),
function(c,d,b,a,e,g,f,h,l,m,k,p,r,q,s){var t=function(a){var c=k.fromTag("span");l.add(c,f.resolve("special-char"));var d=k.fromHtml(a);h.setAll(c,{"data-ephox-polish-special-char":a,"data-ephox-polish-char-code":a.charCodeAt(0).toString(16),tabindex:"-1"});b.gridcell(c);p.append(c,d);return c},u=function(a,d){var e=k.fromTag("div");m.add(e,[f.resolve("special-char-row"),f.resolve("special-char-row-"+d)]);b.row(e);c.each(a,function(a){p.append(e,t(a))});return e},v=function(a,d,e){var h=k.fromTag("div");
l.add(h,f.resolve(d));b.base(h,g.translate("specialchar.grid"));a=c.chunk(a,e);a=c.map(a,function(a){return u(a,d)});r.append(h,a);return h};return{generateItems:function(b){var c=600>=q.min(s.innerWidth,s.innerHeight)?12:16;return d.mapToArray(b,function(b,d){var f=v(b,d,c);return e(g.translate("specialchar."+d),a(f))})}}});k("im","b 3m g2 8h gc 7 r0 g3 g4 l2 ot 73 r1 r2 33 54 46 1a 1y 3u 2y 2o 6m 31 2a 32".split(" "),function(c,d,b,a,e,g,f,h,l,m,k,p,r,q,s,t,u,v,w,x,y,B,z,A,C,D){var F=function(c){var d=
{item:g.constant(".ephox-pastry-statebutton.ephox-pastry-tablayout-item")},e=b.flow({trigger:l.button,executeOnArrow:!0});return a.flow(c.menu(),d,e)},E=function(a){return z.closest(a,".ephox-pastry-tablayout-active")},G=function(c){var d={row:g.constant(".ephox-pastry-tablayout-active ."+s.resolve("special-char-row")),cell:g.constant(".ephox-pastry-tablayout-active ."+s.resolve("special-char"))},e=b.tabular({trigger:l.click,isValid:E});return a.tabular(c.body(),d,e)};return function(g){var z=u.create({insert:t(["string"]),
close:t([])}),E=h(g);g=f();g=q.generateItems(g);var J=m.input("specialchar","specialchar.selects"),K=k(e.left(),g,s.resolve("specialchars"));w.add(K.body(),s.resolve("specialchar-body"));w.add(E.element(),s.resolve("specialchar-dialog"));c.each(C.children(K.element()),d.register);var M=x.bind(E.element(),"click",function(a){a=a.target();A.closest(a,"[data-ephox-polish-special-char]").each(function(a){y.focus(a);var b=v.get(a,"data-ephox-polish-special-char");a=J.input();b=D.get(a)+b;D.set(a,b)})}),
N=r.controls("specialchar");E.setTitle(p.translate("specialchar.dialog"));E.setContent(K.element());E.setControls(N.element());B.after(K.element(),J.element());g=function(){E.hide();D.set(J.input(),"");z.trigger.close()};var S=F(K),Q=G(K),P=l.setup(E,N,[S,Q,a.input(J.input(),b.input({}))]);K.events.setActive.bind(function(a){S.clickFocus(a.item().element())});E.events.close.bind(function(){P.exit();z.trigger.close()});N.events.cancel.bind(g);E.events.close.bind(g);N.events.insert.bind(function(){z.trigger.insert(D.get(J.input()))});
return{element:E.element(),events:z.registry,open:function(){E.show();P.enter()},destroy:function(){M.unbind();E.destroy();K.destroy();N.destroy();P.destroy()},close:function(){E.hide();D.set(J.input(),"")}}}});k("av",["im","54","46","47"],function(c,d,b,a){return function(e,g){var f=c(g),h=b.create({insert:a(["string"],f.events.insert),close:d([])}),l=function(){h.trigger.close();f.close()};f.events.close.bind(l);return{show:function(){e.toReading();f.open()},close:l,destroy:function(){f.events.close.unbind(l);
f.destroy()},events:h.registry}}});k("60","97 7 7u 71 73 av 6t l".split(" "),function(c,d,b,a,e,g,f,h){return function(l){var m=l.content(),k=l.smartview(),p=function(a){a=h.fromText(a.string());b.insertAtCursor(m,[a]).each(function(a){a=c.after(a.element());m.setRelativeSelection(a,a);m.focus();m.toEditing()})},r=a.destroyable(),q=function(){r.clear()};return{ui:f.ui({"specialchar.general":{toggle:!1,value:"specialchar",textkey:e.key("specialchar.open"),action:function(){var a=g(m,k.uiContainer());
r.set(a);a.events.close.bind(function(){m.focus();q()});a.events.insert.bind(function(a){p(a);q()});l.content().hideInlineSelection();a.show()},updateGeneral:d.noop,icon:!0,shortcut:!1,hasPopup:!1,hasDialog:!0}}),destroy:q}}});k("aw","7 s 6n 73 bq 6s 6t 74 1a".split(" "),function(c,d,b,a,e,g,f,h,l){return function(m,k,p,r,q){var s=m.content(),t=m.profile().nativeSpelling(),u=function(a){l.set(a,"spellcheck","false")},v=function(a){l.set(a,"spellcheck","true")};s.runOrOnLoaded(function(){var a=t.get()?
v:u;s.body().each(a)});m=f.ui({"spelling.general":{toggle:!0,value:"spellcheck",textkey:a.key("cog.spellcheck"),action:function(){var a=!t.get();t.setAndCache(a);a=a?v:u;s.body().each(a)},updateGeneral:function(a){(t.get()?a.select:a.deselect)()},icon:!0,tooltip:h.get}});return e({events:b(["analytics"]),init:c.noop,hasDropdown:c.constant(!1),hasAutocorrect:c.constant(!1),check:c.noop,scanView:c.noop,lock:c.apply,situation:g.noSituation,handle:c.noop,assign:c.noop,destroy:function(){s.body().each(function(a){l.remove(a,
"spellcheck")})},state:c.constant({}),ui:m,lookup:c.constant(d.none()),name:c.constant("spelling-disabled")})}});k("in",["eg","4n","lf"],function(c,d,b){var a=d.generate([{single:["element"]},{range:["start","soffset","finish","foffset"]}]);return{cata:function(a,b,c){return a.fold(b,c)},single:a.single,range:function(d,g,f,h){var l=b.after(f,h,d,g),m=l?c.point(d,g):c.point(f,h);d=l?c.point(f,h):c.point(d,g);return a.range(m.element(),m.offset(),d.element(),d.offset())}}});k("xe",["2u"],function(c){return c.immutable("suggestions",
"ignore")});k("xf",["5b","68"],function(c,d){return{clean:function(b){var a=new d(c.zeroWidth(),"g"),e=new d("[\u2018\u2019]","g");return b.replace(a,"").replace(e,"'")}}});k("r3",["xe","xf","1o","s"],function(c,d,b,a){return function(e){var g={},f=function(a){return g.hasOwnProperty(a)&&void 0!==g[a]?g[a]:{}},h=function(a,b){var c=f(a);b(c);g[a]=c},l=function(a,b){var c=f(a);return b(c)},m=function(b,e,f){h(b,function(b){var g=d.clean(e);b.hasOwnProperty(g)&&void 0!==b[g]||(b[g]=c(a.some(f),!1))})},
k=function(b,e){h(b,function(b){var f=d.clean(e),g=b.hasOwnProperty(f)?b[f]:void 0,g=void 0!==g?g.suggestions():a.none(),g=c(g,!0);b[f]=g})};b.each(void 0!==e?e:{},function(a,c){b.each(a,function(a,b){!0===a.ignore&&k(c,b);void 0!==a.suggestions&&m(c,b,a.suggestions)})});return{add:m,get:function(b,c){return l(b,function(b){var e=d.clean(c);return b.hasOwnProperty(e)?a.from(b[e]):a.none()})},ignore:k,suggestions:function(b,c){return l(b,function(b){var e=d.clean(c);return(b.hasOwnProperty(e)?a.from(b[e]):
a.none()).bind(function(a){return a.suggestions()})})},state:function(){return b.map(g,function(a,c){return b.map(a,function(a,b){return{ignore:a.ignore(),suggestions:a.suggestions().getOr([])}})})},destroy:function(){g={}}}}});k("io",["r3"],function(c){return function(d){return c(d)}});k("iq",["ca","1y"],function(c,d){return{configure:function(b){b.add(b.internal(),"ephox-cram-annotation-wrap",c.unwrap);b.add(b.output(),"ephox-cram-annotation-wrap",c.unwrap);b.add(b.paste(),"ephox-cram-annotation-wrap",
c.unwrap)},isWrap:function(b){return d.has(b,"ephox-cram-annotation-wrap")}}});k("66","b 6 2k 7 s 73".split(" "),function(c,d,b,a,e,g){var f={en_au:"en_gb",en_bz:"en_gb",en_ca:"en_gb",en_gb:"en_gb",en_ie:"en_gb",en_in:"en_gb",en_jm:"en_gb",en_my:"en_gb",en_nz:"en_gb",en_ph:"en_gb",en_sg:"en_gb",en_tt:"en_gb",en_za:"en_gb",en_zw:"en_gb",en_us:"en_us",en:"en_us"},h="da de en en_au en_br en_gb en_uk en_us es fi fr it nb nl pt pt_pt sv".split(" "),l=function(b,c){return{value:a.constant(b),textkey:a.constant(c),
icon:e.none}};return{determine:function(a){if("no.language"===a)a=e.some(a);else{var g=d.merge(b.localeList(),f);a=b.determineFrom(a,g);a=""!==a&&c.contains(h,a)?e.some(a):e.none()}return a},get:function(){return[l("no.language",g.key("spelling.none")),l("en_us",g.key("parlance.en_us")),l("en_gb",g.key("parlance.en_gb")),l("da",g.key("parlance.da")),l("de",g.key("parlance.de")),l("es",g.key("parlance.es")),l("fi",g.key("parlance.fi")),l("fr",g.key("parlance.fr")),l("it",g.key("parlance.it")),l("nb",
g.key("parlance.no")),l("nl",g.key("parlance.nl")),l("pt",g.key("parlance.pt_br")),l("pt_pt",g.key("parlance.pt_pt")),l("sv",g.key("parlance.sv"))]},isOn:function(a){return"no.language"!==a},offKey:a.constant("no.language")}});k("ir","7 s 73 66 6t 7a 54 46 v".split(" "),function(c,d,b,a,e,g,f,h,l){var k=function(e,f){var h=a.get();return{"spelling.dropdown":{name:"spellcheck",textkey:b.key("spelling.menu"),menuTextkey:"",updateDropdown:function(a){a.populate([{label:d.none,items:c.constant(h)}]);
var b=e.profile().spelling().get();g.on(b).fold(a.untick,c.noop,a.tick)},action:function(a){e.profile().spelling().setAndCache(a);l.startsWith(a,"en")||e.profile().autocorrect().set(!1);f.trigger.change(a)},values:h,render:d.none(),describe:function(a){return b.key("spelling.menu")},hasPopup:!0,toggle:!1}}},n=function(c,d,e){var f=c.profile().spelling().get()!==a.offKey();return{"spelling.general":{toggle:!0,value:"spellcheck",textkey:b.key("cog.spellcheck"),action:function(){var b=(f=!f)?d:a.offKey();
c.profile().spelling().setAndCache(b);e.trigger.change(b)},updateGeneral:function(a){f?a.select():a.deselect()},icon:!1}}};return function(a,b,d){var g=h.create({change:f(["language"])});a=d?k(a,g):n(a,b,g);return{ui:e.ui(a),hasDropdown:c.constant(d),events:g.registry}}});k("xg",["s","2u"],function(c,d){var b=d.immutable("area","f");return function(){var a=[],d=!1,g=function(){d=!0;c.from(a.shift()).fold(function(){d=!1},function(a){a.f()(a.area(),g)})};return{enqueue:function(c,h){a.push(b(c,h));
d||g()},destroy:function(){a=[]}}}});k("15t",["7"],function(c){return{stop:c.constant("trampoline.stop"),run:function(c){for(;"trampoline.stop"!==c;)c=c()}}});k("154","s i7 9z 15t 153 4n".split(" "),function(c,d,b,a,e,g){var f=g.generate([{inline:["item","mode","lang"]},{text:["item","mode"]},{empty:["item","mode"]},{boundary:["item","mode","lang"]},{concluded:["item","mode"]}]),h=function(a,b,d,e){var g=a.property().isElement(b)?c.from(a.attrs().get(b,"lang")):c.none();return a.property().isText(b)?
f.text(b,d):e(b,d)?f.concluded(b,d):a.property().isBoundary(b)?f.boundary(b,d,g):a.property().isEmptyTag(b)?f.empty(b,d):f.inline(b,d,g)},l=function(a,b,c,e){return d.walk(a,b,c,d.walkers().right(),void 0).fold(function(){return f.concluded(b,c)},function(b){return h(a,b.item(),b.mode(),e)})},k=function(c,e,f,g,h,l){return function(){return e.fold(function(a,b,e){(b===d.advance?g.openInline:g.closeInline)(e,a);return n(c,a,b,f,g,h,l)},function(b,d){var e=h(c,b);g.addDetail(e);return f(b,d)?a.stop():
n(c,b,d,f,g,h,l)},function(a,b){g.addEmpty(a);return n(c,a,b,f,g,h,l)},function(e,k,m){var r=l.assess(e);return b.cata(r,function(b){return k!==d.backtrack?n(c,e,d.sidestep,f,g,h,l):a.stop()},function(a){(k===d.advance?g.openBoundary:g.closeBoundary)(m,e);return n(c,e,k,f,g,h,l)},function(b){return a.stop()})},function(b,c){return a.stop()})}},n=function(a,b,c,d,e,f,g){b=l(a,b,c,d);return k(a,b,d,e,f,g)};return{walk:function(b,c,f,g,l,n){var v=function(a,c){return b.eq(a,f)&&(c!==d.advance||b.property().isText(a)||
0===b.property().children(a).length)},w=e.nu(g),x=h(b,c,d.advance,v);a.run(function(){return k(b,x,v,w,l,n)});return w.done()}}});k("155",["b","7","zi","2u"],function(c,d,b,a){var e=a.immutableBag(["elements","lang","words"],[]);return{fromWalking:function(a,f){var h=c.map(f,function(a){var d=a.details();a=a.lang();var f=c.map(d,function(a){return a.text()}).join(""),d=c.map(d,function(a){return a.item()}),f=b.words(f);return e({lang:a,words:f,elements:d})});return{zones:d.constant(h)}}}});k("13x",
"7 s lz 14f 152 153 154 155".split(" "),function(c,d,b,a,e,g,f,h){var l=function(a,b,c,e,h,l){return(a.eq(b,c)?d.some(b):a.property().parent(b)).map(function(d){d=g.calculate(a,d).getOr(e);return f.walk(a,b,c,d,h,l)})},k=function(a,c,e,f,g,k){c=b.subset(a,c,e).bind(function(b){return 0===b.length?d.none():l(a,b[0],b[b.length-1],f,g,k)}).getOr([]);return h.fromWalking(a,c)},n=function(a,b){return function(c,d){return c.eq(d,a.item())?a:c.eq(d,b.item())?b:e.detail(c,d)}},p=function(){return{zones:c.constant([])}};
return{fromRange:function(b,d,e,f,g){d=a.getEdges(b,d,e,c.constant(!1));e=n(d.left(),d.right());return k(b,d.left().item(),d.right().item(),f,e,g)},transformEdges:n,fromBounded:function(a,b,c,d,f){return k(a,b,c,d,e.detail,f)},fromBoundedWith:k,fromInline:function(b,c,d,e){c=a.byBoundary(b,c);var f=n(c.left(),c.right());return c.isEmpty()?p():k(b,c.left().item(),c.right().item(),d,f,e)},empty:p}});k("117",["7","lm","13x"],function(c,d,b){var a=function(a,c,d,l){return a.property().isBoundary(c)?b.fromBounded(a,
c,c,d,l):a.property().isEmptyTag(c)?e():b.fromInline(a,c,d,l)},e=function(){return b.empty()};return{single:a,range:function(c,e,h,l,k,n,p){e=d.toLeaf(c,e,h);l=d.toLeaf(c,l,k);return c.eq(e.element(),l.element())?a(c,e.element(),n,p):b.fromRange(c,e.element(),l.element(),n,p)},empty:e}});k("xh",["dy","117"],function(c,d){var b=c();return{single:function(a,c,g){return d.single(b,a,c,g)},range:function(a,c,g,f,h,l){return d.range(b,a,c,g,f,h,l)},empty:function(){return d.empty()}}});k("r4","in xg 7 xh 4m 2m".split(" "),
function(c,d,b,a,e,g){return function(f,h){var l=e(f),k=d(),n=function(b,d,e,f){e=c.cata(e,function(b){return g.inBody(b)?a.single(b,l.get(),h):a.empty()},function(b,c,d,e){return g.inBody(b)&&g.inBody(d)?a.range(b,c,d,e,l.get(),h):a.empty()});d(b,e,l.get(),f)};return{run:function(a,c,d){n(a,c,d,b.identity)},setLang:l.set,schedule:function(a,b,c,d){k.enqueue(c,function(c,e){void 0!==d&&d()?e():n(a,b,c,e)})},destroy:function(){k.destroy()}}}});k("xi",["b","1o","7"],function(c,d,b){return{update:function(a,
b,g){var f=d.keys(g);c.each(f,function(c){a.add(b,c,g[c])});return f},getInCache:function(a,d,g){return c.filter(g,function(c){return a.get(d,c.word()).fold(b.constant(!1),function(a){return a.suggestions().isSome()})})}}});k("16o",["7","9z"],function(c,d){return{anything:c.constant({assess:d.inView})}});k("16e","s lm 16o 14f 152 153 13x".split(" "),function(c,d,b,a,e,g,f){var h=b.anything(),l=function(a,b,d,e,g,l){a=f.fromBoundedWith(a,b,d,e,l,h).zones();1===a.length?(a=a[0],g=a.lang()===g?c.some(a):
c.none()):g=c.none();return g},k=function(a,b,c,d,f){return l(a,b,c,d,f,e.detail)};return{fromRange:function(b,c,d,e,h){var k=g.strictBounder(e,h);c=a.getEdges(b,c,d,k);d=f.transformEdges(c.left(),c.right());return l(b,c.left().item(),c.right().item(),e,h,d)},fromBounded:k,fromInline:function(b,c,e,h){var s=g.strictBounder(e,h),s=a.getEdges(b,c,c,s),t=f.transformEdges(s.left(),s.right());s.isEmpty()?(t=b.property().isText(c)?b.property().getText(c):b.property().children(c).length,s=d.toLeaf(b,c,0),
c=d.toLeaf(b,c,t),b=k(b,s.element(),c.element(),e,h)):b=l(b,s.left().item(),s.right().item(),e,h,t);return b},empty:function(){return c.none()}}});k("15u",["lm","16e"],function(c,d){var b=function(a,b,c,f){return a.property().isBoundary(b)?d.fromBounded(a,b,b,c,f):a.property().isEmptyTag(b)?d.empty():d.fromInline(a,b,c,f)};return{single:b,range:function(a,e,g,f,h,l,k){e=c.toLeaf(a,e,g);f=c.toLeaf(a,f,h);return a.eq(e.element(),f.element())?b(a,e.element(),l,k):d.fromRange(a,e.element(),f.element(),
l,k)}}});k("156",["dy","15u"],function(c,d){var b=c();return{single:function(a,c,g){return d.single(b,a,c,g)},range:function(a,c,g,f,h,l){return d.range(b,a,c,g,f,h,l)}}});k("13y","b s 156 21 6h ak 2a".split(" "),function(c,d,b,a,e,g,f){var h=function(b){return c.bind(b,function(b){return e.descendants(b,a.isText)})};return{textnodes:h,text:function(b){b=h(b);return c.map(b,function(b){return a.isText(b)?g.get(b):""}).join("")},parsed:function(a,c,e){return d.from(a[0]).bind(function(a){return b.single(a,
c,e).bind(function(a){a=a.words();return 1===a.length?d.some(a[0]).map(function(a){return a.word()}):d.none()})})},children:function(a){return c.bind(a,f.children)}}});k("118","b 13y s 3c 2q ak".split(" "),function(c,d,b,a,e,g){return{clobber:function(f,h){var l=d.children(f),k=d.textnodes(f);return b.from(f[0]).bind(function(d){a.before(d,l);d=b.from(k[0]);d.each(function(a){g.set(a,h)});c.each(k.slice(1),function(a){g.set(a,"")});c.each(f,e.remove);return d})}}});k("119","109 136 137 7 s h3 1a 1y l".split(" "),
function(c,d,b,a,e,g,f,h,l){var k=d.resolve("annotation"),n=d.resolve("lingo"),p=b.resolve("annotation-wrap");return{nu:function(){var a=l.fromTag("span");h.add(a,p);f.set(a,"aria-invalid","spelling");return g.nu(a)},set:function(a,b,c){f.set(a,k,c);f.set(a,n,b)},label:a.constant(p),detail:function(b){return c.id(b).bind(function(c){return e.from(f.get(b,k)).bind(function(d){return e.from(f.get(b,n)).map(function(b){return{id:a.constant(c),word:a.constant(d),lang:a.constant(b)}})})})}}});k("11a",
["b","109","137","1y"],function(c,d,b,a){var e=b.resolve("wrap-disabled");return{enable:function(b){b=d.all(b);c.each(b,function(b){a.remove(b,e)})},disable:function(b){b=d.all(b);c.each(b,function(b){a.add(b,e)})}}});k("13z",["2u"],function(c){return c.immutable("id","elements","word","lang")});k("140",[],function(){var c=function(c){return{fold:c}};return{success:function(d){return c(function(b,a){a(d)})},fail:function(d){return c(function(b,a){b(d)})}}});k("11b","b 1o 13z 140 109 13y 2m".split(" "),
function(c,d,b,a,e,g,f){var h=function(a,d){var g={};c.each(a,function(a){e.marker(a,d.label()).filter(f.inBody).each(function(a){d.detail(a).each(function(c){var d=c.id(),f=c.word();c=c.lang();var h=e.all(a);0<h.length&&(g[d]=b(d,h,f,c))})})});return g},l=function(a,b,c,d){var e=g.text(a);a=g.parsed(a,c,d);return e===b&&a.is(b)},k=function(b,e,f){b=d.values(b);return c.map(b,function(b){return b.lang()===f&&l(b.elements(),b.word(),e,b.lang())?a.success(b):a.fail(b)})};return{validate:l,verify:function(a,
b,d,e,f){b=h(a.elements(),b);a=k(b,f,a.lang());c.each(a,function(a){var b=function(a){return function(b){c.each(b.elements(),a)}};a.fold(b(e),b(d))})}}});k("xn","b 118 119 wc 109 11a wd 11b 7 h3 2q".split(" "),function(c,d,b,a,e,g,f,h,l,k,n){var p=function(a){return e.marker(a,b.label())};return{highlight:function(d,l,p,t){h.verify(l,b,g.enable,n.unwrap,d.lang());p=f.matchWords(l.elements(),p,t);p=f.annotates(p,b.label());return c.bind(p,function(f){return f.current().fold(function(){var g=f.match(),
h=g.word();if(d.ignore(g))return[];g=k.wrapper(g.elements(),b.nu)||[];c.each(g,function(a){e.set(a,f.id());b.set(a,l.lang(),h)});return[a.created(g)]},function(b){return[a.preserved(b)]})})},marker:p,substitute:function(a,b){var c=p(a).fold(l.constant([]),e.all);return d.clobber(c,b)},detail:function(a){return b.detail(a)}}});k("xj",["b","xn","7"],function(c,d,b){return{highlight:function(a,e,g,f){var h={operation:a,internal:a,ignore:b.constant(!1),lang:b.constant(f)},l=c.map(g,function(a){return a.word()}),
k=c.filter(l,function(a,b){return c.indexOf(l,a)===b});h.operation(function(){d.highlight(h,e,k,b.constant(!1))})}}});k("xk","xi xf b 3s 7 p n".split(" "),function(c,d,b,a,e,g,f){var h=function(c,h){return a.nu(function(a){var k={words:b.map(c.words(),function(a){return d.clean(a.word())})};h.correction(k,c.lang(),function(b){b=g.value({spelling:e.constant(b),zone:e.constant(c)});a(b)},function(b){b=g.error(new f(b));a(b)})})};return{scan:function(f,g,k){var p=function(a){var g=a.zone(),h=c.update(f,
g.lang(),a.spelling());a=b.filter(g.words(),function(a){a=d.clean(a.word());return b.contains(h,a)});return{zone:e.constant(g),words:e.constant(a)}};k=b.map(k,function(a){return h(a,g)});return a.par(k).map(function(a){a=b.bind(a,function(a){return a.fold(e.constant([]),b.pure)});return b.map(a,p)})}}});k("r5",["xi","xj","xk","b","7"],function(c,d,b,a,e){return function(g,f){var h=function(b){return a.map(b,function(a){var b=c.getInCache(g,a.lang(),a.words());return{zone:e.constant(a),words:e.constant(b),
lang:a.lang}})},l=function(b,c,e){a.each(c,function(a){d.highlight(b,a.zone(),a.words(),e)})};return{local:function(a,b,c,d){b=b.zones();b=h(b);l(a,b,c);d()},remote:function(a,c,d,e){c=c.zones();b.scan(g,f,c).get(function(b){l(a,b,d);e()})},destroy:e.noop}}});k("r6",["s","o"],function(c,d){return{active:function(b){var a={};b.autocorrect().get(function(b){b.fold(function(a){d.log("Error loading autocorrect list")},function(b){a=b.corrections})});return{lookup:function(b){return a.hasOwnProperty(b)?
c.from(a[b]):c.none()}}},inactive:function(){return{lookup:c.none}}}});k("11c",["ps","po","7"],function(c,d,b){c=d.objOf([c.strict("language"),c.strict("words")]);return{many:b.constant(c)}});k("11d","hr b 1o 2z 9t hs hu 7".split(" "),function(c,d,b,a,e,g,f,h){var l=function(a,b){return c.readOptFrom(a,b).getOrThunk(function(){return g()})},k=a.generate("good-spelling");return{execute:function(a,g,r,q,s,t){var u=l(g,r);t=f.multiple(function(b,c){return a.execute({language:r,words:b})},u,q,function(a){return a.spell},
h.identity,s,void 0!==t?t:!1);g[r]=u;return e.mapSync(t,function(a){d.each(q,function(b){c.hasKey(a,b)||u.set(b,k,s)});var e={};b.each(a,function(a,b){u.get(s,b).is(k)||(e[b]=a)});return e})},initCaches:function(a){var c={};b.each(void 0!==a?a:{},function(a,b){c[b]=g(a)});return c},correct:h.constant(k)}});k("xl",["1o","ht","hv","11c","11d"],function(c,d,b,a,e){return function(g,f,h){var l=e.initCaches(h),k=d.post("ephox.spelling.service.many",a.many(),g,f);return{checkMany:function(a,c,d){d=b.now();
return e.execute(k,l,a,c,d)},dumpCache:function(){return c.map(l,function(a){return a.dump()})}}}});k("xm",["7","v"],function(c,d){var b={image:c.constant("1"),spelling:c.constant("1")};return{corsQuery:function(a){return d.ensureTrailing(a,"/")+"version"},spelling:function(a){var c=b.spelling();return d.ensureTrailing(a,"/")+c+"/"}}});k("r7","6 ha 2l xl 7 gf xm 54 46 o".split(" "),function(c,d,b,a,e,g,f,h,l,k){return function(n,p,r,q,s){var t=f.spelling(p),u=a(t+"correction",n.mediatorHeaders(),
s),v=l.create({failed:h(["resource"])});s=b.nu(function(a){var b=c.merge(n.headers(),{dataType:"json"});d.get(t+"autocorrect?language="+r,b).get(a)});var w=g.bind(s,function(){return u.checkMany(r,["startup"],!0)});w.get(function(a){a.fold(function(a){k.error("Unable to communicate with the spelling service:",a);v.trigger.failed(p)},e.noop)});return{correction:function(a,b,c,d){w.get(function(e){e.fold(d,function(){u.checkMany(q?b:r,a.words).get(function(a){a.fold(function(a){k.error("Error response from the spelling service:",
a);d(a)},function(a){c(a)})})})})},autocorrect:e.constant(s),events:v.registry,state:function(){return u.dumpCache()}}}});k("is","r4 r5 r6 66 r7 46 47 h6 f0 ca".split(" "),function(c,d,b,a,e,g,f,h,l,k){return function(n){var p=n.content(),r=n.profile(),q=e(n.communication(),n.url(),n.language(),n.multilingual(),n.fromServiceState()),s=n.autocorrectOn()?b.active(q):b.inactive(),t=g.create({failed:f(["resource"],q.events.failed)}),u=c(n.language(),n.viewable().viewport()),v=d(n.cache(),q),w=function(a){p.body().each(function(b){h.filterDom(b,
[l("."+a,k.unwrap)])})},x=function(){return!a.isOn(r.spelling().get())},y=function(){w("ephox-cram-annotation-wrap")};return{run:function(b,c){var d=r.spelling().get();a.isOn(d)&&(u.setLang(d),u.run(b,v.local,c),u.schedule(b,v.remote,c,x))},refresh:function(){var b=r.spelling().get();a.isOn(b)||y()},clear:y,lookup:s.lookup,destroy:function(){u.destroy();v.destroy()},state:q.state,events:t.registry}}});k("xp",["7","33"],function(c,d){var b=function(a){a="data-"+d.resolve(a);return c.constant(a)};return{value:b("spelling-value"),
type:b("spelling-type"),overflow:b("spelling-overflow"),overflowMenu:b("spelling-overflow-menu"),spelling:b("spelling-suggestion")}});k("xo",["xp","73","2u"],function(c,d,b){var a=b.immutable("primary","secondary","submenus"),e=b.immutable("value","text","attrs"),g=b.immutable("textkey","value","items");return{generate:function(b,h){var l;if(b.length>h){l=b.slice(0,h);var k=e(c.overflow(),d.translate("spelling.context.more"),{}),n=b.slice(h),p={};p[c.overflow()]=c.overflowMenu();n=g(d.key("spelling.context.morelabel"),
c.overflowMenu(),n);l=a(l.concat([k]),[n],p)}else l=a(b,[],{});return l}}});k("xq","xn s xp 54 46 1a".split(" "),function(c,d,b,a,e,g){return function(){var f=e.create({incorrect:a(["substitution"])}),h=d.none(),l={};l[b.spelling()]=function(a){h.each(function(d){d=c.substitute(d,g.get(a,b.value()));f.trigger.incorrect(d)})};return{assign:function(a){h=a},run:function(a){var c=g.get(a,b.type()),c=l[c];void 0!==c&&c(a)},events:f.registry}}});k("r8","b xn 7 hh xo xp xq 2u".split(" "),function(c,d,b,
a,e,g,f,h){var l=h.immutable("value","text","attrs");return function(h,k,p){var r=f();r.events.incorrect.bind(function(b){k.save();h.focus();h.domChanged();b.substitution().each(function(b){a.selectEnd(h,b)})});var q=b.curry(function(a,b,d,e){return a.marker(e).bind(a.detail).bind(function(a){return d(a).map(function(a){return c.map(a,function(a){var c={};c[g.type()]=b;c[g.value()]=a;return l(a,a,c)})})})},d,g.spelling(),function(a){return p.suggestions(a.lang(),a.word())});return{assign:r.assign,
handle:function(a){r.run(a)},situation:function(a){a=q(a).getOr([]);return e.generate(a,4)},destroy:b.noop}}});k("r9",["7","a1","54","46"],function(c,d,b,a){return function(e,g){var f=a.create({lookup:b(["element"])}),h=function(a){e.getSelection().each(a)},l=function(){h(function(a){f.trigger.lookup(a.startContainer())})};e.events.keyup.bind(function(a){d.isSpace(a)&&l()});e.events.nodeChanged.bind(function(a){a.prev().each(f.trigger.lookup)});return{events:f.registry,destroy:c.noop}}});k("it","in c 7 eh r8 r9 lf q".split(" "),
function(c,d,b,a,e,g,f,h){var l=d.detect().browser;return function(d,h,k,r,q,s,t,u,v){var w=e(h,q,u),x=g(h,k),y=function(a){h.getSelection().each(function(c){var d;(d=c.collapsed())||(d=!l.isIE())||(d=f.after(c.endContainer(),c.endOffset(),c.startContainer(),c.startOffset()));return(d?r.lightweightWith:b.apply)(a,c)})},B=a.tap(function(a){a=a.element();a=c.single(a);z(a)});x.events.lookup.bind(function(a){B.instance(a)});var z=function(a){v.run(y,a)};return{destroy:function(){w.destroy();x.destroy()},
scan:z,situation:w.situation,lock:function(a){var b=B.control.isBlocked();B.control.block();a();b||B.control.unblock()},assign:w.assign,handle:w.handle}}});k("ax","in io b 7 s eg ip bt iq ir 66 is it bq 8p 54 46 2u 1a 2a".split(" "),function(c,d,b,a,e,g,f,h,l,k,n,p,r,q,s,t,u,v,w,x){var y=v.immutableBag("communication profile content undo viewable cache url autocorrectOn language fromServiceState multilingual".split(" "),[]);return function(v,z,A,C,D){D=z.language.getOr(D);var F=v.communication(),
E=v.profile(),G=v.filter(),H=v.content(),I=v.operations(),L=v.undo(),J=v.smartview(),K=v.shortcuts(),M=v.context(),N=v.viewablearea();l.configure(G);v.profile().spelling().set(D);var S=d(z.words),Q=p(y({communication:F,profile:E,content:H,undo:L,viewable:N,cache:S,url:A.url,autocorrectOn:A.autocorrect,language:C,fromServiceState:z.service,multilingual:A.multilingual})),P=e.none();z=u.create({analytics:t(["message"])});Q.events.failed.bind(function(a){a=s.get("error.code.spelling.not.found",[a.resource()]);
a=h(a);v.ui().displayBanner(a)});H.events.ready.bind(function(a){H.body().each(function(a){w.set(a,"spellcheck",!1)});a=a.api().doc();a=r(a,H,M,I,L,K,J,S,Q);Q.refresh();P=e.some(a)});C=k(v,C,A.menu);C.events.change.bind(function(a){(n.isOn(a.language())?O:Q.clear)();H.uiChanged();H.domChanged()});var R=function(a){b.each(a,function(a){a=c.single(a);T(a)})},O=A.scanView?function(){var a=N.sections();R(a)}:Q.clear;A.scanView&&N.events.onChange.bind(O);var T=function(a){P.each(function(b){b.scan(a)})};
return q({events:z.registry,destroy:function(){H.body().each(function(a){w.remove(a,"spellcheck")});P.each(function(a){a.destroy()});S.destroy();Q.destroy()},state:function(){return{words:S.state(),service:Q.state(),language:e.some(v.profile().spelling().get())}},init:a.noop,hasDropdown:a.constant(!0),hasAutocorrect:a.constant(A.autocorrect),ui:C.ui,check:function(a,b,d,e){a=l.isWrap(a)?f.toLeaf(a,b):g.point(a,b);d=l.isWrap(d)?f.toLeaf(d,e):g.point(d,e);d=c.range(a.element(),a.offset(),d.element(),
d.offset());T(d)},scanView:O,situation:function(b){var c={primary:a.constant([]),secondary:a.constant([]),submenus:a.constant({})};return P.fold(a.constant(c),function(a){return a.situation(b)})},lock:function(a){return P.fold(function(){return a()},function(b){return b.lock(a)})},assign:function(a){P.each(function(b){b.assign(a.bind(x.firstChild).or(a))})},handle:function(a){P.each(function(b){b.handle(a)})},lookup:Q.lookup,name:a.constant("spelling")})}});k("61",["aw","ax"],function(c,d){return function(b,
a,e,g,f){return(!0===e.service?d:c)(b,a,e,g,f)}});k("iv","5b 7 dl 1y l 2o 2a".split(" "),function(c,d,b,a,e,g,f){var h=function(d){d=e.fromTag(d);var f=e.fromText(c.zeroWidth());g.append(d,f);a.add(d,b.styleSpan());return d},l=function(a,b,c,d){var e=h(d);f.firstChild(e).each(function(d){a(c,e);b.setSelection(d,0,d,0)})};return{nu:h,insertAfter:d.curry(l,g.after),insertBefore:d.curry(l,g.before)}});k("b3","b c 7 s eg ip iw 7c fp b8 1b 21 ak".split(" "),function(c,d,b,a,e,g,f,h,l,k,n,p,r){var q=d.detect().browser,
s=function(a){return p.isText(a)&&0!==r.get(a).trim().length},t=function(a){return p.isElement(a)&&"br"===p.name(a)},u=function(a){return c.exists([s,t],function(b){return b(a)})},v=function(a){return p.isText(a.element())&&0===a.offset()||p.isElement(a.element())},w=function(c,d,g){var h=b.constant(c);return(!1===d&&v(c)?a.some(!0):a.none()).fold(h,function(a){return f.seekLeft(c.element(),u,g).fold(h,function(a){return e.point(a,p.isText(a)?r.get(a).length:0)})})};return{context:function(c){return c.getSelection().bind(function(c){if(c.collapsed()){var d=
c.startContainer();return k.cell(d).bind(function(a){return k.table(d).map(function(e){return{cell:b.constant(a),table:b.constant(e),start:b.constant(d),selection:b.constant(c)}})})}return a.none()})},selectedCells:function(a,c){return h.cata(a.get(),b.constant([]),b.identity,function(a){var b;if(q.isFirefox()){b=a.startContainer();var d=a.startOffset();b=g.toLeaf(b,d)}else b=e.point(a.startContainer(),a.startOffset());if(q.isFirefox())var d=a.endContainer(),f=a.endOffset(),d=g.toLeaf(d,f);else d=
e.point(a.endContainer(),a.endOffset());(a=a.collapsed())||(a=n.eq(b.element(),d.element()));a=w(d,a,c);return l.sharedOne(k.cell,[b.element(),a.element()]).toArray()})}}});k("ra",[],function(){var c=function(c){return{fold:c}};return{none:function(d){return c(function(b,a,c,g){return b(d)})},first:function(d){return c(function(b,a,c,g){return a(d)})},middle:function(d,b){return c(function(a,c,g,f){return g(d,b)})},last:function(d){return c(function(b,a,c,g){return g(d)})}}});k("ix","b 7 s ra b8 1b".split(" "),
function(c,d,b,a,e,g){var f=function(a){return e.table(a).bind(function(f){f=e.cells(f);var k=c.findIndex(f,function(b){return g.eq(a,b)});return 0>k?b.none():b.some({index:d.constant(k),all:d.constant(f)})})};return{next:function(b){return f(b).fold(function(){return a.none(b)},function(c){return c.index()+1<c.all().length?a.middle(b,c.all()[c.index()+1]):a.last(b)})},prev:function(b){return f(b).fold(function(){return a.none()},function(c){return 0<=c.index()-1?a.middle(b,c.all()[c.index()-1]):
a.first(b)})}}});k("ay","iu 7 iv fi b3 ix".split(" "),function(c,d,b,a,e,g){return{upOrLeft:function(f){e.context(f).each(function(e){g.prev(e.cell()).fold(d.noop,function(){a.isFirstInContent(f,e.table())&&c.isLeft(e.cell(),e.selection())&&b.insertBefore(f,e.table(),"p")},d.noop,d.noop)})},right:function(f){e.context(f).each(function(e){g.next(e.cell()).fold(d.noop,d.noop,d.noop,function(){a.isLastInContent(f,e.table())&&c.isRight(e.cell(),e.selection())&&b.insertAfter(f,e.table(),"p")})})}}});k("b0",
"b 7v 7 gx 73 b3 74 7a 54 46 47 2n 2y".split(" "),function(c,d,b,a,e,g,f,h,l,k,n,p,r){var q={cssNamespace:"table-cell-border",i18nNamespace:"table.cell.border",property:"border-width",tag:"table",specials:[["thin","medium","thick"]]};return{widget:function(s){var t=s.content(),u=a(q);u.initLayout();d.dialog(u.element(),e.translate("aria.table.cell.border.size"));var v=k.create({done:l([]),abort:n([],u.events.abort)});u.events.close.bind(function(a){v.trigger.done();t.focus()});u.events.action.bind(function(a){var d=
r.active();t.focus();var e=g.selectedCells(s.selections(),t.isRoot);c.each(e,function(c){p.set(c,"border-width",a.value());p.getRaw(c,"border-style").fold(function(){p.set(c,"border-style","solid")},b.noop)});d.each(r.focus)});var w=function(){u.enter();u.open()};return{element:u.element,destroy:u.destroy,name:b.constant("cellborderwidth"),textkey:b.constant(e.key("table.cell.border.width")),tooltip:f.get,label:b.constant(!1),updateWidget:function(a){var c=g.selectedCells(s.selections(),t.isRoot);
0<c.length?(a.enable(),a=p.getRaw(c[0],"border-width").fold(h.off,h.on),u.updateInlineWidget({size:b.constant(a)},"1px")):a.disable();w()},events:v.registry,open:w,close:u.close}}}});k("b1","7v cr 4z 7 50 iy 73 b3 33 74 54 46 2u 4b 2o".split(" "),function(c,d,b,a,e,g,f,h,l,k,n,p,r,q,s){var t=r.immutableBag(["name","textkey","menuTextkey","action","shortname"],[]);return{widget:function(r,v){var w=t(v),x=r.content(),y=b.div();c.label(y,f.translate(w.textkey()));q.add(y,[l.resolve("palette-cell-colors"),
l.resolve(w.shortname()+"-cell-colors")]);var B=g.create();s.append(y,B.element());var z="."+l.resolve(w.shortname()+"-cell-colors")+" ."+l.resolve("palette-detail-action"),A=g.makeLayout(y,z,{}),z=A.layout(),C=p.create({done:n([]),abort:n([])});B.events.selected.bind(function(a){a=a.value();var b=h.selectedCells(r.selections(),x.isRoot);w.action()(b,a);C.trigger.done()});var D=function(){F.enter();A.refresh()},F=d(y,[z]);F.events.exit.bind(function(){C.trigger.abort()});return{element:a.constant(y),
destroy:function(){F.destroy();B.destroy()},name:a.constant(w.name()),textkey:a.constant(f.key(w.textkey())),tooltip:k.get,label:a.constant(!1),updateWidget:function(a){e.isHighContrast(r.smartview())?a.disable():(0===h.selectedCells(r.selections(),x.isRoot).length?a.disable():a.enable(),D())},events:C.registry,open:D,close:function(){C.trigger.done()}}}}});k("rb",["1a","2n","l","2o","3c"],function(c,d,b,a,e){return{render:function(g,f,h,l){var k=b.fromTag("table");d.setAll(k,{"border-collapse":"collapse",
width:"100%"});c.set(k,"border","1");var n=b.fromTag("tbody");a.append(k,n);for(var p=[],r=0;r<g;r++){for(var q=b.fromTag("tr"),s=0;s<f;s++){var t=r<h||s<l?b.fromTag("th"):b.fromTag("td");s<l&&c.set(t,"scope","row");r<h&&c.set(t,"scope","col");a.append(t,b.fromTag("br"));d.set(t,"width",100/f+"%");a.append(q,t)}p.push(q)}e.append(n,p);return k}}});k("iz",["s","7u","rb","b8"],function(c,d,b,a){return{insert:function(e,g,f,h,l){return e.getSelection().bind(function(k){return a.table(k.startContainer()).fold(function(){var k=
b.render(g,f,h,l);d.insertAtCursor(e,[k]).each(function(b){a.firstCell(k).each(function(a){e.setSelection(a,0,a,0)})});return c.some(k)},c.none)})}}});k("xr","7v er a7 4z l1 7 73 33 1a 1y 4b 2y 2o".split(" "),function(c,d,b,a,e,g,f,h,l,k,n,p,r){return function(q){var s=e(q);k.add(s.element(),h.resolve("choice-button"));var t=a.span();l.set(s.element(),"title",f.translate("table."+q));l.set(s.element(),"tabindex","-1");c.button(s.element(),f.translate("table."+q),!1);var u=b.describe(s.element(),f.translate("aria.table.headerdescription"));
r.append(s.element(),u);s.events.click.bind(function(){p.focus(s.element());d.pressed(s)});n.add(t,[h.resolve(q),"ephox-pastry-icon-content","ephox-polish-icon"]);s.content({element:g.constant(t)});return s}});k("142",["7","rk"],function(c,d){var b=d.resolve("table-picker"),a=d.resolve("table-picker-row"),e=d.resolve("table-picker-cell"),g=d.resolve("table-picker-button");return{table:c.constant(b),row:c.constant(a),cell:c.constant(e),button:c.constant(g)}});k("141","fq 142 1a 4e 31 dg".split(" "),
function(c,d,b,a,e,g){var f="."+d.cell(),h="."+d.row();return{cells:function(b){return a.descendants(b,f)},rows:function(b){return a.descendants(b,h)},grid:function(a,d,e){d=g(b.get(a,d),10);a=g(b.get(a,e),10);return c.grid(d,a)},button:function(a){return e.child(a,"."+d.button()).getOr(a)}}});k("157",["7","fq","1s"],function(c,d,b){var a=function(a,c,e,l,k){l=b.max(l,b.min(k,a.row()));a=b.max(c,b.min(e,a.column()));return d.address(l,a)},e=function(b,e){var h=a(b,1,e.maxCols,1,e.maxRows),l;l=d.address(h.row()+
1,h.column()+1);l=a(l,e.minCols,e.maxCols,e.minRows,e.maxRows);return{selection:c.constant(h),full:c.constant(l)}};return{resize:function(a,b){var c;c=d.address(a.row()+1,a.column()+1);return e(c,b)},grow:function(a,b,c,l){a=d.address(a.rows()+c,a.columns()+b);return e(a,l)}}});k("143","fq 157 2y 6d 3l 2r 1s".split(" "),function(c,d,b,a,e,g,f){return function(f,l){var k=!1,n=function(a,c,d){var e=d.full();e.row()===c.rows()&&e.column()===c.columns()||a.setSize(e.row(),e.column());a=a.setSelection(d.selection().row(),
d.selection().column());b.focus(a)};return{on:function(){k=!0},off:function(){k=!1},mousemove:function(b,r,q,s){if(k){var t;t=g.get(b.element());var u=a.get(b.element());t=c.dimensions(t,u);u=e.absolute(b.element());u=c.coords(u.left(),u.top());q=c.coords(q,s);q=f.pickerCell(u,t,r,q);q=d.resize(q,l);n(b,r,q)}},manual:function(a,b,c,e){k&&(c=d.grow(b,c,e,l),n(a,b,c))}}}});k("11e","b wt 7v 7 54 46 fq 141 142 143 rk t2 1a 1y 4b 3u l 2y 2o 3c fr 2q dg".split(" "),function(c,d,b,a,e,g,f,h,l,k,n,p,r,q,
s,t,u,v,w,x,y,B,z){return function(d,C,D){var F=g.create({select:e(["rows","cols","rowHeaders","columnHeaders"])}),E=u.fromTag("table");b.presentation(E);b.hidden(E,!0);q.add(E,l.table());var G=u.fromTag("tbody");w.append(E,G);var H=0,I=0,L=function(a,b){H=b;I=a;J()},J=function(){B.empty(G);var a=D.ids();p.repeat(I,function(b){var c=u.fromTag("tr");q.add(c,l.row());var d=p.repeat(H,function(c){var d=u.fromTag("td");q.add(d,n.resolve("cell-"+c+"-"+b));q.add(d,l.cell());var e=u.fromTag("button");r.set(e,
"type","button");r.set(e,"aria-labelledby",a[b][c]);q.add(e,l.button());w.append(d,e);return d});x.append(c,d);w.append(G,c)})},K=function(a,b){var d=h.cells(E);c.each(d,function(a){q.remove(a,n.resolve("picker-selected"))});d=h.rows(E).slice(0,a);c.each(d,function(a,d){var e=h.cells(a).slice(0,b);c.each(e,function(a,b){var c=h.grid(E,"data-picker-header-row","data-picker-header-col"),c=d<c.rows()||b<c.columns()?[n.resolve("picker-selected"),n.resolve("picker-header")]:[n.resolve("picker-selected")];
s.add(a,c)})});r.set(E,"data-picker-col",b-1);r.set(E,"data-picker-row",a-1);d=h.cells(d[d.length-1]).slice(0,b);return h.button(d[d.length-1])},M=function(){var a=z(r.get(E,"data-picker-col"),10)+1,b=z(r.get(E,"data-picker-row"),10)+1;return f.grid(b,a)},N={element:a.constant(E),setSelection:K,setSize:L},S=k(d,C),Q=t.bind(E,"mousemove",function(a){S.mousemove(N,f.grid(I,H),a.raw().pageX,a.raw().pageY)}),P=function(a,b){S.manual(N,M(),a,b)},R=y.realClick.bind(E,function(a){O();a.raw().preventDefault()}),
O=function(){var a=h.grid(E,"data-picker-row","data-picker-col"),b=h.grid(E,"data-picker-header-row","data-picker-header-col");F.trigger.select(a.rows()+1,a.columns()+1,b.rows(),b.columns())};return{element:function(){return E},destroy:function(){R.unbind();Q.unbind();B.remove(E)},setSize:L,setHeaders:function(a,b){r.set(E,"data-picker-header-row",a);r.set(E,"data-picker-header-col",b)},setSelection:K,on:S.on,off:S.off,reset:function(){L(C.minRows,C.minCols);var a=K(1,1);v.focus(a)},refresh:function(){var a=
M();J();return K(a.rows(),a.columns())},events:F.registry,sendLeft:a.curry(P,d.isRtl()?1:-1,0),sendRight:a.curry(P,d.isRtl()?-1:1,0),sendUp:a.curry(P,0,-1),sendDown:a.curry(P,0,1),sendExecute:O}}});k("xs",["11e"],function(c){return function(d,b,a){return c(d,b,a)}});k("rc","wt 7v er a7 g2 8h ke a8 4z 7 s xr 73 33 46 47 xs 1a 1y 4b l 2y 3c 31".split(" "),function(c,d,b,a,e,g,f,h,l,k,n,p,r,q,s,t,u,v,w,x,y,B,z,A){return function(l,D){var F=c.createHelp(D.maxRows,D.maxCols,{row:function(a){return r.translate("table.picker.rows",
a)},col:function(a){return r.translate("table.picker.cols",a)}}),E=u(l,D,F);d.label(E.element(),r.translate("table.picker.label"));var G=a.describe(E.element(),r.translate("table.picker.describepicker")),H=y.fromTag("div");v.set(H,"tabIndex","-1");d.group(H);x.add(H,[q.resolve("insert-table"),q.resolve("toolbar-menu")]);var I=y.fromTag("div");w.add(I,q.resolve("table-controls"));d.toolbarGroup(I,r.translate("table.picker.header"));var L=p("row-header"),J=p("column-header");z.append(I,[L.element(),
J.element()]);z.append(H,[I,E.element(),G,F.help()]);var K=function(){E.setHeaders(L.selected()?1:0,J.selected()?1:0);var a=B.active(),b=E.refresh();a.each(function(a){B.hasFocus(a)||B.focus(b)})},F=function(a,b){return function(){b();return n.some(!0)}},F=g.single(E.element(),[f.basic(h.LEFT()[0],F("left",E.sendLeft)),f.basic(h.RIGHT()[0],F("right",E.sendRight)),f.basic(h.UP()[0],F("up",E.sendUp)),f.basic(h.DOWN()[0],F("down",E.sendDown)),f.rule(f.inSet(h.SPACE().concat(h.ENTER())),F("execute",E.sendExecute))],
n.none());F.events.enter.bind(function(){B.focus(E.element())});var M=g.flow(I,{item:k.constant(".ephox-pastry-statebutton")},e.flow({trigger:function(a){return A.descendant(a,".ephox-pastry-button").map(function(a){a.dom().click();return a})}})),N=g.multiple(H,[F,M]);L.events.click.bind(function(){M.clickFocus(L.element());K()});J.events.click.bind(function(){M.clickFocus(J.element());K()});I=s.create({select:t(["rows","cols","rowHeaders","columnHeaders"],E.events.select),exit:t([],N.events.exit)});
return{element:function(){return H},destroy:function(){N.destroy();L.destroy();J.destroy();E.destroy()},setSize:E.setSize,setSelection:E.setSelection,on:function(){E.on();N.enter()},off:function(){E.off();N.isFocused()&&N.exit()},reset:function(){E.setHeaders(0,0);L.deselect();b.release(L.element());J.deselect();b.release(J.element());E.reset()},events:I.registry}}});k("j0",["6","rc","54","46"],function(c,d,b,a){return function(e,g){var f=a.create({enabled:b(["enabled"]),select:b(["rows","cols","rowHeaders",
"columnHeaders"]),insert:b(["table"]),done:b([]),abort:b([])}),h=c.merge({minCols:7,maxCols:10,minRows:4,maxRows:10},g),l=d(e,h);l.events.select.bind(function(a){k();f.trigger.done();f.trigger.select(a.rows(),a.cols(),a.rowHeaders(),a.columnHeaders())});l.events.exit.bind(function(){k();f.trigger.abort()});var k=function(){l.off()};return{element:l.element,open:function(){l.reset();l.on()},close:k,destroy:function(){l.destroy()},events:f.registry}}});k("rd",["fq","1s"],function(c,d){var b=function(a,
b,g,f){var h=a.width()/b.columns();a=a.height()/b.rows();g=d.floor(g/h);f=d.floor(f/a);return c.address(f,g)};return{findCellRtl:function(a,c,d,f){var h=a.x()+c.width()-f.x();a=f.y()-a.y();return b(c,d,h,a)},findCellLtr:function(a,c,d,f){var h=f.x()-a.x();a=f.y()-a.y();return b(c,d,h,a)}}});k("j1",["7","rd"],function(c,d){var b={pickerCell:d.findCellLtr,isRtl:c.constant(!1)},a={pickerCell:d.findCellRtl,isRtl:c.constant(!0)};return{ltr:b,rtl:a}});k("b2","7 iz j0 73 74 46 47 j1 b8".split(" "),function(c,
d,b,a,e,g,f,h,l){return{widget:function(k,n){var p=b(k.region().uiDirection().isRtl()?h.rtl:h.ltr,n),r=k.content(),q=k.undo(),s=g.create({done:f([],p.events.done),abort:f([],p.events.abort)});p.events.select.bind(function(a){q.save();d.insert(r,a.rows(),a.cols(),a.rowHeaders(),a.columnHeaders()).each(function(a){q.save();r.domChanged()});r.toEditing()});return{element:p.element,name:c.constant("table"),textkey:c.constant(a.key("insert.table")),menuTextkey:c.constant(a.key("table.menu")),tooltip:e.get,
label:c.constant(!1),updateWidget:function(a){r.getSelection().each(function(b){(l.table(b.startContainer()).isNone()?a.enable:a.disable)()});p.open()},destroy:p.destroy,events:s.registry,open:p.open,close:p.close}}}});k("xt",["31"],function(c){return{set:function(c,b){c.dom().checked=b},find:function(d){return c.descendant(d,"input:checked")}}});k("re","2z 7 g4 73 1a xt l 2o 3c 2q 32".split(" "),function(c,d,b,a,e,g,f,h,l,k,n){return function(){var p=f.fromTag("fieldset"),r=f.fromHtml("<legend>"+
a.translate("table.border")+"</legend>");h.append(p,r);var q=c.generate(""),r=function(a){var b=f.fromTag("input");e.setAll(b,{type:"radio",id:"tableborder"+a+q,value:a,name:q});return b},s=r("1"),t=r("0");l.append(p,[s,f.fromHtml('<label for="tableborder1'+q+'">'+a.translate("border.on")+"</label>"),t,f.fromHtml('<label for="tableborder0'+q+'">'+a.translate("border.off")+"</label>")]);var u=b.radio(p,'input[type="radio"]',"input:checked");return{element:function(){return p},get:function(){return g.find(p).map(function(a){return n.get(a)})},
select:function(a){g.set(t,!1);g.set(s,!1);a.each(function(a){"0"===a?g.set(t,!0):"1"===a&&g.set(s,!0)});u.refresh()},keylayout:d.constant(u),destroy:function(){k.remove(p)}}}});k("rf","b g2 8h 4z 7 s l2 p3 33 1a 1y 3u 3c 2q 32".split(" "),function(c,d,b,a,e,g,f,h,l,k,n,p,r,q,s){return function(){var t=a.div();n.add(t,l.resolve("table-size-controls"));var u=f.input("table-width","table.width"),v=f.input("table-height","table.height");c.map([u,v],function(a){k.set(a.input(),"placeholder","Auto")});
r.append(t,[u.element(),v.element()]);var w=[b.input(u.input(),d.input({})),b.input(v.input(),d.input({}))],x=function(a){var b=a.target();h.validateField(b,"width",g.some("px")).fold(function(){h.highlight(b)},function(a){h.dehighlight(b)})},y=[p.bind(u.input(),"input",x),p.bind(v.input(),"input",x)];return{element:function(){return t},get:function(){return h.validate([h.rule(u.input(),"width",g.some("px")),h.rule(v.input(),"height",g.some("px"))])},set:function(a){a.width().bind(e.curry(s.set,u.input()));
a.height().bind(e.curry(s.set,v.input()))},keylayouts:e.constant(w),highlight:h.highlight,dehighlight:e.curry(h.clearHighlights,t),destroy:function(){q.remove(t);c.each(y,function(a){a.unbind()})}}}});k("j5","7 s rg 2u da 1a 2n df 2f 2q 31".split(" "),function(c,d,b,a,e,g,f,h,l,k,n){var p=a.immutableBag(["floatval","caption","summary","border","dimensions"],[]),r=function(a){a=g.get(a,"border");return"0"===a||"1"===a?d.some(a):d.none()},q=function(a){var b=f.getRaw(a,"width");a=f.getRaw(a,"height");
return{width:c.constant(b),height:c.constant(a)}};return{divine:function(a,b){var c=h.divine(b),d=g.get(b,"summary"),e=n.child(b,"caption").map(function(b){b=l.get(b);return a.filterHtml(a.output(),b)}).getOr(""),f=r(b),k=q(b);return p({floatval:c,caption:e,summary:d,border:f,dimensions:k})},properties:p,apply:function(a,c){c.floatval().each(function(b){e.runFloat(a,b)});c.border().each(function(b){g.set(a,"border",b)});""===c.summary()?g.remove(a,"summary"):b.setSummary(a,c.summary());""===c.caption()?
n.child(a,"caption").each(k.remove):b.setCaption(a,c.caption());b.setDimensions(a,c.dimensions())}}});k("j4","g2 8h 4z 7 s g3 g4 l2 p4 re rf j5 73 g5 33 54 46 1y 3c 32".split(" "),function(c,d,b,a,e,g,f,h,l,k,n,p,r,q,s,t,u,v,w,x){return function(y,B){var z=u.create({ok:t(["properties"]),close:t([])}),A=g(B);A.setTitle(r.translate("table.dialog"));v.add(A.element(),s.resolve("dialog-narrow"));var C=b.div(),D=l("table.float"),F=h.input("tablesummary","table.summary"),E=h.input("tablecaption","table.caption"),
G=n(),H=k();w.append(C,[E.element(),F.element(),H.element(),G.element(),D.element()]);var I=q.okCancel("table");I.events.ok.bind(function(){M()});I.events.cancel.bind(function(){A.hide();z.trigger.close()});A.events.close.bind(function(){A.hide();z.trigger.close()});A.setContent(C);A.setControls(I.element());var L=f.setup(A,I,[d.input(E.input(),c.input({})),d.input(F.input(),c.input({})),H.keylayout()].concat(G.keylayouts()).concat([D.keylayout()])),J=function(){return G.get().map(function(b){b={width:a.constant(e.some(b.width())),
height:a.constant(e.some(b.height()))};return p.properties({floatval:D.get(),caption:K(E.input()),summary:K(F.input()),border:H.get(),dimensions:b})})},K=function(a){return x.get(a).trim()},M=function(){J().fold(function(a){G.highlight(a)},function(a){z.trigger.ok(a)})};return{element:A.element,events:z.registry,open:function(){A.show();L.enter()},represent:function(a){a=p.divine(y,a);D.select(a.floatval());void 0!==a.summary()&&x.set(F.input(),a.summary());void 0!==a.caption()&&x.set(E.input(),a.caption());
G.set(a.dimensions());H.select(a.border())},execute:M,destroy:function(){D.destroy();G.destroy();H.destroy();I.destroy();A.destroy();L.destroy()},hide:function(){L.exit();A.hide()}}}});k("b5","b fm 7 s d1 j3 j4 j5 73 9b j6 2u j7 b8 j8 1a 21 31".split(" "),function(c,d,b,a,e,g,f,h,l,k,n,p,r,q,s,t,u,v){return function(w,x,y,B,z,A,C,D){var F=a.none(),E=function(a,b){var c=r.getWidth(a);r.setWidth(a,c/2);r.setWidth(b,c/2)},G={"tablemenu-delete-table":g.erase,"delete-row":g.execute(x,s.eraseRow,b.noop,
D),"delete-column":g.execute(x,s.eraseColumn,b.noop,D),"make-header-column":g.execute(x,s.makeColumnHeader,b.noop,D),"make-header-row":g.execute(x,s.makeRowHeader,b.noop,D),"unmake-header-column":g.execute(x,s.unmakeColumnHeader,b.noop,D),"unmake-header-row":g.execute(x,s.unmakeRowHeader,b.noop,D),"insert-row-before":g.execute(x,s.insertRowBefore,b.noop,D),"insert-row-after":g.execute(x,s.insertRowAfter,b.noop,D),"insert-column-before":g.execute(x,s.insertColumnBefore,E,D),"insert-column-after":g.execute(x,
s.insertColumnAfter,E,D),"tablemenu-table-properties":function(b,c,d){b=f(w,C);var g=k.generate(z,b,["properties"]);g.events.ok.bind(function(a){y.activate();F.bind(function(b){q.table(b.element()).each(function(b){e.runTransaction(y,A,function(){h.apply(b,a.properties())})})});g.destroy()});g.events.close.bind(function(a){g.destroy();y.activate();y.focus()});y.deactivate();g.represent(c);g.open();return a.none()},"cell-merge":g.execute(x,s.mergeCells,b.noop,D),"cell-unmerge":g.execute(x,s.unmergeCells,
b.noop,D)},H=p.immutable("value","text","attrs");return{handle:function(a){y.doc().each(function(b){F.each(function(b){var c=b.element();q.table(c).each(function(c){var f=t.get(a,"data-ephox-gopher-item-value"),g=G[f];void 0!==g&&e.runTransaction(y,A,function(){g(y,c,b).each(function(a){y.setSelection(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset());d.clear(c)})})})})})},assign:function(a){F=a.bind(function(a){return q.cell(a).bind(function(a){return v.ancestor(a,"table").map(function(b){return n.forMenu(B,
b,a)})}).orThunk(function(){return v.closest(a,"caption").map(function(a){return n.caption(a)})})})},situation:function(a){a=F.map(function(a){var b=a.element();return c.flatten([c.contains(["td","th"],u.name(b))?[H("tablemenu-row",l.translate("table.context.row.menu"),{})]:[],c.contains(["td","th"],u.name(b))?[H("tablemenu-column",l.translate("table.context.column.menu"),{})]:[],[H("tablemenu-table",l.translate("table.context.table.menu"),{})],a.mergable().isSome()?[H("cell-merge",l.translate("table.context.cell.merge"),
{})]:[],a.unmergable().isSome()?[H("cell-unmerge",l.translate("table.context.cell.unmerge"),{})]:[]])}).getOr([]);var d=F.map(function(a){var d=a.element();a=function(a,c,e){var f=a+"-menu",g="th"===u.name(d)?"unmake":"make",h="make"===g?"header":"normal";c=[H("insert-"+a+"-before",l.translate("table.context."+a+"."+c),{}),H("insert-"+a+"-after",l.translate("table.context."+a+"."+e),{}),H("delete-"+a,l.translate("table.context.common.delete"),{}),H(g+"-header-"+a,l.translate("table.context.common."+
h),{})];return{textkey:b.constant(l.key("table.context."+a+".title")),value:b.constant(f),items:b.constant(c)}};var e={textkey:b.constant(l.key("table.context.table.title")),value:b.constant("table-menu"),items:b.constant([H("tablemenu-table-properties",l.translate("table.context.table.properties"),{}),H("tablemenu-delete-table",l.translate("table.context.common.delete"),{})])};return c.flatten([[a("row","insertabove","insertbelow")],[a("column","insertleft","insertright")],[e]])}).getOr([]);return{primary:b.constant(a),
secondary:b.constant(d),submenus:b.constant({"tablemenu-row":"row-menu","tablemenu-column":"column-menu","tablemenu-table":"table-menu"})}},destroy:b.noop}}});k("b6","j9 7 s j3 j6 ix b8 j8 4e 31".split(" "),function(c,d,b,a,e,g,f,h,l,k){var n=function(g,n,q,s){return q.fold(b.none,b.none,function(a,d){return b.some(c(d,0,d,0))},function(b){return f.table(b).bind(function(f){a.execute(g,h.insertRowAfter,d.noop,s)(n,f,e.noMenu(b));f=l.descendants(f,"tr");if(0<f.length)return k.descendant(f[f.length-
1],"td,th").map(function(a){return c(a,0,a,0)})})})};return{forward:function(a,b,c,d){return n(a,b,g.next(c),d)},backward:function(a,b,c,d){return n(a,b,g.prev(c),d)}}});k("xu",["54","46"],function(c,d){return function(){var b=d.create({drag:c(["xDelta","yDelta"])});return{mutate:function(a,c){b.trigger.drag(a,c)},events:b.registry}}});k("ri",["s","54","46","xu"],function(c,d,b,a){return function(){var e=b.create({drag:d(["xDelta","yDelta","target"])}),g=c.none(),f=a();f.events.drag.bind(function(a){g.each(function(b){e.trigger.drag(a.xDelta(),
a.yDelta(),b)})});return{assign:function(a){g=c.some(a)},get:function(){return g},mutate:f.mutate,events:e.registry}}});k("jb","ib 7 s 54 46 ri rj rk qv 1a 1y 2n 3u 21 6m 31 dg".split(" "),function(c,d,b,a,e,g,f,h,l,k,n,p,r,q,s,t,u){return function(v,w,x){var y=g(),B=c.transform(y,{}),z=b.none(),A=function(a,c){return b.from(k.get(a,c))};y.events.drag.bind(function(a){A(a.target(),"data-row").each(function(b){b=l.getInt(a.target(),"top");p.set(a.target(),"top",b+a.yDelta()+"px")});A(a.target(),"data-column").each(function(b){b=
l.getInt(a.target(),"left");p.set(a.target(),"left",b+a.xDelta()+"px")})});var C=function(a,b){var c=l.getInt(a,b),d=u(k.get(a,"data-initial-"+b),10);return c-d};B.events.stop.bind(function(){y.get().each(function(a){z.each(function(b){A(a,"data-row").each(function(c){var d=C(a,"top");k.remove(a,"data-initial-top");I.trigger.adjustHeight(b,d,u(c,10))});A(a,"data-column").each(function(c){var d=C(a,"left");k.remove(a,"data-initial-left");I.trigger.adjustWidth(b,d,u(c,10))});f.refresh(v,b,x,w)})})});
var D=function(a,b){I.trigger.startAdjust();y.assign(a);k.set(a,"data-initial-"+b,u(p.get(a,b),10));n.add(a,h.resolve("resizer-bar-dragging"));p.set(a,"opacity","0.2");B.go(v.parent())},F=r.bind(v.parent(),"mousedown",function(a){f.isRowBar(a.target())&&D(a.target(),"top");f.isColBar(a.target())&&D(a.target(),"left")}),E=r.bind(v.view(),"mouseover",function(a){if("table"===q.name(a.target())||s.ancestor(a.target(),"table"))z="table"===q.name(a.target())?b.some(a.target()):t.ancestor(a.target(),"table"),
z.each(function(a){f.refresh(v,a,x,w)})}),G=r.bind(v.view(),"mouseout",function(a){"table"===q.name(a.target())&&f.hide(v)}),H=r.bind(v.view(),"dragstart",function(a){a.raw().preventDefault()}),I=e.create({adjustHeight:a(["table","delta","row"]),adjustWidth:a(["table","delta","column"]),startAdjust:a([])});return{destroy:function(){F.unbind();E.unbind();G.unbind();H.unbind();B.destroy();f.destroy(v)},refresh:function(a){f.refresh(v,a,x,w)},on:B.on,off:B.off,hideBars:d.curry(f.hide,v),showBars:d.curry(f.show,
v),events:I.registry}}});k("b9",["54","46","ja","jb","jc"],function(c,d,b,a,e){return function(g,f){var h=e.height,l=a(g,f,h),k=d.create({beforeResize:c([]),afterResize:c([]),startDrag:c([])});l.events.adjustHeight.bind(function(a){k.trigger.beforeResize();var c=h.delta(a.delta(),a.table());b.adjustHeight(a.table(),c,a.row(),h);k.trigger.afterResize()});l.events.startAdjust.bind(function(a){k.trigger.startDrag()});l.events.adjustWidth.bind(function(a){k.trigger.beforeResize();var c=f.delta(a.delta(),
a.table());b.adjustWidth(a.table(),c,a.column(),f);k.trigger.afterResize()});return{on:l.on,off:l.off,hideBars:l.hideBars,showBars:l.showBars,destroy:l.destroy,events:k.registry}}});k("62","b c 7 s ay az b0 b1 b2 73 b3 b4 b5 b6 6t b7 b8 b9 2n".split(" "),function(c,d,b,a,e,g,f,h,l,k,n,p,r,q,s,t,u,v,w){return function(d,y){var B=d.content(),z=d.keyboard(),A=d.undo(),C=d.smartview(),D=function(){return N.getOr(t.only(B.element()))},F=r(d.filter(),d.region(),B,d.selections(),z,A,C.uiContainer(),D),E=
function(a,b,d){A.save();c.each(b,function(b){a(b,d)});A.save();B.focus()},G=b.curry(E,function(a,b){w.set(a,"background-color",b)}),E=b.curry(E,function(a,c){w.set(a,"border-color",c);w.getRaw(a,"border-style").fold(function(){w.set(a,"border-style","solid")},b.noop)}),G=s.ui({"table.widget":b.curry(l.widget,d,y),"cell.palette":b.constant({items:[{type:"widget",build:b.curry(h.widget,d,{action:G,shortname:"background",name:"cellbackgroundcolor",textkey:"table.cell.color.background",menuTextkey:"table.cell.color.background"})},
{type:"widget",build:b.curry(h.widget,d,{action:E,shortname:"border",name:"cellbordercolor",textkey:"table.cell.color.border",menuTextkey:"table.cell.color.border"})},{type:"widget",build:b.curry(f.widget,d)}],updatePalette:function(c){var e=n.selectedCells(d.selections(),B.isRoot),f=b.curry(c.show,a.some(k.translate("table.context.palette.show")));c=b.curry(c.hide,a.some(k.translate("table.context.palette.hide")));(0<e.length?f:c)()&&d.ui().refresh()}})},b.identity),H=function(a){var b=a.stopper();
B.getSelection().each(function(c){c.collapsed()&&u.cell(c.startContainer()).each(function(c){(a.shift()?q.backward:q.forward)(d.region(),B,c,D).fold(b,function(a){b();B.setSelection(a.startContainer(),a.startOffset(),a.endContainer(),a.endOffset())})})})},I=function(a){e.upOrLeft(B)},L=function(a){e.right(B)},J=z.editor();J.on();J.events.tab.bind(H);J.events.left.bind(I);J.events.up.bind(I);J.events.right.bind(L);var K=B.cursor(),M=a.none(),N=a.none();B.events.ready.bind(function(b){b=g.get(B,C,b.api().doc());
N=a.some(b);var c=p(d.region()),e=v(b,c);e.events.beforeResize.bind(A.save);e.events.afterResize.bind(function(){B.focus();A.save();B.domChanged();K.restore()});e.on();e.events.startDrag.bind(K.save);M=a.some(e);b=d.selections();b.events.beforeScan.bind(function(){e.hideBars()});b.events.afterScan.bind(function(){e.showBars()})});return{ui:G,destroy:function(){F.destroy();M.each(function(a){a.destroy()});J.off();J.events.tab.unbind(H);J.events.left.unbind(I);J.events.up.unbind(I);J.events.right.unbind(L);
J.destroy()},handle:F.handle,assign:F.assign,situation:F.situation,name:b.constant("table")}}});k("63",["7","54","46"],function(c,d,b){return function(){var a=b.create({pasteUpload:d([]),uploadAssets:d(["assets"]),registerBlob:d(["id","blob","bloburl","data"])});return{destroy:c.noop,events:a.registry,pasteUpload:a.trigger.pasteUpload,uploadAssets:a.trigger.uploadAssets,registerBlob:a.trigger.registerBlob}}});k("rl",["b","7","2u"],function(c,d,b){var a=b.immutable("withSpaces","withoutSpaces"),e=
function(a){return c.filter(a.split(/[\.,-\/#!$%\^&\*;:{}=\-_`~()\s\u00A0]/gim),function(a){return 0<a.length}).length};return{count:function(b){return{words:d.constant(e(b)),characters:d.constant(a(b.length,b.replace(/[\s\u00A0]/gim,"").length))}}}});k("jd","8h 7 mv g3 73 33 rl 54 46 4b l 2y 9q v".split(" "),function(c,d,b,a,e,g,f,h,l,k,n,p,r,q){return function(s,t){var u=s().uiContainer(),v=l.create({close:h([])}),w=a(u);w.setTitle(e.translate("wordcount.dialog"));k.add(w.element(),[g.resolve("dialog-wordcount"),
g.resolve("dialog-narrow")]);var u=t().body().getOrDie(),x=b.toText(u,d.constant(!1)),y=r.get(u),u=t().getSelectedText().getOr(""),x=f.count(x),y=y.length,u=f.count(u),B=n.fromHtml(q.supplant('<table class="ephox-polish-tabular ephox-polish-wordcount-table" tabindex="-1">    <thead>        <tr>            <th scope="col"> ${headerCounts}&nbsp;</th>            <th scope="col"> ${headerDocument}&nbsp;</th>            <th scope="col"> ${headerSelection}&nbsp;</th>        </tr>    </thead>    <tbody>        <tr>            <td>${wordCountLabel}&nbsp;</td>            <td class="ephox-polish-wordcount-document-words">${documentCountWords}&nbsp;</td>            <td class="ephox-polish-wordcount-selection-words">${selectionCountWords}&nbsp;</td>        </tr>        <tr>            <td>${wordCountCharsNoSpacesLabel}&nbsp;</td>            <td class="ephox-polish-wordcount-document-charsnospaces">${documentCharactersNoSpaces}&nbsp;</td>            <td class="ephox-polish-wordcount-selection-charsnospaces">${selectionCharactersNoSpaces}&nbsp;</td>        </tr>        <tr>            <td>${wordcountCharsLabel}&nbsp;</td>            <td class="ephox-polish-wordcount-document-chars">${documentCountCharsWithSpaces}&nbsp;</td>            <td class="ephox-polish-wordcount-selection-chars">${selectionCountCharsWithSpaces}&nbsp;</td>        </tr>    </tbody></table>',
{headerCounts:e.translate("wordcount.counts"),headerDocument:e.translate("wordcount.document"),headerSelection:e.translate("wordcount.selection"),wordCountLabel:e.translate("wordcount.words"),wordCountCharsNoSpacesLabel:e.translate("wordcount.charactersnospaces"),wordcountCharsLabel:e.translate("wordcount.characters"),documentCountWords:x.words(),selectionCountWords:u.words(),documentCharactersNoSpaces:x.characters().withoutSpaces(),selectionCharactersNoSpaces:u.characters().withoutSpaces(),documentCountCharsWithSpaces:y,
selectionCountCharsWithSpaces:u.characters().withSpaces()}));w.setContent(B);var z=c.multiple(w.element(),[]),u=function(){A();v.trigger.close()},A=function(){w.hide()};w.events.close.bind(u);z.events.exit.bind(u);return{element:w.element,events:v.registry,open:function(){w.show();z.enter();p.focus(B)},destroy:function(){z.destroy();w.destroy()},hide:A}}});k("ba",["jd","54","46"],function(c,d,b){return function(a,e){var g=c(a,e),f=b.create({close:d([])});g.events.close.bind(function(){f.trigger.close();
g.destroy()});return{show:function(){g.open()},events:f.registry}}});k("64",["7","73","6t","ba"],function(c,d,b,a){return function(e){var g=e.content,f=e.smartview;return{ui:b.ui({"wordcount.general":{toggle:!1,value:"wordcount",textkey:d.key("wordcount.open"),action:function(){var b=a(f,g);b.events.close.bind(function(){e.ui().tabstrip.focused()||g().focus()});e.content().hideInlineSelection();b.show()},updateGeneral:c.noop,icon:!0,shortcut:!1,hasPopup:!1,hasDialog:!0}}),destroy:c.noop}}});k("65",
"b c 7s 7 a1 79 21 37 ak 2a".split(" "),function(c,d,b,a,e,g,f,h,l,k){var n=d.detect(),p=function(a){return"img"===f.name(a)},r=function(a){var b=function(a){return f.isText(a)&&0<l.get(a).length};return b(a)||h.descendant(a,b)},q=function(d,f){var h=d.content(),l=function(a){e.isBackspace(a)&&h.win().each(function(d){h.getSelection().each(function(e){var f=e.startContainer(),g=e.startOffset(),h=e.endContainer(),l=e.endOffset(),f=b.cloneFragment(d,f,g,h,l),f=k.children(f),g=c.find(f,p);void 0===g||
null===g||c.exists(f,r)||(b.deleteRange(d,e.startContainer(),e.startOffset(),e.endContainer(),e.endOffset()),a.original().kill())})})};f.events.changed.bind(function(a){d.content().uiChanged();g.select(h,a.image())});f.events.contextmenu.bind(function(a){var b=a.image();k.parent(b).each(function(a){k.findIndex(b).each(function(b){h.setSelection(a,b,a,b+1)})})});h.events.keydown.bind(l);return{cleanup:a.noop,destroy:function(){h.events.keydown.unbind(l)}}};return function(b,c){return n.browser.isIE()?
q(b,c):{cleanup:a.noop,destroy:a.noop}}});k("67",["1q","a","b"],function(c,d,b){var a=["img","br","hr","input"],e=["_moz_dirty"],g=["script","style"],f={"<":"&lt;",">":"&gt;","&":"&amp;","\u00a0":"&nbsp;"},h=/[<>&\u00A0]/g,l=function(a){return a.replace(h,function(a){return f[a]||a})},k=function(a,c){for(var d="<"+a,f="",g=0;g<c.length;g++){var h=c[g];h.specified&&!b.contains(e,h.name)&&(f+=" "+h.name+'="'+h.value.replace(/"/g,"&quot;")+'"')}return d+f},n=function(a){var c="";b.each(a,function(a){c+=
r(a)});return c},p=function(a){var c="";b.each(a,function(a){c+=a.textContent});return c},r=function(d){var e=d.nodeType;if(e===c.ELEMENT){var e=d.nodeName.toLowerCase(),f=d.childNodes;d=d.attributes;0===f.length&&b.contains(a,e)?e=k(e,d)+" />":(f=b.contains(g,e)?p(f):n(f),e=k(e,d)+">"+f+"</"+e+">");return e}if(e===c.TEXT)return l(d.textContent);if(e==c.COMMENT)return"\x3c!--"+l(d.textContent)+"--\x3e";throw"unsupported node type "+d.nodeType;};return{writeNode:function(a){if(!d.isObject(a))throw"sugarNode parameter must be an object";
return r(a.dom()).replace(/^<body.*?>/,"").replace(/<\/body>$/,"")},writeChildren:function(a){if(!d.isObject(a))throw"sugarNode parameter must be an object";return n(a.dom().childNodes)}}});k("40","5b b 1o 6 7 s 51 3j 42 5c 5d 5e 5f 5g 5h 5i 5j 5k 5l 5m 5n 5o 5p 5q 5r 5s 5t 5u 5v 5w 5x 5y 5z 60 61 53 62 63 64 1f 65 66 54 46 47 2u 1a l 67 68 3t".split(" "),function(c,d,b,a,e,g,f,h,l,k,n,p,r,q,s,t,u,v,w,x,y,B,z,A,C,D,F,E,G,H,I,L,J,K,M,N,S,Q,P,R,O,T,W,X,V,aa,ca,Z,ba,da,ga){var fa=aa.immutableBag("accessibility formatting alignindent directionality table font parlance media imageEdit blocktag specialchar wordcount link linkvalidator horizontalrule help fileupload findreplace plaincodeview macros spelling".split(" "),
[]);return function(Y,aa,ea){var $=function(a,b,c,d){return b.bundled?a.apply(void 0,d.concat([b])):c()},U=t(Y,aa,ea),ja=Q(),ha=$(z,Y.image,N.image,[U]),la=$(A,Y.imageEdit,N.imageEdit,[U,ha,ja]);aa=$(p,Y.formatting,N.basic,[U]);var ka=$(n,Y.alignindent,N.basic,[U,ha]),ma=$(q,Y.directionality,N.basic,[U]),oa=$(S,Y.table,N.table,[U]),sa=$(r,Y.blocktag,N.basic,[U]),ta=$(w,Y.font,N.basic,[U]),xa=$(P,Y.wordcount,N.basic,[U]),Ga=$(E,Y.media,N.basic,[U]),Ha=$(K,Y.specialchar,N.basic,[U]),qa=$(D,Y.linkvalidator,
N.linkvalidator,[U,ea.linkvalidator]),ua=$(C,Y.link,N.basic,[U,qa]),Ea=$(B,Y.horizontalrule,N.basic,[U]),Fa=$(x,Y.help,N.dialog,[U]),pa=function(a,b,c,d){var e=Y.ui.locale.code,f=void 0!==e?e:R.get();return(!0===b.bundled?T.determine(f):g.none()).fold(function(){return c()},function(c){var f=U.profile().spelling().get(),f=void 0!==e||!0!==b.menu&&f!==T.offKey()||!1===f?c:f;return a.apply(void 0,d.concat([b,c,f]))})}(M,Y.spelling,N.spelling,[U,ea.spelling]),Ja=$(H,Y.parlance,N.basic,[U,pa]),Ca=$(L,
Y.resize,e.curry(O,U,ha),[U,ha]),ra=$(F,Y.macros,N.macros,[U,pa,ea.macros]),ya=$(y,Y.highlighter,N.highlighter,[U,ra]),Ba=$(s,Y.draganddrop,N.draganddrop,[U]),Ia=$(u,Y.fileupload,N.dialog,[U,ja,la.insertResample(),Ba]),Ka=$(J,Y.smartclipboard,N.basic,[U,ja,la.insertResample()]),La=$(G,Y.mentions,N.basic,[U]),Ma=$(v,Y.findreplace,N.basic,[U]),Na=$(k,Y.accessibility,N.basic,[U]);ea=function(){var a=U.content();return a.body().fold(a.getContent,function(b){b=Z.fromDom(b.dom().cloneNode(!0));var d=U.filter();
d.filterDom(d.output(),b);b=ba.writeNode(b);b=a.extract(b);d=new da(c.zeroWidth(),"g");return b.replace(d,"")})};var va=function(a){var b=U.filter(),c=U.content();a=b.filterHtml(b.input(),a);c.resetContent(a);ya.run();qa.refresh();pa.scanView();return a},$=$(I,{getContent:ea,setContent:va,bundled:Y.plaincodeview.bundled},N.basic,[U]);U.contextmenu().register("table",oa);U.contextmenu().register("imageEdit",la);U.contextmenu().register("image",ha);U.contextmenu().register("spelling",pa);U.contextmenu().register("link",
ua);var Da=fa({formatting:aa,alignindent:ka,directionality:ma,table:oa,font:ta,imageEdit:la,parlance:Ja,blocktag:sa,wordcount:xa,specialchar:Ha,media:Ga,link:ua,linkvalidator:qa,horizontalrule:Ea,help:Fa,fileupload:Ia,findreplace:Ma,accessibility:Na,plaincodeview:$,macros:ra,spelling:pa});U.content().events.loaded.bind(function(){U.ui().init(U.keyboard(),U.undo(),Da);pa.init(U.content());ya.run();qa.refresh();ga(wa.trigger.loaded,0)});var wa=X.create({loaded:W([]),focus:W([]),dirty:V([],U.laundry().events.dirty),
internal:W(["command","data"])});U.content().events.focus.bind(function(){wa.trigger.focus()});U.internalevents().events.internal.bind(function(a){var b=a.command();"insertLink"===b&&(a=ca.get(a.data(),"href"),wa.trigger.internal(b,a))});$=U.content().isInline()?function(){var a=U.ui(),b=U.content(),c=a.state(),c=void 0!==c.toolbar&&void 0!==c.toolbar.drag?c.toolbar.drag.isSome():!1;b.activate();b.focus();U.viewablearea().setOn();c||a.position();a.refresh()}:e.noop;aa=U.content().isInline()?function(){U.content().deactivate();
U.content().blur();U.viewablearea().setOff()}:e.noop;return l.internal({activateInline:$,deactivateInline:aa,element:U.ui().element,viewport:U.ui().viewport,connect:U.ui().connect,focus:U.content().focus,blur:U.content().blur,getContent:ea,toTransfer:e.compose(f.changed,ea),setContent:function(a){var b=U.undo();b.disable(function(){var c=va(a);b.reset(c)});U.laundry().setDirty(!1)},insertHtmlAtCursor:U.insertFilteredHtmlAtCursor,isDirty:U.laundry().isDirty,setDirty:U.laundry().setDirty,fromTransfer:function(a){var b=
U.undo();f.cata(a,function(a){b.disable(function(){va(a)});b.replaceTop()},function(a){va(a);b.save()})},uploader:e.constant(ja),state:function(){var b=U.state();return a.merge(b,{spelling:pa.state(),macros:ra.state(),filters:U.filter().customFilters().state(),linkvalidator:qa.state()})},cleanup:function(){Ca.cleanup()},destroy:function(){U.content().deactivate();var a=d.map(b.values(Da),e.apply);d.each(a.concat([ha,la,pa,Ca,ra,ya,ja,Ka,La,U,Ba]),function(a){a.destroy()})},events:wa.registry,communication:U.communication,
fullscreen:U.fullscreen,content:U.content,ui:U.ui,undo:U.undo,smartview:U.smartview,keyboard:U.keyboard,filter:U.filter,operations:U.operations,macros:e.constant(ra),getMode:h.pencil,isPrettyPrinting:function(){return!0===Y.content.prettyprint}})}});k("57",["3w","40","3j"],function(c,d,b){var a=b.pencil(),e=b.code(),g=function(a){var b=a.old().toTransfer();a.nu().fromTransfer(b)},f={transition:g,factory:c,style:b.pencil},h={transition:g,factory:d,style:b.code};return{toMode:function(a,b){b(a.style(),
function(b){var c=b.swap(a.factory,{},{});return function(){a.transition(c);c.destroy()}})},goingToDesign:function(a){return a===e},alternate:function(b){return b===e?a:e},detect:function(a){return a===e?f:h}}});k("bb","7v 4z eh 73 33 54 46 1a 1y 4b 3u l 2o 2q".split(" "),function(c,d,b,a,e,g,f,h,l,k,n,p,r,q){return{generate:function(p){var t=f.create({change:g(["type"])}),u=d.div();c.hidden(u,"true");k.add(u,[e.resolve("html-switch-wrapper"),e.resolve("layer-editor")]);var v=d.div();k.add(v,[e.resolve("html-switch"),
e.resolve("icon"),e.resolve(p)]);h.set(v,"data-icon",p);r.append(u,v);var w=function(a,b){var c=h.get(v,"data-icon");l.remove(v,e.resolve(c));l.add(v,e.resolve(a));h.set(v,"data-icon",a);h.set(v,"title",b)},x=function(){return h.get(v,"data-icon")},y=b.tap(function(){t.trigger.change(x())}),B=n.bind(u,"click",y.instance);return{render:function(a){r.append(a,u)},destroy:function(){q.remove(u);B.unbind()},current:x,switchto:function(b){w(b,a.translate("toolbar.switch-"+b));y.control.unblock()},spin:function(){w("spin",
a.translate("loading.wait"));y.control.block()},events:t.registry}}}});k("58","b 4l 7 s p 57 3g bb 54 46 4m o".split(" "),function(c,d,b,a,e,g,f,h,l,k,n,p){var r=function(a,c){return{destroy:b.noop,init:b.noop,setMode:b.die("Code view is not enabled, cannot switch modes"),events:k.create({change:l([])}).registry}},q=function(a){a=n(a);return{switchto:a.set,current:a.get,render:b.noop,spin:b.noop,destroy:b.noop,events:k.create({change:l([])}).registry}},s=function(b,n){var r=n.css+"/codemirror.css",
s=k.create({change:l(["style","swapper"])}),x=n.showButton?h.generate(n.mode):q(n.mode);x.events.change.bind(function(a){z(a.type())});var y=a.none(),B=[],z=function(a){y.fold(function(){throw"Cannot set mode before Code View has loaded";},function(c){if(b.get().getMode()!==a){x.spin();var d=g.detect(a);c.get(function(b){b.fold(function(b){x.switchto(a);p.error(b);p.error("Code View non-functional due to error downloading script file")},function(){g.toMode(d,function(a,b){s.trigger.change(a,b)})})})}})},
A=function(a){var c=b.get();x.switchto(a);x.render(c.viewport())},C=function(a){a(e.value(!0))};return{destroy:function(){x.destroy();c.each(B,function(a){a.unbind()})},setMode:z,init:function(b){y.fold(function(){d.addStylesheet(r,C).get(function(c){c.fold(function(a){p.error(a);p.error("Code View disabled due to error loading stylesheet")},function(){y=a.some(f.load.codeview(n.js));A(b)})})},function(a){A(b)})},events:s.registry}};return function(a,b){return(!0===b.bundled?s:r)(a,b)}});k("je","a5 b rm 4z 7 50 73 1f c1 33 c2 c3 c4 c5 aj kq 1a 2m 1y 4b 3u l 2o 2q q".split(" "),
function(c,d,b,a,e,g,f,h,l,k,n,p,r,q,s,t,u,v,w,x,y,B,z,A,C){return function(D,C,E,G,H,I){var L=B.fromTag("div");G.updateUi(L);x.add(L,[s.editorContainer(),"ephox-textbox-font",k.resolve("layer-editor"),k.resolve("fullscreen-maximized")]);u.set(L,"lang",h.get());l.addClasses(L);var J=t(),K=c.toolbar(J,f.translate);C.events.toolbar.bind(K.enter);K.events.exit.bind(D.focus);var M=n(),N=v.body(),S=a.div();w.add(S,k.resolve("socket"));var Q=d.map(["dragover","drop"],function(a){return y.bind(S,a,function(a){a.kill()})});
J.integrate(L,K,M,S);r.build(L,H.sideBar,H.bottomBar);var P=b({layerClass:k.resolve("layer-below-editor"),background:"rgba(255, 255, 255, 0.92)"}),R=k.resolve("body-fullscreen"),O=H.autoresize?p(H):q();O.events.change.bind(function(a){K.refresh();E.refresh()});return{element:function(){return L},socket:function(a){z.append(S,a.element())},viewport:e.constant(S),connect:function(a){P.show();w.add(N,R);z.append(a,L);g.detect(L);O.hookup(D.element());return!0},destroy:function(){d.each(Q,function(a){a.unbind()});
K.destroy();w.remove(N,R);A.remove(L);P.destroy();O.destroy();M.destroy()},banners:M.element,displayBanner:M.display,hideBanner:M.hide,position:function(){J.init(K,M,S,H,I)},refresh:function(){J.update();K.refresh()},toolbar:K}}});k("bc",["7","6v","je","6y"],function(c,d,b,a){return{build:function(a,g,f,h,l,k,n,p){var r=b(a,g,f,k,n,p),q=h.full(r);q.init();return{element:r.element,socket:r.socket,viewport:r.viewport,init:function(b,c,g){c=q.config(a.isInline(),c,l,g);d.setup(r,k,a,b,f,c);q.loaded()},
connect:r.connect,destroy:function(){r.destroy();q.destroy()},displayBanner:r.displayBanner,hideBanner:r.hideBanner,position:c.noop,refresh:r.refresh,tabstrip:r.toolbar,state:c.constant(p)}},bounds:function(){return a.view}}});k("59","s 57 40 bc 56 54 46 2m 1b 2a q".split(" "),function(c,d,b,a,e,g,f,h,l,k,n){return function(n){var r=c.none(),q=c.none(),s=f.create({maximize:g([]),restore:g([])}),t=function(c){r=k.parent(n.get().element());r.getOrDie("maximize called on editor that is not in the DOM.");
n.swap(b,{ui:{layout:a,isFullScreen:!0},fullscreen:{layout:void 0!==c.layout()?c.layout():e}}).destroy();var d=n.get();d.fullscreen().select();d.connect(h.body());d.events.loaded.bind(function(){d.focus();s.trigger.maximize()})},u=function(a){n.swap(b,{ui:{layout:void 0!==a.layout()?a.layout():e,isFullScreen:!1}}).destroy();var c=n.get();c.fullscreen().deselect();a=r.getOrDie("restore called on editor that was not previously in the DOM.");n.get().connect(a);c.events.loaded.bind(function(){c.focus();
s.trigger.restore()})};return{init:function(a){if(d.goingToDesign(a)){a=n.get();var b=n.get().element();q.each(function(a){if(l.eq(a,b))throw"Fullscreen init called twice on the same instance";});q=c.some(b);a.fullscreen().events.maximize.bind(t);a.fullscreen().events.restore.bind(u)}},destroy:function(){},events:s.registry}}});k("bd",["a","b"],function(c,d){return function(){var b=[];return{setCallback:function(a){c.isFunction(a)&&b.push(a)},done:function(a){d.each(b,function(b){b.apply(null,[a])});
b=[]}}}});k("jf","rn ro 2z ge 7 s de 1a".split(" "),function(c,d,b,a,e,g,f,h){var l=function(a){return a.result};return{blobTob64:function(a,b){var c=h.get(b,f.blobId());h.remove(b,f.blobId());a.get(c).each(function(a){h.remove(b,f.blobId());h.set(b,"src",l(a.data()))})},b64ToBlob:function(e,l){var k=h.get(l,"src"),r=function(a){console.warn("Unable to read Base64 image data: ",a,k);return g.none()};e.lookupByData(k).fold(function(){var f=c.toBlob(k);return d.cata(f,g.none,r,function(c){var d=a.createObjectURL(c),
f=b.generate("image");return g.some(e.add(f,c,d,{result:k}))})},g.some).each(function(a){h.set(l,f.blobId(),a.id());h.set(l,"src",a.objurl())})}}});k("be",["b","jf","de"],function(c,d,b){return{configure:function(a,e){a.addSelector(a.output(),"img["+b.blobId()+"]",function(a){c.each(a,function(a){d.blobTob64(e,a)})});a.addSelector(a.input(),"img:not(["+b.blobId()+"])[src]",function(a){c.each(a,function(a){d.b64ToBlob(e,a)})});var g=function(a){return c.each(a,b.cleanup)};a.add(a.output(),b.uploadContainer(),
g);a.add(a.history(),b.uploadContainer(),g);a.add(a.internal(),b.uploadContainer(),g)},blobId:b.blobId}});k("jg","de 1y l 2o 3c 2q 31 2a".split(" "),function(c,d,b,a,e,g,f,h){return{removeUi:function(a){f.ancestor(a,"."+c.uploadContainer()).each(function(a){var b=h.children(a);e.before(a,b);g.remove(a)})},addUi:function(e){var f=b.fromTag("div");d.add(f,c.uploadContainer());a.before(e,f);a.append(f,e)}}});k("bj","b fz 7 s p de jg 4n 2u 1a 31 o".split(" "),function(c,d,b,a,e,g,f,h,l,k,n,p){var r=l.immutable("image",
"blobInfo"),q=h.generate([{failure:["error"]},{success:["result","images","blob"]}]),s=function(a,b,d,e){c.each(b,function(a){k.set(a,"src",e.location);k.remove(a,g.blobId())});return v(a,d)},t=function(a,b,c,d,e,f){var h=a.lookupByData(e.result).getOrThunk(function(){return a.add(b,c,d,e)});k.set(f,g.blobId(),h.id());return r(f,h)},u=function(a,b){var c=k.get(b,g.blobId());return a.get(c).fold(function(){return e.error(c)},function(a){return e.value(r(b,a))})},v=function(a,b){return a.get(b).fold(function(){return e.error("Internal error with blob cache")},
function(c){a.remove(b);return e.value(c)})};return{prepareForUpload:function(b,c,d){var e=b.isActive(c);b.register(d,c);f.addUi(d);return e?a.none():a.some(c)},handleUpload:function(a,d,e,g,h,l,k,m){var n=function(){p.error("Internal error with blob cache",h);m(q.failure({status:b.constant(666)}))};a.upload(l,h,function(a){var b=d.findById(g,h);k(function(){c.each(b,f.removeUi)});a.fold(function(a){m(q.failure(a))},function(a){s(e,b,h,a).fold(n,function(c){m(q.success(a,b,c))})});d.report(h,b,a.isValue())})},
registerAssets:function(a,f,g){return c.bind(g,function(c){return d.cata(c,function(b,c,d,g){return n.descendant(f,'img[src="'+d+'"]').fold(function(){return[e.error("Image that was just inserted could not be found: "+d)]},function(f){return[e.value(t(a,b,c,d,g,f))]})},b.constant([]))})},registerBlob:t,findBlobs:function(a,b,d){d=a.findAll(d);return a.inProgress()?[]:c.map(d,function(a){return u(b,a)})}}});k("bf","fz gd 3s 9d gf gi 9i 8o bj".split(" "),function(c,d,b,a,e,g,f,h,l){var k=function(k){var m=
function(b){var m=b.image(),p=b.blobInfo(),t=g.changedBounds(m);return h.resampleAction(t,p.blob(),function(g){if(g===p.blob())return e.pure(b);var h=a.updater(a.keepResample,m),t=f.applyEdit(m);g=d.single(g).bind(t).map(h);return e.map(g,function(a){return c.cata(a,function(a,b,c,d){return l.registerBlob(k,a,b,c,d,m)},function(a,c,d){return b})})})};return function(a){return b.mapM(a,m)}};return{instance:function(a,c){return!0===a.immediate?b.pure:k(c)}}});k("rp",["s","73"],function(c,d){var b={400:"errors.http.400",
401:"errors.http.401",403:"errors.http.403",404:"errors.http.404",407:"errors.http.407",409:"errors.http.409",413:"errors.http.413",415:"errors.http.415",500:"errors.http.500",501:"errors.http.501"};return{get:function(a,e){return c.from(b[a]).map(function(a){return d.translate(a,e)})}}});k("jh",["a","7","r","8p","rp"],function(c,d,b,a,e){var g=function(b){return c.isString(b)&&""!==b.trim()?{description:d.constant(b),link:d.constant(null)}:a.get("error.imageupload.generic")},f=function(b,c){var f=
c.status();return e.get(f,b).fold(function(){var c;c=0===f?"error.imageupload.cors":400<=f&&500>f?"error.code.images.not.found":"error.imageupload";return a.get(c,[b])},function(a){return{description:d.constant(a),link:d.constant(null)}})},h=function(a,c){return{instance:function(){return b.cached(function(b){b=c(b);a.show(b)})}}};return{simple:function(a){return h(a,g)},url:function(a,b){return h(a,d.curry(f,b))}}});k("rq",["6","pp","vv","7"],function(c,d,b,a){return{json:function(){return{get:function(b,
c,f,h){d.get(b,c,f||a.identity,h)},post:function(b,c,f,h){d.ajax(b,"POST",c,f||a.identity,h)},ajaxData:function(e,g,f,h,l,k){g=c.merge(k||{},{data:void 0!==g?b.stringify(g):""});d.ajax(e,f,h,l||a.identity,g)}}}}});k("xw",["2i"],function(c){return function(){return new (c.getOrDie("FormData"))}});k("rr",["a","b","xw","2u","v"],function(c,d,b,a,e){var g=["jpg","png","gif","jpeg"];return{failureObject:a.immutable("message","status","contents"),getFilename:function(a,b){var l;c.isString(a.name)&&!e.endsWith(a.name,
".tmp")?l=a.name:c.isString(a.type)&&e.startsWith(a.type,"image/")?(l=a.type.substr(6),l=d.contains(g,l)?b+"."+l:b):l=b;return l},buildExtra:function(a,c,d){var e=b();e.append(a,c,d);return{data:e,contentType:!1,processData:!1}}}});k("rs","a 6 p6 vv p rr v hy".split(" "),function(c,d,b,a,e,g,f,h){return function(l){var k=function(){var a=l.url,b=a.lastIndexOf("/"),a=0<b?a.substr(0,b):a,a=void 0===l.basePath?a:l.basePath;return f.endsWith(a,"/")?a:a+"/"}();return{upload:function(f,p,r){f=f.blob();
var q=function(a,b,c){r(e.error(g.failureObject(a,b,c)))},s=g.getFilename(f,p);p=d.merge(!0!==l.credentials?{}:{xhrFields:{withCredentials:!0}},g.buildExtra("image",f,s));b.post(l.url,{},function(b){var d;try{var f=a.parse(b);if(c.isString(f.location))d=f.location;else{q("JSON response did not contain a string location",500,b);return}}catch(g){d=b}b=d.split(/\s+/);b=h.resolve(k,1===b.length&&""!==b[0]?b[0]:s);r(e.value({location:b}))},q,p)}}}});k("rt","a p rr 2u o 3t".split(" "),function(c,d,b,a,
e,g){var f=a.immutable("id","filename","blob","base64");return function(a){return{upload:function(l,k,n){var p=function(a){n(d.error(a))},r=function(a){c.isString(a)?n(d.value({location:a})):(e.error("Image upload result was not a string"),p(""))},q=b.getFilename(l.blob(),k),s=f(k,q,l.blob(),l.data().result);g(function(){a(s,r,p)},0)}}}});k("jj",["rr","rs","rt"],function(c,d,b){return{direct:function(a){return d(a)},custom:function(a){return b(a)},failureObject:function(a,b,d){return c.failureObject(a,
b,d)},getFilename:function(a,b){return c.getFilename(a,b)},buildExtra:function(a,b,d){return c.buildExtra(a,b,d)}}});k("ji",["6","p","rq","jj"],function(c,d,b,a){return function(e,g){return{upload:function(f,h,l){f=f.blob();h=a.getFilename(f,h);h=c.merge(e.headers(),a.buildExtra("image",f,h));b.json().post(g,function(a){l(d.value(a))},function(b,c,e){l(d.error(a.failureObject(b,c,e)))},h)}}}});k("bg","a 7 jh ji jj 2u".split(" "),function(c,d,b,a,e,g){var f=g.immutable("uploader","errors");return{choose:function(g,
l,k){return!0!==g.bundled?f({upload:d.die},{instance:d.constant(d.die("Image Upload is disabled"))}):c.isString(g.service)?f(a(k,g.service),b.url(l,g.service)):c.isFunction(g.handler)?f(e.custom(g.handler),b.simple(l)):f(e.direct(g.direct),b.url(l,g.direct.url))}}});k("bh",["1o","ge","s","2u"],function(c,d,b,a){var e=a.immutable("id","blob","objurl","data");return function(){var a={},f=function(a){d.revokeObjectURL(a.objurl())};return{add:function(b,c,d,f){c=e(b,c,d,f);return a[b]=c},get:function(c){return b.from(a[c])},
remove:function(b){var c=a[b];delete a[b];void 0!==c&&f(c)},lookupByData:function(d){return b.from(c.find(a,function(a){return a.data().result===d}))},destroy:function(){c.each(a,f);a={}}}}});k("bi","b jk de 54 46 1a 4e".split(" "),function(c,d,b,a,e,g,f){var h="data-"+d.resolve("image-upload"),l=function(a,b){return f.descendants(a,"img["+h+'="'+b+'"]')},k=function(a){return f.descendants(a,"img:not(["+h+"])["+b.blobId()+"]")};return function(){var b=[],d=[],f=e.create({complete:a(["response"])}),
q=function(a){b=c.filter(b,function(b,c){return b!==a});!1===s()&&(f.trigger.complete(d),d=[])},s=function(){return 0<b.length};return{findById:l,findAll:k,register:function(a,c){g.set(a,h,c);b.push(c)},report:function(a,b,e){c.each(b,function(a){g.remove(a,h);d.push({success:e,element:a.dom()})});q(a)},inProgress:s,isActive:function(a){return c.contains(b,a)},events:f.registry}}});k("5a","a b s 8i bd 9v 57 be bf bg bh bi bj o".split(" "),function(c,d,b,a,e,g,f,h,l,k,n,p,r,q){return function(s,t){var u=
n(),v=e(),w=p(),x=a(s.ui),y=k.choose(t,x,s.communication()),B=y.uploader(),z=y.errors(),A=l.instance(t,u);w.events.complete.bind(function(a){v.done(a.response())});var C=function(a,b,c,d){r.handleUpload(B,w,u,a,b,c,s.operations().preserveAndRestore,function(a){a.fold(function(a){d(a)},F)})},D=function(a){s.content().body().each(function(b){var c=z.instance(),e=r.registerAssets(u,b,a.assets());d.each(e,function(a){a.fold(function(a){q.error(a)},function(a){!0===t.immediate&&E(b,a,c)})})})},F=function(a,
b,c){s.undo().rewrite(c.objurl(),a.location)},E=function(a,b,c){!1!==t.bundled&&s.operations().preserveAndRestore(function(){return r.prepareForUpload(w,b.blobInfo().id(),b.image())}).each(function(d){C(a,d,b.blobInfo(),c)})},G=function(a){d.each(a,function(a){w.report(a,b.none(),!1)})},H=function(a,b){var c=g.partition(b),e=c.values;G(c.errors);var f=z.instance();A(e).get(function(b){b=g.partition(b);0<b.errors.length&&(x.showKey("imageedit.generic"),q.error("Image resample on upload errors: ",b.errors),
G(b.errors));d.each(b.values,function(b){E(a,b,f)})})},I=function(a){c.isFunction(a)&&v.setCallback(a);!0!==t.bundled?v.done([]):s.content().body().fold(function(){v.done([])},function(a){var b=r.findBlobs(w,u,a);0!==b.length||w.inProgress()?H(a,b):v.done([])})};return{init:function(a){f.goingToDesign(a)&&(a=s.filter(),h.configure(a,u),s.uploader().events.uploadAssets.bind(D),s.uploader().events.pasteUpload.bind(function(){!0===t.immediate&&I()}),s.uploader().events.registerBlob.bind(function(a){var b=
a.id(),c=a.blob(),d=a.bloburl();a=a.data();u.add(b,c,d,a)}));x.reset()},reconstitute:I,destroy:function(){u.destroy()}}}});k("3z","b 57 3j 58 59 5a".split(" "),function(c,d,b,a,e,g){return function(f,h,k,m){var n=e(f),p=g(h,k.imageupload);k=a(f,k.codeview);var r=[n,p],q=r.concat([k]);n.events.restore.bind(function(){m.restore();s(q,b.code())});n.events.maximize.bind(function(){m.save();s(r,b.code())});k.events.change.bind(function(a){p.reconstitute(function(){var b=a.swapper()(f);f.get().events.loaded.bind(function(){h.focus()});
h.reconnect();b()})});var s=function(a,b){c.each(a,function(a){a.init(b)})};h.events.connected.bind(function(){s(q,d.alternate(h.getMode()))});return{setMode:k.setMode,uploadImages:p.reconstitute,destroy:function(){f.destroy();c.each(q,function(a){a.destroy()})}}}});ma.define("bk",[],function(){return'/*\n * Keep this file as small as possible.\n * It is injected into the JavaScript, so it needs to be tiny.\n */\n\n/*\n * Animate from 0 to 359, not 0 to 360, as they are the same and FireFox does nothing\n *\n * Until we have token replacement, manual shorthand for "ephox-polish-spin"\n */\n\n@keyframes e-p-spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(359deg);\n  }\n}\n\n/* Until we have token replacement, manual shorthand for "ephox-polish-spinner-img" */\n\n.e-p-s-img {\n  animation: e-p-spin 2s infinite linear;\n  width: 30px;\n  height: 30px;\n  margin: 2px 2em 0 auto;\n  background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAIVBMVEUAAABAQEBDQ0NERERERERCQkJDQ0NERERDQ0NEREREREQTPu3mAAAACnRSTlMAENDPwGBwsKB/qy4kVgAAAFpJREFUCNdjAAImAwYI4FoApooFuBYwWgAZXoZMCsJLgAyhpQwMUYpABmMiA4OYAAMCaC2GklqLwIxFMAmoYkmQYmGQdkOQgYpMBkIgA4tAVmggLAU7QwFIAADjyQ3FWhtneAAAAABJRU5ErkJggg==") 0/cover;\n}'});
k("6b","s 2m l 2o 2q 9q bk".split(" "),function(c,d,b,a,e,g,f){var h=0,k=c.none();return{add:function(){if(0===h){var e=b.fromTag("style");g.set(e,f);a.append(d.body(),e);k=c.some(e)}h++},remove:function(){0!==h&&0===--h&&(k.each(e.remove),k=c.none())}}});k("41","6 7 s 69 51 42 6a 53 6b 45 6c 4m 2n l 6d 2f 2o 2q 6e 3t".split(" "),function(c,d,b,a,e,g,f,h,k,m,n,p,r,q,s,t,u,v,w,x){return function(y,B){var z=h.state(B),A=p(null),C=q.fromTag("div"),D=function(){t.set(C,'<div class="e-p-s-img"></div>');
F()},F=void 0===y.content.inline?d.noop:function(){if(!1===y.ui.toolbar.visible)r.set(C,"display","none");else{var a={isInline:d.constant(!0),element:d.constant(y.content.inline)},a=n.offsetFrom(a,C,s.get(C),y.ui);r.setAll(C,{position:"absolute",left:a.left+"px",top:a.top-4+"px"})}},E=null,G=d.die("API unavailable while the editor is loading"),H={body:d.constant(b.none()),doc:G,execCommand:G,getSelectedText:G,focus:G,deactivate:d.noop,blur:d.noop},I=void 0===y.content.inline?A.get:function(){return t.get(y.content.inline)};
return g.internal({activateInline:F,blur:G,cleanup:d.noop,communication:d.constant(f(y)),connect:function(a){E=x(D,1E3);u.append(a,C);k.add();return!1},content:d.constant(H),deactivateInline:d.noop,destroy:function(){w(E);k.remove();v.remove(C)},element:d.constant(C),events:m.events(),failure:function(){w(E);k.remove();t.set(C,"<p>Unable to load editor. See browser console for details.</p>")},filter:z.filter,focus:G,fromTransfer:function(a){e.cata(a,A.set,A.set)},fullscreen:h.fullscreen,getContent:I,
getMode:G,insertHtmlAtCursor:G,isDirty:z.laundry.isDirty,isPrettyPrinting:function(){return!0===y.content.prettyprint},keyboard:m.keyboard,macros:z.macros,operations:m.operations,setContent:function(a){void 0===y.content.inline?A.set(a):t.set(y.content.inline,a);z.laundry.setDirty(!1)},setDirty:z.laundry.setDirty,smartview:m.smartview,state:function(){var b=I(),b=a.isEmpty(b)?{}:{content:{clean:b,marked:b},undo:{initial:{clean:b,marked:b}}};return c.deepMerge(z.getState(),b)},toTransfer:d.compose(e.changed,
A.get),ui:m.ui,undo:d.constant(h.undo()),uploader:d.constant(h.uploader()),viewport:d.constant(C)})}});k("43",["c","6"],function(c,d){return{settings:function(b){var a=c.detect(),e={ui:{toolbar:{display:!1}},spelling:{bundled:!1},highlighter:{bundled:!1},table:{bundled:!1},resize:{bundled:!1},codeview:{bundled:!1},imageEdit:{bundled:!1},imageupload:{immediate:!0},linkvalidator:{bundled:!1}},g={resize:{bundled:!1}},a=a.deviceType.isTouch()?e:a.browser.isIE()?g:{};return d.deepMerge(a,void 0===b.content||
void 0===b.content.inline?{}:{fullscreen:{bundled:!1},codeview:{bundled:!1},plaincodeview:{bundled:!1}})}}});k("6f","b 7 s 1f 1a bl 21 2a v".split(" "),function(c,d,b,a,e,g,f,h,k){var m={isRtl:d.constant(!1)},n={isRtl:d.constant(!0)},p=function(a){return c.exists(["ar","fa","he"],function(b){return k.startsWith(a,b)})};return function(a){var c=p(a);return{directionAt:function(a){return"rtl"===(f.isText(a)?h.parent(a):b.some(a)).map(g.getDirection).getOr("ltr")?n:m},uiDirection:function(){return c?
n:m},updateUi:function(a){e.set(a,"dir",c?"rtl":"ltr")},destroy:d.noop}}});k("44","6 7 r 1f 6f 54 46".split(" "),function(c,d,b,a,e,g,f){return function(h,k){var m=f.create({create:g(["instance"]),loaded:g([]),focus:g([]),dirty:g([]),internal:g(["command","data"])}),n=b.cached(function(){m.trigger.loaded()}),p=function(a){a.events.focus.bind(function(){m.trigger.focus()});a.events.dirty.bind(function(){m.trigger.dirty()});a.events.internal.bind(function(a){m.trigger.internal(a.command(),a.data())});
a.events.loaded.bind(n)};p(h);var r=h,q=d.compose(e,a.get);return{get:function(){return r},swap:function(a,b){var e=r;e.cleanup();var f=c.deepMerge(k,b),g=e.state(),f=a(f,q(),g);p(f);m.trigger.create(f);r=f;return{old:d.constant(e),nu:d.constant(f),destroy:function(){e.destroy()}}},destroy:function(){r.cleanup();r.destroy()},events:m.registry}}});k("2e","b 3m 6 t 3w 3x 3y 3z 40 41 42 43 44 45 46 47 l o q 36".split(" "),function(c,d,b,a,e,g,f,h,k,m,n,p,r,q,s,t,u,v,w,x){var y=function(a){return b.deepMerge(g.settings(a.resources),
a,p.settings(a))};return function(p,z){var A=y(p);a.setLanguage(A.ui.locale.code);var C=b.deepMerge(g.state(),z),D=d.capture(u.fromDom(w),x),F=m(A,C),E=r(F,A),G=f(E),C=h(E,G,A,D),D=s.create({loaded:t([],E.events.loaded),focus:t([],E.events.focus),dirty:t([],E.events.dirty),connected:t([],G.events.connected),internal:t(["command","data"],E.events.internal)});a.waitForLoad().get(function(b){b=a.getFailures(b);0===b.length?(E.swap("code"===A.codeview.mode?e:k).destroy(),G.reconnect()):(c.each(b,function(a){v.error(a)}),
v.error("Required resources are not available. Cancelling editor load."),F.failure())});return n.external({activateInline:G.activateInline,communication:q.communication,connect:G.connect,content:G.content,deactivateInline:G.deactivateInline,element:G.element,events:D.registry,filter:G.filter,focus:G.focus,getContent:G.getContent,getMode:G.getMode,insertHtmlAtCursor:G.insertHtmlAtCursor,isDirty:G.isDirty,isPrettyPrinting:G.isPrettyPrinting,keyboard:G.keyboard,macros:G.macros,operations:G.operations,
setContent:G.setContent,setDirty:G.setDirty,smartview:G.smartview,state:G.state,ui:G.ui,undo:G.undo,setMode:C.setMode,uploadImages:C.uploadImages,registerBlob:C.registerBlob,destroy:C.destroy})}});k("1l","2c 24 2d 7 2e 1a 2f".split(" "),function(c,d,b,a,e,g,f){var h=function(a,b,h){var k=c.withOptions(a,h);k.content&&k.content.tabindex&&(0,g.remove)(a,"tabindex",k.content.tabindex);h=e(k);var r=f.get(a),q=g.get(a,"style");b(a);f.set(a,"");h.connect(a);d.set(h,r);return{polish:h,restore:function(b){f.set(a,
b);null!==q&&void 0!==q&&0<q.length?g.set(a,"style",q):g.remove(a,"style");k.content&&k.content.tabindex&&(0,g.set)(a,"tabindex",k.content.tabindex);return a}}};return{replace:function(a,c){return h(a,b.explicit,c)},takeover:function(b,c){return h(b,a.noop,c)}}});k("1c",["1l","6"],function(c,d){return{replace:function(b,a){var e=d.deepMerge(a,{platform:{fillscreen:!0}}),e=c.takeover(b,e);return{polish:e.polish,restore:e.restore}}}});k("1d","a b 1o 2g i 6 s v n".split(" "),function(c,d,b,a,e,g,f,h,
k){var m=function(a,b){var e={};if(void 0===a)return e;d.each(b,function(b){var d=b.name(),d=a[d];void 0!==d&&(b.validate(d),e[b.output()]=c.isArray(b.contents)?m(d,b.contents):d)});return e},n=function(a){return d.map(void 0===a?[]:a,function(a){var b=m,c=e.string("prefix"),d=e.string("suffix"),f;f=[e.string("color"),e.string("background-color")];f=g.merge(e.object("style"),{contents:f});return b(a,[c,d,f])})},p=function(a,b,c){if(void 0===a[b])return c;e.bool(b).validate(a[b]);return a[b]},r=function(a){if(void 0===
a||void 0===a.fonts)return[];a=a.fonts;if(!c.isArray(a))throw new k("The fonts configuration was not an array");var b=function(a,b){console.error(a+" :",b);throw new k(a);};return d.map(a,function(a){if(c.isString(a))return{value:a,text:a};c.isObject(a)||b("The fonts array value was not a string or object",a);void 0!==a.value&&c.isString(a.value)||b("The fonts value configuration was not a string or is undefined",a);void 0===a.text||c.isString(a.text)||b("The fonts text configuration was not a string",
a);void 0!==a.text&&c.isString(a.text)&&0===a.text.length&&b("The fonts text configuration was an empty string",a);return{value:a.value,text:a.text&&0<a.text.length?a.text:a.value}})},q=function(a){a=m(void 0===a?{}:a,[e.arrayOfStrings("languages")]);return void 0===a.languages?{}:{languages:d.map(a.languages,function(a){return a.toLowerCase()})}},s=function(a){return void 0===a.styles?{}:{styles:d.filter(a.styles,function(a){a=a.rule;return!(void 0===a||"."===a||0<=a.indexOf("..")||0<=a.indexOf("#"))})}},
t=function(a){var b=m(a,[e.arrayOfStrings("plugins")]),b=void 0===b.plugins?[]:b.plugins,d=m(a.ui,[e.string("locale","code")]),f=p(a,"autosubmit",!0),t=m(a.content,[e.arrayOfObjects("highlighters")]),u=m(a.paste,[e.string("style"),e.bool("enableFlashImport")]),A=m(a.css,[e.arrayOfStrings("stylesheets"),e.string("documentStyles")]),C=m(a.css,[e.arrayOfObjects("styles")]),D=m(a.ui,[e.bool("shortcuts","features")]),F=q(a.ui),E;E=a.codeview;E=m(void 0===E?{}:E,[e.bool("enabled"),e.bool("showButton")]);
E={bundled:void 0===E.enabled||!0===E.enabled,showButton:void 0===E.showButton||!0===E.showButton};var G;var H=a.spelling;if(void 0===H||void 0===H.url)G={service:!1};else{var I=p(H,"autocorrect",!0);if(c.isString(H.url))G={url:H.url,service:!0,autocorrect:I};else throw new k("Spelling URL was not a string");}var L;H=a.links;if(void 0===H||void 0===H.validation||void 0===H.validation.url)L={bundled:!1};else if(c.isString(H.validation.url))L={url:H.validation.url,bundled:!0};else throw new k("Link Validation URL was not a string");
H=a.images;H=g.merge({allowLocal:!0},void 0===H?{}:H);e.bool("allowLocal").validate(H.allowLocal);H=H.allowLocal;I=a.images;I=m((void 0===I?{}:I).editing,[e.bool("enabled"),e.string("proxy"),e.number("preferredWidth"),e.number("preferredHeight")]);void 0!==I.enabled&&(I.bundled=I.enabled);var J;if(H){var K=a.images;J=!1===I.bundled?!0:!1;K=(void 0===K?{}:K).upload;if(void 0!==K)if(void 0!==K.handler){if(!c.isFunction(K.handler))throw new k("Image Upload Handler was not a function");J={handler:K.handler,
immediate:J,bundled:!0}}else{if(!c.isString(K.url))throw new k("Image Upload URL was not a string");J={direct:m(K,[e.string("url"),e.string("basePath"),e.bool("credentials")]),immediate:J,bundled:!0}}else J={}}else J={};var K=a.ui,K=m((void 0===K?{}:K).toolbar,[e.arrayOfToolbarGroups("items"),e.arrayOfStrings("contextual")]),M;var N=a.ui;if(void 0===N)M={};else{if(void 0===N.toolbar)M={};else if(M=N.toolbar,void 0!==M.offset){M=M.offset;if(!c.isObject(M)||void 0===M.top||void 0===M.left)throw new k("toolbar offset must be an object with left and top");
if(!c.isNumber(M.top)&&!c.isNumber(M.left))throw new k("toolbar offset values must be numbers");M={draggable:!0,offset:{left:M.left,top:M.top}}}else M={};N=m(N.toolbar,[e.bool("visible"),e.bool("draggable")]);M=g.deepMerge(M,N)}var S;N=a.basePath;if(void 0===N)S=void 0;else{if(!c.isString(N))throw new k("The basePath configuration value was not a string");S=h.removeTrailing(N,"/")}N=r(a.ui);a=m(a.ui,[e.string("aria-label","editorName")]);a=g.merge(a,{locale:d,toolbar:M});d=S;N={faces:N};t={external:n(t.highlighters)};
M=u.style;return{resources:d,plugins:b,spelling:G,linkvalidator:L,font:N,ui:a,shortcuts:D,autosubmit:f,highlighter:t,smartclipboard:{paste:"plain"===M?{forceText:!0}:{officeStyles:"retain"===M?"merge":void 0!==M?M:"prompt",htmlStyles:"retain"===M?"merge":void 0!==M?M:"merge",allowLocalImages:H,enableFlashImport:!1===u.enableFlashImport?!1:!0}},parlance:F,content:A,imageEdit:I,imageupload:J,blocktag:s(C),fileupload:{allowLocalImages:H},platform:{toolbar:K,allowLocalImages:H},plaincodeview:{bundled:E.bundled},
codeview:E}},u=function(c){var d=void 0===c.privateapi?{}:c.privateapi;c=m(d.ui,[e.func("bounds"),e.bool("showHelpHint"),e.domElement("bottomBar"),e.domElement("sideBar")]);var h=m(d.integration,[e.string("type"),e.string("version")]),n=void 0===d.content?{}:d.content,p=m(n.macros,[e.arrayOfStrings("whitelist")]),n=m(n,[e.string("base")]);void 0!==p.whitelist&&(p.whitelist=f.some(p.whitelist));var q=a.paramList(),r=m(d.mentions,q),s=b.keys(r).length,d=m(d.output,[e.bool("prettyprint")]);if(0<s){if(s!==
q.length)throw new k("Missing @mentions configuration. Expected "+q.length+" objects, was "+s);r.bundled=!0}return{ui:c,help:{integration:h},macros:p,content:g.merge(n,d),mentions:r}};return function(a){a=void 0!==a?a:{};return g.deepMerge(t(a),u(a))}});k("u",["b"],function(c){return{getPath:function(d){var b=document.getElementsByTagName("script");return(b=c.find(b,function(a){return a.src.indexOf(d)===a.src.length-d.length}))?b.src.substring(0,b.src.indexOf(d)):void 0}}});k("5","67rstuv".split(""),
function(c,d,b,a,e,g,f){var h=b.cached(function(){return a.from(g.getPath("textboxio.js")).map(function(a){return f.removeTrailing(a,"/")})}),k=function(a){return a+"/resources"};return{setupResources:function(b){return a.from(b.resources).orThunk(h).map(k).fold(d.die("basePath auto detection failed, please provide one in the editor configuration"),function(a){a=e.load(a);return c.deepMerge(b,{resources:a})})},speculate:function(b){a.from(b).orThunk(h).map(k).each(e.load)}}});k("2v","49 c 7 s 1y 1b 3u l 37 q 3t".split(" "),
function(c,d,b,a,e,g,f,h,k,m,n){var p=function(a,b,c){var d=function(){var a=h.fromDom(m.activeElement);b(a)&&c()};return f.bind(a,"blur",function(){n(d,200)})},r=function(a,b,c){return f.bind(a,"focusout",function(a){t(a,b)&&c()})},q=function(a,b,c){return f.bind(a,"blur",function(a){t(a,b)&&c()})},s=function(){var a=d.detect();return a.browser.isFirefox()?p:a.browser.isIE()?r:q}(),t=function(b,c){var d=a.from(b.raw().relatedTarget).getOr(m.activeElement);return c(h.fromDom(d))};return{register:function(a,
b,d,h){var m=f.bind(a,"focus",d),n=s(a,function(d){return!k.closest(d,function(d){return g.eq(a,d)||g.eq(b(),d)||e.has(d,c.magicBox())})},h);return{destroy:function(){m.unbind();n.unbind()}}}}});k("2w",["4a","1a","1y","4b","2n"],function(c,d,b,a,e){return function(g,f,h){b.add(f,c.base());return{toolbarShow:function(){b.add(f,c.active());e.set(g(),"display","block")},toolbarHide:function(){b.remove(f,c.active());e.set(g(),"display","none")},isVisible:function(){return b.has(f,c.active())},restore:function(){a.remove(f,
[c.base(),c.active()]);d.setAll(f,h)}}}});k("1m","24 2v 2w 6 2e 2x 1a 2m 1b 2y 2f".split(" "),function(c,d,b,a,e,g,f,h,k,m,n){return{replace:function(p,r){var q=a.deepMerge(r,{content:{inline:p}}),s=f.clone(p),t=e(q),u=b(t.element,p,s),v=g(u.toolbarHide,u.toolbarShow,!1),w=function(){var a=u.isVisible();v.on();!1===a&&t.activateInline()},x=function(){t.deactivateInline();v.off()},y=d.register(p,t.element,w,x),q=function(){m.active().each(function(a){k.eq(a,p)||x()})};q();t.events.connected.bind(q);
t.events.loaded.bind(function(){t.content().getSelection().bind(w)});var B=t.focus,q={polish:a.merge(t,{focus:function(){w();B()}}),restore:function(a){y.destroy();u.restore();n.set(p,a);return p}};t.connect(h.body());c.set(t,n.get(p));return q}}});k("4c",["1a","l"],function(c,d){return{attach:function(b,a,e,g){if(4!==arguments.length)throw"requires 4 parameters";var f=function(a){return function(){var e=d.fromTag("input");c.setAll(e,{type:"hidden",name:a});b.append(e.dom());return function(a){e.val(a)}}},
h=e.getOrThunk(f(a)),k=g.getOrThunk(f(a+"_styles"));return function(a){h(a.content);k(a.styles)}}}});k("4d",[],function(){return function(c){var d=!1;return{submit:function(){d=!0;c.submit[0]?c.submit[0].click():c.submit.click?c.submit.click():c.submit();d=!1},inprogress:function(){return d}}}});k("30",["4c","4d"],function(c,d){var b=function(a,b){var c=a.onsubmit,f=d(a);a.onsubmit=function(d){if(f.inprogress())return!0;b(function(){c&&!1===c.apply(a)||setTimeout(f.submit,0)});return!1};return{unbind:function(){a.onsubmit=
c}}};return{attachToFormSubmit:b,attachToParentFormSubmit:function(a,d,g,f,h){if(5!==arguments.length)throw"requires 5 parameters";var k=a.parents("form:first");if(0!==k.size()){var m=k.get(0),n=c.attach(k,d,f,h);b(m,function(a){n(g());a()})}}}});k("1n","2z 2c 24 2d 30 s 2e 1a 2n l 2o 2q 31 2a 32".split(" "),function(c,d,b,a,e,g,f,h,k,m,n,p,r,q,s){var t=function(a,c,e,h){k.set(c,"display","none");var m=f(d.withOptions(c,h)),n=s.get(c);m.connect(a);b.set(m,n);var q=!0===h.autosubmit?u(c,m):g.none();
return{polish:m,restore:function(b){q.each(function(a){a.unbind()});s.set(c,b);e.fold(function(){k.remove(c,"display")},function(a){k.set(c,"display",a)});p.remove(a);return c}}},u=function(a,c){return r.closest(a,"form").map(function(d){return e.attachToFormSubmit(d.dom(),function(d){c.uploadImages(function(){s.set(a,b.get(c));d()})})})};return{replace:function(b,d){var e=k.getRaw(b,"display");return q.parent(b).fold(function(){return null},function(){var f=h.get(b,"id"),f=f?"ephox_"+f:c.generate("ephox"),
g=m.fromTag("div");h.set(g,"id",f);k.copy(b,g);a.copyFrom(b,g);n.before(b,g);return t(g,b,e,d)})}}});k("e","1c 1d 5 1l 1m 1n 6 7 r".split(" "),function(c,d,b,a,e,g,f,h,k){var m={textarea:g,div:a,body:c},n={div:e,blockquote:e,article:e,aside:e,figure:e,figcaption:e,footer:e,header:e,nav:e,section:e};return function(a){var c=function(c,e){var g=k.cached(function(){var c=f.deepMerge(d(e),a);return b.setupResources(c)});return{constructors:h.constant(c),options:g}};return{classic:function(a){return c(m,
a)},inline:function(a){a=f.deepMerge({ui:{toolbar:{draggable:!0}}},a);return c(n,a)}}}});k("h",["i","7"],function(c,d){var b=function(a){return{name:a.name,required:d.constant(!1),validate:a.validate}};return{bool:d.compose(b,c.bool),func:d.compose(b,c.func),number:d.compose(b,c.number),object:d.compose(b,c.object),string:d.compose(b,c.string)}});k("3","abcdef8ghij7klmno".split(""),function(c,d,b,a,e,g,f,h,k,m,n,p,r,q,s,t,u){return function(v){var w=a(),x=e(v),y=function(a,b){var d;d=c.isString(a)?
s.one(a).getOrThunk(p.die("Selector did not match any elements: "+a)):q.fromDom(a);return w.getOrCreate(d,b)},B=function(a,b){c.isString(a)?u.error("Selector did not match a "+b+": ",a):u.error("Element was not a "+b+": ",a);throw new t("Unable to create textbox.io editor");},z=b.detect(),A=function(a){c.isString(a)||n(a,[m.domElement("element")]);return c.isString(a)?s.all(a):d.map(a,q.fromDom)},C=function(a,b){var c=A(a),c=d.map(c,function(a){return w.getOrCreate(a,b)});return r.cat(c)};return g.makeReadOnly({replace:function(a,
b){n(arguments,[m.stringOrDom("element"),k.object("options")]);return y(a,x.classic(b)).getOrThunk(p.curry(B,a,"div or textarea"))},replaceAll:function(a,b){n(arguments,[m.stringOrArray("elements"),k.object("options")]);return C(a,x.classic(b))},inline:function(a,b){if(z.deviceType.isTouch())throw new t("Mobile does not not support inline editing");n(arguments,[m.stringOrDom("element"),k.object("options")]);return y(a,x.inline(b)).getOrThunk(p.curry(B,a,"supported tag for inline editing"))},inlineAll:function(a,
b){if(z.deviceType.isTouch())throw new t("Mobile does not not support inline editing");n(arguments,[m.stringOrArray("elements"),k.object("options")]);return C(a,x.inline(b))},get:function(a){n(arguments,[m.string("selector")]);return w.get(a)},getActiveEditor:function(){return w.getActiveEditor().getOr(null)},definePlugin:function(a,b){n(arguments,[m.string("namespace"),m.object("code")]);h.get(a).each(function(){throw new t("namespace "+a+" is already defined");});if(void 0===b.initialize||!c.isFunction(b.initialize))throw new t("plugin does not have an initialize function");
return h.register(a,b)},version:f,isSupported:p.constant(!0)})}});k("4",["c","p","o","q"],function(c,d,b,a){var e=function(a){return d.error("ERROR: Textbox.io requires "+a+" or above")},g=c.detect().os,f=c.detect().browser,h="CSS1Compat"===a.compatMode||"html"===a.doctype;return{supported:function(){if(f.isIE()&&11>f.version.major)return e("Internet Explorer 11");if(g.isOSX()&&f.isSafari()&&9>f.version.major)return e("Safari 9");if(g.isiOS()&&9>g.version.major)return e("iOS 9");if(!h&&f.isIE())return d.error("ERROR: Document is not in standards mode. Textbox.io requires standards mode on Internet Explorer.");
h||void 0===b.warn||b.warn("WARNING: Document is not in standards mode. Textbox.io may experience user interface issues.");return d.value()}}});k("0","1234567".split(""),function(c,d,b,a,e,g,f){var h=function(a){c.textboxio=a},k=f.compose(h,d);return function(){var d=c.install;c.install=function(f,p){c.install=d;a.supported().fold(k,function(){var a=null===p||void 0===p?{onprem:!0}:p,a=null===f||void 0===f?a:g.deepMerge(a,{resources:f});h(b(a));e.speculate(a.resources)})}}});ka("0")()})();
install();
